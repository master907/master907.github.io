<!-- ********** ********** ********** ********* **********
COPY AND PASTE THE FOLLOWING AUTO-GENERATED LINE INTO YOUR CUSTOMIZED HTML PAGE
<iframe src="test-3d.html" width="600px" height="480px" frameborder="0" scrolling="no"></iframe>
    ********** ********** ********** ********** ********** -->

<!-- Copyright (c) Simulation Lab Software (www.simlab-soft.com). All rights reserved. -->

<!-- Part of the code is covered by -->

<!--|--------------------------------------------------------------------| 
    | Raphaël 2.1.1 - JavaScript Vector Library                          | 
    |--------------------------------------------------------------------| 
    | Copyright © 2008-2012 Dmitry Baranovskiy (http://raphaeljs.com)    | 
    | Copyright © 2008-2012 Sencha Labs (http://sencha.com)              | 
    |--------------------------------------------------------------------| 
    | Licensed under the MIT (http://raphaeljs.com/license.html) license.| 
    |--------------------------------------------------------------------| -->

<!-- * @author Tim Knip / http://www.floorplanner.com/ / tim at floorplanner.com -->

<!-- three.js - http://github.com/mrdoob/three.js -->

<!-- Copyright (c) 2009 The Chromium Authors. All rights reserved. -->

<!-- * @author Eberhard Graether / http://egraether.com/ -->

<!-- zip.js - Copyright (c) 2013 Gildas Lormeau. All rights reserved. -->

<!-- progressbar.js 0.9.0 - https://kimmobrunfeldt.github.io/progressbar.js -->

<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<style type="text/css">
.modalContainer {
	background-color: transparent;
	width :500px;
	margin: 0 auto;
	padding:10px;
	display:inline-block;
	left: 0;
	position: absolute;
	top: 0;
	z-index: 10000;
	border-radius: 10px ;
}
#alertBox {
	background-color: rgba(239,239,239,1);
	border: 2px solid #000000;
	margin:0px;
	min-height: 100px;
	position: relative;
	min-width: 300px;
	border-radius: 10px ;
	display:inline-block;
}
.modalContainer > #alertBox {
}
#alertBox h1 {
	background-color: rgba(147,170,188,1);
	border-bottom: 1px solid #000000;
	color: rgba(0,0,0,1);
	/*font: bold 0.9em verdana,arial;*/
	margin: 0;
	padding: 2px 0 2px 5px;
	border-radius: 10px ;
}
#alertBox h3 {
	background-color: rgba(147,170,188,1);
	border-bottom: 1px solid #000000;
	color: rgba(0,0,0,1);
	/*font: bold 0.9em verdana,arial;*/
	margin: 0;
	padding: 2px 0 2px 5px;
	border-top-right-radius: 10px ;
	border-top-left-radius: 10px ;
}
#alertBox p {
	/*font: 0.7em verdana,arial;*/
	height: 50px;
	margin-left: 10px;
	padding-left: 5px;
}
#alertBox h5 {
	/*font: 0.7em verdana,arial;*/
	margin: 10px;
	padding: 4px;
}
#alertBox #closeBtn {
	background-color:rgba(147,170,188,1);
	border: 2px solid #000000;
	color: rgba(0,0,0,1);
	display: block;
	/*font: 0.7em verdana,arial;*/
	margin: 5px auto;
	padding: 3px;
	position: relative;
	text-align: center;
	text-decoration: none;
	text-transform: uppercase;
	width: 70px;
	border-radius: 5px ;
}
#mContainer {
	border-bottom: 2px solid #000000;
	border-top: 2px solid #000000;
	/*font: 0.7em verdana,arial;*/
	margin: auto;
	padding: 5px;
	position: relative;
}
h1, h2, h3 {
	border-bottom: 1px solid #000000;
	/*font: bold 1.5em verdana;*/
	margin: 0;
	padding: 4px;
}
code {
	color: #006699;
	font-size: 1.2em;
}
#credits {
	border-bottom: 1px solid #000000;
	border-top: 1px solid #000000;
	/*font: 0.7em verdana;*/
	height: 90px;
	padding-top: 4px;
	position: relative;
}

#loadingOverlay {
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	background-color: #000;
	filter:alpha(opacity=10);
	-moz-opacity:0.1;
	-khtml-opacity: 0.1;
	opacity: 0.1;
	z-index: 100;
	display: none;
}
#overlay {
	position: fixed;
	top: 0;
	left: 0;
	width: 100%;
	height: 100%;
	background-color: #000;
	filter:alpha(opacity=70);
	-moz-opacity:0.7;
	-khtml-opacity: 0.7;
	opacity: 0.7;
	z-index: 100;
	display: none;
}
.popup{
	width: 100%;
	left: 0;
	margin: 0 auto;
	display: none;
	position: fixed;
	z-index: 101;
}
.content{
	min-width: 600px;
	width: 600px;
	min-height: 150px;
	height: 600px;
	margin: 50px auto;
	background: #f3f3f3;
	position: relative;
	z-index: 103;
	padding: 10px;
	border-radius: 5px;
	box-shadow: 0 2px 5px #000;
}
.content .x{
	float: right;
	height: 25px;
	left: 20px;
	position: relative;
	top: -22px;
	width: 24px;
}
.content .x:hover{
	cursor: pointer;
}
#progressText {
top:27px;
margin: auto auto;
font-size:15px;
color: #eee;
position:relative;
visibility:hidden;
font-family:Gotham, "Helvetica Neue", Helvetica, Arial, sans-serif;
background-color:rgba(53, 53, 53, 1);
}
.progress {
height:195px;
font-size:78px;
top:98px;
margin: auto auto;
visibility:hidden;
position:relative;
font-family:Gotham, "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.progress > svg {
height:195px;
display: block;
-webkit-filter: blur(0px);
-moz-filter: blur(0px);
-ms-filter: blur(0px);
-o-filter: blur(0px);
filter: blur(0px);
}
.glowEffect {
height:195px;
width:195px;
border-radius: 100%;
box-shadow:
inset 0 0 100px #fff;
}
.opacityEffect {
opacity: 0.5;
}
@keyframes rotating {
from {
transform: rotate(0deg);
-ms-transform: rotate(0deg);
-moz-transform: rotate(0deg);
-webkit-transform: rotate(0deg);
-o-transform: rotate(0deg);
}
to {
transform: rotate(360deg);
-ms-transform: rotate(360deg);
-moz-transform: rotate(360deg);
-webkit-transform: rotate(360deg);
-o-transform: rotate(360deg);
}
}
@-webkit-keyframes rotating /* Safari and Chrome */ {
from {
transform: rotate(0deg);
-ms-transform: rotate(0deg);
-moz-transform: rotate(0deg);
-webkit-transform: rotate(0deg);
-o-transform: rotate(0deg);
}
to {
transform: rotate(360deg);
-ms-transform: rotate(360deg);
-moz-transform: rotate(360deg);
-webkit-transform: rotate(360deg);
-o-transform: rotate(360deg);
}
}
.rotating {
-webkit-animation: rotating 2s linear infinite;
-moz-animation: rotating 2s linear infinite;
-ms-animation: rotating 2s linear infinite;
-o-animation: rotating 2s linear infinite;
animation: rotating 2s linear infinite;
transform-origin: 50% 50%;
}
</style>
<script type="text/javascript">
(function(a){var z="File format is not recognized.";var K="CRC failed.";var A="File contains encrypted entry.";var S="File is using Zip64 (4gb+ file size).";var D="Error while reading zip file.";var n="Error while writing zip file.";var k="Error while writing file data.";var T="Error while reading file data.";var g="File already exists.";var C=512*1024;var c="text/plain";var H;try{H=new Blob([new DataView(new ArrayBuffer(0))]).size===0}catch(R){}function M(){this.crc=-1}M.prototype.append=function E(Y){var X=this.crc|0,W=this.table;for(var Z=0,e=Y.length|0;Z<e;Z++){X=(X>>>8)^W[(X^Y[Z])&255]}this.crc=X};M.prototype.get=function P(){return ~this.crc};M.prototype.table=(function(){var X,e,W,Y=[];for(X=0;X<256;X++){W=X;for(e=0;e<8;e++){if(W&1){W=(W>>>1)^3988292384}else{W=W>>>1}}Y[X]=W}return Y})();function j(){}j.prototype.append=function E(e,W){return e};j.prototype.flush=function i(){};function d(e,W,X){if(W<0||X<0||W+X>e.size){throw new RangeError("offset:"+W+", length:"+X+", size:"+e.size)}if(e.slice){return e.slice(W,W+X)}else{if(e.webkitSlice){return e.webkitSlice(W,W+X)}else{if(e.mozSlice){return e.mozSlice(W,W+X)}else{if(e.msSlice){return e.msSlice(W,W+X)}}}}}function I(X,W){var Y,e;Y=new ArrayBuffer(X);e=new Uint8Array(Y);if(W){e.set(W,0)}return{buffer:Y,array:e,view:new DataView(Y)}}function G(){}function Q(Z){var e=this,X;function Y(ac,aa){var ab=new Blob([Z],{type:c});X=new t(ab);X.init(function(){e.size=X.size;ac()},aa)}function W(ab,ac,ad,aa){X.readUint8Array(ab,ac,ad,aa)}e.size=0;e.init=Y;e.readUint8Array=W}Q.prototype=new G();Q.prototype.constructor=Q;function O(W){var X=this,e;function Z(ab){var aa=W.length;while(W.charAt(aa-1)=="="){aa--}e=W.indexOf(",")+1;X.size=Math.floor((aa-e)*0.75);ab()}function Y(af,ab,ah){var ae,ad=I(ab);var aa=Math.floor(af/3)*4;var ac=Math.ceil((af+ab)/3)*4;var ai=a.atob(W.substring(aa+e,ac+e));var ag=af-Math.floor(aa/4)*3;for(ae=ag;ae<ag+ab;ae++){ad.array[ae-ag]=ai.charCodeAt(ae)}ah(ad.array)}X.size=0;X.init=Z;X.readUint8Array=Y}O.prototype=new G();O.prototype.constructor=O;function t(e){var W=this;function Y(Z){W.size=e.size;Z()}function X(ab,ac,ae,aa){var Z=new FileReader();Z.onload=function(af){ae(new Uint8Array(af.target.result))};Z.onerror=aa;try{Z.readAsArrayBuffer(d(e,ab,ac))}catch(ad){aa(ad)}}W.size=0;W.init=Y;W.readUint8Array=X}t.prototype=new G();t.prototype.constructor=t;function h(){}h.prototype.getData=function(e){e(this.data)};function q(Y){var X=this,W;function aa(ab){W=new Blob([],{type:c});ab()}function Z(ac,ab){W=new Blob([W,H?ac:ac.buffer],{type:c});ab()}function e(ad,ac){var ab=new FileReader();ab.onload=function(ae){ad(ae.target.result)};ab.onerror=ac;ab.readAsText(W,Y)}X.init=aa;X.writeUint8Array=Z;X.getData=e}q.prototype=new h();q.prototype.constructor=q;function o(ab){var W=this,Y="",aa="";function Z(ac){Y+="data:"+(ab||"")+";base64,";ac()}function X(ag,af){var ac,ae=aa.length,ad=aa;aa="";for(ac=0;ac<(Math.floor((ae+ag.length)/3)*3)-ae;ac++){ad+=String.fromCharCode(ag[ac])}for(;ac<ag.length;ac++){aa+=String.fromCharCode(ag[ac])}if(ad.length>2){Y+=a.btoa(ad)}else{aa=ad}af()}function e(ac){ac(Y+a.btoa(aa))}W.init=Z;W.writeUint8Array=X;W.getData=e}o.prototype=new h();o.prototype.constructor=o;function N(aa){var W,X=this;function Z(ab){W=new Blob([],{type:aa});ab()}function Y(ac,ab){W=new Blob([W,H?ac:ac.buffer],{type:aa});ab()}function e(ab){ab(W)}X.init=Z;X.writeUint8Array=Y;X.getData=e}N.prototype=new h();N.prototype.constructor=N;function F(ab,W,X,aj,ac,ah,Z,Y,ak,aa){var e=0,af,ai,al=W.sn,ag;function am(){ab.removeEventListener("message",ad,false);Y(ai,ag)}function ad(ap){var ao=ap.data,aq=ao.data,an=ao.error;if(an){an.toString=function(){return"Error: "+this.message};ak(an);return}if(ao.sn!==al){return}if(typeof ao.codecTime==="number"){ab.codecTime+=ao.codecTime}if(typeof ao.crcTime==="number"){ab.crcTime+=ao.crcTime}switch(ao.type){case"append":if(aq){ai+=aq.length;aj.writeUint8Array(aq,function(){ae()},aa)}else{ae()}break;case"flush":ag=ao.crc;if(aq){ai+=aq.length;aj.writeUint8Array(aq,function(){am()},aa)}else{am()}break;case"progress":if(Z){Z(af+ao.loaded,ah)}break;case"importScripts":case"newTask":case"echo":break;default:console.warn("zip.js:launchWorkerProcess: unknown message: ",ao)}}function ae(){af=e*C;if(af<=ah){X.readUint8Array(ac+af,Math.min(C,ah-af),function(ap){if(Z){Z(af,ah)}var ao=af===0?W:{sn:al};ao.type="append";ao.data=ap;try{ab.postMessage(ao,[ap.buffer])}catch(an){ab.postMessage(ao)}e++},ak)}else{ab.postMessage({sn:al,type:"flush"})}}ai=0;ab.addEventListener("message",ad,false);ae()}function b(e,af,aa,ac,al,W,X,ak,Z,ad){var ai=0,ah,ab=0,aj=W==="input",ae=W==="output",ag=new M();function Y(){var am;ah=ai*C;if(ah<al){af.readUint8Array(ac+ah,Math.min(C,al-ah),function(ap){var ao;try{ao=e.append(ap,function(ar){if(X){X(ah+ar,al)}})}catch(aq){Z(aq);return}if(ao){ab+=ao.length;aa.writeUint8Array(ao,function(){ai++;setTimeout(Y,1)},ad);if(ae){ag.append(ao)}}else{ai++;setTimeout(Y,1)}if(aj){ag.append(ap)}if(X){X(ah,al)}},Z)}else{try{am=e.flush()}catch(an){Z(an);return}if(am){if(ae){ag.append(am)}ab+=am.length;aa.writeUint8Array(am,function(){ak(ab,ag.get())},ad)}else{ak(ab,ag.get())}}}Y()}function m(Y,X,ae,aa,ab,ah,af,ag,W,Z,ad){var e=af?"output":"none";if(a.zip.useWebWorkers){var ac={sn:X,codecClass:"Inflater",crcType:e};F(Y,ac,ae,aa,ab,ah,W,ag,Z,ad)}else{b(new a.zip.Inflater(),ae,aa,ab,ah,e,W,ag,Z,ad)}}function B(Z,Y,ae,aa,e,af,X,ab,ad){var W="input";if(a.zip.useWebWorkers){var ac={sn:Y,options:{level:e},codecClass:"Deflater",crcType:W};F(Z,ac,ae,aa,0,ae.size,X,af,ab,ad)}else{b(new a.zip.Deflater(),ae,aa,0,ae.size,W,X,af,ab,ad)}}function U(Y,X,ae,aa,ab,ah,af,ag,W,Z,ad){var e="input";if(a.zip.useWebWorkers&&af){var ac={sn:X,codecClass:"NOOP",crcType:e};F(Y,ac,ae,aa,ab,ah,W,ag,Z,ad)}else{b(new j(),ae,aa,ab,ah,e,W,ag,Z,ad)}}function J(Z){var Y,X="",W,e=["\u00C7","\u00FC","\u00E9","\u00E2","\u00E4","\u00E0","\u00E5","\u00E7","\u00EA","\u00EB","\u00E8","\u00EF","\u00EE","\u00EC","\u00C4","\u00C5","\u00C9","\u00E6","\u00C6","\u00F4","\u00F6","\u00F2","\u00FB","\u00F9","\u00FF","\u00D6","\u00DC","\u00F8","\u00A3","\u00D8","\u00D7","\u0192","\u00E1","\u00ED","\u00F3","\u00FA","\u00F1","\u00D1","\u00AA","\u00BA","\u00BF","\u00AE","\u00AC","\u00BD","\u00BC","\u00A1","\u00AB","\u00BB","_","_","_","\u00A6","\u00A6","\u00C1","\u00C2","\u00C0","\u00A9","\u00A6","\u00A6","+","+","\u00A2","\u00A5","+","+","-","-","+","-","+","\u00E3","\u00C3","+","+","-","-","\u00A6","-","+","\u00A4","\u00F0","\u00D0","\u00CA","\u00CB","\u00C8","i","\u00CD","\u00CE","\u00CF","+","+","_","_","\u00A6","\u00CC","_","\u00D3","\u00DF","\u00D4","\u00D2","\u00F5","\u00D5","\u00B5","\u00FE","\u00DE","\u00DA","\u00DB","\u00D9","\u00FD","\u00DD","\u00AF","\u00B4","\u00AD","\u00B1","_","\u00BE","\u00B6","\u00A7","\u00F7","\u00B8","\u00B0","\u00A8","\u00B7","\u00B9","\u00B3","\u00B2","_"," "];for(Y=0;Y<Z.length;Y++){W=Z.charCodeAt(Y)&255;if(W>127){X+=e[W-128]}else{X+=String.fromCharCode(W)}}return X}function x(e){return decodeURIComponent(escape(e))}function L(e){var W,X="";for(W=0;W<e.length;W++){X+=String.fromCharCode(e[W])}return X}function s(X){var W=(X&4294901760)>>16,Z=X&65535;try{return new Date(1980+((W&65024)>>9),((W&480)>>5)-1,W&31,(Z&63488)>>11,(Z&2016)>>5,(Z&31)*2,0)}catch(Y){}}function r(Y,Z,X,W,e){Y.version=Z.view.getUint16(X,true);Y.bitFlag=Z.view.getUint16(X+2,true);Y.compressionMethod=Z.view.getUint16(X+4,true);Y.lastModDateRaw=Z.view.getUint32(X+6,true);Y.lastModDate=s(Y.lastModDateRaw);if((Y.bitFlag&1)===1){e(A);return}if(W||(Y.bitFlag&8)!=8){Y.crc32=Z.view.getUint32(X+10,true);Y.compressedSize=Z.view.getUint32(X+14,true);Y.uncompressedSize=Z.view.getUint32(X+18,true)}if(Y.compressedSize===4294967295||Y.uncompressedSize===4294967295){e(S);return}Y.filenameLength=Z.view.getUint16(X+22,true);Y.extraFieldLength=Z.view.getUint16(X+24,true)}function V(W,ab,e){var aa=0;function X(){}X.prototype.getData=function(af,ak,ae,ac){var ai=this;function ad(al){var am=I(4);am.view.setUint32(0,al);return ai.crc32==am.view.getUint32(0)}function aj(al,am){if(ac&&!ad(am)){e(K)}else{af.getData(function(an){ak(an)})}}function ag(al){e(al||T)}function ah(al){e(al||k)}W.readUint8Array(ai.offset,30,function(am){var an=I(am.length,am),al;if(an.view.getUint32(0)!=1347093252){e(z);return}r(ai,an,4,false,e);al=ai.offset+30+ai.filenameLength+ai.extraFieldLength;af.init(function(){if(ai.compressionMethod===0){U(ai._worker,aa++,W,af,al,ai.compressedSize,ac,aj,ae,ag,ah)}else{m(ai._worker,aa++,W,af,al,ai.compressedSize,ac,aj,ae,ag,ah)}},ah)},ag)};function Z(af){var ad=22;if(W.size<ad){e(z);return}var ac=256*256,ae=ad+ac;ag(ad,function(){ag(Math.min(ae,W.size),function(){e(z)})});function ag(ah,ai){W.readUint8Array(W.size-ah,ah,function(aj){for(var ak=aj.length-ad;ak>=0;ak--){if(aj[ak]===80&&aj[ak+1]===75&&aj[ak+2]===5&&aj[ak+3]===6){af(new DataView(aj.buffer,ak,ad));return}}ai()},function(){e(D)})}}var Y={getEntries:function(ad){var ac=this._worker;Z(function(ag){var af,ae;af=ag.getUint32(16,true);ae=ag.getUint16(8,true);if(af<0||af>=W.size){e(z);return}W.readUint8Array(af,W.size-af,function(ai){var al,ak=0,ah=[],am,aj,ao,an=I(ai.length,ai);for(al=0;al<ae;al++){am=new X();am._worker=ac;if(an.view.getUint32(ak)!=1347092738){e(z);return}r(am,an,ak+6,true,e);am.commentLength=an.view.getUint16(ak+32,true);am.directory=((an.view.getUint8(ak+38)&16)==16);am.offset=an.view.getUint32(ak+42,true);aj=L(an.array.subarray(ak+46,ak+46+am.filenameLength));am.filename=((am.bitFlag&2048)===2048)?x(aj):J(aj);if(!am.directory&&am.filename.charAt(am.filename.length-1)=="/"){am.directory=true}ao=L(an.array.subarray(ak+46+am.filenameLength+am.extraFieldLength,ak+46+am.filenameLength+am.extraFieldLength+am.commentLength));am.comment=((am.bitFlag&2048)===2048)?x(ao):J(ao);ah.push(am);ak+=46+am.filenameLength+am.extraFieldLength+am.commentLength}ad(ah)},function(){e(D)})})},close:function(ac){if(this._worker){this._worker.terminate();this._worker=null}if(ac){ac()}},_worker:null};if(!a.zip.useWebWorkers){ab(Y)}else{w("inflater",function(ac){Y._worker=ac;ab(Y)},function(ac){e(ac)})}}function y(e){return unescape(encodeURIComponent(e))}function f(W){var e,X=[];for(e=0;e<W.length;e++){X.push(W.charCodeAt(e))}return X}function v(Y,ae,ad,Z){var e={},ab=[],af=0;var ac=0;function aa(ag){ad(ag||n)}function X(ag){ad(ag||T)}var W={add:function(ai,ao,aq,aj,ar){var an,ah,al;var ak=this._worker;function ap(au){var at;al=ar.lastModDate||new Date();an=I(26);e[ai]={headerArray:an.array,directory:ar.directory,filename:ah,offset:af,comment:f(y(ar.comment||""))};an.view.setUint32(0,335546376);if(ar.version){an.view.setUint8(0,ar.version)}if(!Z&&ar.level!==0&&!ar.directory){an.view.setUint16(4,2048)}an.view.setUint16(6,(((al.getHours()<<6)|al.getMinutes())<<5)|al.getSeconds()/2,true);an.view.setUint16(8,((((al.getFullYear()-1980)<<4)|(al.getMonth()+1))<<5)|al.getDate(),true);an.view.setUint16(22,ah.length,true);at=I(30+ah.length);at.view.setUint32(0,1347093252);at.array.set(an.array,4);at.array.set(ah,30);af+=at.array.length;Y.writeUint8Array(at.array,au,aa)}function ag(at,au){var av=I(16);af+=at||0;av.view.setUint32(0,1347094280);if(typeof au!="undefined"){an.view.setUint32(10,au,true);av.view.setUint32(4,au,true)}if(ao){av.view.setUint32(8,at,true);an.view.setUint32(14,at,true);av.view.setUint32(12,ao.size,true);an.view.setUint32(18,ao.size,true)}Y.writeUint8Array(av.array,function(){af+=16;aq()},aa)}function am(){ar=ar||{};ai=ai.trim();if(ar.directory&&ai.charAt(ai.length-1)!="/"){ai+="/"}if(e.hasOwnProperty(ai)){ad(g);return}ah=f(y(ai));ab.push(ai);ap(function(){if(ao){if(Z||ar.level===0){U(ak,ac++,ao,Y,0,ao.size,true,ag,aj,X,aa)}else{B(ak,ac++,ao,Y,ar.level,ag,aj,X,aa)}}else{ag()}},aa)}if(ao){ao.init(am,X)}else{am()}},close:function(al){if(this._worker){this._worker.terminate();this._worker=null}var ak,aj=0,ah=0,ag,ai;for(ag=0;ag<ab.length;ag++){ai=e[ab[ag]];aj+=46+ai.filename.length+ai.comment.length}ak=I(aj+22);for(ag=0;ag<ab.length;ag++){ai=e[ab[ag]];ak.view.setUint32(ah,1347092738);ak.view.setUint16(ah+4,5120);ak.array.set(ai.headerArray,ah+6);ak.view.setUint16(ah+32,ai.comment.length,true);if(ai.directory){ak.view.setUint8(ah+38,16)}ak.view.setUint32(ah+42,ai.offset,true);ak.array.set(ai.filename,ah+46);ak.array.set(ai.comment,ah+46+ai.filename.length);ah+=46+ai.filename.length+ai.comment.length}ak.view.setUint32(ah,1347093766);ak.view.setUint16(ah+8,ab.length,true);ak.view.setUint16(ah+10,ab.length,true);ak.view.setUint32(ah+12,aj,true);ak.view.setUint32(ah+16,af,true);Y.writeUint8Array(ak.array,function(){Y.getData(al)},aa)},_worker:null};if(!a.zip.useWebWorkers){ae(W)}else{w("deflater",function(ag){W._worker=ag;ae(W)},function(ag){ad(ag)})}}function p(W){var e=document.createElement("a");return W.map(function(X){e.href=X;return e.href})}var l={deflater:["z-worker.js","deflate.js"],inflater:["z-worker.js","inflate.js"]};function w(Y,ab,W){if(a.zip.workerScripts!==null&&a.zip.workerScriptsPath!==null){W(new Error("Either zip.workerScripts or zip.workerScriptsPath may be set, not both."));return}var e;if(a.zip.workerScripts){e=a.zip.workerScripts[Y];if(!Array.isArray(e)){W(new Error("zip.workerScripts."+Y+" is not an array!"));return}e=p(e)}else{e=l[Y].slice(0);e[0]=(a.zip.workerScriptsPath||"")+e[0]}var Z=new Worker(e[0]);Z.codecTime=Z.crcTime=0;Z.postMessage({type:"importScripts",scripts:e.slice(1)});Z.addEventListener("message",aa);function aa(ac){var ad=ac.data;if(ad.error){Z.terminate();W(ad.error);return}if(ad.type==="importScripts"){Z.removeEventListener("message",aa);Z.removeEventListener("error",X);ab(Z)}}Z.addEventListener("error",X);function X(ac){Z.terminate();W(ac)}}function u(e){console.error(e)}a.zip={Reader:G,Writer:h,BlobReader:t,Data64URIReader:O,TextReader:Q,BlobWriter:N,Data64URIWriter:o,TextWriter:q,createReader:function(W,X,e){e=e||u;W.init(function(){V(W,X,e)},e)},createWriter:function(W,Y,e,X){e=e||u;X=!!X;W.init(function(){v(W,Y,e,X)},e)},useWebWorkers:true,workerScriptsPath:null,workerScripts:null}})(this);
</script>
<script type="text/javascript">
(function(){var i=512*1024;var j=zip.TextWriter,r=zip.BlobWriter,u=zip.Data64URIWriter,x=zip.Reader,v=zip.TextReader,a=zip.BlobReader,c=zip.Data64URIReader,q=zip.createReader,g=zip.createWriter;function h(C){var B=this,E;function F(G){B.size=C.uncompressedSize;G()}function A(G){if(B.data){G()}else{C.getData(new r(),function(H){B.data=H;E=new a(H);G()},null,B.checkCrc32)}}function D(H,I,J,G){A(function(){E.readUint8Array(H,I,J,G)},G)}B.size=0;B.init=F;B.readUint8Array=D}h.prototype=new x();h.prototype.constructor=h;h.prototype.checkCrc32=false;function s(B){var A=0;function C(D){A+=D.uncompressedSize||0;D.children.forEach(C)}C(B);return A}function l(D,E,A){var B=0;function C(){B++;if(B<D.children.length){F(D.children[B])}else{E()}}function F(G){if(G.directory){l(G,C,A)}else{G.reader=new G.Reader(G.data,A);G.reader.init(function(){G.uncompressedSize=G.reader.size;C()})}}if(D.children.length){F(D.children[B])}else{E()}}function y(B){var A=B.parent.children;A.forEach(function(D,C){if(D.id==B.id){A.splice(C,1)}})}function m(C,D,F,E,B){var A=0;function G(J,K,M,L,H){var N=0;function I(){var O=K.children[N];if(O){J.add(O.getFullname(),O.reader,function(){A+=O.uncompressedSize||0;G(J,O,function(){N++;I()},L,H)},function(P){if(L){L(A+P,H)}},{directory:O.directory,version:O.zipVersion})}else{M()}}I()}G(C,D,F,E,B)}function p(D,F,B,A){function E(H,G){if(H.isDirectory){H.createReader().readEntries(G)}if(H.isFile){G([])}}function C(H,I,G){E(I,function(J){var M=0;function L(O){function N(P){C(P,O,function(){M++;K()})}if(O.isDirectory){N(H.addDirectory(O.name))}if(O.isFile){O.file(function(Q){var P=H.addBlob(O.name,Q);P.uncompressedSize=Q.size;N(P)},A)}}function K(){var N=J[M];if(N){L(N)}else{G()}}K()})}if(F.isDirectory){C(D,F,B)}else{F.file(function(G){D.addBlob(F.name,G);B()},A)}}function z(D,G,I,C,F,H,A){var E=0;function B(M,P,R,K,O,Q){var L=0;function N(T){function S(U){E+=T.uncompressedSize||0;B(U,T,function(){L++;J()},K,O,Q)}if(T.directory){M.getDirectory(T.name,{create:true},S,O)}else{M.getFile(T.name,{create:true},function(U){T.getData(new zip.FileWriter(U,zip.getMimeType(T.name)),S,function(V){if(K){K(E+V,Q)}},A)},O)}}function J(){var S=P.children[L];if(S){N(S)}else{R()}}J()}if(G.directory){B(D,G,I,C,F,H)}else{G.getData(new zip.FileWriter(D,zip.getMimeType(G.name)),I,C,A)}}function o(A){A.entries=[];A.root=new t(A)}function k(B,G,F,E,A){var C=0;function D(){var H=C*i;if(E){E(H,B.size)}if(H<B.size){B.readUint8Array(H,Math.min(i,B.size-H),function(I){G.writeUint8Array(new Uint8Array(I),function(){C++;D()})},A)}else{G.getData(F)}}D()}function d(C,B,D,A){if(C.directory){return A?new t(C.fs,B,D,C):new w(C.fs,B,D,C)}else{throw"Parent entry is not a directory."}}function f(){}f.prototype={init:function(A,B,E,C){var D=this;if(A.root&&C&&C.getChildByName(B)){throw"Entry filename already exists."}if(!E){E={}}D.fs=A;D.name=B;D.id=A.entries.length;D.parent=C;D.children=[];D.zipVersion=E.zipVersion||20;D.uncompressedSize=0;A.entries.push(D);if(C){D.parent.children.push(D)}},getFileEntry:function(F,E,D,A,B){var C=this;l(C,function(){z(F,C,E,D,A,s(C),B)},A)},moveTo:function(B){var A=this;if(B.directory){if(!B.isDescendantOf(A)){if(A!=B){if(B.getChildByName(A.name)){throw"Entry filename already exists."}y(A);A.parent=B;B.children.push(A)}}else{throw"Entry is a ancestor of target entry."}}else{throw"Target entry is not a directory."}},getFullname:function(){var C=this,A=C.name,B=C.parent;while(B){A=(B.name?B.name+"/":"")+A;B=B.parent}return A},isDescendantOf:function(A){var B=this.parent;while(B&&B.id!=A.id){B=B.parent}return !!B}};f.prototype.constructor=f;var n;function w(A,B,E,C){var D=this;f.prototype.init.call(D,A,B,E,C);D.Reader=E.Reader;D.Writer=E.Writer;D.data=E.data;if(E.getData){D.getData=E.getData}}w.prototype=n=new f();n.constructor=w;n.getData=function(E,D,C,A){var B=this;if(!E||(E.constructor==B.Writer&&B.data)){D(B.data)}else{if(!B.reader){B.reader=new B.Reader(B.data,A)}B.reader.init(function(){E.init(function(){k(B.reader,E,D,C,A)},A)})}};n.getText=function(D,C,A,B){this.getData(new j(B),D,C,A)};n.getBlob=function(D,C,B,A){this.getData(new r(D),C,B,A)};n.getData64URI=function(D,C,B,A){this.getData(new u(D),C,B,A)};var e;function t(A,B,E,C){var D=this;f.prototype.init.call(D,A,B,E,C);D.directory=true}t.prototype=e=new f();e.constructor=t;e.addDirectory=function(A){return d(this,A,null,true)};e.addText=function(A,B){return d(this,A,{data:B,Reader:v,Writer:j})};e.addBlob=function(B,A){return d(this,B,{data:A,Reader:a,Writer:r})};e.addData64URI=function(B,A){return d(this,B,{data:A,Reader:c,Writer:u})};e.addFileEntry=function(C,B,A){p(this,C,B,A)};e.addData=function(A,B){return d(this,A,B)};e.importBlob=function(B,C,A){this.importZip(new a(B),C,A)};e.importText=function(C,B,A){this.importZip(new v(C),B,A)};e.importData64URI=function(B,C,A){this.importZip(new c(B),C,A)};e.exportBlob=function(C,B,A){this.exportZip(new r("application/zip"),C,B,A)};e.exportText=function(C,B,A){this.exportZip(new j(),C,B,A)};e.exportFileEntry=function(D,C,B,A){this.exportZip(new zip.FileWriter(D,"application/zip"),C,B,A)};e.exportData64URI=function(C,B,A){this.exportZip(new u("application/zip"),C,B,A)};e.importZip=function(B,D,A){var C=this;q(B,function(E){E.getEntries(function(F){F.forEach(function(I){var H=C,J=I.filename.split("/"),G=J.pop();J.forEach(function(K){H=H.getChildByName(K)||new t(C.fs,K,null,H)});if(!I.directory){d(H,G,{data:I,Reader:h})}});D()})},A)};e.exportZip=function(E,D,C,A){var B=this;l(B,function(){g(E,function(F){m(F,B,function(){F.close(D)},C,s(B))},A)},A)};e.getChildByName=function(A){var D,C,B=this;for(D=0;D<B.children.length;D++){C=B.children[D];if(C.name==A){return C}}};function b(){o(this)}b.prototype={remove:function(A){y(A);this.entries[A.id]=null},find:function(A){var B,D=A.split("/"),C=this.root;for(B=0;C&&B<D.length;B++){C=C.getChildByName(D[B])}return C},getById:function(A){return this.entries[A]},importBlob:function(B,C,A){o(this);this.root.importBlob(B,C,A)},importText:function(C,B,A){o(this);this.root.importText(C,B,A)},importData64URI:function(B,C,A){o(this);this.root.importData64URI(B,C,A)},exportBlob:function(C,B,A){this.root.exportBlob(C,B,A)},exportText:function(C,B,A){this.root.exportText(C,B,A)},exportFileEntry:function(D,C,B,A){this.root.exportFileEntry(D,C,B,A)},exportData64URI:function(C,B,A){this.root.exportData64URI(C,B,A)}};zip.fs={FS:b,ZipDirectoryEntry:t,ZipFileEntry:w};zip.getMimeType=function(){return"application/octet-stream"}})();
</script>
<script type="text/javascript">
(function(){var b="HTTP Range not supported.";var i=zip.Reader;var f=zip.Writer;var g;var d;try{d=new Blob([new DataView(new ArrayBuffer(0))]).size===0}catch(h){}function c(m){var n=this;function e(s,q){var r;if(!n.data){r=new XMLHttpRequest();r.addEventListener("load",function(){if(!n.size){n.size=Number(r.getResponseHeader("Content-Length"))}n.data=new Uint8Array(r.response);s()},false);r.addEventListener("error",q,false);r.open("GET",m);r.responseType="arraybuffer";r.send()}else{s()}}function p(s,q){var r=new XMLHttpRequest();r.addEventListener("load",function(){n.size=Number(r.getResponseHeader("Content-Length"));s()},false);r.addEventListener("error",q,false);r.open("HEAD",m);r.send()}function o(r,s,t,q){e(function(){t(new Uint8Array(n.data.subarray(r,r+s)))},q)}n.size=0;n.init=p;n.readUint8Array=o}c.prototype=new i();c.prototype.constructor=c;function j(e){var m=this;function p(s,q){var r=new XMLHttpRequest();r.addEventListener("load",function(){m.size=Number(r.getResponseHeader("Content-Length"));if(r.getResponseHeader("Accept-Ranges")=="bytes"){s()}else{q(b)}},false);r.addEventListener("error",q,false);r.open("HEAD",e);r.send()}function o(r,t,u,q){var s=new XMLHttpRequest();s.open("GET",e);s.responseType="arraybuffer";s.setRequestHeader("Range","bytes="+r+"-"+(r+t-1));s.addEventListener("load",function(){u(s.response)},false);s.addEventListener("error",q,false);s.send()}function n(r,s,t,q){o(r,s,function(u){t(new Uint8Array(u))},q)}m.size=0;m.init=p;m.readUint8Array=n}j.prototype=new i();j.prototype.constructor=j;function a(e){var m=this;function o(q,p){m.size=e.byteLength;q()}function n(q,r,s,p){s(new Uint8Array(e.slice(q,q+r)))}m.size=0;m.init=o;m.readUint8Array=n}a.prototype=new i();a.prototype.constructor=a;function k(){var p,m=this;function o(r,q){p=new Uint8Array();r()}function n(r,t,q){var s=new Uint8Array(p.length+r.length);s.set(p);s.set(r,p.length);p=s;t()}function e(q){q(p.buffer)}m.init=o;m.writeUint8Array=n;m.getData=e}k.prototype=new f();k.prototype.constructor=k;function l(r,q){var o,m=this;function p(t,s){r.createWriter(function(u){o=u;t()},s)}function n(v,u,s){var t=new Blob([d?v:v.buffer],{type:q});o.onwrite=function(){o.onwrite=null;u()};o.onerror=s;o.write(t)}function e(s){r.file(s)}m.init=p;m.writeUint8Array=n;m.getData=e}l.prototype=new f();l.prototype.constructor=l;zip.FileWriter=l;zip.HttpReader=c;zip.HttpRangeReader=j;zip.ArrayBufferReader=a;zip.ArrayBufferWriter=k;if(zip.fs){g=zip.fs.ZipDirectoryEntry;g.prototype.addHttpContent=function(m,e,n){function o(r,q,s,p){if(r.directory){return p?new g(r.fs,q,s,r):new zip.fs.ZipFileEntry(r.fs,q,s,r)}else{throw"Parent entry is not a directory."}}return o(this,m,{data:e,Reader:n?j:c})};g.prototype.importHttpContent=function(m,n,o,e){this.importZip(n?new j(m):new c(m),o,e)};zip.fs.FS.prototype.importHttpContent=function(m,n,o,e){this.entries=[];this.root=new g(this);this.root.importHttpContent(m,n,o,e)}}})();
</script>
<script type="text/javascript">
zip.useWebWorkers=false;
//zip.workerScriptsPath = 'lib/';
</script>
<script type="text/javascript">
(function(a){var ag=15;var s=0;var af=1;var M=2;var ak=-2;var k=-3;var e=-4;var O=-5;var V=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535];var W=1440;var ad=0;var h=4;var x=9;var D=5;var I=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255];var S=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577];var aj=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0];var Y=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112];var J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];var t=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var c=15;function n(){var ap=this;var al;var at;var aq;var am;var au;var ar;function an(aT,ax,aH,aE,aS,aR,aD,aI,av,aw,aC){var aU;var aQ;var aP;var aO;var aN;var aL;var aK;var aJ;var aM;var aG;var aF;var aB;var aA;var az;var ay;aG=0;aN=aH;do{aq[aT[ax+aG]]++;aG++;aN--}while(aN!==0);if(aq[0]==aH){aD[0]=-1;aI[0]=0;return s}aJ=aI[0];for(aL=1;aL<=c;aL++){if(aq[aL]!==0){break}}aK=aL;if(aJ<aL){aJ=aL}for(aN=c;aN!==0;aN--){if(aq[aN]!==0){break}}aP=aN;if(aJ>aN){aJ=aN}aI[0]=aJ;for(az=1<<aL;aL<aN;aL++,az<<=1){if((az-=aq[aL])<0){return k}}if((az-=aq[aN])<0){return k}aq[aN]+=az;ar[1]=aL=0;aG=1;aA=2;while(--aN!==0){ar[aA]=(aL+=aq[aG]);aA++;aG++}aN=0;aG=0;do{if((aL=aT[ax+aG])!==0){aC[ar[aL]++]=aN}aG++}while(++aN<aH);aH=ar[aP];ar[0]=aN=0;aG=0;aO=-1;aB=-aJ;au[0]=0;aF=0;ay=0;for(;aK<=aP;aK++){aU=aq[aK];while(aU--!==0){while(aK>aB+aJ){aO++;aB+=aJ;ay=aP-aB;ay=(ay>aJ)?aJ:ay;if((aQ=1<<(aL=aK-aB))>aU+1){aQ-=aU+1;aA=aK;if(aL<ay){while(++aL<ay){if((aQ<<=1)<=aq[++aA]){break}aQ-=aq[aA]}}}ay=1<<aL;if(aw[0]+ay>W){return k}au[aO]=aF=aw[0];aw[0]+=ay;if(aO!==0){ar[aO]=aN;am[0]=aL;am[1]=aJ;aL=aN>>>(aB-aJ);am[2]=(aF-au[aO-1]-aL);av.set(am,(au[aO-1]+aL)*3)}else{aD[0]=aF}}am[1]=(aK-aB);if(aG>=aH){am[0]=128+64}else{if(aC[aG]<aE){am[0]=(aC[aG]<256?0:32+64);am[2]=aC[aG++]}else{am[0]=(aR[aC[aG]-aE]+16+64);am[2]=aS[aC[aG++]-aE]}}aQ=1<<(aK-aB);for(aL=aN>>>aB;aL<ay;aL+=aQ){av.set(am,(aF+aL)*3)}for(aL=1<<(aK-1);(aN&aL)!==0;aL>>>=1){aN^=aL}aN^=aL;aM=(1<<aB)-1;while((aN&aM)!=ar[aO]){aO--;aB-=aJ;aM=(1<<aB)-1}}}return az!==0&&aP!=1?O:s}function ao(aw){var av;if(!al){al=[];at=[];aq=new Int32Array(c+1);am=[];au=new Int32Array(c);ar=new Int32Array(c+1)}if(at.length<aw){at=[]}for(av=0;av<aw;av++){at[av]=0}for(av=0;av<c+1;av++){aq[av]=0}for(av=0;av<3;av++){am[av]=0}au.set(aq.subarray(0,c),0);ar.set(aq.subarray(0,c+1),0)}ap.inflate_trees_bits=function(aA,az,aw,ax,ay){var av;ao(19);al[0]=0;av=an(aA,0,19,19,null,null,aw,az,ax,al,at);if(av==k){ay.msg="oversubscribed dynamic bit lengths tree"}else{if(av==O||az[0]===0){ay.msg="incomplete dynamic bit lengths tree";av=k}}return av};ap.inflate_trees_dynamic=function(av,ay,aB,aw,az,aD,ax,aC,aA){var aE;ao(288);al[0]=0;aE=an(aB,0,av,257,aj,Y,aD,aw,aC,al,at);if(aE!=s||aw[0]===0){if(aE==k){aA.msg="oversubscribed literal/length tree"}else{if(aE!=e){aA.msg="incomplete literal/length tree";aE=k}}return aE}ao(288);aE=an(aB,av,ay,0,J,t,ax,az,aC,al,at);if(aE!=s||(az[0]===0&&av>257)){if(aE==k){aA.msg="oversubscribed distance tree"}else{if(aE==O){aA.msg="incomplete distance tree";aE=k}else{if(aE!=e){aA.msg="empty distance tree with lengths";aE=k}}}return aE}return s}}n.inflate_trees_fixed=function(ao,am,al,an){ao[0]=x;am[0]=D;al[0]=I;an[0]=S;return s};var K=0;var ac=1;var Z=2;var z=3;var b=4;var p=5;var A=6;var r=7;var ab=8;var E=9;function f(){var av=this;var at;var aw=0;var aB;var aq=0;var az=0;var aA=0;var ao=0;var ay=0;var ar=0;var an=0;var ax;var am=0;var ap;var al=0;function au(aC,aF,aE,aG,aH,aX,aK,aI){var aJ;var aD;var aN;var aU;var aY;var aS;var aO;var aQ;var aM;var aR;var aT;var aZ;var aW;var aV;var aL;var aP;aO=aI.next_in_index;aQ=aI.avail_in;aY=aK.bitb;aS=aK.bitk;aM=aK.write;aR=aM<aK.read?aK.read-aM-1:aK.end-aM;aT=V[aC];aZ=V[aF];do{while(aS<(20)){aQ--;aY|=(aI.read_byte(aO++)&255)<<aS;aS+=8}aJ=aY&aT;aD=aE;aN=aG;aP=(aN+aJ)*3;if((aU=aD[aP])===0){aY>>=(aD[aP+1]);aS-=(aD[aP+1]);aK.window[aM++]=aD[aP+2];aR--;continue}do{aY>>=(aD[aP+1]);aS-=(aD[aP+1]);if((aU&16)!==0){aU&=15;aW=aD[aP+2]+(aY&V[aU]);aY>>=aU;aS-=aU;while(aS<(15)){aQ--;aY|=(aI.read_byte(aO++)&255)<<aS;aS+=8}aJ=aY&aZ;aD=aH;aN=aX;aP=(aN+aJ)*3;aU=aD[aP];do{aY>>=(aD[aP+1]);aS-=(aD[aP+1]);if((aU&16)!==0){aU&=15;while(aS<(aU)){aQ--;aY|=(aI.read_byte(aO++)&255)<<aS;aS+=8}aV=aD[aP+2]+(aY&V[aU]);aY>>=(aU);aS-=(aU);aR-=aW;if(aM>=aV){aL=aM-aV;if(aM-aL>0&&2>(aM-aL)){aK.window[aM++]=aK.window[aL++];aK.window[aM++]=aK.window[aL++];aW-=2}else{aK.window.set(aK.window.subarray(aL,aL+2),aM);aM+=2;aL+=2;aW-=2}}else{aL=aM-aV;do{aL+=aK.end}while(aL<0);aU=aK.end-aL;if(aW>aU){aW-=aU;if(aM-aL>0&&aU>(aM-aL)){do{aK.window[aM++]=aK.window[aL++]}while(--aU!==0)}else{aK.window.set(aK.window.subarray(aL,aL+aU),aM);aM+=aU;aL+=aU;aU=0}aL=0}}if(aM-aL>0&&aW>(aM-aL)){do{aK.window[aM++]=aK.window[aL++]}while(--aW!==0)}else{aK.window.set(aK.window.subarray(aL,aL+aW),aM);aM+=aW;aL+=aW;aW=0}break}else{if((aU&64)===0){aJ+=aD[aP+2];aJ+=(aY&V[aU]);aP=(aN+aJ)*3;aU=aD[aP]}else{aI.msg="invalid distance code";aW=aI.avail_in-aQ;aW=(aS>>3)<aW?aS>>3:aW;aQ+=aW;aO-=aW;aS-=aW<<3;aK.bitb=aY;aK.bitk=aS;aI.avail_in=aQ;aI.total_in+=aO-aI.next_in_index;aI.next_in_index=aO;aK.write=aM;return k}}}while(true);break}if((aU&64)===0){aJ+=aD[aP+2];aJ+=(aY&V[aU]);aP=(aN+aJ)*3;if((aU=aD[aP])===0){aY>>=(aD[aP+1]);aS-=(aD[aP+1]);aK.window[aM++]=aD[aP+2];aR--;break}}else{if((aU&32)!==0){aW=aI.avail_in-aQ;aW=(aS>>3)<aW?aS>>3:aW;aQ+=aW;aO-=aW;aS-=aW<<3;aK.bitb=aY;aK.bitk=aS;aI.avail_in=aQ;aI.total_in+=aO-aI.next_in_index;aI.next_in_index=aO;aK.write=aM;return af}else{aI.msg="invalid literal/length code";aW=aI.avail_in-aQ;aW=(aS>>3)<aW?aS>>3:aW;aQ+=aW;aO-=aW;aS-=aW<<3;aK.bitb=aY;aK.bitk=aS;aI.avail_in=aQ;aI.total_in+=aO-aI.next_in_index;aI.next_in_index=aO;aK.write=aM;return k}}}while(true)}while(aR>=258&&aQ>=10);aW=aI.avail_in-aQ;aW=(aS>>3)<aW?aS>>3:aW;aQ+=aW;aO-=aW;aS-=aW<<3;aK.bitb=aY;aK.bitk=aS;aI.avail_in=aQ;aI.total_in+=aO-aI.next_in_index;aI.next_in_index=aO;aK.write=aM;return s}av.init=function(aH,aF,aC,aE,aG,aD){at=K;ar=aH;an=aF;ax=aC;am=aE;ap=aG;al=aD;aB=null};av.proc=function(aO,aM,aC){var aJ;var aF;var aL;var aN=0;var aI=0;var aE=0;var aG;var aD;var aH;var aK;aE=aM.next_in_index;aG=aM.avail_in;aN=aO.bitb;aI=aO.bitk;aD=aO.write;aH=aD<aO.read?aO.read-aD-1:aO.end-aD;while(true){switch(at){case K:if(aH>=258&&aG>=10){aO.bitb=aN;aO.bitk=aI;aM.avail_in=aG;aM.total_in+=aE-aM.next_in_index;aM.next_in_index=aE;aO.write=aD;aC=au(ar,an,ax,am,ap,al,aO,aM);aE=aM.next_in_index;aG=aM.avail_in;aN=aO.bitb;aI=aO.bitk;aD=aO.write;aH=aD<aO.read?aO.read-aD-1:aO.end-aD;if(aC!=s){at=aC==af?r:E;break}}az=ar;aB=ax;aq=am;at=ac;case ac:aJ=az;while(aI<(aJ)){if(aG!==0){aC=s}else{aO.bitb=aN;aO.bitk=aI;aM.avail_in=aG;aM.total_in+=aE-aM.next_in_index;aM.next_in_index=aE;aO.write=aD;return aO.inflate_flush(aM,aC)}aG--;aN|=(aM.read_byte(aE++)&255)<<aI;aI+=8}aF=(aq+(aN&V[aJ]))*3;aN>>>=(aB[aF+1]);aI-=(aB[aF+1]);aL=aB[aF];if(aL===0){aA=aB[aF+2];at=A;break}if((aL&16)!==0){ao=aL&15;aw=aB[aF+2];at=Z;break}if((aL&64)===0){az=aL;aq=aF/3+aB[aF+2];break}if((aL&32)!==0){at=r;break}at=E;aM.msg="invalid literal/length code";aC=k;aO.bitb=aN;aO.bitk=aI;aM.avail_in=aG;aM.total_in+=aE-aM.next_in_index;aM.next_in_index=aE;aO.write=aD;return aO.inflate_flush(aM,aC);case Z:aJ=ao;while(aI<(aJ)){if(aG!==0){aC=s}else{aO.bitb=aN;aO.bitk=aI;aM.avail_in=aG;aM.total_in+=aE-aM.next_in_index;aM.next_in_index=aE;aO.write=aD;return aO.inflate_flush(aM,aC)}aG--;aN|=(aM.read_byte(aE++)&255)<<aI;aI+=8}aw+=(aN&V[aJ]);aN>>=aJ;aI-=aJ;az=an;aB=ap;aq=al;at=z;case z:aJ=az;while(aI<(aJ)){if(aG!==0){aC=s}else{aO.bitb=aN;aO.bitk=aI;aM.avail_in=aG;aM.total_in+=aE-aM.next_in_index;aM.next_in_index=aE;aO.write=aD;return aO.inflate_flush(aM,aC)}aG--;aN|=(aM.read_byte(aE++)&255)<<aI;aI+=8}aF=(aq+(aN&V[aJ]))*3;aN>>=aB[aF+1];aI-=aB[aF+1];aL=(aB[aF]);if((aL&16)!==0){ao=aL&15;ay=aB[aF+2];at=b;break}if((aL&64)===0){az=aL;aq=aF/3+aB[aF+2];break}at=E;aM.msg="invalid distance code";aC=k;aO.bitb=aN;aO.bitk=aI;aM.avail_in=aG;aM.total_in+=aE-aM.next_in_index;aM.next_in_index=aE;aO.write=aD;return aO.inflate_flush(aM,aC);case b:aJ=ao;while(aI<(aJ)){if(aG!==0){aC=s}else{aO.bitb=aN;aO.bitk=aI;aM.avail_in=aG;aM.total_in+=aE-aM.next_in_index;aM.next_in_index=aE;aO.write=aD;return aO.inflate_flush(aM,aC)}aG--;aN|=(aM.read_byte(aE++)&255)<<aI;aI+=8}ay+=(aN&V[aJ]);aN>>=aJ;aI-=aJ;at=p;case p:aK=aD-ay;while(aK<0){aK+=aO.end}while(aw!==0){if(aH===0){if(aD==aO.end&&aO.read!==0){aD=0;aH=aD<aO.read?aO.read-aD-1:aO.end-aD}if(aH===0){aO.write=aD;aC=aO.inflate_flush(aM,aC);aD=aO.write;aH=aD<aO.read?aO.read-aD-1:aO.end-aD;if(aD==aO.end&&aO.read!==0){aD=0;aH=aD<aO.read?aO.read-aD-1:aO.end-aD}if(aH===0){aO.bitb=aN;aO.bitk=aI;aM.avail_in=aG;aM.total_in+=aE-aM.next_in_index;aM.next_in_index=aE;aO.write=aD;return aO.inflate_flush(aM,aC)}}}aO.window[aD++]=aO.window[aK++];aH--;if(aK==aO.end){aK=0}aw--}at=K;break;case A:if(aH===0){if(aD==aO.end&&aO.read!==0){aD=0;aH=aD<aO.read?aO.read-aD-1:aO.end-aD}if(aH===0){aO.write=aD;aC=aO.inflate_flush(aM,aC);aD=aO.write;aH=aD<aO.read?aO.read-aD-1:aO.end-aD;if(aD==aO.end&&aO.read!==0){aD=0;aH=aD<aO.read?aO.read-aD-1:aO.end-aD}if(aH===0){aO.bitb=aN;aO.bitk=aI;aM.avail_in=aG;aM.total_in+=aE-aM.next_in_index;aM.next_in_index=aE;aO.write=aD;return aO.inflate_flush(aM,aC)}}}aC=s;aO.window[aD++]=aA;aH--;at=K;break;case r:if(aI>7){aI-=8;aG++;aE--}aO.write=aD;aC=aO.inflate_flush(aM,aC);aD=aO.write;aH=aD<aO.read?aO.read-aD-1:aO.end-aD;if(aO.read!=aO.write){aO.bitb=aN;aO.bitk=aI;aM.avail_in=aG;aM.total_in+=aE-aM.next_in_index;aM.next_in_index=aE;aO.write=aD;return aO.inflate_flush(aM,aC)}at=ab;case ab:aC=af;aO.bitb=aN;aO.bitk=aI;aM.avail_in=aG;aM.total_in+=aE-aM.next_in_index;aM.next_in_index=aE;aO.write=aD;return aO.inflate_flush(aM,aC);case E:aC=k;aO.bitb=aN;aO.bitk=aI;aM.avail_in=aG;aM.total_in+=aE-aM.next_in_index;aM.next_in_index=aE;aO.write=aD;return aO.inflate_flush(aM,aC);default:aC=ak;aO.bitb=aN;aO.bitk=aI;aM.avail_in=aG;aM.total_in+=aE-aM.next_in_index;aM.next_in_index=aE;aO.write=aD;return aO.inflate_flush(aM,aC)}}};av.free=function(){}}var m=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var q=0;var ae=1;var F=2;var C=3;var U=4;var g=5;var aa=6;var w=7;var y=8;var ah=9;function v(av,ax){var ar=this;var aq=q;var ao=0;var az=0;var at=0;var aA;var au=[0];var ap=[0];var al=new f();var ay=0;var an=new Int32Array(W*3);var am=0;var aw=new n();ar.bitk=0;ar.bitb=0;ar.window=new Uint8Array(ax);ar.end=ax;ar.read=0;ar.write=0;ar.reset=function(aB,aC){if(aC){aC[0]=am}if(aq==aa){al.free(aB)}aq=q;ar.bitk=0;ar.bitb=0;ar.read=ar.write=0};ar.reset(av,null);ar.inflate_flush=function(aE,aB){var aF;var aD;var aC;aD=aE.next_out_index;aC=ar.read;aF=((aC<=ar.write?ar.write:ar.end)-aC);if(aF>aE.avail_out){aF=aE.avail_out}if(aF!==0&&aB==O){aB=s}aE.avail_out-=aF;aE.total_out+=aF;aE.next_out.set(ar.window.subarray(aC,aC+aF),aD);aD+=aF;aC+=aF;if(aC==ar.end){aC=0;if(ar.write==ar.end){ar.write=0}aF=ar.write-aC;if(aF>aE.avail_out){aF=aE.avail_out}if(aF!==0&&aB==O){aB=s}aE.avail_out-=aF;aE.total_out+=aF;aE.next_out.set(ar.window.subarray(aC,aC+aF),aD);aD+=aF;aC+=aF}aE.next_out_index=aD;ar.read=aC;return aB};ar.proc=function(aH,aJ){var aI;var aT;var aO;var aL;var aM;var aK;var aN;var aQ;aL=aH.next_in_index;aM=aH.avail_in;aT=ar.bitb;aO=ar.bitk;aK=ar.write;aN=(aK<ar.read?ar.read-aK-1:ar.end-aK);while(true){switch(aq){case q:while(aO<(3)){if(aM!==0){aJ=s}else{ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}aM--;aT|=(aH.read_byte(aL++)&255)<<aO;aO+=8}aI=(aT&7);ay=aI&1;switch(aI>>>1){case 0:aT>>>=(3);aO-=(3);aI=aO&7;aT>>>=(aI);aO-=(aI);aq=ae;break;case 1:var aB=[];var aF=[];var aD=[[]];var aG=[[]];n.inflate_trees_fixed(aB,aF,aD,aG);al.init(aB[0],aF[0],aD[0],0,aG[0],0);aT>>>=(3);aO-=(3);aq=aa;break;case 2:aT>>>=(3);aO-=(3);aq=C;break;case 3:aT>>>=(3);aO-=(3);aq=ah;aH.msg="invalid block type";aJ=k;ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}break;case ae:while(aO<(32)){if(aM!==0){aJ=s}else{ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}aM--;aT|=(aH.read_byte(aL++)&255)<<aO;aO+=8}if((((~aT)>>>16)&65535)!=(aT&65535)){aq=ah;aH.msg="invalid stored block lengths";aJ=k;ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}ao=(aT&65535);aT=aO=0;aq=ao!==0?F:(ay!==0?w:q);break;case F:if(aM===0){ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}if(aN===0){if(aK==ar.end&&ar.read!==0){aK=0;aN=(aK<ar.read?ar.read-aK-1:ar.end-aK)}if(aN===0){ar.write=aK;aJ=ar.inflate_flush(aH,aJ);aK=ar.write;aN=(aK<ar.read?ar.read-aK-1:ar.end-aK);if(aK==ar.end&&ar.read!==0){aK=0;aN=(aK<ar.read?ar.read-aK-1:ar.end-aK)}if(aN===0){ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}}}aJ=s;aI=ao;if(aI>aM){aI=aM}if(aI>aN){aI=aN}ar.window.set(aH.read_buf(aL,aI),aK);aL+=aI;aM-=aI;aK+=aI;aN-=aI;if((ao-=aI)!==0){break}aq=ay!==0?w:q;break;case C:while(aO<(14)){if(aM!==0){aJ=s}else{ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}aM--;aT|=(aH.read_byte(aL++)&255)<<aO;aO+=8}az=aI=(aT&16383);if((aI&31)>29||((aI>>5)&31)>29){aq=ah;aH.msg="too many length or distance symbols";aJ=k;ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}aI=258+(aI&31)+((aI>>5)&31);if(!aA||aA.length<aI){aA=[]}else{for(aQ=0;aQ<aI;aQ++){aA[aQ]=0}}aT>>>=(14);aO-=(14);at=0;aq=U;case U:while(at<4+(az>>>10)){while(aO<(3)){if(aM!==0){aJ=s}else{ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}aM--;aT|=(aH.read_byte(aL++)&255)<<aO;aO+=8}aA[m[at++]]=aT&7;aT>>>=(3);aO-=(3)}while(at<19){aA[m[at++]]=0}au[0]=7;aI=aw.inflate_trees_bits(aA,au,ap,an,aH);if(aI!=s){aJ=aI;if(aJ==k){aA=null;aq=ah}ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}at=0;aq=g;case g:while(true){aI=az;if(at>=258+(aI&31)+((aI>>5)&31)){break}var aP,aR;aI=au[0];while(aO<(aI)){if(aM!==0){aJ=s}else{ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}aM--;aT|=(aH.read_byte(aL++)&255)<<aO;aO+=8}aI=an[(ap[0]+(aT&V[aI]))*3+1];aR=an[(ap[0]+(aT&V[aI]))*3+2];if(aR<16){aT>>>=(aI);aO-=(aI);aA[at++]=aR}else{aQ=aR==18?7:aR-14;aP=aR==18?11:3;while(aO<(aI+aQ)){if(aM!==0){aJ=s}else{ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}aM--;aT|=(aH.read_byte(aL++)&255)<<aO;aO+=8}aT>>>=(aI);aO-=(aI);aP+=(aT&V[aQ]);aT>>>=(aQ);aO-=(aQ);aQ=at;aI=az;if(aQ+aP>258+(aI&31)+((aI>>5)&31)||(aR==16&&aQ<1)){aA=null;aq=ah;aH.msg="invalid bit length repeat";aJ=k;ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}aR=aR==16?aA[aQ-1]:0;do{aA[aQ++]=aR}while(--aP!==0);at=aQ}}ap[0]=-1;var aU=[];var aE=[];var aS=[];var aC=[];aU[0]=9;aE[0]=6;aI=az;aI=aw.inflate_trees_dynamic(257+(aI&31),1+((aI>>5)&31),aA,aU,aE,aS,aC,an,aH);if(aI!=s){if(aI==k){aA=null;aq=ah}aJ=aI;ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}al.init(aU[0],aE[0],an,aS[0],an,aC[0]);aq=aa;case aa:ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;if((aJ=al.proc(ar,aH,aJ))!=af){return ar.inflate_flush(aH,aJ)}aJ=s;al.free(aH);aL=aH.next_in_index;aM=aH.avail_in;aT=ar.bitb;aO=ar.bitk;aK=ar.write;aN=(aK<ar.read?ar.read-aK-1:ar.end-aK);if(ay===0){aq=q;break}aq=w;case w:ar.write=aK;aJ=ar.inflate_flush(aH,aJ);aK=ar.write;aN=(aK<ar.read?ar.read-aK-1:ar.end-aK);if(ar.read!=ar.write){ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}aq=y;case y:aJ=af;ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ);case ah:aJ=k;ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ);default:aJ=ak;ar.bitb=aT;ar.bitk=aO;aH.avail_in=aM;aH.total_in+=aL-aH.next_in_index;aH.next_in_index=aL;ar.write=aK;return ar.inflate_flush(aH,aJ)}}};ar.free=function(aB){ar.reset(aB,null);ar.window=null;an=null};ar.set_dictionary=function(aB,aD,aC){ar.window.set(aB.subarray(aD,aD+aC),0);ar.read=ar.write=aC};ar.sync_point=function(){return aq==ae?1:0}}var d=32;var X=8;var B=0;var ai=1;var N=2;var P=3;var Q=4;var R=5;var T=6;var G=7;var H=12;var u=13;var j=[0,0,255,255];function l(){var am=this;am.mode=0;am.method=0;am.was=[0];am.need=0;am.marker=0;am.wbits=0;function al(an){if(!an||!an.istate){return ak}an.total_in=an.total_out=0;an.msg=null;an.istate.mode=G;an.istate.blocks.reset(an,null);return s}am.inflateEnd=function(an){if(am.blocks){am.blocks.free(an)}am.blocks=null;return s};am.inflateInit=function(ao,an){ao.msg=null;am.blocks=null;if(an<8||an>15){am.inflateEnd(ao);return ak}am.wbits=an;ao.istate.blocks=new v(ao,1<<an);al(ao);return s};am.inflate=function(aq,ap){var ao;var an;if(!aq||!aq.istate||!aq.next_in){return ak}ap=ap==h?O:s;ao=O;while(true){switch(aq.istate.mode){case B:if(aq.avail_in===0){return ao}ao=ap;aq.avail_in--;aq.total_in++;if(((aq.istate.method=aq.read_byte(aq.next_in_index++))&15)!=X){aq.istate.mode=u;aq.msg="unknown compression method";aq.istate.marker=5;break}if((aq.istate.method>>4)+8>aq.istate.wbits){aq.istate.mode=u;aq.msg="invalid window size";aq.istate.marker=5;break}aq.istate.mode=ai;case ai:if(aq.avail_in===0){return ao}ao=ap;aq.avail_in--;aq.total_in++;an=(aq.read_byte(aq.next_in_index++))&255;if((((aq.istate.method<<8)+an)%31)!==0){aq.istate.mode=u;aq.msg="incorrect header check";aq.istate.marker=5;break}if((an&d)===0){aq.istate.mode=G;break}aq.istate.mode=N;case N:if(aq.avail_in===0){return ao}ao=ap;aq.avail_in--;aq.total_in++;aq.istate.need=((aq.read_byte(aq.next_in_index++)&255)<<24)&4278190080;aq.istate.mode=P;case P:if(aq.avail_in===0){return ao}ao=ap;aq.avail_in--;aq.total_in++;aq.istate.need+=((aq.read_byte(aq.next_in_index++)&255)<<16)&16711680;aq.istate.mode=Q;case Q:if(aq.avail_in===0){return ao}ao=ap;aq.avail_in--;aq.total_in++;aq.istate.need+=((aq.read_byte(aq.next_in_index++)&255)<<8)&65280;aq.istate.mode=R;case R:if(aq.avail_in===0){return ao}ao=ap;aq.avail_in--;aq.total_in++;aq.istate.need+=(aq.read_byte(aq.next_in_index++)&255);aq.istate.mode=T;return M;case T:aq.istate.mode=u;aq.msg="need dictionary";aq.istate.marker=0;return ak;case G:ao=aq.istate.blocks.proc(aq,ao);if(ao==k){aq.istate.mode=u;aq.istate.marker=0;break}if(ao==s){ao=ap}if(ao!=af){return ao}ao=ap;aq.istate.blocks.reset(aq,aq.istate.was);aq.istate.mode=H;case H:return af;case u:return k;default:return ak}}};am.inflateSetDictionary=function(aq,ar,ap){var an=0;var ao=ap;if(!aq||!aq.istate||aq.istate.mode!=T){return ak}if(ao>=(1<<aq.istate.wbits)){ao=(1<<aq.istate.wbits)-1;an=ap-ao}aq.istate.blocks.set_dictionary(ar,an,ao);aq.istate.mode=G;return s};am.inflateSync=function(ar){var at;var aq;var an;var ap,ao;if(!ar||!ar.istate){return ak}if(ar.istate.mode!=u){ar.istate.mode=u;ar.istate.marker=0}if((at=ar.avail_in)===0){return O}aq=ar.next_in_index;an=ar.istate.marker;while(at!==0&&an<4){if(ar.read_byte(aq)==j[an]){an++}else{if(ar.read_byte(aq)!==0){an=0}else{an=4-an}}aq++;at--}ar.total_in+=aq-ar.next_in_index;ar.next_in_index=aq;ar.avail_in=at;ar.istate.marker=an;if(an!=4){return k}ap=ar.total_in;ao=ar.total_out;al(ar);ar.total_in=ap;ar.total_out=ao;ar.istate.mode=G;return s};am.inflateSyncPoint=function(an){if(!an||!an.istate||!an.istate.blocks){return ak}return an.istate.blocks.sync_point()}}function L(){}L.prototype={inflateInit:function(am){var al=this;al.istate=new l();if(!am){am=ag}return al.istate.inflateInit(al,am)},inflate:function(am){var al=this;if(!al.istate){return ak}return al.istate.inflate(al,am)},inflateEnd:function(){var am=this;if(!am.istate){return ak}var al=am.istate.inflateEnd(am);am.istate=null;return al},inflateSync:function(){var al=this;if(!al.istate){return ak}return al.istate.inflateSync(al)},inflateSetDictionary:function(an,am){var al=this;if(!al.istate){return ak}return al.istate.inflateSetDictionary(al,an,am)},read_byte:function(am){var al=this;return al.next_in.subarray(am,am+1)[0]},read_buf:function(an,al){var am=this;return am.next_in.subarray(an,an+al)}};function o(){var ao=this;var aq=new L();var ap=512;var al=ad;var am=new Uint8Array(ap);var an=false;aq.inflateInit();aq.next_out=am;ao.append=function(aw,av){var au,at=[],az=0,ar=0,ay=0,ax;if(aw.length===0){return}aq.next_in_index=0;aq.next_in=aw;aq.avail_in=aw.length;do{aq.next_out_index=0;aq.avail_out=ap;if((aq.avail_in===0)&&(!an)){aq.next_in_index=0;an=true}au=aq.inflate(al);if(an&&(au===O)){if(aq.avail_in!==0){throw new Error("inflating: bad input")}}else{if(au!==s&&au!==af){throw new Error("inflating: "+aq.msg)}}if((an||au===af)&&(aq.avail_in===aw.length)){throw new Error("inflating: bad input")}if(aq.next_out_index){if(aq.next_out_index===ap){at.push(new Uint8Array(am))}else{at.push(new Uint8Array(am.subarray(0,aq.next_out_index)))}}ay+=aq.next_out_index;if(av&&aq.next_in_index>0&&aq.next_in_index!=az){av(aq.next_in_index);az=aq.next_in_index}}while(aq.avail_in>0||aq.avail_out===0);ax=new Uint8Array(ay);at.forEach(function(aA){ax.set(aA,ar);ar+=aA.length});return ax};ao.flush=function(){aq.inflateEnd()}}var i=a.zip||a;i.Inflater=i._jzlib_Inflater=o})(this);
</script>
<script type="text/javascript">
(function(u){if(!u.CFInstall){var t=function(e,d){return typeof e=="string"?(d||document).getElementById(e):e},s=function(){if(u.CFInstall._force){return u.CFInstall._forceValue}if(navigator.userAgent.toLowerCase().indexOf("chromeframe")>=0){return true}if(typeof window.ActiveXObject!="undefined"){try{var e=new ActiveXObject("ChromeTab.ChromeFrame");if(e){e.registerBhoIfNeeded();return true}}catch(d){}}return false},r=function(e){try{var d=document.createElement("style");d.setAttribute("type","text/css");if(d.styleSheet){d.styleSheet.cssText=e}else{d.appendChild(document.createTextNode(e))}var h=document.getElementsByTagName("head")[0];h.insertBefore(d,h.firstChild)}catch(f){}},q=false,p=false,g=function(){if(!p){r(".chromeFrameOverlayContent { display: none; }.chromeFrameOverlayUnderlay { display: none; }");document.cookie="disableGCFCheck=1;path=/;max-age=31536000000";p=true}},c=function(e){var d=document.createElement("iframe");d.setAttribute("frameborder","0");d.setAttribute("border","0");var f=t(e.node);d.id=e.id||(f?f.id||getUid(f):"");d.style.cssText=" "+(e.cssText||"");d.className=e.className||"";d.src=e.src||"about:blank";f&&f.parentNode.replaceChild(d,f);return d},b=function(d){d.className="chromeFrameInstallDefaultStyle "+(d.className||"");d=c(d);d.parentNode||document.body.insertBefore(d,document.body.firstChild)},a=function(e){if(!t("chromeFrameOverlayContent")){var d=document.createElement("span");d.innerHTML='<div class="chromeFrameOverlayUnderlay"></div><table class="chromeFrameOverlayContent"id="chromeFrameOverlayContent"cellpadding="0" cellspacing="0"><tr class="chromeFrameOverlayCloseBar"><td><button id="chromeFrameCloseButton">close</button></td></tr><tr><td id="chromeFrameIframeHolder"></td></tr></table>';for(var f=document.body;d.firstChild;){f.insertBefore(d.lastChild,f.firstChild)}e=c(e);t("chromeFrameIframeHolder").appendChild(e);t("chromeFrameCloseButton").onclick=g}},v={};v.check=function(e){e=e||{};var d=navigator.userAgent,i=/MSIE (\S+); Windows NT/,f=false;if(i.test(d)){if(parseFloat(i.exec(d)[1])<6&&d.indexOf("SV1")<0){f=true}}else{f=true}if(!f){if(!q){r('.chromeFrameInstallDefaultStyle {width: 800px;height: 600px;position: absolute;}.chromeFrameOverlayContent {position: absolute;border: 1px solid #93B4D9;background-color: white;z-index: 2001;}.chromeFrameOverlayContent iframe {width: 800px;height: 600px;border: none;}.chromeFrameOverlayCloseBar {height: 1em;text-align: right;background-color: #CADEF4;}.chromeFrameOverlayUnderlay {position: absolute;width: 100%;height: 100%;background-color: white;opacity: 0.5;-moz-opacity: 0.5;-webkit-opacity: 0.5;-ms-filter: "progid:DXImageTransform.Microsoft.Alpha(Opacity=50)";filter: alpha(opacity=50);z-index: 2000;}');q=true}document.cookie.indexOf("disableGCFCheck=1")>=0&&g();d=(document.location.protocol=="https:"?"https:":"http:")+"//www.google.com/chromeframe";if(!s()){e.onmissing&&e.onmissing();e.src=e.url||d;d=e.mode||"inline";if(!(e.preventPrompt||0)){if(d=="inline"){b(e)}else{d=="overlay"?a(e):window.open(e.src)}}if(!e.preventInstallDetection){var h=setInterval(function(){if(s()){e.oninstall&&e.oninstall();clearInterval(h);window.location=e.destination||window.location}},2000)}}}if(!s()&&document.getElementById("kuda")){alert("This page requires Chrome Frame to work properly. Please install it, and try again")}};v._force=false;v._forceValue=false;v.isAvailable=s;u.CFInstall=v}})(this.ChromeFrameInstallScope||this);
</script>
<script type="text/javascript">
(function(v){var u="0.3.4",t="hasOwnProperty",s=/[\.\/]/,r="*",q=function(){},p=function(d,c){return d-c},o,n,m={n:{}},l=function(D,C){var B=m,A=n,z=Array.prototype.slice.call(arguments,2),y=l.listeners(D),x=0,w=!1,k,j=[],i={},h=[],g=o,G=[];o=D,n=0;for(var F=0,E=y.length;F<E;F++){"zIndex" in y[F]&&(j.push(y[F].zIndex),y[F].zIndex<0&&(i[y[F].zIndex]=y[F]))}j.sort(p);while(j[x]<0){k=i[j[x++]],h.push(k.apply(C,z));if(n){n=A;return h}}for(F=0;F<E;F++){k=y[F];if("zIndex" in k){if(k.zIndex==j[x]){h.push(k.apply(C,z));if(n){break}do{x++,k=i[j[x]],k&&h.push(k.apply(C,z));if(n){break}}while(k)}else{i[k.zIndex]=k}}else{h.push(k.apply(C,z));if(n){break}}}n=A,o=g;return h.length?h:null};l.listeners=function(F){var E=F.split(s),D=m,C,B,A,z,y,x,w,j,e=[D],d=[];for(z=0,y=E.length;z<y;z++){j=[];for(x=0,w=e.length;x<w;x++){D=e[x].n,B=[D[E[z]],D[r]],A=2;while(A--){C=B[A],C&&(j.push(C),d=d.concat(C.f||[]))}}e=j}return d},l.on=function(f,d){var w=f.split(s),k=m;for(var j=0,i=w.length;j<i;j++){k=k.n,!k[w[j]]&&(k[w[j]]={n:{}}),k=k[w[j]]}k.f=k.f||[];for(j=0,i=k.f.length;j<i;j++){if(k.f[j]==d){return q}}k.f.push(d);return function(b){+b==+b&&(d.zIndex=+b)}},l.stop=function(){n=1},l.nt=function(b){if(b){return(new RegExp("(?:\\.|\\/|^)"+b+"(?:\\.|\\/|$)")).test(o)}return o},l.off=l.unbind=function(D,C){var B=D.split(s),A,z,y,x,w,j,e,d=[m];for(x=0,w=B.length;x<w;x++){for(j=0;j<d.length;j+=y.length-2){y=[j,1],A=d[j].n;if(B[x]!=r){A[B[x]]&&y.push(A[B[x]])}else{for(z in A){A[t](z)&&y.push(A[z])}}d.splice.apply(d,y)}}for(x=0,w=d.length;x<w;x++){A=d[x];while(A.n){if(C){if(A.f){for(j=0,e=A.f.length;j<e;j++){if(A.f[j]==C){A.f.splice(j,1);break}}!A.f.length&&delete A.f}for(z in A.n){if(A.n[t](z)&&A.n[z].f){var c=A.n[z].f;for(j=0,e=c.length;j<e;j++){if(c[j]==C){c.splice(j,1);break}}!c.length&&delete A.n[z].f}}}else{delete A.f;for(z in A.n){A.n[t](z)&&A.n[z].f&&delete A.n[z].f}}A=A.n}}},l.once=function(e,d){var f=function(){var a=d.apply(this,arguments);l.unbind(e,f);return a};return l.on(e,f)},l.version=u,l.toString=function(){return"You are running Eve "+u},typeof module!="undefined"&&module.exports?module.exports=l:typeof define!="undefined"?define("eve",[],function(){return l}):v.eve=l})(this),function(){function cX(d){for(var c=0;c<ab.length;c++){ab[c].el.paper==d&&ab.splice(c--,1)}}function c0(br,bq,bp,bo,bn,bm){bp=c4(bp);var bl,bk,bj,bi=[],bh,bg,be,bb=br.ms,Z={},X={},V={};if(bo){for(Q=0,C=ab.length;Q<C;Q++){var T=ab[Q];if(T.el.id==bq.id&&T.anim==br){T.percent!=bp?(ab.splice(Q,1),bj=1):bk=T,bq.attr(T.totalOrigin);break}}}else{bo=+X}for(var Q=0,C=br.percents.length;Q<C;Q++){if(br.percents[Q]==bp||br.percents[Q]>bo*br.top){bp=br.percents[Q],bg=br.percents[Q-1]||0,bb=bb/br.top*(bp-bg),bh=br.percents[Q+1],bl=br.anim[bp];break}bo&&bq.attr(br.anim[br.percents[Q]])}if(!!bl){if(!bk){for(var bf in bl){if(bl[aV](bf)){if(cS[aV](bf)||bq.paper.customAttributes[aV](bf)){Z[bf]=bq.attr(bf),Z[bf]==null&&(Z[bf]=cV[bf]),X[bf]=bl[bf];switch(cS[bf]){case dv:V[bf]=(X[bf]-Z[bf])/bb;break;case"colour":Z[bf]=a8.getRGB(Z[bf]);var bd=a8.getRGB(X[bf]);V[bf]={r:(bd.r-Z[bf].r)/bb,g:(bd.g-Z[bf].g)/bb,b:(bd.b-Z[bf].b)/bb};break;case"path":var bc=dA(Z[bf],X[bf]),ba=bc[1];Z[bf]=bc[0],V[bf]=[];for(Q=0,C=Z[bf].length;Q<C;Q++){V[bf][Q]=[0];for(var Y=1,W=Z[bf][Q].length;Y<W;Y++){V[bf][Q][Y]=(ba[Q][Y]-Z[bf][Q][Y])/bb}}break;case"transform":var U=bq._,S=aM(U[bf],X[bf]);if(S){Z[bf]=S.from,X[bf]=S.to,V[bf]=[],V[bf].real=!0;for(Q=0,C=Z[bf].length;Q<C;Q++){V[bf][Q]=[Z[bf][Q][0]];for(Y=1,W=Z[bf][Q].length;Y<W;Y++){V[bf][Q][Y]=(X[bf][Q][Y]-Z[bf][Q][Y])/bb}}}else{var N=bq.matrix||new aL,s={_:{transform:U.transform},getBBox:function(){return bq.getBBox(1)}};Z[bf]=[N.a,N.b,N.c,N.d,N.e,N.f],dT(s,X[bf]),X[bf]=s._.transform,V[bf]=[(s.matrix.a-N.a)/bb,(s.matrix.b-N.b)/bb,(s.matrix.c-N.c)/bb,(s.matrix.d-N.d)/bb,(s.matrix.e-N.e)/bb,(s.matrix.f-N.f)/bb]}break;case"csv":var r=aF(bl[bf])[aD](a3),n=aF(Z[bf])[aD](a3);if(bf=="clip-rect"){Z[bf]=n,V[bf]=[],Q=n.length;while(Q--){V[bf][Q]=(r[Q]-Z[bf][Q])/bb}}X[bf]=r;break;default:r=[][aN](bl[bf]),n=[][aN](Z[bf]),V[bf]=[],Q=bq.paper.customAttributes[bf].length;while(Q--){V[bf][Q]=((r[Q]||0)-(n[Q]||0))/bb}}}}}var g=bl.easing,c=a8.easing_formulas[g];if(!c){c=aF(g).match(dc);if(c&&c.length==5){var a=c;c=function(b){return c6(b,+a[1],+a[2],+a[3],+a[4],bb)}}else{c=cU}}be=bl.start||br.start||+(new Date),T={anim:br,percent:bp,timestamp:be,start:be+(br.del||0),status:0,initstatus:bo||0,stop:!1,ms:bb,easing:c,from:Z,diff:V,to:X,el:bq,callback:bl.callback,prev:bg,next:bh,repeat:bm||br.times,origin:bq.attr(),totalOrigin:bn},ab.push(T);if(bo&&!bk&&!bj){T.stop=!0,T.start=new Date-bb*bo;if(ab.length==1){return db()}}bj&&(T.start=new Date-T.ms*bo),ab.length==1&&aa(db)}else{bk.initstatus=bo,bk.start=new Date-bk.ms*bo}eve("raphael.anim.start."+bq.id,bq,br)}}function c3(g,f){var j=[],i={};this.ms=f,this.times=1;if(g){for(var h in g){g[aV](h)&&(i[c4(h)]=g[h],j.push(c4(h)))}j.sort(cZ)}this.anim=i,this.top=j[j.length-1],this.percents=j}function c6(D,C,B,A,z,y){function p(h,g){var E,o,n,m,l,i;for(n=h,i=0;i<8;i++){m=r(n)-h;if(ao(m)<g){return n}l=(3*v*n+2*w)*n+x;if(ao(l)<0.000001){break}n=n-m/l}E=0,o=1,n=h;if(n<E){return E}if(n>o){return o}while(E<o){m=r(n);if(ao(m-h)<g){return n}h>m?E=n:o=n,n=(o-E)/2+E}return n}function q(e,d){var f=p(e,d);return((s*f+t)*f+u)*f}function r(b){return((v*b+w)*b+x)*b}var x=3*C,w=3*(A-C)-x,v=1-x-w,u=3*B,t=3*(z-B)-u,s=1-u-t;return q(D,1/(200*y))}function aj(){return this.x+aH+this.y+aH+this.width+" � "+this.height}function ak(){return this.x+aH+this.y}function aL(h,g,l,k,j,i){h!=null?(this.a=+h,this.b=+g,this.c=+l,this.d=+k,this.e=+j,this.f=+i):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function dK(T,S,R){T=a8._path2curve(T),S=a8._path2curve(S);var Q,P,O,N,M,L,K,J,I,H,G=R?0:[];for(var F=0,E=T.length;F<E;F++){var D=T[F];if(D[0]=="M"){Q=M=D[1],P=L=D[2]}else{D[0]=="C"?(I=[Q,P].concat(D.slice(1)),Q=I[6],P=I[7]):(I=[Q,P,Q,P,M,L,M,L],Q=M,P=L);for(var C=0,B=S.length;C<B;C++){var A=S[C];if(A[0]=="M"){O=K=A[1],N=J=A[2]}else{A[0]=="C"?(H=[O,N].concat(A.slice(1)),O=H[6],N=H[7]):(H=[O,N,O,N,K,J,K,J],O=K,N=J);var z=dL(I,H,R);if(R){G+=z}else{for(var y=0,a=z.length;y<a;y++){z[y].segment1=F,z[y].segment2=C,z[y].bez1=I,z[y].bez2=H}G=G.concat(z)}}}}}return G}function dL(X,W,V){var U=a8.bezierBBox(X),T=a8.bezierBBox(W);if(!a8.isBBoxIntersect(U,T)){return V?0:[]}var S=dQ.apply(0,X),R=dQ.apply(0,W),Q=~~(S/5),P=~~(R/5),O=[],N=[],M={},L=V?0:[];for(var K=0;K<Q+1;K++){var J=a8.findDotsAtSegment.apply(a8,X.concat(K/Q));O.push({x:J.x,y:J.y,t:K/Q})}for(K=0;K<P+1;K++){J=a8.findDotsAtSegment.apply(a8,W.concat(K/P)),N.push({x:J.x,y:J.y,t:K/P})}for(K=0;K<Q;K++){for(var H=0;H<P;H++){var G=O[K],F=O[K+1],E=N[H],D=N[H+1],C=ao(F.x-G.x)<0.001?"y":"x",B=ao(D.x-E.x)<0.001?"y":"x",z=dO(G.x,G.y,F.x,F.y,E.x,E.y,D.x,D.y);if(z){if(M[z.x.toFixed(4)]==z.y.toFixed(4)){continue}M[z.x.toFixed(4)]=z.y.toFixed(4);var a=G.t+ao((z[C]-G[C])/(F[C]-G[C]))*(F.t-G.t),I=E.t+ao((z[B]-E[B])/(D[B]-E[B]))*(D.t-E.t);a>=0&&a<=1&&I>=0&&I<=1&&(V?L++:L.push({x:z.x,y:z.y,t1:a,t2:I}))}}}return L}function dM(d,c){return dL(d,c,1)}function dN(d,c){return dL(d,c)}function dO(D,C,B,A,z,y,x,w){if(!(at(D,B)<aq(z,x)||aq(D,B)>at(z,x)||at(C,A)<aq(y,w)||aq(C,A)>at(y,w))){var v=(D*A-C*B)*(z-x)-(D-B)*(z*w-y*x),u=(D*A-C*B)*(y-w)-(C-A)*(z*w-y*x),t=(D-B)*(y-w)-(C-A)*(z-x);if(!t){return}var s=v/t,r=u/t,q=+s.toFixed(2),p=+r.toFixed(2);if(q<+aq(D,B).toFixed(2)||q>+at(D,B).toFixed(2)||q<+aq(z,x).toFixed(2)||q>+at(z,x).toFixed(2)||p<+aq(C,A).toFixed(2)||p>+at(C,A).toFixed(2)||p<+aq(y,w).toFixed(2)||p>+at(y,w).toFixed(2)){return}return{x:s,y:r}}}function dP(B,A,z,y,x,w,v,u,t){if(!(t<0||dQ(B,A,z,y,x,w,v,u)<t)){var s=1,r=s/2,q=s-r,p,o=0.01;p=dQ(B,A,z,y,x,w,v,u,q);while(ao(p-t)>o){r/=2,q+=(p<t?1:-1)*r,p=dQ(B,A,z,y,x,w,v,u,q)}return q}}function dQ(L,K,J,I,H,G,F,E,D){D==null&&(D=1),D=D>1?1:D<0?0:D;var C=D/2,B=12,A=[-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,0.9041,-0.9816,0.9816],z=[0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],y=0;for(var x=0;x<B;x++){var w=C*A[x]+C,v=dR(w,L,J,H,F),u=dR(w,K,I,G,E),t=v*v+u*u;y+=z[x]*av.sqrt(t)}return C*y}function dR(i,h,n,m,l){var k=-3*h+9*n-9*m+3*l,j=i*k+6*h-12*n+6*m;return i*j-3*h+3*n}function aW(h,g){var l=[];for(var k=0,j=h.length;j-2*!g>k;k+=2){var i=[{x:+h[k-2],y:+h[k-1]},{x:+h[k],y:+h[k+1]},{x:+h[k+2],y:+h[k+3]},{x:+h[k+4],y:+h[k+5]}];g?k?j-4==k?i[3]={x:+h[0],y:+h[1]}:j-2==k&&(i[2]={x:+h[0],y:+h[1]},i[3]={x:+h[2],y:+h[3]}):i[0]={x:+h[j-2],y:+h[j-1]}:j-4==k?i[3]=i[2]:k||(i[0]={x:+h[k],y:+h[k+1]}),l.push(["C",(-i[0].x+6*i[1].x+i[2].x)/6,(-i[0].y+6*i[1].y+i[2].y)/6,(i[1].x+6*i[2].x-i[3].x)/6,(i[1].y+6*i[2].y-i[3].y)/6,i[2].x,i[2].y])}return l}function aY(){return this.hex}function a2(f,e,h){function g(){var d=Array.prototype.slice.call(arguments,0),c=d.join("?"),b=g.cache=g.cache||{},a=g.count=g.count||[];if(b[aV](c)){a4(a,c);return h?h(b[c]):b[c]}a.length>=1000&&delete b[a.shift()],a.push(c),b[c]=f[aO](e,d);return h?h(b[c]):b[c]}return g}function a4(f,e){for(var h=0,g=f.length;h<g;h++){if(f[h]===e){return f.push(f.splice(h,1)[0])}}}function b5(e){if(Object(e)!==e){return e}var d=new e.constructor;for(var f in e){e[aV](f)&&(d[f]=b5(e[f]))}return d}function a8(f){if(a8.is(f,"function")){return a6?f():eve.on("raphael.DOMload",f)}if(a8.is(f,dr)){return a8._engine.create[aO](a8,f.splice(0,3+a8.is(f[0],dv))).add(f)}var b=Array.prototype.slice.call(arguments,0);if(a8.is(b[b.length-1],"function")){var a=b.pop();return a6?a.call(a8._engine.create[aO](a8,b)):eve.on("raphael.DOMload",function(){a.call(a8._engine.create[aO](a8,b))})}return a8._engine.create[aO](a8,arguments)}a8.version="2.1.0",a8.eve=eve;var a6,a3=/[, ]+/,a1={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},a0=/\{(\d+)\}/g,aX="prototype",aV="hasOwnProperty",aU={doc:document,win:window},aS={was:Object.prototype[aV].call(aU.win,"Raphael"),is:aU.win.Raphael},aR=function(){this.ca=this.customAttributes={}},aQ,aP="appendChild",aO="apply",aN="concat",aK="createTouch" in aU.doc,aJ="",aH=" ",aF=String,aD="split",aB="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[aD](aH),az={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},ax=aF.prototype.toLowerCase,av=Math,at=av.max,aq=av.min,ao=av.abs,dz=av.pow,dx=av.PI,dv="number",dt="string",dr="array",dp="toString",dm="fill",dk=Object.prototype.toString,di={},dh="push",dg=a8._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,df=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,de={NaN:1,Infinity:1,"-Infinity":1},dc=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,da=av.round,c7="setAttribute",c4=parseFloat,c1=parseInt,cY=aF.prototype.toUpperCase,cV=a8._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},cS=a8._availableAnimAttrs={blur:dv,"clip-rect":"csv",cx:dv,cy:dv,fill:"colour","fill-opacity":dv,"font-size":dv,height:dv,opacity:dv,path:"path",r:dv,rx:dv,ry:dv,stroke:"colour","stroke-opacity":dv,"stroke-width":dv,transform:"transform",width:dv,x:dv,y:dv},cP=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]/g,cM=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,cK={hs:1,rg:1},b9=/,?([achlmqrstvxz]),?/gi,b7=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,dS=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/ig,b1=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/ig,c9=a8._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,c5={},c2=function(d,c){return d.key-c.key},cZ=function(d,c){return c4(d)-c4(c)},cW=function(){},cU=function(b){return b},cR=a8._rectPath=function(g,f,j,i,h){if(h){return[["M",g+h,f],["l",j-h*2,0],["a",h,h,0,0,1,h,h],["l",0,i-h*2],["a",h,h,0,0,1,-h,h],["l",h*2-j,0],["a",h,h,0,0,1,-h,-h],["l",0,h*2-i],["a",h,h,0,0,1,h,-h],["z"]]}return[["M",g,f],["l",j,0],["l",0,i],["l",-j,0],["z"]]},cO=function(f,e,h,g){g==null&&(g=h);return[["M",f,e],["m",0,-g],["a",h,g,0,1,1,0,2*g],["a",h,g,0,1,1,0,-2*g],["z"]]},cL=a8._getPath={path:function(b){return b.attr("path")},circle:function(d){var c=d.attrs;return cO(c.cx,c.cy,c.r)},ellipse:function(d){var c=d.attrs;return cO(c.cx,c.cy,c.rx,c.ry)},rect:function(d){var c=d.attrs;return cR(c.x,c.y,c.width,c.height,c.r)},image:function(d){var c=d.attrs;return cR(c.x,c.y,c.width,c.height)},text:function(d){var c=d._getBBox();return cR(c.x,c.y,c.width,c.height)}},cJ=a8.mapPath=function(r,q){if(!q){return r}var p,o,n,m,l,k,j;r=dA(r);for(n=0,l=r.length;n<l;n++){j=r[n];for(m=1,k=j.length;m<k;m+=2){p=q.x(j[m],j[m+1]),o=q.y(j[m],j[m+1]),j[m]=p,j[m+1]=o}}return r};a8._g=aU,a8.type=aU.win.SVGAngle||aU.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(a8.type=="VML"){var b8=aU.doc.createElement("div"),b6;b8.innerHTML='<v:shape adj="1"/>',b6=b8.firstChild,b6.style.behavior="url(#default#VML)";if(!b6||typeof b6.adj!="object"){return a8.type=aJ}b8=null}a8.svg=!(a8.vml=a8.type=="VML"),a8._Paper=aR,a8.fn=aQ=aR.prototype=a8.prototype,a8._id=0,a8._oid=0,a8.is=function(d,c){c=ax.call(c);if(c=="finite"){return !de[aV](+d)}if(c=="array"){return d instanceof Array}return c=="null"&&d===null||c==typeof d&&d!==null||c=="object"&&d===Object(d)||c=="array"&&Array.isArray&&Array.isArray(d)||dk.call(d).slice(8,-1).toLowerCase()==c},a8.angle=function(a,p,o,n,m,l){if(m==null){var k=a-o,j=p-n;if(!k&&!j){return 0}return(180+av.atan2(-j,-k)*180/dx+360)%360}return a8.angle(a,p,m,l)-a8.angle(o,n,m,l)},a8.rad=function(b){return b%360*dx/180},a8.deg=function(b){return b*180/dx%360},a8.snapTo=function(a,j,i){i=a8.is(i,"finite")?i:10;if(a8.is(a,dr)){var h=a.length;while(h--){if(ao(a[h]-j)<=i){return a[h]}}}else{a=+a;var g=j%a;if(g<i){return j-g}if(g>a-i){return j-g+a}}return j};var b4=a8.createUUID=function(d,c){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(d,c).toUpperCase()}}(/[xy]/g,function(e){var d=av.random()*16|0,f=e=="x"?d:d&3|8;return f.toString(16)});a8.setWindow=function(a){eve("raphael.setWindow",a8,aU.win,a),aU.win=a,aU.doc=aU.win.document,a8._engine.initWin&&a8._engine.initWin(aU.win)};var b3=function(a){if(a8.vml){var n=/^\s+|\s+$/g,m;try{var l=new ActiveXObject("htmlfile");l.write("<body>"),l.close(),m=l.body}catch(k){m=createPopup().document.body}var j=m.createTextRange();b3=a2(function(d){try{m.style.color=aF(d).replace(n,aJ);var c=j.queryCommandValue("ForeColor");c=(c&255)<<16|c&65280|(c&16711680)>>>16;return"#"+("000000"+c.toString(16)).slice(-6)}catch(f){return"none"}})}else{var h=aU.doc.createElement("i");h.title="Rapha�l Colour Picker",h.style.display="none",aU.doc.body.appendChild(h),b3=a2(function(b){h.style.color=b;return aU.doc.defaultView.getComputedStyle(h,aJ).getPropertyValue("color")})}return b3(a)},b2=function(){return"hsb("+[this.h,this.s,this.b]+")"},b0=function(){return"hsl("+[this.h,this.s,this.l]+")"},a9=function(){return this.hex},a7=function(a,h,g){h==null&&a8.is(a,"object")&&"r" in a&&"g" in a&&"b" in a&&(g=a.b,h=a.g,a=a.r);if(h==null&&a8.is(a,dt)){var f=a8.getRGB(a);a=f.r,h=f.g,g=f.b}if(a>1||h>1||g>1){a/=255,h/=255,g/=255}return[a,h,g]},a5=function(a,j,i,h){a*=255,j*=255,i*=255;var g={r:a,g:j,b:i,hex:a8.rgb(a,j,i),toString:a9};a8.is(h,"finite")&&(g.opacity=h);return g};a8.color=function(a){var d;a8.is(a,"object")&&"h" in a&&"s" in a&&"b" in a?(d=a8.hsb2rgb(a),a.r=d.r,a.g=d.g,a.b=d.b,a.hex=d.hex):a8.is(a,"object")&&"h" in a&&"s" in a&&"l" in a?(d=a8.hsl2rgb(a),a.r=d.r,a.g=d.g,a.b=d.b,a.hex=d.hex):(a8.is(a,"string")&&(a=a8.getRGB(a)),a8.is(a,"object")&&"r" in a&&"g" in a&&"b" in a?(d=a8.rgb2hsl(a),a.h=d.h,a.s=d.s,a.l=d.l,d=a8.rgb2hsb(a),a.v=d.b):(a={hex:"none"},a.r=a.g=a.b=a.h=a.s=a.v=a.l=-1)),a.toString=a9;return a},a8.hsb2rgb=function(r,q,p,o){this.is(r,"object")&&"h" in r&&"s" in r&&"b" in r&&(p=r.b,q=r.s,r=r.h,o=r.o),r*=360;var n,m,l,k,j;r=r%360/60,j=p*q,k=j*(1-ao(r%2-1)),n=m=l=p-j,r=~~r,n+=[j,k,0,0,k,j][r],m+=[k,j,j,k,0,0][r],l+=[0,0,k,j,j,k][r];return a5(n,m,l,o)},a8.hsl2rgb=function(r,q,p,o){this.is(r,"object")&&"h" in r&&"s" in r&&"l" in r&&(p=r.l,q=r.s,r=r.h);if(r>1||q>1||p>1){r/=360,q/=100,p/=100}r*=360;var n,m,l,k,j;r=r%360/60,j=2*q*(p<0.5?p:1-p),k=j*(1-ao(r%2-1)),n=m=l=p-j/2,r=~~r,n+=[j,k,0,0,k,j][r],m+=[k,j,j,k,0,0][r],l+=[0,0,k,j,j,k][r];return a5(n,m,l,o)},a8.rgb2hsb=function(i,h,n){n=a7(i,h,n),i=n[0],h=n[1],n=n[2];var m,l,k,j;k=at(i,h,n),j=k-aq(i,h,n),m=j==0?null:k==i?(h-n)/j:k==h?(n-i)/j+2:(i-h)/j+4,m=(m+360)%6*60/360,l=j==0?0:j/k;return{h:m,s:l,b:k,toString:b2}},a8.rgb2hsl=function(r,q,p){p=a7(r,q,p),r=p[0],q=p[1],p=p[2];var o,n,m,l,k,j;l=at(r,q,p),k=aq(r,q,p),j=l-k,o=j==0?null:l==r?(q-p)/j:l==q?(p-r)/j+2:(r-q)/j+4,o=(o+360)%6*60/360,m=(l+k)/2,n=j==0?0:m<0.5?j/(2*m):j/(2-2*m);return{h:o,s:n,l:m,toString:b0}},a8._path2string=function(){return this.join(",").replace(b9,"$1")};var aZ=a8._preload=function(e,d){var f=aU.doc.createElement("img");f.style.cssText="position:absolute;left:-9999em;top:-9999em",f.onload=function(){d.call(this),this.onload=null,aU.doc.body.removeChild(this)},f.onerror=function(){aU.doc.body.removeChild(this)},aU.doc.body.appendChild(f),f.src=e};a8.getRGB=a2(function(r){if(!r||!!((r=aF(r)).indexOf("-")+1)){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:aY}}if(r=="none"){return{r:-1,g:-1,b:-1,hex:"none",toString:aY}}!cK[aV](r.toLowerCase().substring(0,2))&&r.charAt()!="#"&&(r=b3(r));var q,p,o,n,m,l,g,a=r.match(df);if(a){a[2]&&(n=c1(a[2].substring(5),16),o=c1(a[2].substring(3,5),16),p=c1(a[2].substring(1,3),16)),a[3]&&(n=c1((l=a[3].charAt(3))+l,16),o=c1((l=a[3].charAt(2))+l,16),p=c1((l=a[3].charAt(1))+l,16)),a[4]&&(g=a[4][aD](cM),p=c4(g[0]),g[0].slice(-1)=="%"&&(p*=2.55),o=c4(g[1]),g[1].slice(-1)=="%"&&(o*=2.55),n=c4(g[2]),g[2].slice(-1)=="%"&&(n*=2.55),a[1].toLowerCase().slice(0,4)=="rgba"&&(m=c4(g[3])),g[3]&&g[3].slice(-1)=="%"&&(m/=100));if(a[5]){g=a[5][aD](cM),p=c4(g[0]),g[0].slice(-1)=="%"&&(p*=2.55),o=c4(g[1]),g[1].slice(-1)=="%"&&(o*=2.55),n=c4(g[2]),g[2].slice(-1)=="%"&&(n*=2.55),(g[0].slice(-3)=="deg"||g[0].slice(-1)=="�")&&(p/=360),a[1].toLowerCase().slice(0,4)=="hsba"&&(m=c4(g[3])),g[3]&&g[3].slice(-1)=="%"&&(m/=100);return a8.hsb2rgb(p,o,n,m)}if(a[6]){g=a[6][aD](cM),p=c4(g[0]),g[0].slice(-1)=="%"&&(p*=2.55),o=c4(g[1]),g[1].slice(-1)=="%"&&(o*=2.55),n=c4(g[2]),g[2].slice(-1)=="%"&&(n*=2.55),(g[0].slice(-3)=="deg"||g[0].slice(-1)=="�")&&(p/=360),a[1].toLowerCase().slice(0,4)=="hsla"&&(m=c4(g[3])),g[3]&&g[3].slice(-1)=="%"&&(m/=100);return a8.hsl2rgb(p,o,n,m)}a={r:p,g:o,b:n,toString:aY},a.hex="#"+(16777216|n|o<<8|p<<16).toString(16).slice(1),a8.is(m,"finite")&&(a.opacity=m);return a}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:aY}},a8),a8.hsb=a2(function(a,f,e){return a8.hsb2rgb(a,f,e).hex}),a8.hsl=a2(function(a,f,e){return a8.hsl2rgb(a,f,e).hex}),a8.rgb=a2(function(e,d,f){return"#"+(16777216|f|d<<8|e<<16).toString(16).slice(1)}),a8.getColor=function(e){var d=this.getColor.start=this.getColor.start||{h:0,s:1,b:e||0.75},f=this.hsb2rgb(d.h,d.s,d.b);d.h+=0.075,d.h>1&&(d.h=0,d.s-=0.2,d.s<=0&&(this.getColor.start={h:0,s:1,b:d.b}));return f.hex},a8.getColor.reset=function(){delete this.start},a8.parsePathString=function(a){if(!a){return null}var h=aT(a);if(h.arr){return dI(h.arr)}var g={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},f=[];a8.is(a,dr)&&a8.is(a[0],dr)&&(f=dI(a)),f.length||aF(a).replace(b7,function(e,d,k){var j=[],i=d.toLowerCase();k.replace(b1,function(l,c){c&&j.push(+c)}),i=="m"&&j.length>2&&(f.push([d][aN](j.splice(0,2))),i="l",d=d=="m"?"l":"L");if(i=="r"){f.push([d][aN](j))}else{while(j.length>=g[i]){f.push([d][aN](j.splice(0,g[i])));if(!g[i]){break}}}}),f.toString=a8._path2string,h.arr=dI(f);return f},a8.parseTransformString=a2(function(a){if(!a){return null}var f={r:3,s:4,t:2,m:6},e=[];a8.is(a,dr)&&a8.is(a[0],dr)&&(e=dI(a)),e.length||aF(a).replace(dS,function(g,d,j){var i=[],h=ax.call(d);j.replace(b1,function(k,c){c&&i.push(+c)}),e.push([d][aN](i))}),e.toString=a8._path2string;return e});var aT=function(d){var c=aT.ps=aT.ps||{};c[d]?c[d].sleep=100:c[d]={sleep:100},setTimeout(function(){for(var a in c){c[aV](a)&&a!=d&&(c[a].sleep--,!c[a].sleep&&delete c[a])}});return c[d]};a8.findDotsAtSegment=function(X,W,V,U,T,S,R,Q,P){var O=1-P,N=dz(O,3),M=dz(O,2),L=P*P,K=L*P,J=N*X+M*3*P*V+O*3*P*P*T+K*R,I=N*W+M*3*P*U+O*3*P*P*S+K*Q,H=X+2*P*(V-X)+L*(T-2*V+X),G=W+2*P*(U-W)+L*(S-2*U+W),F=V+2*P*(T-V)+L*(R-2*T+V),E=U+2*P*(S-U)+L*(Q-2*S+U),D=O*X+P*V,C=O*W+P*U,B=O*T+P*R,A=O*S+P*Q,w=90-av.atan2(H-F,G-E)*180/dx;(H>F||G<E)&&(w+=180);return{x:J,y:I,m:{x:H,y:G},n:{x:F,y:E},start:{x:D,y:C},end:{x:B,y:A},alpha:w}},a8.bezierBBox=function(r,q,p,o,n,m,l,k){a8.is(r,"array")||(r=[r,q,p,o,n,m,l,k]);var a=dB.apply(null,r);return{x:a.min.x,y:a.min.y,x2:a.max.x,y2:a.max.y,width:a.max.x-a.min.x,height:a.max.y-a.min.y}},a8.isPointInsideBBox=function(e,d,f){return d>=e.x&&d<=e.x2&&f>=e.y&&f<=e.y2},a8.isBBoxIntersect=function(a,f){var e=a8.isPointInsideBBox;return e(f,a.x,a.y)||e(f,a.x2,a.y)||e(f,a.x,a.y2)||e(f,a.x2,a.y2)||e(a,f.x,f.y)||e(a,f.x2,f.y)||e(a,f.x,f.y2)||e(a,f.x2,f.y2)||(a.x<f.x2&&a.x>f.x||f.x<a.x2&&f.x>a.x)&&(a.y<f.y2&&a.y>f.y||f.y<a.y2&&f.y>a.y)},a8.pathIntersection=function(d,c){return dK(d,c)},a8.pathIntersectionNumber=function(d,c){return dK(d,c,1)},a8.isPointInsidePath=function(a,h,g){var f=a8.pathBBox(a);return a8.isPointInsideBBox(f,h,g)&&dK(a,[["M",h,g],["H",f.x2+10]],1)%2==1},a8._removedFactory=function(b){return function(){eve("raphael.log",null,"Rapha�l: you are calling to method �"+b+"� of removed object",b)}};var dJ=a8.pathBBox=function(D){var C=aT(D);if(C.bbox){return b5(C.bbox)}if(!D){return{x:0,y:0,width:0,height:0,x2:0,y2:0}}D=dA(D);var B=0,A=0,z=[],y=[],x;for(var w=0,v=D.length;w<v;w++){x=D[w];if(x[0]=="M"){B=x[1],A=x[2],z.push(B),y.push(A)}else{var u=dB(B,A,x[1],x[2],x[3],x[4],x[5],x[6]);z=z[aN](u.min.x,u.max.x),y=y[aN](u.min.y,u.max.y),B=x[5],A=x[6]}}var t=aq[aO](0,z),s=aq[aO](0,y),r=at[aO](0,z),n=at[aO](0,y),m={x:t,y:s,x2:r,y2:n,width:r-t,height:n-s};C.bbox=b5(m);return m},dI=function(a){var d=b5(a);d.toString=a8._path2string;return d},dH=a8._pathToRelative=function(H){var G=aT(H);if(G.rel){return dI(G.rel)}if(!a8.is(H,dr)||!a8.is(H&&H[0],dr)){H=a8.parsePathString(H)}var F=[],E=0,D=0,C=0,B=0,A=0;H[0][0]=="M"&&(E=H[0][1],D=H[0][2],C=E,B=D,A++,F.push(["M",E,D]));for(var z=A,y=H.length;z<y;z++){var x=F[z]=[],w=H[z];if(w[0]!=ax.call(w[0])){x[0]=ax.call(w[0]);switch(x[0]){case"a":x[1]=w[1],x[2]=w[2],x[3]=w[3],x[4]=w[4],x[5]=w[5],x[6]=+(w[6]-E).toFixed(3),x[7]=+(w[7]-D).toFixed(3);break;case"v":x[1]=+(w[1]-D).toFixed(3);break;case"m":C=w[1],B=w[2];default:for(var v=1,u=w.length;v<u;v++){x[v]=+(w[v]-(v%2?E:D)).toFixed(3)}}}else{x=F[z]=[],w[0]=="m"&&(C=w[1]+E,B=w[2]+D);for(var t=0,s=w.length;t<s;t++){F[z][t]=w[t]}}var a=F[z].length;switch(F[z][0]){case"z":E=C,D=B;break;case"h":E+=+F[z][a-1];break;case"v":D+=+F[z][a-1];break;default:E+=+F[z][a-2],D+=+F[z][a-1]}}F.toString=a8._path2string,G.rel=dI(F);return F},dG=a8._pathToAbsolute=function(J){var I=aT(J);if(I.abs){return dI(I.abs)}if(!a8.is(J,dr)||!a8.is(J&&J[0],dr)){J=a8.parsePathString(J)}if(!J||!J.length){return[["M",0,0]]}var H=[],G=0,F=0,E=0,D=0,C=0;J[0][0]=="M"&&(G=+J[0][1],F=+J[0][2],E=G,D=F,C++,H[0]=["M",G,F]);var B=J.length==3&&J[0][0]=="M"&&J[1][0].toUpperCase()=="R"&&J[2][0].toUpperCase()=="Z";for(var A,z,y=C,x=J.length;y<x;y++){H.push(A=[]),z=J[y];if(z[0]!=cY.call(z[0])){A[0]=cY.call(z[0]);switch(A[0]){case"A":A[1]=z[1],A[2]=z[2],A[3]=z[3],A[4]=z[4],A[5]=z[5],A[6]=+(z[6]+G),A[7]=+(z[7]+F);break;case"V":A[1]=+z[1]+F;break;case"H":A[1]=+z[1]+G;break;case"R":var w=[G,F][aN](z.slice(1));for(var v=2,u=w.length;v<u;v++){w[v]=+w[v]+G,w[++v]=+w[v]+F}H.pop(),H=H[aN](aW(w,B));break;case"M":E=+z[1]+G,D=+z[2]+F;default:for(v=1,u=z.length;v<u;v++){A[v]=+z[v]+(v%2?G:F)}}}else{if(z[0]=="R"){w=[G,F][aN](z.slice(1)),H.pop(),H=H[aN](aW(w,B)),A=["R"][aN](z.slice(-2))}else{for(var n=0,a=z.length;n<a;n++){A[n]=z[n]}}}switch(A[0]){case"Z":G=E,F=D;break;case"H":G=A[1];break;case"V":F=A[1];break;case"M":E=A[A.length-2],D=A[A.length-1];default:G=A[A.length-2],F=A[A.length-1]}}H.toString=a8._path2string,I.abs=dI(H);return H},dF=function(f,e,h,g){return[f,e,h,g,h,g]},dE=function(j,i,p,o,n,m){var l=1/3,k=2/3;return[l*j+k*p,l*i+k*o,l*n+k*p,l*m+k*o,n,m]},dD=function(bL,bK,bJ,bI,bH,bG,bF,bE,bD,bC){var bB=dx*120/180,bA=dx/180*(+bH||0),bz=[],by,bx=a2(function(g,f,j){var i=g*av.cos(j)-f*av.sin(j),h=g*av.sin(j)+f*av.cos(j);return{x:i,y:h}});if(!bC){by=bx(bL,bK,-bA),bL=by.x,bK=by.y,by=bx(bE,bD,-bA),bE=by.x,bD=by.y;var bw=av.cos(dx/180*bH),bv=av.sin(dx/180*bH),bu=(bL-bE)/2,bt=(bK-bD)/2,bs=bu*bu/(bJ*bJ)+bt*bt/(bI*bI);bs>1&&(bs=av.sqrt(bs),bJ=bs*bJ,bI=bs*bI);var br=bJ*bJ,bq=bI*bI,bp=(bG==bF?-1:1)*av.sqrt(ao((br*bq-br*bt*bt-bq*bu*bu)/(br*bt*bt+bq*bu*bu))),bo=bp*bJ*bt/bI+(bL+bE)/2,bn=bp*-bI*bu/bJ+(bK+bD)/2,bm=av.asin(((bK-bn)/bI).toFixed(9)),bl=av.asin(((bD-bn)/bI).toFixed(9));bm=bL<bo?dx-bm:bm,bl=bE<bo?dx-bl:bl,bm<0&&(bm=dx*2+bm),bl<0&&(bl=dx*2+bl),bF&&bm>bl&&(bm=bm-dx*2),!bF&&bl>bm&&(bl=bl-dx*2)}else{bm=bC[0],bl=bC[1],bo=bC[2],bn=bC[3]}var bk=bl-bm;if(ao(bk)>bB){var bj=bl,bi=bE,bh=bD;bl=bm+bB*(bF&&bl>bm?1:-1),bE=bo+bJ*av.cos(bl),bD=bn+bI*av.sin(bl),bz=dD(bE,bD,bJ,bI,bH,0,bF,bi,bh,[bl,bj,bo,bn])}bk=bl-bm;var bg=av.cos(bm),bf=av.sin(bm),be=av.cos(bl),bd=av.sin(bl),bc=av.tan(bk/4),bb=4/3*bJ*bc,ba=4/3*bI*bc,Z=[bL,bK],Y=[bL+bb*bf,bK-ba*bg],B=[bE+bb*bd,bD-ba*be],z=[bE,bD];Y[0]=2*Z[0]-Y[0],Y[1]=2*Z[1]-Y[1];if(bC){return[Y,B,z][aN](bz)}bz=[Y,B,z][aN](bz).join()[aD](",");var w=[];for(var s=0,n=bz.length;s<n;s++){w[s]=s%2?bx(bz[s-1],bz[s],bA).y:bx(bz[s],bz[s+1],bA).x}return w},dC=function(t,s,r,q,p,o,n,m,l){var k=1-l;return{x:dz(k,3)*t+dz(k,2)*3*l*r+k*3*l*l*p+dz(l,3)*n,y:dz(k,3)*s+dz(k,2)*3*l*q+k*3*l*l*o+dz(l,3)*m}},dB=a2(function(F,E,D,C,B,A,z,y){var x=B-2*D+F-(z-2*B+D),w=2*(D-F)-2*(B-D),v=F-D,u=(-w+av.sqrt(w*w-4*x*v))/2/x,t=(-w-av.sqrt(w*w-4*x*v))/2/x,s=[E,y],r=[F,z],m;ao(u)>"1e12"&&(u=0.5),ao(t)>"1e12"&&(t=0.5),u>0&&u<1&&(m=dC(F,E,D,C,B,A,z,y,u),r.push(m.x),s.push(m.y)),t>0&&t<1&&(m=dC(F,E,D,C,B,A,z,y,t),r.push(m.x),s.push(m.y)),x=A-2*C+E-(y-2*A+C),w=2*(C-E)-2*(A-C),v=E-C,u=(-w+av.sqrt(w*w-4*x*v))/2/x,t=(-w-av.sqrt(w*w-4*x*v))/2/x,ao(u)>"1e12"&&(u=0.5),ao(t)>"1e12"&&(t=0.5),u>0&&u<1&&(m=dC(F,E,D,C,B,A,z,y,u),r.push(m.x),s.push(m.y)),t>0&&t<1&&(m=dC(F,E,D,C,B,A,z,y,t),r.push(m.x),s.push(m.y));return{min:{x:aq[aO](0,r),y:aq[aO](0,s)},max:{x:at[aO](0,r),y:at[aO](0,s)}}}),dA=a8._path2curve=a2(function(F,E){var D=!E&&aT(F);if(!E&&D.curve){return dI(D.curve)}var C=dG(F),B=E&&dG(E),A={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},z={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},y=function(f,e){var h,g;if(!f){return["C",e.x,e.y,e.x,e.y,e.x,e.y]}!(f[0] in {T:1,Q:1})&&(e.qx=e.qy=null);switch(f[0]){case"M":e.X=f[1],e.Y=f[2];break;case"A":f=["C"][aN](dD[aO](0,[e.x,e.y][aN](f.slice(1))));break;case"S":h=e.x+(e.x-(e.bx||e.x)),g=e.y+(e.y-(e.by||e.y)),f=["C",h,g][aN](f.slice(1));break;case"T":e.qx=e.x+(e.x-(e.qx||e.x)),e.qy=e.y+(e.y-(e.qy||e.y)),f=["C"][aN](dE(e.x,e.y,e.qx,e.qy,f[1],f[2]));break;case"Q":e.qx=f[1],e.qy=f[2],f=["C"][aN](dE(e.x,e.y,f[1],f[2],f[3],f[4]));break;case"L":f=["C"][aN](dF(e.x,e.y,f[1],f[2]));break;case"H":f=["C"][aN](dF(e.x,e.y,f[1],e.y));break;case"V":f=["C"][aN](dF(e.x,e.y,e.x,f[1]));break;case"Z":f=["C"][aN](dF(e.x,e.y,e.X,e.Y))}return f},x=function(e,d){if(e[d].length>7){e[d].shift();var f=e[d];while(f.length){e.splice(d++,0,["C"][aN](f.splice(0,6)))}e.splice(d,1),u=at(C.length,B&&B.length||0)}},w=function(e,d,j,i,h){e&&d&&e[h][0]=="M"&&d[h][0]!="M"&&(d.splice(h,0,["M",i.x,i.y]),j.bx=0,j.by=0,j.x=e[h][1],j.y=e[h][2],u=at(C.length,B&&B.length||0))};for(var v=0,u=at(C.length,B&&B.length||0);v<u;v++){C[v]=y(C[v],A),x(C,v),B&&(B[v]=y(B[v],z)),B&&x(B,v),w(C,B,A,z,v),w(B,C,z,A,v);var t=C[v],s=B&&B[v],n=t.length,m=B&&s.length;A.x=t[n-2],A.y=t[n-1],A.bx=c4(t[n-4])||A.x,A.by=c4(t[n-3])||A.y,z.bx=B&&(c4(s[m-4])||z.x),z.by=B&&(c4(s[m-3])||z.y),z.x=B&&s[m-2],z.y=B&&s[m-1]}B||(D.curve=dI(C));return B?[C,B]:C},null,dI),dy=a8._parseDots=a2(function(t){var s=[];for(var r=0,q=t.length;r<q;r++){var p={},o=t[r].match(/^([^:]*):?([\d\.]*)/);p.color=a8.getRGB(o[1]);if(p.color.error){return null}p.color=p.color.hex,o[2]&&(p.offset=o[2]+"%"),s.push(p)}for(r=1,q=s.length-1;r<q;r++){if(!s[r].offset){var n=c4(s[r-1].offset||0),m=0;for(var l=r+1;l<q;l++){if(s[l].offset){m=s[l].offset;break}}m||(m=100,l=q),m=c4(m);var a=(m-n)/(l-r+1);for(;r<l;r++){n+=a,s[r].offset=n+"%"}}}return s}),dw=a8._tear=function(d,c){d==c.top&&(c.top=d.prev),d==c.bottom&&(c.bottom=d.next),d.next&&(d.next.prev=d.prev),d.prev&&(d.prev.next=d.next)},du=a8._tofront=function(d,c){c.top!==d&&(dw(d,c),d.next=null,d.prev=c.top,c.top.next=d,c.top=d)},ds=a8._toback=function(d,c){c.bottom!==d&&(dw(d,c),d.next=c.bottom,d.prev=null,c.bottom.prev=d,c.bottom=d)},dq=a8._insertafter=function(e,d,f){dw(e,f),d==f.top&&(f.top=e),d.next&&(d.next.prev=e),e.next=d.next,e.prev=d,d.next=e},dn=a8._insertbefore=function(e,d,f){dw(e,f),d==f.bottom&&(f.bottom=e),d.prev&&(d.prev.next=e),e.prev=d.prev,d.prev=e,e.next=d},dl=a8.toMatrix=function(f,e){var h=dJ(f),g={_:{transform:aJ},getBBox:function(){return h}};dT(g,e);return g.matrix},dj=a8.transformPath=function(d,c){return cJ(d,dl(d,c))},dT=a8._extractTransform=function(R,Q){if(Q==null){return R._.transform}Q=aF(Q).replace(/\.{3}|\u2026/g,R._.transform||aJ);var P=a8.parseTransformString(Q),O=0,N=0,M=0,L=1,K=1,J=R._,I=new aL;J.transform=P||[];if(P){for(var H=0,G=P.length;H<G;H++){var F=P[H],E=F.length,D=aF(F[0]).toLowerCase(),C=F[0]!=D,B=C?I.invert():0,A,z,r,p,a;D=="t"&&E==3?C?(A=B.x(0,0),z=B.y(0,0),r=B.x(F[1],F[2]),p=B.y(F[1],F[2]),I.translate(r-A,p-z)):I.translate(F[1],F[2]):D=="r"?E==2?(a=a||R.getBBox(1),I.rotate(F[1],a.x+a.width/2,a.y+a.height/2),O+=F[1]):E==4&&(C?(r=B.x(F[2],F[3]),p=B.y(F[2],F[3]),I.rotate(F[1],r,p)):I.rotate(F[1],F[2],F[3]),O+=F[1]):D=="s"?E==2||E==3?(a=a||R.getBBox(1),I.scale(F[1],F[E-1],a.x+a.width/2,a.y+a.height/2),L*=F[1],K*=F[E-1]):E==5&&(C?(r=B.x(F[3],F[4]),p=B.y(F[3],F[4]),I.scale(F[1],F[2],r,p)):I.scale(F[1],F[2],F[3],F[4]),L*=F[1],K*=F[2]):D=="m"&&E==7&&I.add(F[1],F[2],F[3],F[4],F[5],F[6]),J.dirtyT=1,R.matrix=I}}R.matrix=I,J.sx=L,J.sy=K,J.deg=O,J.dx=N=I.e,J.dy=M=I.f,L==1&&K==1&&!O&&J.bbox?(J.bbox.x+=+N,J.bbox.y+=+M):J.dirtyT=1},dd=function(d){var c=d[0];switch(c.toLowerCase()){case"t":return[c,0,0];case"m":return[c,1,0,0,1,0,0];case"r":return d.length==4?[c,0,d[2],d[3]]:[c,0];case"s":return d.length==5?[c,1,1,d[3],d[4]]:d.length==3?[c,1,1]:[c,1]}},aM=a8._equaliseTransform=function(t,s){s=aF(s).replace(/\.{3}|\u2026/g,t),t=a8.parseTransformString(t)||[],s=a8.parseTransformString(s)||[];var r=at(t.length,s.length),q=[],p=[],o=0,n,m,l,a;for(;o<r;o++){l=t[o]||dd(s[o]),a=s[o]||dd(l);if(l[0]!=a[0]||l[0].toLowerCase()=="r"&&(l[2]!=a[2]||l[3]!=a[3])||l[0].toLowerCase()=="s"&&(l[3]!=a[3]||l[4]!=a[4])){return}q[o]=[],p[o]=[];for(n=0,m=at(l.length,a.length);n<m;n++){n in l&&(q[o][n]=l[n]),n in a&&(p[o][n]=a[n])}}return{from:q,to:p}};a8._getContainer=function(a,k,j,h,i){var g;g=h==null&&!a8.is(a,"object")?aU.doc.getElementById(a):a;if(g!=null){if(g.tagName){return k==null?{container:g,width:g.style.pixelWidth||g.offsetWidth,height:g.style.pixelHeight||g.offsetHeight}:{container:g,width:k,height:j}}return{container:1,x:a,y:k,width:j,height:h,zValue:i}}},a8.pathToRelative=dH,a8._engine={},a8.path2curve=dA,a8.matrix=function(h,g,l,k,j,i){return new aL(h,g,l,k,j,i)},function(a){function e(d){var c=av.sqrt(f(d));d[0]&&(d[0]/=c),d[1]&&(d[1]/=c)}function f(b){return b[0]*b[0]+b[1]*b[1]}a.add=function(z,y,x,w,v,u){var t=[[],[],[]],s=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],r=[[z,x,v],[y,w,u],[0,0,1]],q,p,o,n;z&&z instanceof aL&&(r=[[z.a,z.c,z.e],[z.b,z.d,z.f],[0,0,1]]);for(q=0;q<3;q++){for(p=0;p<3;p++){n=0;for(o=0;o<3;o++){n+=s[q][o]*r[o][p]}t[q][p]=n}}this.a=t[0][0],this.b=t[1][0],this.c=t[0][1],this.d=t[1][1],this.e=t[0][2],this.f=t[1][2]},a.invert=function(){var d=this,c=d.a*d.d-d.b*d.c;return new aL(d.d/c,-d.b/c,-d.c/c,d.a/c,(d.c*d.f-d.d*d.e)/c,(d.b*d.e-d.a*d.f)/c)},a.clone=function(){return new aL(this.a,this.b,this.c,this.d,this.e,this.f)},a.translate=function(d,c){this.add(1,0,0,1,d,c)},a.scale=function(h,g,j,i){g==null&&(g=h),(j||i)&&this.add(1,0,0,1,j,i),this.add(h,0,0,g,0,0),(j||i)&&this.add(1,0,0,1,-j,-i)},a.rotate=function(g,k,j){g=a8.rad(g),k=k||0,j=j||0;var i=+av.cos(g).toFixed(9),h=+av.sin(g).toFixed(9);this.add(i,h,-h,i,k,j),this.add(1,0,0,1,-k,-j)},a.x=function(d,c){return d*this.a+c*this.c+this.e},a.y=function(d,c){return d*this.b+c*this.d+this.f},a.get=function(b){return +this[aF.fromCharCode(97+b)].toFixed(4)},a.toString=function(){return a8.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},a.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},a.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},a.split=function(){var c={};c.dx=this.e,c.dy=this.f;var i=[[this.a,this.c],[this.b,this.d]];c.scalex=av.sqrt(f(i[0])),e(i[0]),c.shear=i[0][0]*i[1][0]+i[0][1]*i[1][1],i[1]=[i[1][0]-i[0][0]*c.shear,i[1][1]-i[0][1]*c.shear],c.scaley=av.sqrt(f(i[1])),e(i[1]),c.shear/=c.scaley;var h=-i[0][1],d=i[1][1];d<0?(c.rotate=a8.deg(av.acos(d)),h<0&&(c.rotate=360-c.rotate)):c.rotate=a8.deg(av.asin(h)),c.isSimple=!+c.shear.toFixed(9)&&(c.scalex.toFixed(9)==c.scaley.toFixed(9)||!c.rotate),c.isSuperSimple=!+c.shear.toFixed(9)&&c.scalex.toFixed(9)==c.scaley.toFixed(9)&&!c.rotate,c.noRotation=!+c.shear.toFixed(9)&&!c.rotate;return c},a.toTransformString=function(d){var c=d||this[aD]();if(c.isSimple){c.scalex=+c.scalex.toFixed(4),c.scaley=+c.scaley.toFixed(4),c.rotate=+c.rotate.toFixed(4);return(c.dx||c.dy?"t"+[c.dx,c.dy]:aJ)+(c.scalex!=1||c.scaley!=1?"s"+[c.scalex,c.scaley,0,0]:aJ)+(c.rotate?"r"+[c.rotate,0,0]:aJ)}return"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(aL.prototype);var aI=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);navigator.vendor=="Apple Computer, Inc."&&(aI&&aI[1]<4||navigator.platform.slice(0,2)=="iP")||navigator.vendor=="Google Inc."&&aI&&aI[1]<8?aQ.safari=function(){var b=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){b.remove()})}:aQ.safari=cW;var aG=function(){this.returnValue=!1},aE=function(){return this.originalEvent.preventDefault()},aC=function(){this.cancelBubble=!0},aA=function(){return this.originalEvent.stopPropagation()},ay=function(){if(aU.doc.addEventListener){return function(h,g,l,k){var j=aK&&az[g]?az[g]:g,i=function(q){var p=aU.doc.documentElement.scrollTop||aU.doc.body.scrollTop,o=aU.doc.documentElement.scrollLeft||aU.doc.body.scrollLeft,d=q.clientX+o,c=q.clientY+p;if(aK&&az[aV](g)){for(var b=0,a=q.targetTouches&&q.targetTouches.length;b<a;b++){if(q.targetTouches[b].target==h){var r=q;q=q.targetTouches[b],q.originalEvent=r,q.preventDefault=aE,q.stopPropagation=aA;break}}}return l.call(k,q,d,c)};h.addEventListener(j,i,!1);return function(){h.removeEventListener(j,i,!1);return !0}}}if(aU.doc.attachEvent){return function(h,g,l,k){var j=function(d){d=d||aU.win.event;var c=aU.doc.documentElement.scrollTop||aU.doc.body.scrollTop,o=aU.doc.documentElement.scrollLeft||aU.doc.body.scrollLeft,n=d.clientX+o,m=d.clientY+c;d.preventDefault=d.preventDefault||aG,d.stopPropagation=d.stopPropagation||aC;return l.call(k,d,n,m)};h.attachEvent("on"+g,j);var i=function(){h.detachEvent("on"+g,j);return !0};return i}}}(),aw=[],au=function(B){var A=B.clientX,z=B.clientY,y=aU.doc.documentElement.scrollTop||aU.doc.body.scrollTop,x=aU.doc.documentElement.scrollLeft||aU.doc.body.scrollLeft,w,v=aw.length;while(v--){w=aw[v];if(aK){var u=B.touches.length,t;while(u--){t=B.touches[u];if(t.identifier==w.el._drag.id){A=t.clientX,z=t.clientY,(B.originalEvent?B.originalEvent:B).preventDefault();break}}}else{B.preventDefault()}var s=w.el.node,r,q=s.nextSibling,o=s.parentNode,h=s.style.display;aU.win.opera&&o.removeChild(s),s.style.display="none",r=w.el.paper.getElementByPoint(A,z),s.style.display=h,aU.win.opera&&(q?o.insertBefore(s,q):o.appendChild(s)),r&&eve("raphael.drag.over."+w.el.id,w.el,r),A+=x,z+=y,eve("raphael.drag.move."+w.el.id,w.move_scope||w.el,A-w.el._drag.x,z-w.el._drag.y,A,z,B)}},ar=function(a){a8.unmousemove(au).unmouseup(ar);var f=aw.length,e;while(f--){e=aw[f],e.el._drag={},eve("raphael.drag.end."+e.el.id,e.end_scope||e.start_scope||e.move_scope||e.el,a)}aw=[]},ap=a8.el={};for(var an=aB.length;an--;){(function(a){a8[a]=ap[a]=function(e,b){a8.is(e,"function")&&(this.events=this.events||[],this.events.push({name:a,f:e,unbind:ay(this.shape||this.node||aU.doc,a,e,b||this)}));return this},a8["un"+a]=ap["un"+a]=function(b){var f=this.events||[],e=f.length;while(e--){if(f[e].name==a&&f[e].f==b){f[e].unbind(),f.splice(e,1),!f.length&&delete this.events;return this}}return this}})(aB[an])}ap.data=function(a,h){var g=c5[this.id]=c5[this.id]||{};if(arguments.length==1){if(a8.is(a,"object")){for(var f in a){a[aV](f)&&this.data(f,a[f])}return this}eve("raphael.data.get."+this.id,this,g[a],a);return g[a]}g[a]=h,eve("raphael.data.set."+this.id,this,h,a);return this},ap.removeData=function(b){b==null?c5[this.id]={}:c5[this.id]&&delete c5[this.id][b];return this},ap.hover=function(f,e,h,g){return this.mouseover(f,h).mouseout(e,g||h)},ap.unhover=function(d,c){return this.unmouseover(d).unmouseout(c)};var am=[];ap.drag=function(a,n,m,l,k,j){function h(d){(d.originalEvent||d).preventDefault();var c=aU.doc.documentElement.scrollTop||aU.doc.body.scrollTop,b=aU.doc.documentElement.scrollLeft||aU.doc.body.scrollLeft;this._drag.x=d.clientX+b,this._drag.y=d.clientY+c,this._drag.id=d.identifier,!aw.length&&a8.mousemove(au).mouseup(ar),aw.push({el:this,move_scope:l,start_scope:k,end_scope:j}),n&&eve.on("raphael.drag.start."+this.id,n),a&&eve.on("raphael.drag.move."+this.id,a),m&&eve.on("raphael.drag.end."+this.id,m),eve("raphael.drag.start."+this.id,k||l||this,d.clientX+b,d.clientY+c,d)}this._drag={},am.push({el:this,start:h}),this.mousedown(h);return this},ap.onDragOver=function(b){b?eve.on("raphael.drag.over."+this.id,b):eve.unbind("raphael.drag.over."+this.id)},ap.undrag=function(){var a=am.length;while(a--){am[a].el==this&&(this.unmousedown(am[a].start),am.splice(a,1),eve.unbind("raphael.drag.*."+this.id))}!am.length&&a8.unmousemove(au).unmouseup(ar)},aQ.circle=function(a,h,g){var f=a8._engine.circle(this,a||0,h||0,g||0);this.__set__&&this.__set__.push(f);return f},aQ.rect=function(a,l,k,j,i){var h=a8._engine.rect(this,a||0,l||0,k||0,j||0,i||0);this.__set__&&this.__set__.push(h);return h},aQ.ellipse=function(a,j,i,h){var g=a8._engine.ellipse(this,a||0,j||0,i||0,h||0);this.__set__&&this.__set__.push(g);return g},aQ.path=function(a){a&&!a8.is(a,dt)&&!a8.is(a[0],dr)&&(a+=aJ);var d=a8._engine.path(a8.format[aO](a8,arguments),this);this.__set__&&this.__set__.push(d);return d},aQ.image=function(a,l,k,j,i){var h=a8._engine.image(this,a||"about:blank",l||0,k||0,j||0,i||0);this.__set__&&this.__set__.push(h);return h},aQ.text=function(a,h,g){var f=a8._engine.text(this,a||0,h||0,aF(g));this.__set__&&this.__set__.push(f);return f},aQ.set=function(a){!a8.is(a,"array")&&(a=Array.prototype.splice.call(arguments,0,arguments.length));var d=new cT(a);this.__set__&&this.__set__.push(d);return d},aQ.setStart=function(b){this.__set__=b||this.set()},aQ.setFinish=function(d){var c=this.__set__;delete this.__set__;return c},aQ.setSize=function(a,d){return a8._engine.setSize.call(this,a,d)},aQ.setViewBox=function(a,j,i,h,g){return a8._engine.setViewBox.call(this,a,j,i,h,g)},aQ.top=aQ.bottom=null,aQ.raphael=a8;var al=function(r){var q=r.getBoundingClientRect(),p=r.ownerDocument,o=p.body,n=p.documentElement,m=n.clientTop||o.clientTop||0,l=n.clientLeft||o.clientLeft||0,k=q.top+(aU.win.pageYOffset||n.scrollTop||o.scrollTop)-m,h=q.left+(aU.win.pageXOffset||n.scrollLeft||o.scrollLeft)-l;return{y:k,x:h}};aQ.getElementByPoint=function(j,h){var p=this,o=p.canvas,n=aU.doc.elementFromPoint(j,h);if(aU.win.opera&&n.tagName=="svg"){var m=al(o),l=o.createSVGRect();l.x=j-m.x,l.y=h-m.y,l.width=l.height=1;var k=o.getIntersectionList(l,null);k.length&&(n=k[k.length-1])}if(!n){return null}while(n.parentNode&&n!=o.parentNode&&!n.raphael){n=n.parentNode}n==p.canvas.parentNode&&(n=o),n=n&&n.raphael?p.getById(n.raphaelid):null;return n},aQ.getById=function(d){var c=this.bottom;while(c){if(c.id==d){return c}c=c.next}return null},aQ.forEach=function(e,d){var f=this.bottom;while(f){if(e.call(d,f)===!1){return this}f=f.next}return this},aQ.getElementsByPoint=function(e,d){var f=this.set();this.forEach(function(a){a.isPointInside(e,d)&&f.push(a)});return f},ap.isPointInside=function(a,f){var e=this.realPath=this.realPath||cL[this.type](this);return a8.isPointInsidePath(e,a,f)},ap.getBBox=function(d){if(this.removed){return{}}var c=this._;if(d){if(c.dirty||!c.bboxwt){this.realPath=cL[this.type](this),c.bboxwt=dJ(this.realPath),c.bboxwt.toString=aj,c.dirty=0}return b5(c.bboxwt)}if(c.dirty||c.dirtyT||!c.bbox){if(c.dirty||!this.realPath){c.bboxwt=0,this.realPath=cL[this.type](this)}c.bbox=dJ(cJ(this.realPath,this.matrix)),c.bbox.toString=aj,c.dirty=c.dirtyT=0}return b5(c.bbox)},ap.getBBoxWOTransform=function(){return this.getBBox(1)},ap.clone=function(){if(this.removed){return null}var b=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(b);return b},ap.glow=function(i){if(this.type=="text"){return null}i=i||{};var h={width:(i.width||10)+(+this.attr("stroke-width")||1),fill:i.fill||!1,opacity:i.opacity||0.5,offsetx:i.offsetx||0,offsety:i.offsety||0,color:i.color||"#000"},n=h.width/2,m=this.paper,l=m.set(),k=this.realPath||cL[this.type](this);k=this.matrix?cJ(k,this.matrix):k;for(var j=1;j<n+1;j++){l.push(m.path(k).attr({stroke:h.color,fill:h.fill?h.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(h.width/n*j).toFixed(3),opacity:+(h.opacity/n).toFixed(3)}))}return l.insertBefore(this).translate(h.offsetx,h.offsety)};var ai={},ah=function(r,q,p,o,n,m,l,k,a){return a==null?dQ(r,q,p,o,n,m,l,k):a8.findDotsAtSegment(r,q,p,o,n,m,l,k,dP(r,q,p,o,n,m,l,k,a))},ag=function(a,d){return function(A,z,y){A=dA(A);var x,w,v,u,t="",s={},r,q=0;for(var c=0,b=A.length;c<b;c++){v=A[c];if(v[0]=="M"){x=+v[1],w=+v[2]}else{u=ah(x,w,v[1],v[2],v[3],v[4],v[5],v[6]);if(q+u>z){if(d&&!s.start){r=ah(x,w,v[1],v[2],v[3],v[4],v[5],v[6],z-q),t+=["C"+r.start.x,r.start.y,r.m.x,r.m.y,r.x,r.y];if(y){return t}s.start=t,t=["M"+r.x,r.y+"C"+r.n.x,r.n.y,r.end.x,r.end.y,v[5],v[6]].join(),q+=u,x=+v[5],w=+v[6];continue}if(!a&&!d){r=ah(x,w,v[1],v[2],v[3],v[4],v[5],v[6],z-q);return{x:r.x,y:r.y,alpha:r.alpha}}}q+=u,x=+v[5],w=+v[6]}t+=v.shift()+v}s.end=t,r=a?q:d?s:a8.findDotsAtSegment(x,w,v[0],v[1],v[2],v[3],v[4],v[5],1),r.alpha&&(r={x:r.x,y:r.y,alpha:r.alpha});return r}},af=ag(1),ae=ag(),ad=ag(0,1);a8.getTotalLength=af,a8.getPointAtLength=ae,a8.getSubpath=function(f,e,h){if(this.getTotalLength(f)-h<0.000001){return ad(f,e).end}var g=ad(f,h,1);return e?ad(g,e).end:g},ap.getTotalLength=function(){if(this.type=="path"){if(this.node.getTotalLength){return this.node.getTotalLength()}return af(this.attrs.path)}},ap.getPointAtLength=function(b){if(this.type=="path"){return ae(this.attrs.path,b)}},ap.getSubpath=function(a,d){if(this.type=="path"){return a8.getSubpath(this.attrs.path,a,d)}};var ac=a8.easing_formulas={linear:function(b){return b},"<":function(b){return dz(b,1.7)},">":function(b){return dz(b,0.48)},"<>":function(j){var i=0.48-j/1.04,p=av.sqrt(0.1734+i*i),o=p-i,n=dz(ao(o),1/3)*(o<0?-1:1),m=-p-i,l=dz(ao(m),1/3)*(m<0?-1:1),k=n+l+0.5;return(1-k)*3*k*k+k*k*k},backIn:function(d){var c=1.70158;return d*d*((c+1)*d-c)},backOut:function(d){d=d-1;var c=1.70158;return d*d*((c+1)*d+c)+1},elastic:function(b){if(b==!!b){return b}return dz(2,-10*b)*av.sin((b-0.075)*2*dx/0.3)+1},bounce:function(f){var e=7.5625,h=2.75,g;f<1/h?g=e*f*f:f<2/h?(f-=1.5/h,g=e*f*f+0.75):f<2.5/h?(f-=2.25/h,g=e*f*f+0.9375):(f-=2.625/h,g=e*f*f+0.984375);return g}};ac.easeIn=ac["ease-in"]=ac["<"],ac.easeOut=ac["ease-out"]=ac[">"],ac.easeInOut=ac["ease-in-out"]=ac["<>"],ac["back-in"]=ac.backIn,ac["back-out"]=ac.backOut;var ab=[],aa=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,16)},db=function(){var T=+(new Date),S=0;for(;S<ab.length;S++){var R=ab[S];if(R.el.removed||R.paused){continue}var Q=T-R.start,P=R.ms,O=R.easing,N=R.from,M=R.diff,L=R.to,K=R.t,J=R.el,I={},H,F={},E;R.initstatus?(Q=(R.initstatus*R.anim.top-R.prev)/(R.percent-R.prev)*P,R.status=R.initstatus,delete R.initstatus,R.stop&&ab.splice(S--,1)):R.status=(R.prev+(R.percent-R.prev)*(Q/P))/R.anim.top;if(Q<0){continue}if(Q<P){var D=O(Q/P);for(var C in N){if(N[aV](C)){switch(cS[C]){case dv:H=+N[C]+D*P*M[C];break;case"colour":H="rgb("+[c8(da(N[C].r+D*P*M[C].r)),c8(da(N[C].g+D*P*M[C].g)),c8(da(N[C].b+D*P*M[C].b))].join(",")+")";break;case"path":H=[];for(var B=0,q=N[C].length;B<q;B++){H[B]=[N[C][B][0]];for(var n=1,g=N[C][B].length;n<g;n++){H[B][n]=+N[C][B][n]+D*P*M[C][B][n]}H[B]=H[B].join(aH)}H=H.join(aH);break;case"transform":if(M[C].real){H=[];for(B=0,q=N[C].length;B<q;B++){H[B]=[N[C][B][0]];for(n=1,g=N[C][B].length;n<g;n++){H[B][n]=N[C][B][n]+D*P*M[C][B][n]}}}else{var a=function(b){return +N[C][b]+D*P*M[C][b]};H=[["m",a(0),a(1),a(2),a(3),a(4),a(5)]]}break;case"csv":if(C=="clip-rect"){H=[],B=4;while(B--){H[B]=+N[C][B]+D*P*M[C][B]}}break;default:var G=[][aN](N[C]);H=[],B=J.paper.customAttributes[C].length;while(B--){H[B]=+G[B]+D*P*M[C][B]}}I[C]=H}}J.attr(I),function(e,d,f){setTimeout(function(){eve("raphael.anim.frame."+e,d,f)})}(J.id,J,R.anim)}else{(function(e,h,f){setTimeout(function(){eve("raphael.anim.frame."+h.id,h,f),eve("raphael.anim.finish."+h.id,h,f),a8.is(e,"function")&&e.call(h)})})(R.callback,J,R.anim),J.attr(L),ab.splice(S--,1);if(R.repeat>1&&!R.next){for(E in L){L[aV](E)&&(F[E]=R.totalOrigin[E])}R.el.attr(F),c0(R.anim,R.el,R.anim.percents[0],null,R.totalOrigin,R.repeat-1)}R.next&&!R.stop&&c0(R.anim,R.el,R.next,null,R.totalOrigin,R.repeat)}}a8.svg&&J&&J.paper&&J.paper.safari(),ab.length&&aa(db)},c8=function(b){return b>255?255:b<0?0:b};ap.animateWith=function(x,w,v,u,t,s){var r=this;if(r.removed){s&&s.call(r);return r}var q=v instanceof c3?v:a8.animation(v,u,t,s),p,o;c0(q,r,q.percents[0],null,r.attr());for(var n=0,a=ab.length;n<a;n++){if(ab[n].anim==w&&ab[n].el==x){ab[a-1].start=ab[n].start;break}}return r},ap.onAnimation=function(b){b?eve.on("raphael.anim.frame."+this.id,b):eve.unbind("raphael.anim.frame."+this.id);return this},c3.prototype.delay=function(d){var c=new c3(this.anim,this.ms);c.times=this.times,c.del=+d||0;return c},c3.prototype.repeat=function(d){var c=new c3(this.anim,this.ms);c.del=this.del,c.times=av.floor(at(d,0))||1;return c},a8.animation=function(a,n,m,l){if(a instanceof c3){return a}if(a8.is(m,"function")||!m){l=l||m||null,m=null}a=Object(a),n=+n||0;var k={},j,g;for(g in a){a[aV](g)&&c4(g)!=g&&c4(g)+"%"!=g&&(j=!0,k[g]=a[g])}if(!j){return new c3(a,n)}m&&(k.easing=m),l&&(k.callback=l);return new c3({100:k},n)},ap.animate=function(a,l,k,j){var i=this;if(i.removed){j&&j.call(i);return i}var h=a instanceof c3?a:a8.animation(a,l,k,j);c0(h,i,h.percents[0],null,i.attr());return i},ap.setTime=function(d,c){d&&c!=null&&this.status(d,aq(c,d.ms)/d.ms);return this},ap.status=function(h,g){var l=[],k=0,j,i;if(g!=null){c0(h,this,-1,aq(g,1));return this}j=ab.length;for(;k<j;k++){i=ab[k];if(i.el.id==this.id&&(!h||i.anim==h)){if(h){return i.status}l.push({anim:i.anim,status:i.status})}}if(h){return 0}return l},ap.pause=function(d){for(var c=0;c<ab.length;c++){ab[c].el.id==this.id&&(!d||ab[c].anim==d)&&eve("raphael.anim.pause."+this.id,this,ab[c].anim)!==!1&&(ab[c].paused=!0)}return this},ap.resume=function(e){for(var d=0;d<ab.length;d++){if(ab[d].el.id==this.id&&(!e||ab[d].anim==e)){var f=ab[d];eve("raphael.anim.resume."+this.id,this,f.anim)!==!1&&(delete f.paused,this.status(f.anim,f.status))}}return this},ap.stop=function(d){for(var c=0;c<ab.length;c++){ab[c].el.id==this.id&&(!d||ab[c].anim==d)&&eve("raphael.anim.stop."+this.id,this,ab[c].anim)!==!1&&ab.splice(c--,1)}return this},eve.on("raphael.remove",cX),eve.on("raphael.clear",cX),ap.toString=function(){return"Rapha�l�s object"};var cT=function(e){this.items=[],this.length=0,this.type="set";if(e){for(var d=0,f=e.length;d<f;d++){e[d]&&(e[d].constructor==ap.constructor||e[d].constructor==cT)&&(this[this.items.length]=this.items[this.items.length]=e[d],this.length++)}}},cQ=cT.prototype;cQ.push=function(){var f,e;for(var h=0,g=arguments.length;h<g;h++){f=arguments[h],f&&(f.constructor==ap.constructor||f.constructor==cT)&&(e=this.items.length,this[e]=this.items[e]=f,this.length++)}return this},cQ.pop=function(){this.length&&delete this[this.length--];return this.items.pop()},cQ.forEach=function(f,e){for(var h=0,g=this.items.length;h<g;h++){if(f.call(e,this.items[h],h)===!1){return this}}return this};for(var cN in ap){ap[aV](cN)&&(cQ[cN]=function(b){return function(){var a=arguments;return this.forEach(function(d){d[b][aO](d,a)})}}(cN))}cQ.attr=function(a,l){if(a&&a8.is(a,dr)&&a8.is(a[0],"object")){for(var k=0,j=a.length;k<j;k++){this.items[k].attr(a[k])}}else{for(var i=0,h=this.items.length;i<h;i++){this.items[i].attr(a,l)}}return this},cQ.clear=function(){while(this.length){this.pop()}},cQ.splice=function(j,i,p){j=j<0?at(this.length+j,0):j,i=at(0,aq(this.length-j,i));var o=[],n=[],m=[],l;for(l=2;l<arguments.length;l++){m.push(arguments[l])}for(l=0;l<i;l++){n.push(this[j+l])}for(;l<this.length-j;l++){o.push(this[j+l])}var k=m.length;for(l=0;l<k+o.length;l++){this.items[j+l]=this[j+l]=l<k?m[l]:o[l-k]}l=this.items.length=this.length-=i-k;while(this[l]){delete this[l++]}return new cT(n)},cQ.exclude=function(e){for(var d=0,f=this.length;d<f;d++){if(this[d]==e){this.splice(d,1);return !0}}},cQ.animate=function(t,s,r,q){(a8.is(r,"function")||!r)&&(q=r||null);var p=this.items.length,o=p,n,m=this,l;if(!p){return this}q&&(l=function(){!--p&&q.call(m)}),r=a8.is(r,dt)?r:l;var a=a8.animation(t,s,r,l);n=this.items[--o].animate(a);while(o--){this.items[o]&&!this.items[o].removed&&this.items[o].animateWith(n,a,a)}return this},cQ.insertAfter=function(d){var c=this.items.length;while(c--){this.items[c].insertAfter(d)}return this},cQ.getBBox=function(){var h=[],g=[],l=[],k=[];for(var j=this.items.length;j--;){if(!this.items[j].removed){var i=this.items[j].getBBox();h.push(i.x),g.push(i.y),l.push(i.x+i.width),k.push(i.y+i.height)}}h=aq[aO](0,h),g=aq[aO](0,g),l=at[aO](0,l),k=at[aO](0,k);return{x:h,y:g,x2:l,y2:k,width:l-h,height:k-g}},cQ.clone=function(e){e=new cT;for(var d=0,f=this.items.length;d<f;d++){e.push(this.items[d].clone())}return e},cQ.toString=function(){return"Rapha�l�s set"},a8.registerFont=function(i){if(!i.face){return i}this.fonts=this.fonts||{};var g={w:i.w,face:{},glyphs:{}},n=i.face["font-family"];for(var m in i.face){i.face[aV](m)&&(g.face[m]=i.face[m])}this.fonts[n]?this.fonts[n].push(g):this.fonts[n]=[g];if(!i.svg){g.face["units-per-em"]=c1(i.face["units-per-em"],10);for(var l in i.glyphs){if(i.glyphs[aV](l)){var k=i.glyphs[l];g.glyphs[l]={w:k.w,k:{},d:k.d&&"M"+k.d.replace(/[mlcxtrv]/g,function(b){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[b]||"M"})+"z"};if(k.k){for(var j in k.k){k[aV](j)&&(g.glyphs[l].k[j]=k.k[j])}}}}}return i},aQ.getFont=function(t,s,r,q){q=q||"normal",r=r||"normal",s=+s||{normal:400,bold:700,lighter:300,bolder:800}[s]||400;if(!!a8.fonts){var p=a8.fonts[t];if(!p){var o=new RegExp("(^|\\s)"+t.replace(/[^\w\d\s+!~.:_-]/g,aJ)+"(\\s|$)","i");for(var n in a8.fonts){if(a8.fonts[aV](n)&&o.test(n)){p=a8.fonts[n];break}}}var m;if(p){for(var g=0,a=p.length;g<a;g++){m=p[g];if(m.face["font-weight"]==s&&(m.face["font-style"]==r||!m.face["font-style"])&&m.face["font-stretch"]==q){break}}}return m}},aQ.print=function(P,O,N,M,L,K,J){K=K||"middle",J=at(aq(J||0,1),-1);var I=aF(N)[aD](aJ),H=0,G=0,F=aJ,E;a8.is(M,N)&&(M=this.getFont(M));if(M){E=(L||16)/M.face["units-per-em"];var D=M.face.bbox[aD](a3),y=+D[0],s=D[3]-D[1],r=0,p=+D[1]+(K=="baseline"?s+ +M.face.descent:s/2);for(var c=0,a=I.length;c<a;c++){if(I[c]=="\n"){H=0,x=0,G=0,r+=s}else{var C=G&&M.glyphs[I[c-1]]||{},x=M.glyphs[I[c]];H+=G?(C.w||M.w)+(C.k&&C.k[I[c]]||0)+M.w*J:0,G=1}x&&x.d&&(F+=a8.transformPath(x.d,["t",H*E,r*E,"s",E,E,y,p,"t",(P-y)/E,(O-p)/E]))}}return this.path(F).attr({fill:"#000",stroke:"none"})},aQ.add=function(a){if(a8.is(a,"array")){var j=this.set(),i=0,g=a.length,d;for(;i<g;i++){d=a[i]||{},a1[aV](d.type)&&j.push(this[d.type]().attr(d))}}return j},a8.format=function(a,f){var e=a8.is(f,dr)?[0][aN](f):arguments;a&&a8.is(a,dt)&&e.length-1&&(a=a.replace(a0,function(d,c){return e[++c]==null?aJ:e[c]}));return a||aJ},a8.fullfill=function(){var e=/\{([^\}]+)\}/g,d=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,f=function(b,i,h){var g=h;i.replace(d,function(k,j,n,m,l){j=j||m,g&&(j in g&&(g=g[j]),typeof g=="function"&&l&&(g=g()))}),g=(g==null||g==h?b:g)+"";return g};return function(a,c){return String(a).replace(e,function(h,g){return f(h,g,c)})}}(),a8.ninja=function(){aS.was?aU.win.Raphael=aS.is:delete Raphael;return a8},a8.st=cQ,function(a,h,g){function f(){/in/.test(a.readyState)?setTimeout(f,9):a8.eve("raphael.DOMload")}a.readyState==null&&a.addEventListener&&(a.addEventListener(h,g=function(){a.removeEventListener(h,g,!1),a.readyState="complete"},!1),a.readyState="loading"),f()}(document,"DOMContentLoaded"),aS.was?aU.win.Raphael=a8:Raphael=a8,eve.on("raphael.DOMload",function(){a6=!0})}(),window.Raphael.svg&&function(af){var ae="hasOwnProperty",ad=String,ac=parseFloat,ab=parseInt,aa=Math,Z=aa.max,Y=aa.abs,X=aa.pow,W=/[, ]+/,V=af.eve,U="",T=" ",S="http://www.w3.org/1999/xlink",R={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},Q={};af.toString=function(){return"Your browser supports SVG.\nYou are running Rapha�l "+this.version};var O=function(c,b){if(b){typeof c=="string"&&(c=O(c));for(var a in b){b[ae](a)&&(a.substring(0,6)=="xlink:"?c.setAttributeNS(S,a.substring(6),ad(b[a])):c.setAttribute(a,ad(b[a])))}}else{c=af._g.doc.createElementNS("http://www.w3.org/2000/svg",c),c.style&&(c.style.webkitTapHighlightColor="rgba(0,0,0,0)")}return c},M=function(z,l){var i="linear",h=z.id+l,g=0.5,f=0.5,d=z.node,c=z.paper,a=d.style,ai=af._g.doc.getElementById(h);if(!ai){l=ad(l).replace(af._radial_gradient,function(k,j,n){i="radial";if(j&&n){g=ac(j),f=ac(n);var m=(f>0.5)*2-1;X(g-0.5,2)+X(f-0.5,2)>0.25&&(f=aa.sqrt(0.25-X(g-0.5,2))*m+0.5)&&f!=0.5&&(f=f.toFixed(5)-0.00001*m)}return U}),l=l.split(/\s*\-\s*/);if(i=="linear"){var ah=l.shift();ah=-ac(ah);if(isNaN(ah)){return null}var ag=[0,0,aa.cos(af.rad(ah)),aa.sin(af.rad(ah))],C=1/(Z(Y(ag[2]),Y(ag[3]))||1);ag[2]*=C,ag[3]*=C,ag[2]<0&&(ag[0]=-ag[2],ag[2]=0),ag[3]<0&&(ag[1]=-ag[3],ag[3]=0)}var B=af._parseDots(l);if(!B){return null}h=h.replace(/[\(\)\s,\xb0#]/g,"_"),z.gradient&&h!=z.gradient.id&&(c.defs.removeChild(z.gradient),delete z.gradient);if(!z.gradient){ai=O(i+"Gradient",{id:h}),z.gradient=ai,O(ai,i=="radial"?{fx:g,fy:f}:{x1:ag[0],y1:ag[1],x2:ag[2],y2:ag[3],gradientTransform:z.matrix.invert()}),c.defs.appendChild(ai);for(var A=0,q=B.length;A<q;A++){ai.appendChild(O("stop",{offset:B[A].offset?B[A].offset:A?"100%":"0%","stop-color":B[A].color||"#fff"}))}}}O(d,{fill:"url(#"+h+")",opacity:1,"fill-opacity":1}),a.fill=U,a.opacity=1,a.fillOpacity=1;return 1},K=function(d){var c=d.getBBox(1);O(d.pattern,{patternTransform:d.matrix.invert()+" translate("+c.x+","+c.y+")"})},J=function(ay,ax,aw){if(ay.type=="path"){var av=ad(ax).toLowerCase().split("-"),au=ay.paper,at=aw?"end":"start",ar=ay.node,aq=ay.attrs,ap=aq["stroke-width"],ao=av.length,al="classic",aj,ah,ag,p,l,c=3,b=3,a=5;while(ao--){switch(av[ao]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":al=av[ao];break;case"wide":b=5;break;case"narrow":b=2;break;case"long":c=5;break;case"short":c=2}}al=="open"?(c+=2,b+=2,a+=2,ag=1,p=aw?4:1,l={fill:"none",stroke:aq.stroke}):(p=ag=c/2,l={fill:aq.stroke,stroke:"none"}),ay._.arrows?aw?(ay._.arrows.endPath&&Q[ay._.arrows.endPath]--,ay._.arrows.endMarker&&Q[ay._.arrows.endMarker]--):(ay._.arrows.startPath&&Q[ay._.arrows.startPath]--,ay._.arrows.startMarker&&Q[ay._.arrows.startMarker]--):ay._.arrows={};if(al!="none"){var an="raphael-marker-"+al,am="raphael-marker-"+at+al+c+b;af._g.doc.getElementById(an)?Q[an]++:(au.defs.appendChild(O(O("path"),{"stroke-linecap":"round",d:R[al],id:an})),Q[an]=1);var ak=af._g.doc.getElementById(am),ai;ak?(Q[am]++,ai=ak.getElementsByTagName("use")[0]):(ak=O(O("marker"),{id:am,markerHeight:b,markerWidth:c,orient:"auto",refX:p,refY:b/2}),ai=O(O("use"),{"xlink:href":"#"+an,transform:(aw?"rotate(180 "+c/2+" "+b/2+") ":U)+"scale("+c/a+","+b/a+")","stroke-width":(1/((c/a+b/a)/2)).toFixed(4)}),ak.appendChild(ai),au.defs.appendChild(ak),Q[am]=1),O(ai,l);var q=ag*(al!="diamond"&&al!="oval");aw?(aj=ay._.arrows.startdx*ap||0,ah=af.getTotalLength(aq.path)-q*ap):(aj=q*ap,ah=af.getTotalLength(aq.path)-(ay._.arrows.enddx*ap||0)),l={},l["marker-"+at]="url(#"+am+")";if(ah||aj){l.d=Raphael.getSubpath(aq.path,aj,ah)}O(ar,l),ay._.arrows[at+"Path"]=an,ay._.arrows[at+"Marker"]=am,ay._.arrows[at+"dx"]=q,ay._.arrows[at+"Type"]=al,ay._.arrows[at+"String"]=ax}else{aw?(aj=ay._.arrows.startdx*ap||0,ah=af.getTotalLength(aq.path)-aj):(aj=0,ah=af.getTotalLength(aq.path)-(ay._.arrows.enddx*ap||0)),ay._.arrows[at+"Path"]&&O(ar,{d:Raphael.getSubpath(aq.path,aj,ah)}),delete ay._.arrows[at+"Path"],delete ay._.arrows[at+"Marker"],delete ay._.arrows[at+"dx"],delete ay._.arrows[at+"Type"],delete ay._.arrows[at+"String"]}for(l in Q){if(Q[ae](l)&&!Q[l]){var o=af._g.doc.getElementById(l);o&&o.parentNode.removeChild(o)}}}},I={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},H=function(i,c,n){c=I[ad(c).toLowerCase()];if(c){var m=i.attrs["stroke-width"]||"1",l={round:m,square:m,butt:0}[i.attrs["stroke-linecap"]||n["stroke-linecap"]]||0,k=[],j=c.length;while(j--){k[j]=c[j]*m+(j%2?1:-1)*l}O(i.node,{"stroke-dasharray":k.join(",")})}};V.on("raphael.util.attr.blur",function(b){this.blur(b)}),V.on("raphael.util.attr.cursor",function(b){this.node.style.cursor=b});var G=function(aj,ai){var ah=aj.node,ag=aj.attrs,y=ah.style.visibility;ah.style.visibility="hidden";for(var v in ai){V("raphael.util.attr."+v,aj,ai[v]);if(ai[ae](v)){if(!af._availableAttrs[ae](v)){continue}var n=ai[v];ag[v]=n;switch(v){case"blur":aj.blur(n);break;case"href":case"title":case"target":var j=ah.parentNode;if(j.tagName.toLowerCase()!="a"){var g=O("a");j.insertBefore(g,ah),g.appendChild(ah),j=g}v=="target"?j.setAttributeNS(S,"show",n=="blank"?"new":n):j.setAttributeNS(S,v,n);break;case"cursor":break;case"transform":aj.transform(n);break;case"arrow-start":J(aj,n);break;case"arrow-end":J(aj,n,1);break;case"clip-rect":var b=ad(n).split(W);if(b.length==4){aj.clip&&aj.clip.parentNode.parentNode.removeChild(aj.clip.parentNode);var t=O("clipPath"),s=O("rect");t.id=af.createUUID(),O(s,{x:b[0],y:b[1],width:b[2],height:b[3]}),t.appendChild(s),aj.paper.defs.appendChild(t),O(ah,{"clip-path":"url(#"+t.id+")"}),aj.clip=s}if(!n){var r=ah.getAttribute("clip-path");if(r){var q=af._g.doc.getElementById(r.replace(/(^url\(#|\)$)/g,U));q&&q.parentNode.removeChild(q),O(ah,{"clip-path":U}),delete aj.clip}}break;case"path":aj.type=="path"&&(O(ah,{d:n?ag.path=af._pathToAbsolute(n):"M0,0"}),aj._.dirty=1,aj._.arrows&&("startString" in aj._.arrows&&J(aj,aj._.arrows.startString),"endString" in aj._.arrows&&J(aj,aj._.arrows.endString,1)));break;case"width":ah.setAttribute(v,n),aj._.dirty=1;if(ag.fx){v="x",n=ag.x}else{break}case"x":ag.fx&&(n=-ag.x-(ag.width||0));case"rx":if(v=="rx"&&aj.type=="rect"){break}case"cx":ah.setAttribute(v,n),aj.pattern&&K(aj),aj._.dirty=1;break;case"height":ah.setAttribute(v,n),aj._.dirty=1;if(ag.fy){v="y",n=ag.y}else{break}case"y":ag.fy&&(n=-ag.y-(ag.height||0));case"ry":if(v=="ry"&&aj.type=="rect"){break}case"cy":ah.setAttribute(v,n),aj.pattern&&K(aj),aj._.dirty=1;break;case"r":aj.type=="rect"?O(ah,{rx:n,ry:n}):ah.setAttribute(v,n),aj._.dirty=1;break;case"src":aj.type=="image"&&ah.setAttributeNS(S,"href",n);break;case"stroke-width":if(aj._.sx!=1||aj._.sy!=1){n/=Z(Y(aj._.sx),Y(aj._.sy))||1}aj.paper._vbSize&&(n*=aj.paper._vbSize),ah.setAttribute(v,n),ag["stroke-dasharray"]&&H(aj,ag["stroke-dasharray"],ai),aj._.arrows&&("startString" in aj._.arrows&&J(aj,aj._.arrows.startString),"endString" in aj._.arrows&&J(aj,aj._.arrows.endString,1));break;case"stroke-dasharray":H(aj,n,ai);break;case"fill":var l=ad(n).match(af._ISURL);if(l){t=O("pattern");var k=O("image");t.id=af.createUUID(),O(t,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),O(k,{x:0,y:0,"xlink:href":l[1]}),t.appendChild(k),function(d){af._preload(l[1],function(){var f=this.offsetWidth,i=this.offsetHeight;O(d,{width:f,height:i}),O(k,{width:f,height:i}),aj.paper.safari()})}(t),aj.paper.defs.appendChild(t),O(ah,{fill:"url(#"+t.id+")"}),aj.pattern=t,aj.pattern&&K(aj);break}var h=af.getRGB(n);if(!h.error){delete ai.gradient,delete ag.gradient,!af.is(ag.opacity,"undefined")&&af.is(ai.opacity,"undefined")&&O(ah,{opacity:ag.opacity}),!af.is(ag["fill-opacity"],"undefined")&&af.is(ai["fill-opacity"],"undefined")&&O(ah,{"fill-opacity":ag["fill-opacity"]})}else{if((aj.type=="circle"||aj.type=="ellipse"||ad(n).charAt()!="r")&&M(aj,n)){if("opacity" in ag||"fill-opacity" in ag){var e=af._g.doc.getElementById(ah.getAttribute("fill").replace(/^url\(#|\)$/g,U));if(e){var c=e.getElementsByTagName("stop");O(c[c.length-1],{"stop-opacity":("opacity" in ag?ag.opacity:1)*("fill-opacity" in ag?ag["fill-opacity"]:1)})}}ag.gradient=n,ag.fill="none";break}}h[ae]("opacity")&&O(ah,{"fill-opacity":h.opacity>1?h.opacity/100:h.opacity});case"stroke":h=af.getRGB(n),ah.setAttribute(v,h.hex),v=="stroke"&&h[ae]("opacity")&&O(ah,{"stroke-opacity":h.opacity>1?h.opacity/100:h.opacity}),v=="stroke"&&aj._.arrows&&("startString" in aj._.arrows&&J(aj,aj._.arrows.startString),"endString" in aj._.arrows&&J(aj,aj._.arrows.endString,1));break;case"gradient":(aj.type=="circle"||aj.type=="ellipse"||ad(n).charAt()!="r")&&M(aj,n);break;case"opacity":ag.gradient&&!ag[ae]("stroke-opacity")&&O(ah,{"stroke-opacity":n>1?n/100:n});case"fill-opacity":if(ag.gradient){e=af._g.doc.getElementById(ah.getAttribute("fill").replace(/^url\(#|\)$/g,U)),e&&(c=e.getElementsByTagName("stop"),O(c[c.length-1],{"stop-opacity":n}));break}default:v=="font-size"&&(n=ab(n,10)+"px");var a=v.replace(/(\-.)/g,function(d){return d.substring(1).toUpperCase()});ah.style[a]=n,aj._.dirty=1,ah.setAttribute(v,n)}}}E(aj,ai),ah.style.visibility=y},F=1.2,E=function(x,w){if(x.type=="text"&&!!(w[ae]("text")||w[ae]("font")||w[ae]("font-size")||w[ae]("x")||w[ae]("y"))){var v=x.attrs,u=x.node,t=u.firstChild?ab(af._g.doc.defaultView.getComputedStyle(u.firstChild,U).getPropertyValue("font-size"),10):10;if(w[ae]("text")){v.text=w.text;while(u.firstChild){u.removeChild(u.firstChild)}var s=ad(w.text).split("\n"),q=[],l;for(var e=0,c=s.length;e<c;e++){l=O("tspan"),e&&O(l,{dy:t*F,x:v.x}),l.appendChild(af._g.doc.createTextNode(s[e])),u.appendChild(l),q[e]=l}}else{q=u.getElementsByTagName("tspan");for(e=0,c=q.length;e<c;e++){e?O(q[e],{dy:t*F,x:v.x}):O(q[0],{dy:0})}}O(u,{x:v.x,y:v.y}),x._.dirty=1;var b=x._getBBox(),a=v.y-(b.y+b.height/2);a&&af.is(a,"finite")&&O(q[0],{dy:a})}},D=function(a,h){var g=0,f=0;this[0]=this.node=a,a.raphael=!0,this.id=af._oid++,a.raphaelid=this.id,this.matrix=af.matrix(),this.realPath=null,this.paper=h,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!h.bottom&&(h.bottom=this),this.prev=h.top,h.top&&(h.top.next=this),h.top=this,this.next=null},P=af.el;D.prototype=P,P.constructor=D,af._engine.path=function(f,e){var h=O("path");e.canvas&&e.canvas.appendChild(h);var g=new D(h,e);g.type="path",G(g,{fill:"none",stroke:"#000",path:f});return g},P.rotate=function(d,c,h){if(this.removed){return this}d=ad(d).split(W),d.length-1&&(c=ac(d[1]),h=ac(d[2])),d=ac(d[0]),h==null&&(c=h);if(c==null||h==null){var g=this.getBBox(1);c=g.x+g.width/2,h=g.y+g.height/2}this.transform(this._.transform.concat([["r",d,c,h]]));return this},P.scale=function(d,c,j,i){if(this.removed){return this}d=ad(d).split(W),d.length-1&&(c=ac(d[1]),j=ac(d[2]),i=ac(d[3])),d=ac(d[0]),c==null&&(c=d),i==null&&(j=i);if(j==null||i==null){var h=this.getBBox(1)}j=j==null?h.x+h.width/2:j,i=i==null?h.y+h.height/2:i,this.transform(this._.transform.concat([["s",d,c,j,i]]));return this},P.translate=function(d,c){if(this.removed){return this}d=ad(d).split(W),d.length-1&&(c=ac(d[1])),d=ac(d[0])||0,c=+c||0,this.transform(this._.transform.concat([["t",d,c]]));return this},P.transform=function(f){var b=this._;if(f==null){return b.transform}af._extractTransform(this,f),this.clip&&O(this.clip,{transform:this.matrix.invert()}),this.pattern&&K(this),this.node&&O(this.node,{transform:this.matrix});if(b.sx!=1||b.sy!=1){var a=this.attrs[ae]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":a})}return this},P.hide=function(){!this.removed&&this.paper.safari(this.node.style.display="none");return this},P.show=function(){!this.removed&&this.paper.safari(this.node.style.display="");return this},P.remove=function(){if(!this.removed&&!!this.node.parentNode){var a=this.paper;a.__set__&&a.__set__.exclude(this),V.unbind("raphael.*.*."+this.id),this.gradient&&a.defs.removeChild(this.gradient),af._tear(this,a),this.node.parentNode.tagName.toLowerCase()=="a"?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node);for(var d in this){this[d]=typeof this[d]=="function"?af._removedFactory(d):null}this.removed=!0}},P._getBBox=function(){if(this.node.style.display=="none"){this.show();var e=!0}var d={};try{d=this.node.getBBox()}catch(f){}finally{d=d||{}}e&&this.hide();return d},P.attr=function(x,w){if(this.removed){return this}if(x==null){var v={};for(var u in this.attrs){this.attrs[ae](u)&&(v[u]=this.attrs[u])}v.gradient&&v.fill=="none"&&(v.fill=v.gradient)&&delete v.gradient,v.transform=this._.transform;return v}if(w==null&&af.is(x,"string")){if(x=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}if(x=="transform"){return this._.transform}var t=x.split(W),s={};for(var r=0,q=t.length;r<q;r++){x=t[r],x in this.attrs?s[x]=this.attrs[x]:af.is(this.paper.customAttributes[x],"function")?s[x]=this.paper.customAttributes[x].def:s[x]=af._availableAttrs[x]}return q-1?s:s[t[0]]}if(w==null&&af.is(x,"array")){s={};for(r=0,q=x.length;r<q;r++){s[x[r]]=this.attr(x[r])}return s}if(w!=null){var k={};k[x]=w}else{x!=null&&af.is(x,"object")&&(k=x)}for(var j in k){V("raphael.attr."+j+"."+this.id,this,k[j])}for(j in this.paper.customAttributes){if(this.paper.customAttributes[ae](j)&&k[ae](j)&&af.is(this.paper.customAttributes[j],"function")){var b=this.paper.customAttributes[j].apply(this,[].concat(k[j]));this.attrs[j]=k[j];for(var a in b){b[ae](a)&&(k[a]=b[a])}}}G(this,k);return this},P.toFront=function(){if(this.removed){return this}this.node.parentNode.tagName.toLowerCase()=="a"?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var a=this.paper;a.top!=this&&af._tofront(this,a);return this},P.toBack=function(){if(this.removed){return this}var a=this.node.parentNode;a.tagName.toLowerCase()=="a"?a.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):a.firstChild!=this.node&&a.insertBefore(this.node,this.node.parentNode.firstChild),af._toback(this,this.paper);var d=this.paper;return this},P.insertAfter=function(a){if(this.removed){return this}var d=a.node||a[a.length-1].node;d.nextSibling?d.parentNode.insertBefore(this.node,d.nextSibling):d.parentNode.appendChild(this.node),af._insertafter(this,a,this.paper);return this},P.insertBefore=function(a){if(this.removed){return this}var d=a.node||a[0].node;d.parentNode.insertBefore(this.node,d),af._insertbefore(this,a,this.paper);return this},P.blur=function(a){var h=this;if(+a!==0){var g=O("filter"),f=O("feGaussianBlur");h.attrs.blur=a,g.id=af.createUUID(),O(f,{stdDeviation:+a||1.5}),g.appendChild(f),h.paper.defs.appendChild(g),h._blur=g,O(h.node,{filter:"url(#"+g.id+")"})}else{h._blur&&(h._blur.parentNode.removeChild(h._blur),delete h._blur,delete h.attrs.blur),h.node.removeAttribute("filter")}},af._engine.circle=function(h,g,l,k){var j=O("circle");h.canvas&&h.canvas.appendChild(j);var i=new D(j,h);i.attrs={cx:g,cy:l,r:k,fill:"none",stroke:"#000"},i.type="circle",O(j,i.attrs);return i},af._engine.rect=function(j,i,p,o,n,m){var l=O("rect");j.canvas&&j.canvas.appendChild(l);var k=new D(l,j);k.attrs={x:i,y:p,width:o,height:n,r:m||0,rx:m||0,ry:m||0,fill:"none",stroke:"#000"},k.type="rect",O(l,k.attrs);return k},af._engine.ellipse=function(i,h,n,m,l){var k=O("ellipse");i.canvas&&i.canvas.appendChild(k);var j=new D(k,i);j.attrs={cx:h,cy:n,rx:m,ry:l,fill:"none",stroke:"#000"},j.type="ellipse",O(k,j.attrs);return j},af._engine.image=function(j,i,p,o,n,m){var l=O("image");O(l,{x:p,y:o,width:n,height:m,preserveAspectRatio:"none"}),l.setAttributeNS(S,"href",i),j.canvas&&j.canvas.appendChild(l);var k=new D(l,j);k.attrs={x:p,y:o,width:n,height:m,src:i},k.type="image";return k},af._engine.text=function(a,l,k,j){var i=O("text");a.canvas&&a.canvas.appendChild(i);var h=new D(i,a);h.attrs={x:l,y:k,"text-anchor":"middle",text:j,font:af._availableAttrs.font,stroke:"none",fill:"#000"},h.type="text",G(h,h.attrs);return h},af._engine.setSize=function(d,c){this.width=d||this.width,this.height=c||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox);return this},af._engine.create=function(){var r=af._getContainer.apply(0,arguments),q=r&&r.container,p=r.x,o=r.y,n=r.width,m=r.height,s=r.zValue;if(!q){throw new Error("SVG container not found.")}var l=O("svg"),k="overflow:hidden;",a;p=p||0,o=o||0,n=n||512,m=m||342,O(l,{height:m,version:1.1,width:n,xmlns:"http://www.w3.org/2000/svg"}),q==1?(l.style.cssText=k+"position:absolute; z-index: "+s+";left:"+p+"px;top:"+o+"px",af._g.doc.body.appendChild(l),a=1):(l.style.cssText=k+"position:relative",q.firstChild?q.insertBefore(l,q.firstChild):q.appendChild(l)),q=new af._Paper,q.width=n,q.height=m,q.canvas=l,q.clear(),q._left=q._top=0,a&&(q.renderfix=function(){}),q.renderfix();return q},af._engine.setViewBox=function(t,s,r,q,p){V("raphael.setViewBox",this,this._viewBox,[t,s,r,q,p]);var o=Z(r/this.width,q/this.height),n=this.top,m=p?"meet":"xMinYMin",k,g;t==null?(this._vbSize&&(o=1),delete this._vbSize,k="0 0 "+this.width+T+this.height):(this._vbSize=o,k=t+T+s+T+r+T+q),O(this.canvas,{viewBox:k,preserveAspectRatio:m});while(o&&n){g="stroke-width" in n.attrs?n.attrs["stroke-width"]:1,n.attr({"stroke-width":g}),n._.dirty=1,n._.dirtyT=1,n=n.prev}this._viewBox=[t,s,r,q,!!p];return this},af.prototype.renderfix=function(){var h=this.canvas,g=h.style,l;try{l=h.getScreenCTM()||h.createSVGMatrix()}catch(k){l=h.createSVGMatrix()}var j=-l.e%1,i=-l.f%1;if(j||i){j&&(this._left=(this._left+j)%1,g.left=this._left+"px"),i&&(this._top=(this._top+i)%1,g.top=this._top+"px")}},af.prototype.clear=function(){af.eve("raphael.clear",this);var a=this.canvas;while(a.firstChild){a.removeChild(a.firstChild)}this.bottom=this.top=null,(this.desc=O("desc")).appendChild(af._g.doc.createTextNode("Created with Rapha�l "+af.version)),a.appendChild(this.desc),a.appendChild(this.defs=O("defs"))},af.prototype.remove=function(){V("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this){this[a]=typeof this[a]=="function"?af._removedFactory(a):null}};var N=af.st;for(var L in P){P[ae](L)&&!N[ae](L)&&(N[L]=function(b){return function(){var a=arguments;return this.forEach(function(d){d[b].apply(d,a)})}}(L))}}(window.Raphael),window.Raphael.vml&&function(ap){var ao="hasOwnProperty",an=String,am=parseFloat,al=Math,ak=al.round,aj=al.max,ai=al.min,ah=al.abs,ag="fill",af=/[, ]+/,ae=ap.eve,ad=" progid:DXImageTransform.Microsoft",ac=" ",ab="",aa={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Y=/([clmz]),?([^clmz]*)/gi,W=/ progid:\S+Blur\([^\)]+\)/g,U=/-?[^,\s-]+/g,S="position:absolute;left:0;top:0;width:1px;height:1px",Q=21600,O={path:1,rect:1,image:1},M={circle:1,ellipse:1},K=function(v){var u=/[ahqstv]/ig,t=ap._pathToAbsolute;an(v).match(u)&&(t=ap._path2curve),u=/[clmz]/g;if(t==ap._pathToAbsolute&&!an(v).match(u)){var s=an(v).replace(Y,function(i,h,m){var l=[],k=h.toLowerCase()=="m",j=aa[h];m.replace(U,function(b){k&&l.length==2&&(j+=l+aa[h=="m"?"l":"L"],l=[]),l.push(ak(b*Q))});return j+l});return s}var q=t(v),p,o;s=[];for(var n=0,f=q.length;n<f;n++){p=q[n],o=q[n][0].toLowerCase(),o=="z"&&(o="x");for(var c=1,a=p.length;c<a;c++){o+=ak(p[c]*Q)+(c!=a-1?",":ab)}s.push(o)}return s.join(ac)},J=function(a,h,g){var f=ap.matrix();f.rotate(-a,0.5,0.5);return{dx:f.x(h,g),dy:f.y(h,g)}},I=function(ar,aq,H,G,F,E){var D=ar._,C=ar.matrix,B=D.fillpos,A=ar.node,z=A.style,y=1,x="",w,u=Q/aq,n=Q/H;z.visibility="hidden";if(!!aq&&!!H){A.coordsize=ah(u)+ac+ah(n),z.rotation=E*(aq*H<0?-1:1);if(E){var j=J(E,G,F);G=j.dx,F=j.dy}aq<0&&(x+="x"),H<0&&(x+=" y")&&(y=-1),z.flip=x,A.coordorigin=G*-u+ac+F*-n;if(B||D.fillsize){var i=A.getElementsByTagName(ag);i=i&&i[0],A.removeChild(i),B&&(j=J(E,C.x(B[0],B[1]),C.y(B[0],B[1])),i.position=j.dx*y+ac+j.dy*y),D.fillsize&&(i.size=D.fillsize[0]*ah(aq)+ac+D.fillsize[1]*ah(H)),A.appendChild(i)}z.visibility="visible"}};ap.toString=function(){return"Your browser doesn�t support SVG. Falling down to VML.\nYou are running Rapha�l "+this.version};var Z=function(t,s,r){var q=an(s).toLowerCase().split("-"),p=r?"end":"start",o=q.length,n="classic",m="medium",l="medium";while(o--){switch(q[o]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":n=q[o];break;case"wide":case"narrow":l=q[o];break;case"long":case"short":m=q[o]}}var c=t.node.getElementsByTagName("stroke")[0];c[p+"arrow"]=n,c[p+"arrowlength"]=m,c[p+"arrowwidth"]=l},X=function(aF,aE){aF.attrs=aF.attrs||{};var aD=aF.node,aC=aF.attrs,aB=aD.style,aA,ay=O[aF.type]&&(aE.x!=aC.x||aE.y!=aC.y||aE.width!=aC.width||aE.height!=aC.height||aE.cx!=aC.cx||aE.cy!=aC.cy||aE.rx!=aC.rx||aE.ry!=aC.ry||aE.r!=aC.r),aw=M[aF.type]&&(aC.cx!=aE.cx||aC.cy!=aE.cy||aC.r!=aE.r||aC.rx!=aE.rx||aC.ry!=aE.ry),av=aF;for(var F in aE){aE[ao](F)&&(aC[F]=aE[F])}ay&&(aC.path=ap._getPath[aF.type](aF),aF._.dirty=1),aE.href&&(aD.href=aE.href),aE.title&&(aD.title=aE.title),aE.target&&(aD.target=aE.target),aE.cursor&&(aB.cursor=aE.cursor),"blur" in aE&&aF.blur(aE.blur);if(aE.path&&aF.type=="path"||ay){aD.path=K(~an(aC.path).toLowerCase().indexOf("r")?ap._pathToAbsolute(aC.path):aC.path),aF.type=="image"&&(aF._.fillpos=[aC.x,aC.y],aF._.fillsize=[aC.width,aC.height],I(aF,1,1,0,0,0))}"transform" in aE&&aF.transform(aE.transform);if(aw){var az=+aC.cx,ax=+aC.cy,au=+aC.rx||+aC.r||0,at=+aC.ry||+aC.r||0;aD.path=ap.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",ak((az-au)*Q),ak((ax-at)*Q),ak((az+au)*Q),ak((ax+at)*Q),ak(az*Q))}if("clip-rect" in aE){var ar=an(aE["clip-rect"]).split(af);if(ar.length==4){ar[2]=+ar[2]+ +ar[0],ar[3]=+ar[3]+ +ar[1];var aq=aD.clipRect||ap._g.doc.createElement("div"),C=aq.style;C.clip=ap.format("rect({1}px {2}px {3}px {0}px)",ar),aD.clipRect||(C.position="absolute",C.top=0,C.left=0,C.width=aF.paper.width+"px",C.height=aF.paper.height+"px",aD.parentNode.insertBefore(aq,aD),aq.appendChild(aD),aD.clipRect=aq)}aE["clip-rect"]||aD.clipRect&&(aD.clipRect.style.clip="auto")}if(aF.textpath){var A=aF.textpath.style;aE.font&&(A.font=aE.font),aE["font-family"]&&(A.fontFamily='"'+aE["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,ab)+'"'),aE["font-size"]&&(A.fontSize=aE["font-size"]),aE["font-weight"]&&(A.fontWeight=aE["font-weight"]),aE["font-style"]&&(A.fontStyle=aE["font-style"])}"arrow-start" in aE&&Z(av,aE["arrow-start"]),"arrow-end" in aE&&Z(av,aE["arrow-end"],1);if(aE.opacity!=null||aE["stroke-width"]!=null||aE.fill!=null||aE.src!=null||aE.stroke!=null||aE["stroke-width"]!=null||aE["stroke-opacity"]!=null||aE["fill-opacity"]!=null||aE["stroke-dasharray"]!=null||aE["stroke-miterlimit"]!=null||aE["stroke-linejoin"]!=null||aE["stroke-linecap"]!=null){var z=aD.getElementsByTagName(ag),x=!1;z=z&&z[0],!z&&(x=z=P(ag)),aF.type=="image"&&aE.src&&(z.src=aE.src),aE.fill&&(z.on=!0);if(z.on==null||aE.fill=="none"||aE.fill===null){z.on=!1}if(z.on&&aE.fill){var w=an(aE.fill).match(ap._ISURL);if(w){z.parentNode==aD&&aD.removeChild(z),z.rotate=!0,z.src=w[1],z.type="tile";var v=aF.getBBox(1);z.position=v.x+ac+v.y,aF._.fillpos=[v.x,v.y],ap._preload(w[1],function(){aF._.fillsize=[this.offsetWidth,this.offsetHeight]})}else{z.color=ap.getRGB(aE.fill).hex,z.src=ab,z.type="solid",ap.getRGB(aE.fill).error&&(av.type in {circle:1,ellipse:1}||an(aE.fill).charAt()!="r")&&V(av,aE.fill,z)&&(aC.fill="none",aC.gradient=aE.fill,z.rotate=!1)}}if("fill-opacity" in aE||"opacity" in aE){var u=((+aC["fill-opacity"]+1||2)-1)*((+aC.opacity+1||2)-1)*((+ap.getRGB(aE.fill).o+1||2)-1);u=ai(aj(u,0),1),z.opacity=u,z.src&&(z.color="none")}aD.appendChild(z);var n=aD.getElementsByTagName("stroke")&&aD.getElementsByTagName("stroke")[0],h=!1;!n&&(h=n=P("stroke"));if(aE.stroke&&aE.stroke!="none"||aE["stroke-width"]||aE["stroke-opacity"]!=null||aE["stroke-dasharray"]||aE["stroke-miterlimit"]||aE["stroke-linejoin"]||aE["stroke-linecap"]){n.on=!0}(aE.stroke=="none"||aE.stroke===null||n.on==null||aE.stroke==0||aE["stroke-width"]==0)&&(n.on=!1);var g=ap.getRGB(aE.stroke);n.on&&aE.stroke&&(n.color=g.hex),u=((+aC["stroke-opacity"]+1||2)-1)*((+aC.opacity+1||2)-1)*((+g.o+1||2)-1);var f=(am(aE["stroke-width"])||1)*0.75;u=ai(aj(u,0),1),aE["stroke-width"]==null&&(f=aC["stroke-width"]),aE["stroke-width"]&&(n.weight=f),f&&f<1&&(u*=f)&&(n.weight=1),n.opacity=u,aE["stroke-linejoin"]&&(n.joinstyle=aE["stroke-linejoin"]||"miter"),n.miterlimit=aE["stroke-miterlimit"]||8,aE["stroke-linecap"]&&(n.endcap=aE["stroke-linecap"]=="butt"?"flat":aE["stroke-linecap"]=="square"?"square":"round");if(aE["stroke-dasharray"]){var d={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};n.dashstyle=d[ao](aE["stroke-dasharray"])?d[aE["stroke-dasharray"]]:ab}h&&aD.appendChild(n)}if(av.type=="text"){av.paper.canvas.style.display=ab;var c=av.paper.span,b=100,a=aC.font&&aC.font.match(/\d+(?:\.\d*)?(?=px)/);aB=c.style,aC.font&&(aB.font=aC.font),aC["font-family"]&&(aB.fontFamily=aC["font-family"]),aC["font-weight"]&&(aB.fontWeight=aC["font-weight"]),aC["font-style"]&&(aB.fontStyle=aC["font-style"]),a=am(aC["font-size"]||a&&a[0])||10,aB.fontSize=a*b+"px",av.textpath.string&&(c.innerHTML=an(av.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var j=c.getBoundingClientRect();av.W=aC.w=(j.right-j.left)/b,av.H=aC.h=(j.bottom-j.top)/b,av.X=aC.x,av.Y=aC.y+av.H/2,("x" in aE||"y" in aE)&&(av.path.v=ap.format("m{0},{1}l{2},{1}",ak(aC.x*Q),ak(aC.y*Q),ak(aC.x*Q)+1));var aG=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var o=0,k=aG.length;o<k;o++){if(aG[o] in aE){av._.dirty=1;break}}switch(aC["text-anchor"]){case"start":av.textpath.style["v-text-align"]="left",av.bbx=av.W/2;break;case"end":av.textpath.style["v-text-align"]="right",av.bbx=-av.W/2;break;default:av.textpath.style["v-text-align"]="center",av.bbx=0}av.textpath.style["v-text-kern"]=!0}},V=function(z,y,x){z.attrs=z.attrs||{};var w=z.attrs,v=Math.pow,u,o,n="linear",e=".5 .5";z.attrs.gradient=y,y=an(y).replace(ap._radial_gradient,function(g,f,h){n="radial",f&&h&&(f=am(f),h=am(h),v(f-0.5,2)+v(h-0.5,2)>0.25&&(h=al.sqrt(0.25-v(f-0.5,2))*((h>0.5)*2-1)+0.5),e=f+ac+h);return ab}),y=y.split(/\s*\-\s*/);if(n=="linear"){var d=y.shift();d=-am(d);if(isNaN(d)){return null}}var c=ap._parseDots(y);if(!c){return null}z=z.shape||z.node;if(c.length){z.removeChild(x),x.on=!0,x.method="none",x.color=c[0].color,x.color2=c[c.length-1].color;var a=[];for(var B=0,A=c.length;B<A;B++){c[B].offset&&a.push(c[B].offset+ac+c[B].color)}x.colors=a.length?a.join():"0% "+x.color,n=="radial"?(x.type="gradientTitle",x.focus="100%",x.focussize="0 0",x.focusposition=e,x.angle=0):(x.type="gradient",x.angle=(270-d)%360),z.appendChild(x)}return 1},T=function(a,d){this[0]=this.node=a,a.raphael=!0,this.id=ap._oid++,a.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=d,this.matrix=ap.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!d.bottom&&(d.bottom=this),this.prev=d.top,d.top&&(d.top.next=this),d.top=this,this.next=null},R=ap.el;T.prototype=R,R.constructor=T,R.transform=function(B){if(B==null){return this._.transform}var A=this.paper._viewBoxShift,z=A?"s"+[A.scale,A.scale]+"-1-1t"+[A.dx,A.dy]:ab,y;A&&(y=B=an(B).replace(/\.{3}|\u2026/g,this._.transform||ab)),ap._extractTransform(this,z+B);var x=this.matrix.clone(),w=this.skew,v=this.node,u,t=~an(this.attrs.fill).indexOf("-"),s=!an(this.attrs.fill).indexOf("url(");x.translate(-0.5,-0.5);if(s||t||this.type=="image"){w.matrix="1 0 0 1",w.offset="0 0",u=x.split();if(t&&u.noRotation||!u.isSimple){v.style.filter=x.toFilter();var o=this.getBBox(),n=this.getBBox(1),c=o.x-n.x,a=o.y-n.y;v.coordorigin=c*-Q+ac+a*-Q,I(this,1,1,c,a,0)}else{v.style.filter=ab,I(this,u.scalex,u.scaley,u.dx,u.dy,u.rotate)}}else{v.style.filter=ab,w.matrix=an(x),w.offset=x.offset()}y&&(this._.transform=y);return this},R.rotate=function(d,c,h){if(this.removed){return this}if(d!=null){d=an(d).split(af),d.length-1&&(c=am(d[1]),h=am(d[2])),d=am(d[0]),h==null&&(c=h);if(c==null||h==null){var g=this.getBBox(1);c=g.x+g.width/2,h=g.y+g.height/2}this._.dirtyT=1,this.transform(this._.transform.concat([["r",d,c,h]]));return this}},R.translate=function(d,c){if(this.removed){return this}d=an(d).split(af),d.length-1&&(c=am(d[1])),d=am(d[0])||0,c=+c||0,this._.bbox&&(this._.bbox.x+=d,this._.bbox.y+=c),this.transform(this._.transform.concat([["t",d,c]]));return this},R.scale=function(d,c,j,i){if(this.removed){return this}d=an(d).split(af),d.length-1&&(c=am(d[1]),j=am(d[2]),i=am(d[3]),isNaN(j)&&(j=null),isNaN(i)&&(i=null)),d=am(d[0]),c==null&&(c=d),i==null&&(j=i);if(j==null||i==null){var h=this.getBBox(1)}j=j==null?h.x+h.width/2:j,i=i==null?h.y+h.height/2:i,this.transform(this._.transform.concat([["s",d,c,j,i]])),this._.dirtyT=1;return this},R.hide=function(){!this.removed&&(this.node.style.display="none");return this},R.show=function(){!this.removed&&(this.node.style.display=ab);return this},R._getBBox=function(){if(this.removed){return{}}return{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},R.remove=function(){if(!this.removed&&!!this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),ap.eve.unbind("raphael.*.*."+this.id),ap._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this){this[a]=typeof this[a]=="function"?ap._removedFactory(a):null}this.removed=!0}},R.attr=function(x,w){if(this.removed){return this}if(x==null){var v={};for(var u in this.attrs){this.attrs[ao](u)&&(v[u]=this.attrs[u])}v.gradient&&v.fill=="none"&&(v.fill=v.gradient)&&delete v.gradient,v.transform=this._.transform;return v}if(w==null&&ap.is(x,"string")){if(x==ag&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}var t=x.split(af),s={};for(var r=0,l=t.length;r<l;r++){x=t[r],x in this.attrs?s[x]=this.attrs[x]:ap.is(this.paper.customAttributes[x],"function")?s[x]=this.paper.customAttributes[x].def:s[x]=ap._availableAttrs[x]}return l-1?s:s[t[0]]}if(this.attrs&&w==null&&ap.is(x,"array")){s={};for(r=0,l=x.length;r<l;r++){s[x[r]]=this.attr(x[r])}return s}var k;w!=null&&(k={},k[x]=w),w==null&&ap.is(x,"object")&&(k=x);for(var j in k){ae("raphael.attr."+j+"."+this.id,this,k[j])}if(k){for(j in this.paper.customAttributes){if(this.paper.customAttributes[ao](j)&&k[ao](j)&&ap.is(this.paper.customAttributes[j],"function")){var b=this.paper.customAttributes[j].apply(this,[].concat(k[j]));this.attrs[j]=k[j];for(var a in b){b[ao](a)&&(k[a]=b[a])}}}k.text&&this.type=="text"&&(this.textpath.string=k.text),X(this,k)}return this},R.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&ap._tofront(this,this.paper);return this},R.toBack=function(){if(this.removed){return this}this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),ap._toback(this,this.paper));return this},R.insertAfter=function(a){if(this.removed){return this}a.constructor==ap.st.constructor&&(a=a[a.length-1]),a.node.nextSibling?a.node.parentNode.insertBefore(this.node,a.node.nextSibling):a.node.parentNode.appendChild(this.node),ap._insertafter(this,a,this.paper);return this},R.insertBefore=function(a){if(this.removed){return this}a.constructor==ap.st.constructor&&(a=a[0]),a.node.parentNode.insertBefore(this.node,a.node),ap._insertbefore(this,a,this.paper);return this},R.blur=function(a){var f=this.node.runtimeStyle,e=f.filter;e=e.replace(W,ab),+a!==0?(this.attrs.blur=a,f.filter=e+ac+ad+".Blur(pixelradius="+(+a||1.5)+")",f.margin=ap.format("-{0}px 0 0 -{0}px",ak(+a||1.5))):(f.filter=e,f.margin=0,delete this.attrs.blur)},ap._engine.path=function(h,g){var l=P("shape");l.style.cssText=S,l.coordsize=Q+ac+Q,l.coordorigin=g.coordorigin;var k=new T(l,g),j={fill:"none",stroke:"#000"};h&&(j.path=h),k.type="path",k.path=[],k.Path=ab,X(k,j),g.canvas.appendChild(l);var i=P("skew");i.on=!0,l.appendChild(i),k.skew=i,k.transform(ab);return k},ap._engine.rect=function(r,q,p,o,n,m){var l=ap._rectPath(q,p,o,n,m),k=r.path(l),a=k.attrs;k.X=a.x=q,k.Y=a.y=p,k.W=a.width=o,k.H=a.height=n,a.r=m,a.path=l,k.type="rect";return k},ap._engine.ellipse=function(i,h,n,m,l){var k=i.path(),j=k.attrs;k.X=h-m,k.Y=n-l,k.W=m*2,k.H=l*2,k.type="ellipse",X(k,{cx:h,cy:n,rx:m,ry:l});return k},ap._engine.circle=function(h,g,l,k){var j=h.path(),i=j.attrs;j.X=g-k,j.Y=l-k,j.W=j.H=k*2,j.type="circle",X(j,{cx:g,cy:l,r:k});return j},ap._engine.image=function(v,u,t,s,r,q){var p=ap._rectPath(t,s,r,q),o=v.path(p).attr({stroke:"none"}),n=o.attrs,j=o.node,a=j.getElementsByTagName(ag)[0];n.src=u,o.X=n.x=t,o.Y=n.y=s,o.W=n.width=r,o.H=n.height=q,n.path=p,o.type="image",a.parentNode==j&&j.removeChild(a),a.rotate=!0,a.src=u,a.type="tile",o._.fillpos=[t,s],o._.fillsize=[r,q],j.appendChild(a),I(o,1,1,0,0,0);return o},ap._engine.text=function(t,s,r,q){var p=P("shape"),o=P("path"),n=P("textpath");s=s||0,r=r||0,q=q||"",o.v=ap.format("m{0},{1}l{2},{1}",ak(s*Q),ak(r*Q),ak(s*Q)+1),o.textpathok=!0,n.string=an(q),n.on=!0,p.style.cssText=S,p.coordsize=Q+ac+Q,p.coordorigin="0 0";var f=new T(p,t),c={fill:"#000",stroke:"none",font:ap._availableAttrs.font,text:q};f.shape=p,f.path=o,f.textpath=n,f.type="text",f.attrs.text=an(q),f.attrs.x=s,f.attrs.y=r,f.attrs.w=1,f.attrs.h=1,X(f,c),p.appendChild(n),p.appendChild(o),t.canvas.appendChild(p);var a=P("skew");a.on=!0,p.appendChild(a),f.skew=a,f.transform(ab);return f},ap._engine.setSize=function(a,f){var e=this.canvas.style;this.width=a,this.height=f,a==+a&&(a+="px"),f==+f&&(f+="px"),e.width=a,e.height=f,e.clip="rect(0 "+a+" "+f+" 0)",this._viewBox&&ap._engine.setViewBox.apply(this,this._viewBox);return this},ap._engine.setViewBox=function(t,s,r,q,p){ap.eve("raphael.setViewBox",this,this._viewBox,[t,s,r,q,p]);var o=this.width,n=this.height,m=1/aj(r/o,q/n),g,a;p&&(g=n/q,a=o/r,r*g<o&&(t-=(o-r*g)/2/g),q*a<n&&(s-=(n-q*a)/2/a)),this._viewBox=[t,s,r,q,!!p],this._viewBoxShift={dx:-t,dy:-s,scale:m},this.forEach(function(b){b.transform("...")});return this};var P;ap._engine.initWin=function(e){var d=e.document;d.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!d.namespaces.rvml&&d.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),P=function(b){return d.createElement("<rvml:"+b+' class="rvml">')}}catch(f){P=function(b){return d.createElement("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},ap._engine.initWin(ap._g.win),ap._engine.create=function(){var t=ap._getContainer.apply(0,arguments),s=t.container,r=t.height,q,p=t.width,o=t.x,n=t.y;if(!s){throw new Error("VML container not found.")}var m=new ap._Paper,l=m.canvas=ap._g.doc.createElement("div"),a=l.style;o=o||0,n=n||0,p=p||512,r=r||342,m.width=p,m.height=r,p==+p&&(p+="px"),r==+r&&(r+="px"),m.coordsize=Q*1000+ac+Q*1000,m.coordorigin="0 0",m.span=ap._g.doc.createElement("span"),m.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",l.appendChild(m.span),a.cssText=ap.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",p,r),s==1?(ap._g.doc.body.appendChild(l),a.left=o+"px",a.top=n+"px",a.position="absolute"):s.firstChild?s.insertBefore(l,s.firstChild):s.appendChild(l),m.renderfix=function(){};return m},ap.prototype.clear=function(){ap.eve("raphael.clear",this),this.canvas.innerHTML=ab,this.span=ap._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},ap.prototype.remove=function(){ap.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var a in this){this[a]=typeof this[a]=="function"?ap._removedFactory(a):null}return !0};var N=ap.st;for(var L in R){R[ao](L)&&!N[ao](L)&&(N[L]=function(b){return function(){var a=arguments;return this.forEach(function(d){d[b].apply(d,a)})}}(L))}}(window.Raphael);
</script>
<script type="text/javascript">

window.onload = function () {
	ShowProgressBar();
	if(navigator.appName == "Microsoft Internet Explorer")
	{
		var Object3DTag = document.getElementById("Object3D");
		if(Object3DTag)
		{
			CFInstall.check({
				mode: "inline",
				cssText:"z-index:30;position:absolute;left:"+ Object3DTag.style.left +"; top:"+ Object3DTag.style.top +"; width:"+Object3DTag.style.width+"; height:"+Object3DTag.style.height+";"
			});
		}
	}
		//repalce the empty line with &nbsp;
		x=document.getElementsByTagName("p");
		for (i=0;i<x.length;i++)
		{
			var innerString = x[i].innerHTML;
			if(innerString=="")
			{
				x[i].innerHTML = "&nbsp;";
			}
		}

		y=document.getElementsByTagName("span");
		for (i=0;i<y.length;i++)
		{
			var innerString = y[i].innerHTML;
			var n = innerString.replace(/ /g,"&nbsp;");
			y[i].innerHTML = n;
		}

	// raphael section
	var paper = Raphael(0,0,600,480);
	 //background color
	paper.rect(0,0,600,480).attr({fill:"rgba(255,255,255,1)", stroke:'none'});
	paper.image("./test-3d_files/Template Image.jpg",0,0,600,480);
	paper.image("./test-3d_files/SimLab Logo.png",510,414,80,53);
	paper.rect(10,10,579,389).attr({fill:"rgba(255,255,255,0.298039)","stroke-width":1, stroke:"rgb(124,62,0)"});
	paper.rect(10,410,579,59).attr({fill:"rgba(255,255,255,0.298039)","stroke-width":1, stroke:"rgb(124,62,0)"});
TemplateActions();
};
</script>
<script type="text/javascript" src="http://code.jquery.com/jquery-1.8.2.js"></script>
<script type='text/javascript'>
var overlay;
var loadingOverlay;
$(function(){
overlay = $('<div id="overlay"></div>');
loadingOverlay = $('<div id="loadingOverlay"></div>');
$('.close').click(function(){
$('.popup').hide();
overlay.appendTo(document.body).remove();
return false;
});
$('.x').click(function(){
$('.popup').hide();
overlay.appendTo(document.body).remove();
return false;
});
});

function OpenLocalHtmlFile(localFile)
{
	var iFrametagJSVar = document.getElementById("iframeId");
	iFrametagJSVar.src = localFile;
	overlay.show();
	overlay.appendTo(document.body);
	$('.popup').show();
};
function ShowProgressBar()
{
	document.getElementById("progress").style.visibility = "visible";
	document.getElementById("progressText").style.visibility = "visible";
	var request = new XMLHttpRequest();
	var circle = new ProgressBar.Circle('#progress', {
	color: '#353535',
	trailColor: '#eee',
	strokeWidth: 2,
	trailWidth: 2,
	duration: 1500,
	text: {
	value: '0'
	},
	step: function(state, bar) {
	bar.setText(((bar.value() * 100).toFixed(0)) + "%");
	}
	});
	request.onprogress = function(evt) {
	if (evt.lengthComputable)
	{
	var percentComplete = (evt.loaded / evt.total);
	circle.animate(percentComplete);
	}
	}
	 request.open("GET", "test-3d_files/" + "test-3d" + ".zip", true);
 	request.overrideMimeType("application / zip");
	request.onreadystatechange = function(){
	if (this.readyState == 3 || this.readyState == 4){
	document.getElementById("progressText").innerHTML = "Downloading...";
	}
	if (this.readyState == 4 && (this.status == 200 || this.status == 0) ){
	document.getElementById("progress").style.visibility = "hidden";
	document.getElementById("progressText").innerHTML = "Unpacking...";
	var circle2 = new ProgressBar.Circle('#progress2', {
	color: '#353535',
	trailColor: '#eee',
	strokeWidth: 2,
	trailWidth: 2,
	duration: 10000,
	easing: 'easeInOut'
	});
	document.getElementById("progress2").style.visibility = "visible";
	circle2.set(0.05);
	circle2.animate(.5, function(){circle2.animate(.9);});
	unzipToBlobAndLoad();
	}
	}
	request.send();
	loadingOverlay.show();
	loadingOverlay.appendTo(document.body);
};
function HideProgressBar()
{
	loadingOverlay.appendTo(document.body).remove();
	document.getElementById("progressText").style.visibility = "hidden";
	document.getElementById("progress2").style.visibility = "hidden";
};
</script>
<script type="text/javascript">
function TemplateActions(){
};
</script>
<script type="text/javascript">
var THREE={REVISION:"64"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};THREE.extend=function(f,e){if(Object.keys){var d=Object.keys(e);for(var c=0,b=d.length;c<b;c++){var g=d[c];Object.defineProperty(f,g,Object.getOwnPropertyDescriptor(e,g))}}else{var a={}.hasOwnProperty;for(var g in e){if(a.call(e,g)){f[g]=e[g]}}}return f};(function(){var b=0;var c=["ms","moz","webkit","o"];for(var a=0;a<c.length&&!self.requestAnimationFrame;++a){self.requestAnimationFrame=self[c[a]+"RequestAnimationFrame"];self.cancelAnimationFrame=self[c[a]+"CancelAnimationFrame"]||self[c[a]+"CancelRequestAnimationFrame"]}if(self.requestAnimationFrame===undefined&&self.setTimeout!==undefined){self.requestAnimationFrame=function(g){var d=Date.now(),e=Math.max(0,16-(d-b));var f=self.setTimeout(function(){g(d+e)},e);b=d+e;return f}}if(self.cancelAnimationFrame===undefined&&self.clearTimeout!==undefined){self.cancelAnimationFrame=function(d){self.clearTimeout(d)}}}());THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;THREE.DoubleSide=2;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;THREE.NormalBlending=1;THREE.AdditiveBlending=2;THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;THREE.SrcAlphaSaturateFactor=210;THREE.MultiplyOperation=0;THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=function(){};THREE.CubeReflectionMapping=function(){};THREE.CubeRefractionMapping=function(){};THREE.SphericalReflectionMapping=function(){};THREE.SphericalRefractionMapping=function(){};THREE.RepeatWrapping=1000;THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;THREE.ByteType=1010;THREE.ShortType=1011;THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;THREE.LuminanceAlphaFormat=1023;THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;THREE.RGBA_S3TC_DXT3_Format=2003;THREE.RGBA_S3TC_DXT5_Format=2004;THREE.Color=function(a){if(a!==undefined){this.set(a)}return this};THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(a){if(a instanceof THREE.Color){this.copy(a)}else{if(typeof a==="number"){this.setHex(a)}else{if(typeof a==="string"){this.setStyle(a)}}}return this},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},setRGB:function(d,c,a){this.r=d;this.g=c;this.b=a;return this},setHSL:function(d,c,b){if(c===0){this.r=this.g=this.b=b}else{var a=function(i,h,g){if(g<0){g+=1}if(g>1){g-=1}if(g<1/6){return i+(h-i)*6*g}if(g<1/2){return h}if(g<2/3){return i+(h-i)*6*(2/3-g)}return i};var f=b<=0.5?b*(1+c):b+c-(b*c);var e=(2*b)-f;this.r=a(e,f,d+1/3);this.g=a(e,f,d);this.b=a(e,f,d-1/3)}return this},setStyle:function(b){if(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(b)){var a=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(b);this.r=Math.min(255,parseInt(a[1],10))/255;this.g=Math.min(255,parseInt(a[2],10))/255;this.b=Math.min(255,parseInt(a[3],10))/255;return this}if(/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(b)){var a=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(b);this.r=Math.min(100,parseInt(a[1],10))/100;this.g=Math.min(100,parseInt(a[2],10))/100;this.b=Math.min(100,parseInt(a[3],10))/100;return this}if(/^\#([0-9a-f]{6})$/i.test(b)){var a=/^\#([0-9a-f]{6})$/i.exec(b);this.setHex(parseInt(a[1],16));return this}if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(b)){var a=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(b);this.setHex(parseInt(a[1]+a[1]+a[2]+a[2]+a[3]+a[3],16));return this}if(/^(\w+)$/i.test(b)){this.setHex(THREE.ColorKeywords[b]);return this}},copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},copyGammaToLinear:function(a){this.r=a.r*a.r;this.g=a.g*a.g;this.b=a.b*a.b;return this},copyLinearToGamma:function(a){this.r=Math.sqrt(a.r);this.g=Math.sqrt(a.g);this.b=Math.sqrt(a.b);return this},convertGammaToLinear:function(){var d=this.r,c=this.g,a=this.b;this.r=d*d;this.g=c*c;this.b=a*a;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return(this.r*255)<<16^(this.g*255)<<8^(this.b*255)<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(m){var l=m||{h:0,s:0,l:0};var a=this.r,e=this.g,h=this.b;var i=Math.max(a,e,h);var c=Math.min(a,e,h);var f,d;var k=(c+i)/2;if(c===i){f=0;d=0}else{var j=i-c;d=k<=0.5?j/(i+c):j/(2-i-c);switch(i){case a:f=(e-h)/j+(e<h?6:0);break;case e:f=(h-a)/j+2;break;case h:f=(a-e)/j+4;break}f/=6}l.h=f;l.s=d;l.l=k;return l},getStyle:function(){return"rgb("+((this.r*255)|0)+","+((this.g*255)|0)+","+((this.b*255)|0)+")"},offsetHSL:function(d,c,a){var b=this.getHSL();b.h+=d;b.s+=c;b.l+=a;this.setHSL(b.h,b.s,b.l);return this},add:function(a){this.r+=a.r;this.g+=a.g;this.b+=a.b;return this},addColors:function(b,a){this.r=b.r+a.r;this.g=b.g+a.g;this.b=b.b+a.b;return this},addScalar:function(a){this.r+=a;this.g+=a;this.b+=a;return this},multiply:function(a){this.r*=a.r;this.g*=a.g;this.b*=a.b;return this},multiplyScalar:function(a){this.r*=a;this.g*=a;this.b*=a;return this},lerp:function(a,b){this.r+=(a.r-this.r)*b;this.g+=(a.g-this.g)*b;this.b+=(a.b-this.b)*b;return this},equals:function(a){return(a.r===this.r)&&(a.g===this.g)&&(a.b===this.b)},fromArray:function(a){this.r=a[0];this.g=a[1];this.b=a[2];return this},toArray:function(){return[this.r,this.g,this.b]},clone:function(){return new THREE.Color().setRGB(this.r,this.g,this.b)}};THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};THREE.Quaternion=function(a,d,c,b){this._x=a||0;this._y=d||0;this._z=c||0;this._w=(b!==undefined)?b:1};THREE.Quaternion.prototype={constructor:THREE.Quaternion,_x:0,_y:0,_z:0,_w:0,_euler:undefined,_updateEuler:function(a){if(this._euler!==undefined){this._euler.setFromQuaternion(this,undefined,false)}},get x(){return this._x},set x(a){this._x=a;this._updateEuler()},get y(){return this._y},set y(a){this._y=a;this._updateEuler()},get z(){return this._z},set z(a){this._z=a;this._updateEuler()},get w(){return this._w},set w(a){this._w=a;this._updateEuler()},set:function(a,d,c,b){this._x=a;this._y=d;this._z=c;this._w=b;this._updateEuler();return this},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._w=a._w;this._updateEuler();return this},setFromEuler:function(g,h){if(g instanceof THREE.Euler===false){throw new Error("ERROR: Quaternion's .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.")}var f=Math.cos(g._x/2);var e=Math.cos(g._y/2);var c=Math.cos(g._z/2);var d=Math.sin(g._x/2);var b=Math.sin(g._y/2);var a=Math.sin(g._z/2);if(g.order==="XYZ"){this._x=d*e*c+f*b*a;this._y=f*b*c-d*e*a;this._z=f*e*a+d*b*c;this._w=f*e*c-d*b*a}else{if(g.order==="YXZ"){this._x=d*e*c+f*b*a;this._y=f*b*c-d*e*a;this._z=f*e*a-d*b*c;this._w=f*e*c+d*b*a}else{if(g.order==="ZXY"){this._x=d*e*c-f*b*a;this._y=f*b*c+d*e*a;this._z=f*e*a+d*b*c;this._w=f*e*c-d*b*a}else{if(g.order==="ZYX"){this._x=d*e*c-f*b*a;this._y=f*b*c+d*e*a;this._z=f*e*a-d*b*c;this._w=f*e*c+d*b*a}else{if(g.order==="YZX"){this._x=d*e*c+f*b*a;this._y=f*b*c+d*e*a;this._z=f*e*a-d*b*c;this._w=f*e*c-d*b*a}else{if(g.order==="XZY"){this._x=d*e*c-f*b*a;this._y=f*b*c-d*e*a;this._z=f*e*a+d*b*c;this._w=f*e*c+d*b*a}}}}}}if(h!==false){this._updateEuler()}return this},setFromAxisAngle:function(c,d){var a=d/2,b=Math.sin(a);this._x=c.x*b;this._y=c.y*b;this._z=c.z*b;this._w=Math.cos(a);this._updateEuler();return this},setFromRotationMatrix:function(e){var d=e.elements,i=d[0],h=d[4],g=d[8],c=d[1],b=d[5],a=d[9],l=d[2],k=d[6],j=d[10],f=i+b+j,n;if(f>0){n=0.5/Math.sqrt(f+1);this._w=0.25/n;this._x=(k-a)*n;this._y=(g-l)*n;this._z=(c-h)*n}else{if(i>b&&i>j){n=2*Math.sqrt(1+i-b-j);this._w=(k-a)/n;this._x=0.25*n;this._y=(h+c)/n;this._z=(g+l)/n}else{if(b>j){n=2*Math.sqrt(1+b-i-j);this._w=(g-l)/n;this._x=(h+c)/n;this._y=0.25*n;this._z=(a+k)/n}else{n=2*Math.sqrt(1+j-i-b);this._w=(c-h)/n;this._x=(g+l)/n;this._y=(a+k)/n;this._z=0.25*n}}}this._updateEuler();return this},inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this._x*=-1;this._y*=-1;this._z*=-1;this._updateEuler();return this},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var a=this.length();if(a===0){this._x=0;this._y=0;this._z=0;this._w=1}else{a=1/a;this._x=this._x*a;this._y=this._y*a;this._z=this._z*a;this._w=this._w*a}return this},multiply:function(a,b){if(b!==undefined){console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead.");return this.multiplyQuaternions(a,b)}return this.multiplyQuaternions(this,a)},multiplyQuaternions:function(l,k){var i=l._x,h=l._y,g=l._z,j=l._w;var e=k._x,d=k._y,c=k._z,f=k._w;this._x=i*f+j*e+h*c-g*d;this._y=h*f+j*d+g*e-i*c;this._z=g*f+j*c+i*d-h*e;this._w=j*f-i*e-h*d-g*c;this._updateEuler();return this},multiplyVector3:function(a){console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return a.applyQuaternion(this)},slerp:function(c,k){var i=this._x,h=this._y,g=this._z,j=this._w;var b=j*c._w+i*c._x+h*c._y+g*c._z;if(b<0){this._w=-c._w;this._x=-c._x;this._y=-c._y;this._z=-c._z;b=-b}else{this.copy(c)}if(b>=1){this._w=j;this._x=i;this._y=h;this._z=g;return this}var d=Math.acos(b);var a=Math.sqrt(1-b*b);if(Math.abs(a)<0.001){this._w=0.5*(j+this._w);this._x=0.5*(i+this._x);this._y=0.5*(h+this._y);this._z=0.5*(g+this._z);return this}var f=Math.sin((1-k)*d)/a,e=Math.sin(k*d)/a;this._w=(j*f+this._w*e);this._x=(i*f+this._x*e);this._y=(h*f+this._y*e);this._z=(g*f+this._z*e);this._updateEuler();return this},equals:function(a){return(a._x===this._x)&&(a._y===this._y)&&(a._z===this._z)&&(a._w===this._w)},fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];this._w=a[3];this._updateEuler();return this},toArray:function(){return[this._x,this._y,this._z,this._w]},clone:function(){return new THREE.Quaternion(this._x,this._y,this._z,this._w)}};THREE.Quaternion.slerp=function(d,c,b,a){return b.copy(d).slerp(c,a)};THREE.Vector2=function(a,b){this.x=a||0;this.y=b||0};THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(a,b){this.x=a;this.y=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw new Error("index is out of range: "+a)}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+a)}},copy:function(a){this.x=a.x;this.y=a.y;return this},add:function(b,a){if(a!==undefined){console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(b,a)}this.x+=b.x;this.y+=b.y;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;return this},addScalar:function(a){this.x+=a;this.y+=a;return this},sub:function(b,a){if(a!==undefined){console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(b,a)}this.x-=b.x;this.y-=b.y;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;return this},divideScalar:function(b){if(b!==0){var a=1/b;this.x*=a;this.y*=a}else{this.x=0;this.y=0}return this},min:function(a){if(this.x>a.x){this.x=a.x}if(this.y>a.y){this.y=a.y}return this},max:function(a){if(this.x<a.x){this.x=a.x}if(this.y<a.y){this.y=a.y}return this},clamp:function(b,a){if(this.x<b.x){this.x=b.x}else{if(this.x>a.x){this.x=a.x}}if(this.y<b.y){this.y=b.y}else{if(this.y>a.y){this.y=a.y}}return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(c){var b=this.x-c.x,a=this.y-c.y;return b*b+a*a},setLength:function(a){var b=this.length();if(b!==0&&a!==b){this.multiplyScalar(a/b)}return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},equals:function(a){return((a.x===this.x)&&(a.y===this.y))},fromArray:function(a){this.x=a[0];this.y=a[1];return this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}};THREE.Vector3=function(a,c,b){this.x=a||0;this.y=c||0;this.z=b||0};THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(a,c,b){this.x=a;this.y=c;this.z=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw new Error("index is out of range: "+a)}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+a)}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(b,a){if(a!==undefined){console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(b,a)}this.x+=b.x;this.y+=b.y;this.z+=b.z;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;this.z=d.z+c.z;return this},sub:function(b,a){if(a!==undefined){console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(b,a)}this.x-=b.x;this.y-=b.y;this.z-=b.z;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;this.z=d.z-c.z;return this},multiply:function(b,a){if(a!==undefined){console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead.");return this.multiplyVectors(b,a)}this.x*=b.x;this.y*=b.y;this.z*=b.z;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;return this},multiplyVectors:function(d,c){this.x=d.x*c.x;this.y=d.y*c.y;this.z=d.z*c.z;return this},applyMatrix3:function(b){var a=this.x;var f=this.y;var d=this.z;var c=b.elements;this.x=c[0]*a+c[3]*f+c[6]*d;this.y=c[1]*a+c[4]*f+c[7]*d;this.z=c[2]*a+c[5]*f+c[8]*d;return this},applyMatrix4:function(b){var a=this.x,f=this.y,d=this.z;var c=b.elements;this.x=c[0]*a+c[4]*f+c[8]*d+c[12];this.y=c[1]*a+c[5]*f+c[9]*d+c[13];this.z=c[2]*a+c[6]*f+c[10]*d+c[14];return this},applyProjection:function(b){var a=this.x,h=this.y,g=this.z;var c=b.elements;var f=1/(c[3]*a+c[7]*h+c[11]*g+c[15]);this.x=(c[0]*a+c[4]*h+c[8]*g+c[12])*f;this.y=(c[1]*a+c[5]*h+c[9]*g+c[13])*f;this.z=(c[2]*a+c[6]*h+c[10]*g+c[14])*f;return this},applyQuaternion:function(a){var l=this.x;var k=this.y;var j=this.z;var h=a.x;var g=a.y;var f=a.z;var i=a.w;var d=i*l+g*j-f*k;var c=i*k+f*l-h*j;var b=i*j+h*k-g*l;var e=-h*l-g*k-f*j;this.x=d*i+e*-h+c*-f-b*-g;this.y=c*i+e*-g+b*-h-d*-f;this.z=b*i+e*-f+d*-g-c*-h;return this},transformDirection:function(b){var a=this.x,f=this.y,d=this.z;var c=b.elements;this.x=c[0]*a+c[4]*f+c[8]*d;this.y=c[1]*a+c[5]*f+c[9]*d;this.z=c[2]*a+c[6]*f+c[10]*d;this.normalize();return this},divide:function(a){this.x/=a.x;this.y/=a.y;this.z/=a.z;return this},divideScalar:function(b){if(b!==0){var a=1/b;this.x*=a;this.y*=a;this.z*=a}else{this.x=0;this.y=0;this.z=0}return this},min:function(a){if(this.x>a.x){this.x=a.x}if(this.y>a.y){this.y=a.y}if(this.z>a.z){this.z=a.z}return this},max:function(a){if(this.x<a.x){this.x=a.x}if(this.y<a.y){this.y=a.y}if(this.z<a.z){this.z=a.z}return this},clamp:function(b,a){if(this.x<b.x){this.x=b.x}else{if(this.x>a.x){this.x=a.x}}if(this.y<b.y){this.y=b.y}else{if(this.y>a.y){this.y=a.y}}if(this.z<b.z){this.z=b.z}else{if(this.z>a.z){this.z=a.z}}return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();if(b!==0&&a!==b){this.multiplyScalar(a/b)}return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},cross:function(c,b){if(b!==undefined){console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead.");return this.crossVectors(c,b)}var a=this.x,e=this.y,d=this.z;this.x=e*c.z-d*c.y;this.y=d*c.x-a*c.z;this.z=a*c.y-e*c.x;return this},crossVectors:function(d,c){var h=d.x,f=d.y,e=d.z;var j=c.x,i=c.y,g=c.z;this.x=f*g-e*i;this.y=e*j-h*g;this.z=h*i-f*j;return this},angleTo:function(a){var b=this.dot(a)/(this.length()*a.length());return Math.acos(THREE.Math.clamp(b,-1,1))},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(d){var c=this.x-d.x;var b=this.y-d.y;var a=this.z-d.z;return c*c+b*b+a*a},setEulerFromRotationMatrix:function(b,a){console.error("REMOVED: Vector3's setEulerFromRotationMatrix has been removed in favor of Euler.setFromRotationMatrix(), please update your code.")},setEulerFromQuaternion:function(b,a){console.error("REMOVED: Vector3's setEulerFromQuaternion: has been removed in favor of Euler.setFromQuaternion(), please update your code.")},getPositionFromMatrix:function(a){console.warn("DEPRECATED: Vector3's .getPositionFromMatrix() has been renamed to .setFromMatrixPosition(). Please update your code.");return this.setFromMatrixPosition(a)},getScaleFromMatrix:function(a){console.warn("DEPRECATED: Vector3's .getScaleFromMatrix() has been renamed to .setFromMatrixScale(). Please update your code.");return this.setFromMatrixScale(a)},getColumnFromMatrix:function(b,a){console.warn("DEPRECATED: Vector3's .getColumnFromMatrix() has been renamed to .setFromMatrixColumn(). Please update your code.");return this.setFromMatrixColumn(b,a)},setFromMatrixPosition:function(a){this.x=a.elements[12];this.y=a.elements[13];this.z=a.elements[14];return this},setFromMatrixScale:function(a){var d=this.set(a.elements[0],a.elements[1],a.elements[2]).length();var c=this.set(a.elements[4],a.elements[5],a.elements[6]).length();var b=this.set(a.elements[8],a.elements[9],a.elements[10]).length();this.x=d;this.y=c;this.z=b;return this},setFromMatrixColumn:function(b,a){var d=b*4;var c=a.elements;this.x=c[d];this.y=c[d+1];this.z=c[d+2];return this},equals:function(a){return((a.x===this.x)&&(a.y===this.y)&&(a.z===this.z))},fromArray:function(a){this.x=a[0];this.y=a[1];this.z=a[2];return this},toArray:function(){return[this.x,this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}};THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var a=new THREE.Quaternion();return function(b){if(b instanceof THREE.Euler===false){console.error("ERROR: Vector3's .applyEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.")}this.applyQuaternion(a.setFromEuler(b));return this}}(),applyAxisAngle:function(){var a=new THREE.Quaternion();return function(b,c){this.applyQuaternion(a.setFromAxisAngle(b,c));return this}}(),projectOnVector:function(){var a=new THREE.Vector3();return function(b){a.copy(b).normalize();var c=this.dot(a);return this.copy(a).multiplyScalar(c)}}(),projectOnPlane:function(){var a=new THREE.Vector3();return function(b){a.copy(this).projectOnVector(b);return this.sub(a)}}(),reflect:function(){var a=new THREE.Vector3();return function(b){a.copy(this).projectOnVector(b).multiplyScalar(2);return this.subVectors(a,this)}}()});THREE.Vector4=function(a,d,c,b){this.x=a||0;this.y=d||0;this.z=c||0;this.w=(b!==undefined)?b:1};THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(a,d,c,b){this.x=a;this.y=d;this.z=c;this.w=b;return this},setX:function(a){this.x=a;return this},setY:function(a){this.y=a;return this},setZ:function(a){this.z=a;return this},setW:function(a){this.w=a;return this},setComponent:function(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw new Error("index is out of range: "+a)}},getComponent:function(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+a)}},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=(a.w!==undefined)?a.w:1;return this},add:function(b,a){if(a!==undefined){console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead.");return this.addVectors(b,a)}this.x+=b.x;this.y+=b.y;this.z+=b.z;this.w+=b.w;return this},addScalar:function(a){this.x+=a;this.y+=a;this.z+=a;this.w+=a;return this},addVectors:function(d,c){this.x=d.x+c.x;this.y=d.y+c.y;this.z=d.z+c.z;this.w=d.w+c.w;return this},sub:function(b,a){if(a!==undefined){console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead.");return this.subVectors(b,a)}this.x-=b.x;this.y-=b.y;this.z-=b.z;this.w-=b.w;return this},subVectors:function(d,c){this.x=d.x-c.x;this.y=d.y-c.y;this.z=d.z-c.z;this.w=d.w-c.w;return this},multiplyScalar:function(a){this.x*=a;this.y*=a;this.z*=a;this.w*=a;return this},applyMatrix4:function(b){var a=this.x;var g=this.y;var f=this.z;var c=this.w;var d=b.elements;this.x=d[0]*a+d[4]*g+d[8]*f+d[12]*c;this.y=d[1]*a+d[5]*g+d[9]*f+d[13]*c;this.z=d[2]*a+d[6]*g+d[10]*f+d[14]*c;this.w=d[3]*a+d[7]*g+d[11]*f+d[15]*c;return this},divideScalar:function(b){if(b!==0){var a=1/b;this.x*=a;this.y*=a;this.z*=a;this.w*=a}else{this.x=0;this.y=0;this.z=0;this.w=1}return this},setAxisAngleFromQuaternion:function(b){this.w=2*Math.acos(b.w);var a=Math.sqrt(1-b.w*b.w);if(a<0.0001){this.x=1;this.y=0;this.z=0}else{this.x=b.x/a;this.y=b.y/a;this.z=b.z/a}return this},setAxisAngleFromRotationMatrix:function(t){var u,j,i,h,D=0.01,k=0.1,g=t.elements,C=g[0],A=g[4],v=g[8],e=g[1],c=g[5],a=g[9],r=g[2],p=g[6],n=g[10];if((Math.abs(A-e)<D)&&(Math.abs(v-r)<D)&&(Math.abs(a-p)<D)){if((Math.abs(A+e)<k)&&(Math.abs(v+r)<k)&&(Math.abs(a+p)<k)&&(Math.abs(C+c+n-3)<k)){this.set(1,0,0,0);return this}u=Math.PI;var f=(C+1)/2;var q=(c+1)/2;var B=(n+1)/2;var d=(A+e)/4;var b=(v+r)/4;var o=(a+p)/4;if((f>q)&&(f>B)){if(f<D){j=0;i=0.707106781;h=0.707106781}else{j=Math.sqrt(f);i=d/j;h=b/j}}else{if(q>B){if(q<D){j=0.707106781;i=0;h=0.707106781}else{i=Math.sqrt(q);j=d/i;h=o/i}}else{if(B<D){j=0.707106781;i=0.707106781;h=0}else{h=Math.sqrt(B);j=b/h;i=o/h}}}this.set(j,i,h,u);return this}var l=Math.sqrt((p-a)*(p-a)+(v-r)*(v-r)+(e-A)*(e-A));if(Math.abs(l)<0.001){l=1}this.x=(p-a)/l;this.y=(v-r)/l;this.z=(e-A)/l;this.w=Math.acos((C+c+n-1)/2);return this},min:function(a){if(this.x>a.x){this.x=a.x}if(this.y>a.y){this.y=a.y}if(this.z>a.z){this.z=a.z}if(this.w>a.w){this.w=a.w}return this},max:function(a){if(this.x<a.x){this.x=a.x}if(this.y<a.y){this.y=a.y}if(this.z<a.z){this.z=a.z}if(this.w<a.w){this.w=a.w}return this},clamp:function(b,a){if(this.x<b.x){this.x=b.x}else{if(this.x>a.x){this.x=a.x}}if(this.y<b.y){this.y=b.y}else{if(this.y>a.y){this.y=a.y}}if(this.z<b.z){this.z=b.z}else{if(this.z>a.z){this.z=a.z}}if(this.w<b.w){this.w=b.w}else{if(this.w>a.w){this.w=a.w}}return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(a){var b=this.length();if(b!==0&&a!==b){this.multiplyScalar(a/b)}return this},lerp:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.w+=(a.w-this.w)*b;return this},equals:function(a){return((a.x===this.x)&&(a.y===this.y)&&(a.z===this.z)&&(a.w===this.w))},fromArray:function(a){this.x=a[0];this.y=a[1];this.z=a[2];this.w=a[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}};THREE.Euler=function(b,d,c,a){this._x=b||0;this._y=d||0;this._z=c||0;this._order=a||THREE.Euler.DefaultOrder};THREE.Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];THREE.Euler.DefaultOrder="XYZ";THREE.Euler.prototype={constructor:THREE.Euler,_x:0,_y:0,_z:0,_order:THREE.Euler.DefaultOrder,_quaternion:undefined,_updateQuaternion:function(){if(this._quaternion!==undefined){this._quaternion.setFromEuler(this,false)}},get x(){return this._x},set x(a){this._x=a;this._updateQuaternion()},get y(){return this._y},set y(a){this._y=a;this._updateQuaternion()},get z(){return this._z},set z(a){this._z=a;this._updateQuaternion()},get order(){return this._order},set order(a){this._order=a;this._updateQuaternion()},set:function(b,d,c,a){this._x=b;this._y=d;this._z=c;this._order=a||this._order;this._updateQuaternion();return this},copy:function(a){this._x=a._x;this._y=a._y;this._z=a._z;this._order=a._order;this._updateQuaternion();return this},setFromRotationMatrix:function(e,f){function i(m){return Math.min(Math.max(m,-1),1)}var d=e.elements;var j=d[0],h=d[4],g=d[8];var c=d[1],b=d[5],a=d[9];var n=d[2],l=d[6],k=d[10];f=f||this._order;if(f==="XYZ"){this._y=Math.asin(i(g));if(Math.abs(g)<0.99999){this._x=Math.atan2(-a,k);this._z=Math.atan2(-h,j)}else{this._x=Math.atan2(l,b);this._z=0}}else{if(f==="YXZ"){this._x=Math.asin(-i(a));if(Math.abs(a)<0.99999){this._y=Math.atan2(g,k);this._z=Math.atan2(c,b)}else{this._y=Math.atan2(-n,j);this._z=0}}else{if(f==="ZXY"){this._x=Math.asin(i(l));if(Math.abs(l)<0.99999){this._y=Math.atan2(-n,k);this._z=Math.atan2(-h,b)}else{this._y=0;this._z=Math.atan2(c,j)}}else{if(f==="ZYX"){this._y=Math.asin(-i(n));if(Math.abs(n)<0.99999){this._x=Math.atan2(l,k);this._z=Math.atan2(c,j)}else{this._x=0;this._z=Math.atan2(-h,b)}}else{if(f==="YZX"){this._z=Math.asin(i(c));if(Math.abs(c)<0.99999){this._x=Math.atan2(-a,b);this._y=Math.atan2(-n,j)}else{this._x=0;this._y=Math.atan2(g,k)}}else{if(f==="XZY"){this._z=Math.asin(-i(h));if(Math.abs(h)<0.99999){this._x=Math.atan2(l,b);this._y=Math.atan2(g,j)}else{this._x=Math.atan2(-a,k);this._y=0}}else{console.warn("WARNING: Euler.setFromRotationMatrix() given unsupported order: "+f)}}}}}}this._order=f;this._updateQuaternion();return this},setFromQuaternion:function(d,a,h){function g(i){return Math.min(Math.max(i,-1),1)}var e=d.x*d.x;var c=d.y*d.y;var b=d.z*d.z;var f=d.w*d.w;a=a||this._order;if(a==="XYZ"){this._x=Math.atan2(2*(d.x*d.w-d.y*d.z),(f-e-c+b));this._y=Math.asin(g(2*(d.x*d.z+d.y*d.w)));this._z=Math.atan2(2*(d.z*d.w-d.x*d.y),(f+e-c-b))}else{if(a==="YXZ"){this._x=Math.asin(g(2*(d.x*d.w-d.y*d.z)));this._y=Math.atan2(2*(d.x*d.z+d.y*d.w),(f-e-c+b));this._z=Math.atan2(2*(d.x*d.y+d.z*d.w),(f-e+c-b))}else{if(a==="ZXY"){this._x=Math.asin(g(2*(d.x*d.w+d.y*d.z)));this._y=Math.atan2(2*(d.y*d.w-d.z*d.x),(f-e-c+b));this._z=Math.atan2(2*(d.z*d.w-d.x*d.y),(f-e+c-b))}else{if(a==="ZYX"){this._x=Math.atan2(2*(d.x*d.w+d.z*d.y),(f-e-c+b));this._y=Math.asin(g(2*(d.y*d.w-d.x*d.z)));this._z=Math.atan2(2*(d.x*d.y+d.z*d.w),(f+e-c-b))}else{if(a==="YZX"){this._x=Math.atan2(2*(d.x*d.w-d.z*d.y),(f-e+c-b));this._y=Math.atan2(2*(d.y*d.w-d.x*d.z),(f+e-c-b));this._z=Math.asin(g(2*(d.x*d.y+d.z*d.w)))}else{if(a==="XZY"){this._x=Math.atan2(2*(d.x*d.w+d.y*d.z),(f-e+c-b));this._y=Math.atan2(2*(d.x*d.z+d.y*d.w),(f+e-c-b));this._z=Math.asin(g(2*(d.z*d.w-d.x*d.y)))}else{console.warn("WARNING: Euler.setFromQuaternion() given unsupported order: "+a)}}}}}}this._order=a;if(h!==false){this._updateQuaternion()}return this},reorder:function(){var a=new THREE.Quaternion();return function(b){a.setFromEuler(this);this.setFromQuaternion(a,b)}}(),fromArray:function(a){this._x=a[0];this._y=a[1];this._z=a[2];if(a[3]!==undefined){this._order=a[3]}this._updateQuaternion();return this},toArray:function(){return[this._x,this._y,this._z,this._order]},equals:function(a){return(a._x===this._x)&&(a._y===this._y)&&(a._z===this._z)&&(a._order===this._order)},clone:function(){return new THREE.Euler(this._x,this._y,this._z,this._order)}};THREE.Line3=function(b,a){this.start=(b!==undefined)?b:new THREE.Vector3();this.end=(a!==undefined)?a:new THREE.Vector3()};THREE.Line3.prototype={constructor:THREE.Line3,set:function(b,a){this.start.copy(b);this.end.copy(a);return this},copy:function(a){this.start.copy(a.start);this.end.copy(a.end);return this},center:function(b){var a=b||new THREE.Vector3();return a.addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(b){var a=b||new THREE.Vector3();return a.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(c,b){var a=b||new THREE.Vector3();return this.delta(a).multiplyScalar(c).add(this.start)},closestPointToPointParameter:function(){var b=new THREE.Vector3();var a=new THREE.Vector3();return function(c,g){b.subVectors(c,this.start);a.subVectors(this.end,this.start);var f=a.dot(a);var e=a.dot(b);var d=e/f;if(g){d=THREE.Math.clamp(d,0,1)}return d}}(),closestPointToPoint:function(b,e,d){var c=this.closestPointToPointParameter(b,e);var a=d||new THREE.Vector3();return this.delta(a).multiplyScalar(c).add(this.start)},applyMatrix4:function(a){this.start.applyMatrix4(a);this.end.applyMatrix4(a);return this},equals:function(a){return a.start.equals(this.start)&&a.end.equals(this.end)},clone:function(){return new THREE.Line3().copy(this)}};THREE.Box2=function(b,a){this.min=(b!==undefined)?b:new THREE.Vector2(Infinity,Infinity);this.max=(a!==undefined)?a:new THREE.Vector2(-Infinity,-Infinity)};THREE.Box2.prototype={constructor:THREE.Box2,set:function(b,a){this.min.copy(b);this.max.copy(a);return this},setFromPoints:function(d){if(d.length>0){var a=d[0];this.min.copy(a);this.max.copy(a);for(var c=1,b=d.length;c<b;c++){a=d[c];if(a.x<this.min.x){this.min.x=a.x}else{if(a.x>this.max.x){this.max.x=a.x}}if(a.y<this.min.y){this.min.y=a.y}else{if(a.y>this.max.y){this.max.y=a.y}}}}else{this.makeEmpty()}return this},setFromCenterAndSize:function(){var a=new THREE.Vector2();return function(b,d){var c=a.copy(d).multiplyScalar(0.5);this.min.copy(b).sub(c);this.max.copy(b).add(c);return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return(this.max.x<this.min.x)||(this.max.y<this.min.y)},center:function(b){var a=b||new THREE.Vector2();return a.addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(b){var a=b||new THREE.Vector2();return a.subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){if(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y){return false}return true},containsBox:function(a){if((this.min.x<=a.min.x)&&(a.max.x<=this.max.x)&&(this.min.y<=a.min.y)&&(a.max.y<=this.max.y)){return true}return false},getParameter:function(b,c){var a=c||new THREE.Vector2();return a.set((b.x-this.min.x)/(this.max.x-this.min.x),(b.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(a){if(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y){return false}return true},clampPoint:function(b,c){var a=c||new THREE.Vector2();return a.copy(b).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector2();return function(b){var c=a.copy(b).clamp(this.min,this.max);return c.sub(b).length()}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return new THREE.Box2().copy(this)}};THREE.Box3=function(b,a){this.min=(b!==undefined)?b:new THREE.Vector3(Infinity,Infinity,Infinity);this.max=(a!==undefined)?a:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};THREE.Box3.prototype={constructor:THREE.Box3,set:function(b,a){this.min.copy(b);this.max.copy(a);return this},addPoint:function(a){if(a.x<this.min.x){this.min.x=a.x}else{if(a.x>this.max.x){this.max.x=a.x}}if(a.y<this.min.y){this.min.y=a.y}else{if(a.y>this.max.y){this.max.y=a.y}}if(a.z<this.min.z){this.min.z=a.z}else{if(a.z>this.max.z){this.max.z=a.z}}},setFromPoints:function(d){if(d.length>0){var a=d[0];this.min.copy(a);this.max.copy(a);for(var c=1,b=d.length;c<b;c++){this.addPoint(d[c])}}else{this.makeEmpty()}return this},setFromCenterAndSize:function(){var a=new THREE.Vector3();return function(b,d){var c=a.copy(d).multiplyScalar(0.5);this.min.copy(b).sub(c);this.max.copy(b).add(c);return this}}(),setFromObject:function(){var a=new THREE.Vector3();return function(b){var c=this;b.updateMatrixWorld(true);this.makeEmpty();b.traverse(function(g){if(g.geometry!==undefined&&g.geometry.vertices!==undefined){var e=g.geometry.vertices;for(var f=0,d=e.length;f<d;f++){a.copy(e[f]);a.applyMatrix4(g.matrixWorld);c.expandByPoint(a)}}});return this}}(),copy:function(a){this.min.copy(a.min);this.max.copy(a.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return(this.max.x<this.min.x)||(this.max.y<this.min.y)||(this.max.z<this.min.z)},center:function(b){var a=b||new THREE.Vector3();return a.addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(b){var a=b||new THREE.Vector3();return a.subVectors(this.max,this.min)},expandByPoint:function(a){this.min.min(a);this.max.max(a);return this},expandByVector:function(a){this.min.sub(a);this.max.add(a);return this},expandByScalar:function(a){this.min.addScalar(-a);this.max.addScalar(a);return this},containsPoint:function(a){if(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z){return false}return true},containsBox:function(a){if((this.min.x<=a.min.x)&&(a.max.x<=this.max.x)&&(this.min.y<=a.min.y)&&(a.max.y<=this.max.y)&&(this.min.z<=a.min.z)&&(a.max.z<=this.max.z)){return true}return false},getParameter:function(b,c){var a=c||new THREE.Vector3();return a.set((b.x-this.min.x)/(this.max.x-this.min.x),(b.y-this.min.y)/(this.max.y-this.min.y),(b.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(a){if(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z){return false}return true},clampPoint:function(b,c){var a=c||new THREE.Vector3();return a.copy(b).clamp(this.min,this.max)},distanceToPoint:function(){var a=new THREE.Vector3();return function(b){var c=a.copy(b).clamp(this.min,this.max);return c.sub(b).length()}}(),getBoundingSphere:function(){var a=new THREE.Vector3();return function(c){var b=c||new THREE.Sphere();b.center=this.center();b.radius=this.size(a).length()*0.5;return b}}(),intersect:function(a){this.min.max(a.min);this.max.min(a.max);return this},union:function(a){this.min.min(a.min);this.max.max(a.max);return this},applyMatrix4:function(){var a=[new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3()];return function(b){a[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(b);a[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(b);a[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(b);a[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(b);a[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(b);a[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(b);a[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(b);a[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(b);this.makeEmpty();this.setFromPoints(a);return this}}(),translate:function(a){this.min.add(a);this.max.add(a);return this},equals:function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},clone:function(){return new THREE.Box3().copy(this)}};THREE.Matrix3=function(g,f,e,d,c,b,a,i,h){this.elements=new Float32Array(9);this.set((g!==undefined)?g:1,f||0,e||0,d||0,(c!==undefined)?c:1,b||0,a||0,i||0,(h!==undefined)?h:1)};THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(h,g,f,e,d,c,a,j,i){var b=this.elements;b[0]=h;b[3]=g;b[6]=f;b[1]=e;b[4]=d;b[7]=c;b[2]=a;b[5]=j;b[8]=i;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(a){var b=a.elements;this.set(b[0],b[3],b[6],b[1],b[4],b[7],b[2],b[5],b[8]);return this},multiplyVector3:function(a){console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return a.applyMatrix3(this)},multiplyVector3Array:function(){var a=new THREE.Vector3();return function(b){for(var d=0,c=b.length;d<c;d+=3){a.x=b[d];a.y=b[d+1];a.z=b[d+2];a.applyMatrix3(this);b[d]=a.x;b[d+1]=a.y;b[d+2]=a.z}return b}}(),multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},determinant:function(){var j=this.elements;var s=j[0],r=j[1],q=j[2],p=j[3],o=j[4],n=j[5],m=j[6],l=j[7],k=j[8];return s*o*k-s*n*l-r*p*k+r*n*m+q*p*l-q*o*m},getInverse:function(b,a){var d=b.elements;var f=this.elements;f[0]=d[10]*d[5]-d[6]*d[9];f[1]=-d[10]*d[1]+d[2]*d[9];f[2]=d[6]*d[1]-d[2]*d[5];f[3]=-d[10]*d[4]+d[6]*d[8];f[4]=d[10]*d[0]-d[2]*d[8];f[5]=-d[6]*d[0]+d[2]*d[4];f[6]=d[9]*d[4]-d[5]*d[8];f[7]=-d[9]*d[0]+d[1]*d[8];f[8]=d[5]*d[0]-d[1]*d[4];var c=d[0]*f[0]+d[1]*f[3]+d[2]*f[6];if(c===0){var e="Matrix3.getInverse(): can't invert matrix, determinant is 0";if(a||false){throw new Error(e)}else{console.warn(e)}this.identity();return this}this.multiplyScalar(1/c);return this},transpose:function(){var b,a=this.elements;b=a[1];a[1]=a[3];a[3]=b;b=a[2];a[2]=a[6];a[6]=b;b=a[5];a[5]=a[7];a[7]=b;return this},getNormalMatrix:function(a){this.getInverse(a).transpose();return this},transposeIntoArray:function(b){var a=this.elements;b[0]=a[0];b[1]=a[3];b[2]=a[6];b[3]=a[1];b[4]=a[4];b[5]=a[7];b[6]=a[2];b[7]=a[5];b[8]=a[8];return this},clone:function(){var a=this.elements;return new THREE.Matrix3(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}};THREE.Matrix4=function(n,m,k,i,f,e,d,c,a,q,p,o,l,j,h,g){this.elements=new Float32Array(16);var b=this.elements;b[0]=(n!==undefined)?n:1;b[4]=m||0;b[8]=k||0;b[12]=i||0;b[1]=f||0;b[5]=(e!==undefined)?e:1;b[9]=d||0;b[13]=c||0;b[2]=a||0;b[6]=q||0;b[10]=(p!==undefined)?p:1;b[14]=o||0;b[3]=l||0;b[7]=j||0;b[11]=h||0;b[15]=(g!==undefined)?g:1};THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(n,m,k,i,f,e,d,c,a,q,p,o,l,j,h,g){var b=this.elements;b[0]=n;b[4]=m;b[8]=k;b[12]=i;b[1]=f;b[5]=e;b[9]=d;b[13]=c;b[2]=a;b[6]=q;b[10]=p;b[14]=o;b[3]=l;b[7]=j;b[11]=h;b[15]=g;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){this.elements.set(a.elements);return this},extractPosition:function(a){console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition().");return this.copyPosition(a)},copyPosition:function(a){var c=this.elements;var b=a.elements;c[12]=b[12];c[13]=b[13];c[14]=b[14];return this},extractRotation:function(){var a=new THREE.Vector3();return function(b){var g=this.elements;var f=b.elements;var e=1/a.set(f[0],f[1],f[2]).length();var d=1/a.set(f[4],f[5],f[6]).length();var c=1/a.set(f[8],f[9],f[10]).length();g[0]=f[0]*e;g[1]=f[1]*e;g[2]=f[2]*e;g[4]=f[4]*d;g[5]=f[5]*d;g[6]=f[6]*d;g[8]=f[8]*c;g[9]=f[9]*c;g[10]=f[10]*c;return this}}(),makeRotationFromEuler:function(o){if(o instanceof THREE.Euler===false){console.error("ERROR: Matrix's .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.")}var k=this.elements;var n=o.x,m=o.y,l=o.z;var G=Math.cos(n),F=Math.sin(n);var D=Math.cos(m),A=Math.sin(m);var t=Math.cos(l),r=Math.sin(l);if(o.order==="XYZ"){var v=G*t,s=G*r,h=F*t,g=F*r;k[0]=D*t;k[4]=-D*r;k[8]=A;k[1]=s+h*A;k[5]=v-g*A;k[9]=-F*D;k[2]=g-v*A;k[6]=h+s*A;k[10]=G*D}else{if(o.order==="YXZ"){var q=D*t,p=D*r,C=A*t,u=A*r;k[0]=q+u*F;k[4]=C*F-p;k[8]=G*A;k[1]=G*r;k[5]=G*t;k[9]=-F;k[2]=p*F-C;k[6]=u+q*F;k[10]=G*D}else{if(o.order==="ZXY"){var q=D*t,p=D*r,C=A*t,u=A*r;k[0]=q-u*F;k[4]=-G*r;k[8]=C+p*F;k[1]=p+C*F;k[5]=G*t;k[9]=u-q*F;k[2]=-G*A;k[6]=F;k[10]=G*D}else{if(o.order==="ZYX"){var v=G*t,s=G*r,h=F*t,g=F*r;k[0]=D*t;k[4]=h*A-s;k[8]=v*A+g;k[1]=D*r;k[5]=g*A+v;k[9]=s*A-h;k[2]=-A;k[6]=F*D;k[10]=G*D}else{if(o.order==="YZX"){var E=G*D,B=G*A,j=F*D,i=F*A;k[0]=D*t;k[4]=i-E*r;k[8]=j*r+B;k[1]=r;k[5]=G*t;k[9]=-F*t;k[2]=-A*t;k[6]=B*r+j;k[10]=E-i*r}else{if(o.order==="XZY"){var E=G*D,B=G*A,j=F*D,i=F*A;k[0]=D*t;k[4]=-r;k[8]=A*t;k[1]=E*r+i;k[5]=G*t;k[9]=B*r-j;k[2]=j*r-B;k[6]=F*t;k[10]=i*r+E}}}}}}k[3]=0;k[7]=0;k[11]=0;k[12]=0;k[13]=0;k[14]=0;k[15]=1;return this},setRotationFromQuaternion:function(a){console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code.");return this.makeRotationFromQuaternion(a)},makeRotationFromQuaternion:function(l){var e=this.elements;var h=l.x,g=l.y,f=l.z,i=l.w;var n=h+h,a=g+g,j=f+f;var d=h*n,c=h*a,b=h*j;var m=g*a,k=g*j,r=f*j;var s=i*n,p=i*a,o=i*j;e[0]=1-(m+r);e[4]=c-o;e[8]=b+p;e[1]=c+o;e[5]=1-(d+r);e[9]=k-s;e[2]=b-p;e[6]=k+s;e[10]=1-(d+m);e[3]=0;e[7]=0;e[11]=0;e[12]=0;e[13]=0;e[14]=0;e[15]=1;return this},lookAt:function(){var a=new THREE.Vector3();var c=new THREE.Vector3();var b=new THREE.Vector3();return function(e,f,d){var g=this.elements;b.subVectors(e,f).normalize();if(b.length()===0){b.z=1}a.crossVectors(d,b).normalize();if(a.length()===0){b.x+=0.0001;a.crossVectors(d,b).normalize()}c.crossVectors(b,a);g[0]=a.x;g[4]=c.x;g[8]=b.x;g[1]=a.y;g[5]=c.y;g[9]=b.y;g[2]=a.z;g[6]=c.z;g[10]=b.z;return this}}(),multiply:function(a,b){if(b!==undefined){console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead.");return this.multiplyMatrices(a,b)}return this.multiplyMatrices(this,a)},multiplyMatrices:function(Q,P){var s=Q.elements;var O=P.elements;var c=this.elements;var p=s[0],n=s[4],m=s[8],l=s[12];var N=s[1],M=s[5],L=s[9],K=s[13];var F=s[2],E=s[6],D=s[10],C=s[14];var t=s[3],r=s[7],q=s[11],o=s[15];var i=O[0],g=O[4],e=O[8],d=O[12];var J=O[1],I=O[5],H=O[9],G=O[13];var B=O[2],A=O[6],v=O[10],u=O[14];var k=O[3],j=O[7],h=O[11],f=O[15];c[0]=p*i+n*J+m*B+l*k;c[4]=p*g+n*I+m*A+l*j;c[8]=p*e+n*H+m*v+l*h;c[12]=p*d+n*G+m*u+l*f;c[1]=N*i+M*J+L*B+K*k;c[5]=N*g+M*I+L*A+K*j;c[9]=N*e+M*H+L*v+K*h;c[13]=N*d+M*G+L*u+K*f;c[2]=F*i+E*J+D*B+C*k;c[6]=F*g+E*I+D*A+C*j;c[10]=F*e+E*H+D*v+C*h;c[14]=F*d+E*G+D*u+C*f;c[3]=t*i+r*J+q*B+o*k;c[7]=t*g+r*I+q*A+o*j;c[11]=t*e+r*H+q*v+o*h;c[15]=t*d+r*G+q*u+o*f;return this},multiplyToArray:function(d,c,e){var f=this.elements;this.multiplyMatrices(d,c);e[0]=f[0];e[1]=f[1];e[2]=f[2];e[3]=f[3];e[4]=f[4];e[5]=f[5];e[6]=f[6];e[7]=f[7];e[8]=f[8];e[9]=f[9];e[10]=f[10];e[11]=f[11];e[12]=f[12];e[13]=f[13];e[14]=f[14];e[15]=f[15];return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},multiplyVector3:function(a){console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");return a.applyProjection(this)},multiplyVector4:function(a){console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},multiplyVector3Array:function(){var a=new THREE.Vector3();return function(b){for(var d=0,c=b.length;d<c;d+=3){a.x=b[d];a.y=b[d+1];a.z=b[d+2];a.applyProjection(this);b[d]=a.x;b[d+1]=a.y;b[d+2]=a.z}return b}}(),rotateAxis:function(a){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");a.transformDirection(this)},crossVector:function(a){console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return a.applyMatrix4(this)},determinant:function(){var c=this.elements;var n=c[0],m=c[4],k=c[8],i=c[12];var f=c[1],e=c[5],d=c[9],b=c[13];var a=c[2],q=c[6],p=c[10],o=c[14];var l=c[3],j=c[7],h=c[11],g=c[15];return(l*(+i*d*q-k*b*q-i*e*p+m*b*p+k*e*o-m*d*o)+j*(+n*d*o-n*b*p+i*f*p-k*f*o+k*b*a-i*d*a)+h*(+n*b*q-n*e*o-i*f*q+m*f*o+i*e*a-m*b*a)+g*(-k*e*a-n*d*q+n*e*p+k*f*q-m*f*p+m*d*a))},transpose:function(){var b=this.elements;var a;a=b[1];b[1]=b[4];b[4]=a;a=b[2];b[2]=b[8];b[8]=a;a=b[6];b[6]=b[9];b[9]=a;a=b[3];b[3]=b[12];b[12]=a;a=b[7];b[7]=b[13];b[13]=a;a=b[11];b[11]=b[14];b[14]=a;return this},flattenToArray:function(b){var a=this.elements;b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b},flattenToArrayOffset:function(c,b){var a=this.elements;c[b]=a[0];c[b+1]=a[1];c[b+2]=a[2];c[b+3]=a[3];c[b+4]=a[4];c[b+5]=a[5];c[b+6]=a[6];c[b+7]=a[7];c[b+8]=a[8];c[b+9]=a[9];c[b+10]=a[10];c[b+11]=a[11];c[b+12]=a[12];c[b+13]=a[13];c[b+14]=a[14];c[b+15]=a[15];return c},getPosition:function(){var a=new THREE.Vector3();return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead.");var b=this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(r,h){var g=this.elements;var A=r.elements;var p=A[0],n=A[4],k=A[8],i=A[12];var v=A[1],u=A[5],t=A[9],s=A[13];var d=A[2],c=A[6],b=A[10],a=A[14];var q=A[3],o=A[7],l=A[11],j=A[15];g[0]=t*a*o-s*b*o+s*c*l-u*a*l-t*c*j+u*b*j;g[4]=i*b*o-k*a*o-i*c*l+n*a*l+k*c*j-n*b*j;g[8]=k*s*o-i*t*o+i*u*l-n*s*l-k*u*j+n*t*j;g[12]=i*t*c-k*s*c-i*u*b+n*s*b+k*u*a-n*t*a;g[1]=s*b*q-t*a*q-s*d*l+v*a*l+t*d*j-v*b*j;g[5]=k*a*q-i*b*q+i*d*l-p*a*l-k*d*j+p*b*j;g[9]=i*t*q-k*s*q-i*v*l+p*s*l+k*v*j-p*t*j;g[13]=k*s*d-i*t*d+i*v*b-p*s*b-k*v*a+p*t*a;g[2]=u*a*q-s*c*q+s*d*o-v*a*o-u*d*j+v*c*j;g[6]=i*c*q-n*a*q-i*d*o+p*a*o+n*d*j-p*c*j;g[10]=n*s*q-i*u*q+i*v*o-p*s*o-n*v*j+p*u*j;g[14]=i*u*d-n*s*d-i*v*c+p*s*c+n*v*a-p*u*a;g[3]=t*c*q-u*b*q-t*d*o+v*b*o+u*d*l-v*c*l;g[7]=n*b*q-k*c*q+k*d*o-p*b*o-n*d*l+p*c*l;g[11]=k*u*q-n*t*q-k*v*o+p*t*o+n*v*l-p*u*l;g[15]=n*t*d-k*u*d+k*v*c-p*t*c-n*v*b+p*u*b;var e=p*g[0]+v*g[4]+d*g[8]+q*g[12];if(e==0){var f="Matrix4.getInverse(): can't invert matrix, determinant is 0";if(h||false){throw new Error(f)}else{console.warn(f)}this.identity();return this}this.multiplyScalar(1/e);return this},translate:function(a){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(a){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(a){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(a){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(a,b){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},scale:function(b){var d=this.elements;var a=b.x,e=b.y,c=b.z;d[0]*=a;d[4]*=e;d[8]*=c;d[1]*=a;d[5]*=e;d[9]*=c;d[2]*=a;d[6]*=e;d[10]*=c;d[3]*=a;d[7]*=e;d[11]*=c;return this},getMaxScaleOnAxis:function(){var c=this.elements;var d=c[0]*c[0]+c[1]*c[1]+c[2]*c[2];var b=c[4]*c[4]+c[5]*c[5]+c[6]*c[6];var a=c[8]*c[8]+c[9]*c[9]+c[10]*c[10];return Math.sqrt(Math.max(d,Math.max(b,a)))},makeTranslation:function(a,c,b){this.set(1,0,0,a,0,1,0,c,0,0,1,b,0,0,0,1);return this},makeRotationX:function(a){var d=Math.cos(a),b=Math.sin(a);this.set(1,0,0,0,0,d,-b,0,0,b,d,0,0,0,0,1);return this},makeRotationY:function(a){var d=Math.cos(a),b=Math.sin(a);this.set(d,0,b,0,0,1,0,0,-b,0,d,0,0,0,0,1);return this},makeRotationZ:function(a){var d=Math.cos(a),b=Math.sin(a);this.set(d,-b,0,0,b,d,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(a,b){var f=Math.cos(b);var k=Math.sin(b);var j=1-f;var i=a.x,h=a.y,g=a.z;var e=j*i,d=j*h;this.set(e*i+f,e*h-k*g,e*g+k*h,0,e*h+k*g,d*h+f,d*g-k*i,0,e*g-k*h,d*g+k*i,j*g*g+f,0,0,0,0,1);return this},makeScale:function(a,c,b){this.set(a,0,0,0,0,c,0,0,0,0,b,0,0,0,0,1);return this},compose:function(a,b,c){this.makeRotationFromQuaternion(b);this.scale(c);this.setPosition(a);return this},decompose:function(){var a=new THREE.Vector3();var b=new THREE.Matrix4();return function(i,h,g){var f=this.elements;var l=a.set(f[0],f[1],f[2]).length();var k=a.set(f[4],f[5],f[6]).length();var j=a.set(f[8],f[9],f[10]).length();i.x=f[12];i.y=f[13];i.z=f[14];b.elements.set(this.elements);var e=1/l;var d=1/k;var c=1/j;b.elements[0]*=e;b.elements[1]*=e;b.elements[2]*=e;b.elements[4]*=d;b.elements[5]*=d;b.elements[6]*=d;b.elements[8]*=c;b.elements[9]*=c;b.elements[10]*=c;h.setFromRotationMatrix(b);g.x=l;g.y=k;g.z=j;return this}}(),makeFrustum:function(h,u,f,r,k,j){var g=this.elements;var m=parseFloat(k);var e=parseFloat(j);var t=2*m/(u-h);var q=2*m/(r-f);var s=(u+h)/(u-h);var p=(r+f)/(r-f);var i=e+m;var l=e-m;var o=-i/l;var n=-2*e*m/(e-m);g[0]=t;g[4]=0;g[8]=s;g[12]=0;g[1]=0;g[5]=q;g[9]=p;g[13]=0;g[2]=0;g[6]=0;g[10]=o;g[14]=n;g[3]=0;g[7]=0;g[11]=-1;g[15]=0;return this},makePerspective:function(e,c,g,b){var a=g*Math.tan(THREE.Math.degToRad(e*0.5));var f=-a;var h=f*c;var d=a*c;return this.makeFrustum(h,d,f,a,g,b)},makeOrthographic:function(d,n,k,a,g,f){var c=this.elements;var m=n-d;var e=k-a;var b=f-g;var l=(n+d)/m;var j=(k+a)/e;var i=(f+g)/b;c[0]=2/m;c[4]=0;c[8]=0;c[12]=-l;c[1]=0;c[5]=2/e;c[9]=0;c[13]=-j;c[2]=0;c[6]=0;c[10]=-2/b;c[14]=-i;c[3]=0;c[7]=0;c[11]=0;c[15]=1;return this},fromArray:function(a){this.elements.set(a);return this},toArray:function(){var a=this.elements;return[a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]]},clone:function(){var a=this.elements;return new THREE.Matrix4(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}};THREE.Ray=function(a,b){this.origin=(a!==undefined)?a:new THREE.Vector3();this.direction=(b!==undefined)?b:new THREE.Vector3()};THREE.Ray.prototype={constructor:THREE.Ray,set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(c,b){var a=b||new THREE.Vector3();return a.copy(this.direction).multiplyScalar(c).add(this.origin)},recast:function(){var a=new THREE.Vector3();return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(b,c){var a=c||new THREE.Vector3();a.subVectors(b,this.origin);var d=a.dot(this.direction);if(d<0){return a.copy(this.origin)}return a.copy(this.direction).multiplyScalar(d).add(this.origin)},distanceToPoint:function(){var a=new THREE.Vector3();return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);if(c<0){return this.origin.distanceTo(b)}a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceTo(b)}}(),distanceSqToSegment:function(f,e,l,i){var m=f.clone().add(e).multiplyScalar(0.5);var p=e.clone().sub(f).normalize();var a=f.distanceTo(e)*0.5;var n=this.origin.clone().sub(m);var s=-this.direction.dot(p);var k=n.dot(this.direction);var j=-n.dot(p);var r=n.lengthSq();var h=Math.abs(1-s*s);var d,b,o,g;if(h>=0){d=s*j-k;b=s*k-j;g=a*h;if(d>=0){if(b>=-g){if(b<=g){var q=1/h;d*=q;b*=q;o=d*(d+s*b+2*k)+b*(s*d+b+2*j)+r}else{b=a;d=Math.max(0,-(s*b+k));o=-d*d+b*(b+2*j)+r}}else{b=-a;d=Math.max(0,-(s*b+k));o=-d*d+b*(b+2*j)+r}}else{if(b<=-g){d=Math.max(0,-(-s*a+k));b=(d>0)?-a:Math.min(Math.max(-a,-j),a);o=-d*d+b*(b+2*j)+r}else{if(b<=g){d=0;b=Math.min(Math.max(-a,-j),a);o=b*(b+2*j)+r}else{d=Math.max(0,-(s*a+k));b=(d>0)?a:Math.min(Math.max(-a,-j),a);o=-d*d+b*(b+2*j)+r}}}}else{b=(s>0)?-a:a;d=Math.max(0,-(s*b+k));o=-d*d+b*(b+2*j)+r}if(l){l.copy(this.direction.clone().multiplyScalar(d).add(this.origin))}if(i){i.copy(p.clone().multiplyScalar(b).add(m))}return o},isIntersectionSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},isIntersectionPlane:function(a){var b=a.distanceToPoint(this.origin);if(b===0){return true}var c=a.normal.dot(this.direction);if(c*b<0){return true}return false},distanceToPlane:function(a){var c=a.normal.dot(this.direction);if(c==0){if(a.distanceToPoint(this.origin)==0){return 0}return null}var b=-(this.origin.dot(a.normal)+a.constant)/c;return b>=0?b:null},intersectPlane:function(a,c){var b=this.distanceToPlane(a);if(b===null){return null}return this.at(b,c)},isIntersectionBox:function(){var a=new THREE.Vector3();return function(b){return this.intersectBox(b,a)!==null}}(),intersectBox:function(f,l){var c,g,i,a,h,k;var e=1/this.direction.x,d=1/this.direction.y,b=1/this.direction.z;var j=this.origin;if(e>=0){c=(f.min.x-j.x)*e;g=(f.max.x-j.x)*e}else{c=(f.max.x-j.x)*e;g=(f.min.x-j.x)*e}if(d>=0){i=(f.min.y-j.y)*d;a=(f.max.y-j.y)*d}else{i=(f.max.y-j.y)*d;a=(f.min.y-j.y)*d}if((c>a)||(i>g)){return null}if(i>c||c!==c){c=i}if(a<g||g!==g){g=a}if(b>=0){h=(f.min.z-j.z)*b;k=(f.max.z-j.z)*b}else{h=(f.max.z-j.z)*b;k=(f.min.z-j.z)*b}if((c>k)||(h>g)){return null}if(h>c||c!==c){c=h}if(k<g||g!==g){g=k}if(g<0){return null}return this.at(c>=0?c:g,l)},intersectTriangle:function(){var d=new THREE.Vector3();var b=new THREE.Vector3();var a=new THREE.Vector3();var c=new THREE.Vector3();return function(m,k,j,e,n){b.subVectors(k,m);a.subVectors(j,m);c.crossVectors(b,a);var i=this.direction.dot(c);var f;if(i>0){if(e){return null}f=1}else{if(i<0){f=-1;i=-i}else{return null}}d.subVectors(this.origin,m);var l=f*this.direction.dot(a.crossVectors(d,a));if(l<0){return null}var g=f*this.direction.dot(b.cross(d));if(g<0){return null}if(l+g>i){return null}var h=-f*d.dot(c);if(h<0){return null}return this.at(h/i,n)}}(),applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);this.direction.normalize();return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)},clone:function(){return new THREE.Ray().copy(this)}};THREE.Sphere=function(b,a){this.center=(b!==undefined)?b:new THREE.Vector3();this.radius=(a!==undefined)?a:0};THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(b,a){this.center.copy(b);this.radius=a;return this},setFromPoints:function(){var a=new THREE.Box3();return function(f,g){var b=this.center;if(g!==undefined){b.copy(g)}else{a.setFromPoints(f).center(b)}var c=0;for(var e=0,d=f.length;e<d;e++){c=Math.max(c,b.distanceToSquared(f[e]))}this.radius=Math.sqrt(c);return this}}(),copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},empty:function(){return(this.radius<=0)},containsPoint:function(a){return(a.distanceToSquared(this.center)<=(this.radius*this.radius))},distanceToPoint:function(a){return(a.distanceTo(this.center)-this.radius)},intersectsSphere:function(a){var b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=(b*b)},clampPoint:function(b,d){var c=this.center.distanceToSquared(b);var a=d||new THREE.Vector3();a.copy(b);if(c>(this.radius*this.radius)){a.sub(this.center).normalize();a.multiplyScalar(this.radius).add(this.center)}return a},getBoundingBox:function(a){var b=a||new THREE.Box3();b.set(this.center,this.center);b.expandByScalar(this.radius);return b},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius=this.radius*a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&(a.radius===this.radius)},clone:function(){return new THREE.Sphere().copy(this)}};THREE.Frustum=function(f,e,d,c,b,a){this.planes=[(f!==undefined)?f:new THREE.Plane(),(e!==undefined)?e:new THREE.Plane(),(d!==undefined)?d:new THREE.Plane(),(c!==undefined)?c:new THREE.Plane(),(b!==undefined)?b:new THREE.Plane(),(a!==undefined)?a:new THREE.Plane()]};THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(g,f,e,d,c,b){var a=this.planes;a[0].copy(g);a[1].copy(f);a[2].copy(e);a[3].copy(d);a[4].copy(c);a[5].copy(b);return this},copy:function(c){var a=this.planes;for(var b=0;b<6;b++){a[b].copy(c.planes[b])}return this},setFromMatrix:function(o){var h=this.planes;var t=o.elements;var l=t[0],j=t[1],i=t[2],g=t[3];var f=t[4],e=t[5],d=t[6],c=t[7];var b=t[8],a=t[9],s=t[10],r=t[11];var q=t[12],p=t[13],n=t[14],k=t[15];h[0].setComponents(g-l,c-f,r-b,k-q).normalize();h[1].setComponents(g+l,c+f,r+b,k+q).normalize();h[2].setComponents(g+j,c+e,r+a,k+p).normalize();h[3].setComponents(g-j,c-e,r-a,k-p).normalize();h[4].setComponents(g-i,c-d,r-s,k-n).normalize();h[5].setComponents(g+i,c+d,r+s,k+n).normalize();return this},intersectsObject:function(){var a=new THREE.Sphere();return function(b){var c=b.geometry;if(c.boundingSphere===null){c.computeBoundingSphere()}a.copy(c.boundingSphere);a.applyMatrix4(b.matrixWorld);return this.intersectsSphere(a)}}(),intersectsSphere:function(c){var d=this.planes;var a=c.center;var b=-c.radius;for(var e=0;e<6;e++){var f=d[e].distanceToPoint(a);if(f<b){return false}}return true},intersectsBox:function(){var b=new THREE.Vector3(),a=new THREE.Vector3();return function(g){var d=this.planes;for(var e=0;e<6;e++){var c=d[e];b.x=c.normal.x>0?g.min.x:g.max.x;a.x=c.normal.x>0?g.max.x:g.min.x;b.y=c.normal.y>0?g.min.y:g.max.y;a.y=c.normal.y>0?g.max.y:g.min.y;b.z=c.normal.z>0?g.min.z:g.max.z;a.z=c.normal.z>0?g.max.z:g.min.z;var h=c.distanceToPoint(b);var f=c.distanceToPoint(a);if(h<0&&f<0){return false}}return true}}(),containsPoint:function(a){var b=this.planes;for(var c=0;c<6;c++){if(b[c].distanceToPoint(a)<0){return false}}return true},clone:function(){return new THREE.Frustum().copy(this)}};THREE.Plane=function(b,a){this.normal=(b!==undefined)?b:new THREE.Vector3(1,0,0);this.constant=(a!==undefined)?a:0};THREE.Plane.prototype={constructor:THREE.Plane,set:function(b,a){this.normal.copy(b);this.constant=a;return this},setComponents:function(a,d,c,b){this.normal.set(a,d,c);this.constant=b;return this},setFromNormalAndCoplanarPoint:function(b,a){this.normal.copy(b);this.constant=-a.dot(this.normal);return this},setFromCoplanarPoints:function(){var b=new THREE.Vector3();var a=new THREE.Vector3();return function(e,d,g){var f=b.subVectors(g,d).cross(a.subVectors(e,d)).normalize();this.setFromNormalAndCoplanarPoint(f,e);return this}}(),copy:function(a){this.normal.copy(a.normal);this.constant=a.constant;return this},normalize:function(){var a=1/this.normal.length();this.normal.multiplyScalar(a);this.constant*=a;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(a){return this.normal.dot(a)+this.constant},distanceToSphere:function(a){return this.distanceToPoint(a.center)-a.radius},projectPoint:function(a,b){return this.orthoPoint(a,b).sub(a).negate()},orthoPoint:function(b,d){var c=this.distanceToPoint(b);var a=d||new THREE.Vector3();return a.copy(this.normal).multiplyScalar(c)},isIntersectionLine:function(a){var c=this.distanceToPoint(a.start);var b=this.distanceToPoint(a.end);return(c<0&&b>0)||(b<0&&c>0)},intersectLine:function(){var a=new THREE.Vector3();return function(c,e){var b=e||new THREE.Vector3();var f=c.delta(a);var g=this.normal.dot(f);if(g==0){if(this.distanceToPoint(c.start)==0){return b.copy(c.start)}return undefined}var d=-(c.start.dot(this.normal)+this.constant)/g;if(d<0||d>1){return undefined}return b.copy(f).multiplyScalar(d).add(c.start)}}(),coplanarPoint:function(b){var a=b||new THREE.Vector3();return a.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var c=new THREE.Vector3();var b=new THREE.Vector3();var a=new THREE.Matrix3();return function(e,f){var h=f||a.getNormalMatrix(e);var g=c.copy(this.normal).applyMatrix3(h);var d=this.coplanarPoint(b);d.applyMatrix4(e);this.setFromNormalAndCoplanarPoint(g,d);return this}}(),translate:function(a){this.constant=this.constant-a.dot(this.normal);return this},equals:function(a){return a.normal.equals(this.normal)&&(a.constant==this.constant)},clone:function(){return new THREE.Plane().copy(this)}};THREE.Math={PI2:Math.PI*2,generateUUID:function(){var d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");var b=new Array(36);var a=0,c;return function(){for(var e=0;e<36;e++){if(e==8||e==13||e==18||e==23){b[e]="-"}else{if(e==14){b[e]="4"}else{if(a<=2){a=33554432+(Math.random()*16777216)|0}c=a&15;a=a>>4;b[e]=d[(e==19)?(c&3)|8:c]}}}return b.join("")}}(),clamp:function(d,e,c){return(d<e)?e:((d>c)?c:d)},clampBottom:function(b,c){return b<c?c:b},mapLinear:function(b,c,a,e,d){return e+(b-c)*(d-e)/(a-c)},smoothstep:function(b,c,a){if(b<=c){return 0}if(b>=a){return 1}b=(b-c)/(a-c);return b*b*(3-2*b)},smootherstep:function(b,c,a){if(b<=c){return 0}if(b>=a){return 1}b=(b-c)/(a-c);return b*b*b*(b*(b*6-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},randFloat:function(a,b){return a+Math.random()*(b-a)},randFloatSpread:function(a){return a*(0.5-Math.random())},sign:function(a){return(a<0)?-1:((a>0)?1:0)},degToRad:function(){var a=Math.PI/180;return function(b){return b*a}}(),radToDeg:function(){var a=180/Math.PI;return function(b){return b*a}}()};THREE.Spline=function(n){this.points=n;var h=[],j={x:0,y:0,z:0},m,a,e,d,b,l,k,i,g;this.initFromArray=function(c){this.points=[];for(var o=0;o<c.length;o++){this.points[o]={x:c[o][0],y:c[o][1],z:c[o][2]}}};this.getPoint=function(c){m=(this.points.length-1)*c;a=Math.floor(m);e=m-a;h[0]=a===0?a:a-1;h[1]=a;h[2]=a>this.points.length-2?this.points.length-1:a+1;h[3]=a>this.points.length-3?this.points.length-1:a+2;l=this.points[h[0]];k=this.points[h[1]];i=this.points[h[2]];g=this.points[h[3]];d=e*e;b=e*d;j.x=f(l.x,k.x,i.x,g.x,e,d,b);j.y=f(l.y,k.y,i.y,g.y,e,d,b);j.z=f(l.z,k.z,i.z,g.z,e,d,b);return j};this.getControlPointsArray=function(){var o,r,c=this.points.length,q=[];for(o=0;o<c;o++){r=this.points[o];q[o]=[r.x,r.y,r.z]}return q};this.getLength=function(p){var r,t,u,s,B=0,c=0,q=0,A=new THREE.Vector3(),o=new THREE.Vector3(),v=[],C=0;v[0]=0;if(!p){p=100}u=this.points.length*p;A.copy(this.points[0]);for(r=1;r<u;r++){t=r/u;s=this.getPoint(t);o.copy(s);C+=o.distanceTo(A);A.copy(s);B=(this.points.length-1)*t;c=Math.floor(B);if(c!=q){v[c]=C;q=c}}v[v.length]=C;return{chunks:v,total:C}};this.reparametrizeByArcLength=function(p){var t,s,A,B,q,o,C,v,u,D=[],c=new THREE.Vector3(),r=this.getLength();D.push(c.copy(this.points[0]).clone());for(t=1;t<this.points.length;t++){C=r.chunks[t]-r.chunks[t-1];v=Math.ceil(p*C/r.total);B=(t-1)/(this.points.length-1);q=t/(this.points.length-1);for(s=1;s<v-1;s++){A=B+s*(1/v)*(q-B);u=this.getPoint(A);D.push(c.copy(u).clone())}D.push(c.copy(this.points[t]).clone())}this.points=D};function f(v,u,r,q,A,o,c){var s=(r-v)*0.5,p=(q-u)*0.5;return(2*(u-r)+s+p)*c+(-3*(u-r)-2*s-p)*o+s*A+u}};THREE.Triangle=function(e,d,f){this.a=(e!==undefined)?e:new THREE.Vector3();this.b=(d!==undefined)?d:new THREE.Vector3();this.c=(f!==undefined)?f:new THREE.Vector3()};THREE.Triangle.normal=function(){var a=new THREE.Vector3();return function(g,e,i,h){var d=h||new THREE.Vector3();d.subVectors(i,e);a.subVectors(g,e);d.cross(a);var f=d.lengthSq();if(f>0){return d.multiplyScalar(1/Math.sqrt(f))}return d.set(0,0,0)}}();THREE.Triangle.barycoordFromPoint=function(){var a=new THREE.Vector3();var c=new THREE.Vector3();var b=new THREE.Vector3();return function(n,m,k,h,r){a.subVectors(h,m);c.subVectors(k,m);b.subVectors(n,m);var l=a.dot(a);var j=a.dot(c);var i=a.dot(b);var f=c.dot(c);var d=c.dot(b);var g=(l*f-j*j);var q=r||new THREE.Vector3();if(g==0){return q.set(-2,-1,-1)}var e=1/g;var p=(f*i-j*d)*e;var o=(l*d-j*i)*e;return q.set(1-p-o,o,p)}}();THREE.Triangle.containsPoint=function(){var a=new THREE.Vector3();return function(f,g,e,h){var d=THREE.Triangle.barycoordFromPoint(f,g,e,h,a);return(d.x>=0)&&(d.y>=0)&&((d.x+d.y)<=1)}}();THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(e,d,f){this.a.copy(e);this.b.copy(d);this.c.copy(f);return this},setFromPointsAndIndices:function(b,d,c,a){this.a.copy(b[d]);this.b.copy(b[c]);this.c.copy(b[a]);return this},copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},area:function(){var a=new THREE.Vector3();var b=new THREE.Vector3();return function(){a.subVectors(this.c,this.b);b.subVectors(this.a,this.b);return a.cross(b).length()*0.5}}(),midpoint:function(b){var a=b||new THREE.Vector3();return a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(a){return THREE.Triangle.normal(this.a,this.b,this.c,a)},plane:function(b){var a=b||new THREE.Plane();return a.setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(a,b){return THREE.Triangle.barycoordFromPoint(a,this.a,this.b,this.c,b)},containsPoint:function(a){return THREE.Triangle.containsPoint(a,this.a,this.b,this.c)},equals:function(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)},clone:function(){return new THREE.Triangle().copy(this)}};THREE.Vertex=function(a){console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead.");return a};THREE.UV=function(b,a){console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead.");return new THREE.Vector2(b,a)};THREE.Clock=function(a){this.autoStart=(a!==undefined)?a:true;this.startTime=0;this.oldTime=0;this.elapsedTime=0;this.running=false};THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.startTime=self.performance!==undefined&&self.performance.now!==undefined?self.performance.now():Date.now();this.oldTime=this.startTime;this.running=true},stop:function(){this.getElapsedTime();this.running=false},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var b=0;if(this.autoStart&&!this.running){this.start()}if(this.running){var a=self.performance!==undefined&&self.performance.now!==undefined?self.performance.now():Date.now();b=0.001*(a-this.oldTime);this.oldTime=a;this.elapsedTime+=b}return b}};THREE.EventDispatcher=function(){};THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,apply:function(a){a.addEventListener=THREE.EventDispatcher.prototype.addEventListener;a.hasEventListener=THREE.EventDispatcher.prototype.hasEventListener;a.removeEventListener=THREE.EventDispatcher.prototype.removeEventListener;a.dispatchEvent=THREE.EventDispatcher.prototype.dispatchEvent},addEventListener:function(b,c){if(this._listeners===undefined){this._listeners={}}var a=this._listeners;if(a[b]===undefined){a[b]=[]}if(a[b].indexOf(c)===-1){a[b].push(c)}},hasEventListener:function(b,c){if(this._listeners===undefined){return false}var a=this._listeners;if(a[b]!==undefined&&a[b].indexOf(c)!==-1){return true}return false},removeEventListener:function(d,e){if(this._listeners===undefined){return}var c=this._listeners;var a=c[d];if(a!==undefined){var b=a.indexOf(e);if(b!==-1){a.splice(b,1)}}},dispatchEvent:function(){var a=[];return function(f){if(this._listeners===undefined){return}var d=this._listeners;var b=d[f.type];if(b!==undefined){f.target=this;var e=b.length;for(var c=0;c<e;c++){a[c]=b[c]}for(var c=0;c<e;c++){a[c].call(this,f)}}}}()};(function(i){i.Raycaster=function(o,q,p,n){this.ray=new i.Ray(o,q);this.near=p||0;this.far=n||Infinity};var e=new i.Sphere();var f=new i.Ray();var j=new i.Plane();var l=new i.Vector3();var h=new i.Vector3();var k=new i.Matrix4();var d=function(o,n){return o.distance-n.distance};var c=new i.Vector3();var b=new i.Vector3();var a=new i.Vector3();var g=function(Y,K,n){if(Y instanceof i.Sprite){h.setFromMatrixPosition(Y.matrixWorld);var q=K.ray.distanceToPoint(h);if(q>Y.scale.x){return n}n.push({distance:q,point:Y.position,face:null,object:Y})}else{if(Y instanceof i.LOD){h.setFromMatrixPosition(Y.matrixWorld);var q=K.ray.origin.distanceTo(h);g(Y.getObjectForDistance(q),K,n)}else{if(Y instanceof i.Mesh){var t=Y.geometry;if(t.boundingSphere===null){t.computeBoundingSphere()}e.copy(t.boundingSphere);e.applyMatrix4(Y.matrixWorld);if(K.ray.isIntersectionSphere(e)===false){return n}k.getInverse(Y.matrixWorld);f.copy(K.ray).applyMatrix4(k);if(t.boundingBox!==null){if(f.isIntersectionBox(t.boundingBox)===false){return n}}if(t instanceof i.BufferGeometry){var I=Y.material;if(I===undefined){return n}if(t.dynamic===false){return n}var V,U,T;var P=K.precision;if(t.attributes.index!==undefined){var v=t.offsets;var u=t.attributes.index.array;var E=t.attributes.position.array;var S=t.offsets.length;var G=t.attributes.index.array.length/3;for(var J=0;J<S;++J){var r=v[J].start;var D=v[J].count;var C=v[J].index;for(var O=r,H=r+D;O<H;O+=3){V=C+u[O];U=C+u[O+1];T=C+u[O+2];c.set(E[V*3],E[V*3+1],E[V*3+2]);b.set(E[U*3],E[U*3+1],E[U*3+2]);a.set(E[T*3],E[T*3+1],E[T*3+2]);if(I.side===i.BackSide){var N=f.intersectTriangle(a,b,c,true)}else{var N=f.intersectTriangle(c,b,a,I.side!==i.DoubleSide)}if(N===null){continue}N.applyMatrix4(Y.matrixWorld);var q=K.ray.origin.distanceTo(N);if(q<P||q<K.near||q>K.far){continue}n.push({distance:q,point:N,face:null,faceIndex:null,object:Y})}}}else{var v=t.offsets;var E=t.attributes.position.array;var S=t.offsets.length;var G=t.attributes.position.array.length;for(var O=0;O<G;O+=3){V=O;U=O+1;T=O+2;c.set(E[V*3],E[V*3+1],E[V*3+2]);b.set(E[U*3],E[U*3+1],E[U*3+2]);a.set(E[T*3],E[T*3+1],E[T*3+2]);if(I.side===i.BackSide){var N=f.intersectTriangle(a,b,c,true)}else{var N=f.intersectTriangle(c,b,a,I.side!==i.DoubleSide)}if(N===null){continue}N.applyMatrix4(Y.matrixWorld);var q=K.ray.origin.distanceTo(N);if(q<P||q<K.near||q>K.far){continue}n.push({distance:q,point:N,face:null,faceIndex:null,object:Y})}}}else{if(t instanceof i.Geometry){var p=Y.material instanceof i.MeshFaceMaterial;var M=p===true?Y.material.materials:null;var V,U,T,R;var P=K.precision;var B=t.vertices;for(var Q=0,G=t.faces.length;Q<G;Q++){var F=t.faces[Q];var I=p===true?M[F.materialIndex]:Y.material;if(I===undefined){continue}V=B[F.a];U=B[F.b];T=B[F.c];if(I.side===i.BackSide){var N=f.intersectTriangle(T,U,V,true)}else{var N=f.intersectTriangle(V,U,T,I.side!==i.DoubleSide)}if(N===null){continue}N.applyMatrix4(Y.matrixWorld);var q=K.ray.origin.distanceTo(N);if(q<P||q<K.near||q>K.far){continue}n.push({distance:q,point:N,face:F,faceIndex:Q,object:Y})}}}}else{if(Y instanceof i.Line){var P=K.linePrecision;var X=P*P;var t=Y.geometry;if(t.boundingSphere===null){t.computeBoundingSphere()}e.copy(t.boundingSphere);e.applyMatrix4(Y.matrixWorld);if(K.ray.isIntersectionSphere(e)===false){return n}k.getInverse(Y.matrixWorld);f.copy(K.ray).applyMatrix4(k);if(t instanceof i.Geometry){var B=t.vertices;var W=B.length;var s=new i.Vector3();var L=new i.Vector3();var A=Y.type===i.LineStrip?1:2;for(var O=0;O<W-1;O=O+A){var o=f.distanceSqToSegment(B[O],B[O+1],L,s);if(o>X){continue}var q=f.origin.distanceTo(L);if(q<K.near||q>K.far){continue}n.push({distance:q,point:s.clone().applyMatrix4(Y.matrixWorld),face:null,faceIndex:null,object:Y})}}}}}}};var m=function(p,o,r){var s=p.getDescendants();for(var q=0,n=s.length;q<n;q++){g(s[q],o,r)}};i.Raycaster.prototype.precision=0.0001;i.Raycaster.prototype.linePrecision=1;i.Raycaster.prototype.set=function(n,o){this.ray.set(n,o)};i.Raycaster.prototype.intersectObject=function(o,n){var p=[];if(n===true){m(o,this,p)}g(o,this,p);p.sort(d);return p};i.Raycaster.prototype.intersectObjects=function(r,o){var q=[];for(var p=0,n=r.length;p<n;p++){g(r[p],this,q);if(o===true){m(r[p],this,q)}}q.sort(d);return q}}(THREE));THREE.Object3D=function(){this.id=THREE.Object3DIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.parent=undefined;this.children=[];this.up=new THREE.Vector3(0,1,0);this.position=new THREE.Vector3();this._rotation=new THREE.Euler();this._quaternion=new THREE.Quaternion();this.scale=new THREE.Vector3(1,1,1);this._rotation._quaternion=this.quaternion;this._quaternion._euler=this.rotation;this.renderDepth=null;this.rotationAutoUpdate=true;this.matrix=new THREE.Matrix4();this.matrixWorld=new THREE.Matrix4();this.matrixAutoUpdate=true;this.matrixWorldNeedsUpdate=true;this.visible=true;this.castShadow=false;this.receiveShadow=false;this.frustumCulled=true;this.userData={}};THREE.Object3D.prototype={constructor:THREE.Object3D,get rotation(){return this._rotation},set rotation(a){this._rotation=a;this._rotation._quaternion=this._quaternion;this._quaternion._euler=this._rotation;this._rotation._updateQuaternion()},get quaternion(){return this._quaternion},set quaternion(a){this._quaternion=a;this._quaternion._euler=this._rotation;this._rotation._quaternion=this._quaternion;this._quaternion._updateEuler()},get eulerOrder(){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");return this.rotation.order},set eulerOrder(a){console.warn("DEPRECATED: Object3D's .eulerOrder has been moved to Object3D's .rotation.order.");this.rotation.order=a},get useQuaternion(){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},set useQuaternion(a){console.warn("DEPRECATED: Object3D's .useQuaternion has been removed. The library now uses quaternions by default.")},applyMatrix:function(){var a=new THREE.Matrix4();return function(b){this.matrix.multiplyMatrices(b,this.matrix);this.position.setFromMatrixPosition(this.matrix);this.scale.setFromMatrixScale(this.matrix);a.extractRotation(this.matrix);this.quaternion.setFromRotationMatrix(a)}}(),setRotationFromAxisAngle:function(a,b){this.quaternion.setFromAxisAngle(a,b)},setRotationFromEuler:function(a){this.quaternion.setFromEuler(a,true)},setRotationFromMatrix:function(a){this.quaternion.setFromRotationMatrix(a)},setRotationFromQuaternion:function(a){this.quaternion.copy(a)},rotateOnAxis:function(){var a=new THREE.Quaternion();return function(b,c){a.setFromAxisAngle(b,c);this.quaternion.multiply(a);return this}}(),rotateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.rotateOnAxis(a,b)}}(),rotateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.rotateOnAxis(a,b)}}(),translateOnAxis:function(){var a=new THREE.Vector3();return function(b,c){a.copy(b);a.applyQuaternion(this.quaternion);this.position.add(a.multiplyScalar(c));return this}}(),translate:function(b,a){console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed.");return this.translateOnAxis(a,b)},translateX:function(){var a=new THREE.Vector3(1,0,0);return function(b){return this.translateOnAxis(a,b)}}(),translateY:function(){var a=new THREE.Vector3(0,1,0);return function(b){return this.translateOnAxis(a,b)}}(),translateZ:function(){var a=new THREE.Vector3(0,0,1);return function(b){return this.translateOnAxis(a,b)}}(),localToWorld:function(a){return a.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var a=new THREE.Matrix4();return function(b){return b.applyMatrix4(a.getInverse(this.matrixWorld))}}(),lookAt:function(){var a=new THREE.Matrix4();return function(b){a.lookAt(b,this.position,this.up);this.quaternion.setFromRotationMatrix(a)}}(),add:function(a){if(a===this){console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");return}if(a instanceof THREE.Object3D){if(a.parent!==undefined){a.parent.remove(a)}a.parent=this;a.dispatchEvent({type:"added"});this.children.push(a);var b=this;while(b.parent!==undefined){b=b.parent}if(b!==undefined&&b instanceof THREE.Scene){b.__addObject(a)}}},remove:function(b){var a=this.children.indexOf(b);if(a!==-1){b.parent=undefined;b.dispatchEvent({type:"removed"});this.children.splice(a,1);var c=this;while(c.parent!==undefined){c=c.parent}if(c!==undefined&&c instanceof THREE.Scene){c.__removeObject(b)}}},traverse:function(c){c(this);for(var b=0,a=this.children.length;b<a;b++){this.children[b].traverse(c)}},getObjectById:function(e,b){for(var c=0,a=this.children.length;c<a;c++){var d=this.children[c];if(d.id===e){return d}if(b===true){d=d.getObjectById(e,b);if(d!==undefined){return d}}}return undefined},getObjectByName:function(c,b){for(var d=0,a=this.children.length;d<a;d++){var e=this.children[d];if(e.name===c){return e}if(b===true){e=e.getObjectByName(c,b);if(e!==undefined){return e}}}return undefined},getChildByName:function(b,a){console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(b,a)},getDescendants:function(c){if(c===undefined){c=[]}Array.prototype.push.apply(c,this.children);for(var b=0,a=this.children.length;b<a;b++){this.children[b].getDescendants(c)}return c},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=true},updateMatrixWorld:function(c){if(this.matrixAutoUpdate===true){this.updateMatrix()}if(this.matrixWorldNeedsUpdate===true||c===true){if(this.parent===undefined){this.matrixWorld.copy(this.matrix)}else{this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)}this.matrixWorldNeedsUpdate=false;c=true}for(var b=0,a=this.children.length;b<a;b++){this.children[b].updateMatrixWorld(c)}},clone:function(b,a){if(b===undefined){b=new THREE.Object3D()}if(a===undefined){a=true}b.name=this.name;b.up.copy(this.up);b.position.copy(this.position);b.quaternion.copy(this.quaternion);b.scale.copy(this.scale);b.renderDepth=this.renderDepth;b.rotationAutoUpdate=this.rotationAutoUpdate;b.matrix.copy(this.matrix);b.matrixWorld.copy(this.matrixWorld);b.matrixAutoUpdate=this.matrixAutoUpdate;b.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;b.visible=this.visible;b.castShadow=this.castShadow;b.receiveShadow=this.receiveShadow;b.frustumCulled=this.frustumCulled;b.userData=JSON.parse(JSON.stringify(this.userData));if(a===true){for(var c=0;c<this.children.length;c++){var d=this.children[c];b.add(d.clone())}}return b}};THREE.EventDispatcher.prototype.apply(THREE.Object3D.prototype);THREE.Object3DIdCount=0;THREE.Projector=function(){var X,I,O=[],p=0,C,c,f=[],b=0,l,Q,N=[],j=0,i,T,V=[],A=0,E,t,e=[],W=0,L={objects:[],sprites:[],lights:[],elements:[]},M=new THREE.Vector3(),K=new THREE.Vector4(),u=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),Y=new THREE.Box3(),S=new Array(3),R=new Array(4),a=new THREE.Matrix4(),g=new THREE.Matrix4(),F,H=new THREE.Matrix4(),r=new THREE.Matrix3(),q=new THREE.Matrix3(),d=new THREE.Vector3(),U=new THREE.Frustum(),v=new THREE.Vector4(),h=new THREE.Vector4();this.projectVector=function(Z,aa){aa.matrixWorldInverse.getInverse(aa.matrixWorld);g.multiplyMatrices(aa.projectionMatrix,aa.matrixWorldInverse);return Z.applyProjection(g)};this.unprojectVector=function(Z,aa){aa.projectionMatrixInverse.getInverse(aa.projectionMatrix);g.multiplyMatrices(aa.matrixWorld,aa.projectionMatrixInverse);return Z.applyProjection(g)};this.pickingRay=function(aa,ab){aa.z=-1;var Z=new THREE.Vector3(aa.x,aa.y,1);this.unprojectVector(aa,ab);this.unprojectVector(Z,ab);Z.sub(aa).normalize();return new THREE.Raycaster(aa,Z)};var o=function(Z){X=n();X.id=Z.id;X.object=Z;if(Z.renderDepth!==null){X.z=Z.renderDepth}else{M.setFromMatrixPosition(Z.matrixWorld);M.applyProjection(g);X.z=M.z}return X};var G=function(aa){if(aa.visible===false){return}if(aa instanceof THREE.Light){L.lights.push(aa)}else{if(aa instanceof THREE.Mesh||aa instanceof THREE.Line){if(aa.frustumCulled===false||U.intersectsObject(aa)===true){L.objects.push(o(aa))}}else{if(aa instanceof THREE.Sprite){L.sprites.push(o(aa))}}}for(var ab=0,Z=aa.children.length;ab<Z;ab++){G(aa.children[ab])}};var P=function(Z,aa){I=0;L.objects.length=0;L.sprites.length=0;L.lights.length=0;G(Z);if(aa===true){L.objects.sort(s)}};this.projectScene=function(al,ai,ao,aa){var ak=false,ay,aq,aw,ag,aC,an,az,aH,aF,am,ax,ar,av,af,Z,ae,ad,ab,at,au,aK,aI,aG,aE,ac,aj;Q=0;T=0;t=0;L.elements.length=0;if(al.autoUpdate===true){al.updateMatrixWorld()}if(ai.parent===undefined){ai.updateMatrixWorld()}a.copy(ai.matrixWorldInverse.getInverse(ai.matrixWorld));g.multiplyMatrices(ai.projectionMatrix,a);q.getNormalMatrix(a);U.setFromMatrix(g);P(al,ao);for(ay=0,aq=L.objects.length;ay<aq;ay++){av=L.objects[ay].object;F=av.matrixWorld;c=0;if(av instanceof THREE.Mesh){af=av.geometry;Z=af.vertices;ae=af.faces;at=af.faceVertexUvs;r.getNormalMatrix(F);ac=av.material instanceof THREE.MeshFaceMaterial;aj=ac===true?av.material:null;for(aw=0,ag=Z.length;aw<ag;aw++){C=B();C.positionWorld.copy(Z[aw]).applyMatrix4(F);C.positionScreen.copy(C.positionWorld).applyMatrix4(g);var aD=1/C.positionScreen.w;C.positionScreen.x*=aD;C.positionScreen.y*=aD;C.positionScreen.z*=aD;C.visible=!(C.positionScreen.x<-1||C.positionScreen.x>1||C.positionScreen.y<-1||C.positionScreen.y>1||C.positionScreen.z<-1||C.positionScreen.z>1)}for(aC=0,an=ae.length;aC<an;aC++){ad=ae[aC];var aA=ac===true?aj.materials[ad.materialIndex]:av.material;if(aA===undefined){continue}var ah=aA.side;aK=f[ad.a];aI=f[ad.b];aG=f[ad.c];S[0]=aK.positionScreen;S[1]=aI.positionScreen;S[2]=aG.positionScreen;if(aK.visible===true||aI.visible===true||aG.visible===true||u.isIntersectionBox(Y.setFromPoints(S))){ak=((aG.positionScreen.x-aK.positionScreen.x)*(aI.positionScreen.y-aK.positionScreen.y)-(aG.positionScreen.y-aK.positionScreen.y)*(aI.positionScreen.x-aK.positionScreen.x))<0;if(ah===THREE.DoubleSide||ak===(ah===THREE.FrontSide)){l=m();l.id=av.id;l.v1.copy(aK);l.v2.copy(aI);l.v3.copy(aG)}else{continue}}else{continue}l.normalModel.copy(ad.normal);if(ak===false&&(ah===THREE.BackSide||ah===THREE.DoubleSide)){l.normalModel.negate()}l.normalModel.applyMatrix3(r).normalize();l.normalModelView.copy(l.normalModel).applyMatrix3(q);l.centroidModel.copy(ad.centroid).applyMatrix4(F);ab=ad.vertexNormals;for(az=0,aH=Math.min(ab.length,3);az<aH;az++){var aJ=l.vertexNormalsModel[az];aJ.copy(ab[az]);if(ak===false&&(ah===THREE.BackSide||ah===THREE.DoubleSide)){aJ.negate()}aJ.applyMatrix3(r).normalize();var aB=l.vertexNormalsModelView[az];aB.copy(aJ).applyMatrix3(q)}l.vertexNormalsLength=ab.length;for(aF=0,am=Math.min(at.length,3);aF<am;aF++){au=at[aF][aC];if(au===undefined){continue}for(ax=0,ar=au.length;ax<ar;ax++){l.uvs[aF][ax]=au[ax]}}l.color=ad.color;l.material=aA;d.copy(l.centroidModel).applyProjection(g);l.z=d.z;L.elements.push(l)}}else{if(av instanceof THREE.Line){H.multiplyMatrices(g,F);Z=av.geometry.vertices;aK=B();aK.positionScreen.copy(Z[0]).applyMatrix4(H);var ap=av.type===THREE.LinePieces?2:1;for(aw=1,ag=Z.length;aw<ag;aw++){aK=B();aK.positionScreen.copy(Z[aw]).applyMatrix4(H);if((aw+1)%ap>0){continue}aI=f[c-2];v.copy(aK.positionScreen);h.copy(aI.positionScreen);if(D(v,h)===true){v.multiplyScalar(1/v.w);h.multiplyScalar(1/h.w);i=J();i.id=av.id;i.v1.positionScreen.copy(v);i.v2.positionScreen.copy(h);i.z=Math.max(v.z,h.z);i.material=av.material;if(av.material.vertexColors===THREE.VertexColors){i.vertexColors[0].copy(av.geometry.colors[aw]);i.vertexColors[1].copy(av.geometry.colors[aw-1])}L.elements.push(i)}}}}}for(ay=0,aq=L.sprites.length;ay<aq;ay++){av=L.sprites[ay].object;F=av.matrixWorld;K.set(F.elements[12],F.elements[13],F.elements[14],1);K.applyMatrix4(g);var aD=1/K.w;K.z*=aD;if(K.z>=-1&&K.z<=1){E=k();E.id=av.id;E.x=K.x*aD;E.y=K.y*aD;E.z=K.z;E.object=av;E.rotation=av.rotation;E.scale.x=av.scale.x*Math.abs(E.x-(K.x+ai.projectionMatrix.elements[0])/(K.w+ai.projectionMatrix.elements[12]));E.scale.y=av.scale.y*Math.abs(E.y-(K.y+ai.projectionMatrix.elements[5])/(K.w+ai.projectionMatrix.elements[13]));E.material=av.material;L.elements.push(E)}}if(aa===true){L.elements.sort(s)}return L};function n(){if(I===p){var Z=new THREE.RenderableObject();O.push(Z);p++;I++;return Z}return O[I++]}function B(){if(c===b){var Z=new THREE.RenderableVertex();f.push(Z);b++;c++;return Z}return f[c++]}function m(){if(Q===j){var Z=new THREE.RenderableFace3();N.push(Z);j++;Q++;return Z}return N[Q++]}function J(){if(T===A){var Z=new THREE.RenderableLine();V.push(Z);A++;T++;return Z}return V[T++]}function k(){if(t===W){var Z=new THREE.RenderableSprite();e.push(Z);W++;t++;return Z}return e[t++]}function s(aa,Z){if(aa.z!==Z.z){return Z.z-aa.z}else{if(aa.id!==Z.id){return aa.id-Z.id}else{return 0}}}function D(ad,ac){var ab=0,ag=1,ae=ad.z+ad.w,aa=ac.z+ac.w,Z=-ad.z+ad.w,af=-ac.z+ac.w;if(ae>=0&&aa>=0&&Z>=0&&af>=0){return true}else{if((ae<0&&aa<0)||(Z<0&&af<0)){return false}else{if(ae<0){ab=Math.max(ab,ae/(ae-aa))}else{if(aa<0){ag=Math.min(ag,ae/(ae-aa))}}if(Z<0){ab=Math.max(ab,Z/(Z-af))}else{if(af<0){ag=Math.min(ag,Z/(Z-af))}}if(ag<ab){return false}else{ad.lerp(ac,ab);ac.lerp(ad,1-ag);return true}}}}};THREE.Face3=function(f,e,i,h,g,d){this.a=f;this.b=e;this.c=i;this.normal=h instanceof THREE.Vector3?h:new THREE.Vector3();this.vertexNormals=h instanceof Array?h:[];this.color=g instanceof THREE.Color?g:new THREE.Color();this.vertexColors=g instanceof Array?g:[];this.vertexTangents=[];this.materialIndex=d!==undefined?d:0;this.centroid=new THREE.Vector3()};THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var c=new THREE.Face3(this.a,this.b,this.c);c.normal.copy(this.normal);c.color.copy(this.color);c.centroid.copy(this.centroid);c.materialIndex=this.materialIndex;var b,a;for(b=0,a=this.vertexNormals.length;b<a;b++){c.vertexNormals[b]=this.vertexNormals[b].clone()}for(b=0,a=this.vertexColors.length;b<a;b++){c.vertexColors[b]=this.vertexColors[b].clone()}for(b=0,a=this.vertexTangents.length;b<a;b++){c.vertexTangents[b]=this.vertexTangents[b].clone()}return c}};THREE.Face4=function(g,f,k,j,i,h,e){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new THREE.Face3(g,f,k,i,h,e)};THREE.Geometry=function(){this.id=THREE.GeometryIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingBox=null;this.boundingSphere=null;this.hasTangents=false;this.dynamic=true;this.verticesNeedUpdate=false;this.elementsNeedUpdate=false;this.uvsNeedUpdate=false;this.normalsNeedUpdate=false;this.tangentsNeedUpdate=false;this.colorsNeedUpdate=false;this.lineDistancesNeedUpdate=false;this.buffersNeedUpdate=false};THREE.Geometry.prototype={constructor:THREE.Geometry,applyMatrix:function(b){var h=new THREE.Matrix3().getNormalMatrix(b);for(var e=0,a=this.vertices.length;e<a;e++){var g=this.vertices[e];g.applyMatrix4(b)}for(var e=0,a=this.faces.length;e<a;e++){var f=this.faces[e];f.normal.applyMatrix3(h).normalize();for(var c=0,d=f.vertexNormals.length;c<d;c++){f.vertexNormals[c].applyMatrix3(h).normalize()}f.centroid.applyMatrix4(b)}if(this.boundingBox instanceof THREE.Box3){this.computeBoundingBox()}if(this.boundingSphere instanceof THREE.Sphere){this.computeBoundingSphere()}},computeCentroids:function(){var c,b,a;for(c=0,b=this.faces.length;c<b;c++){a=this.faces[c];a.centroid.set(0,0,0);a.centroid.add(this.vertices[a.a]);a.centroid.add(this.vertices[a.b]);a.centroid.add(this.vertices[a.c]);a.centroid.divideScalar(3)}},computeFaceNormals:function(){var a=new THREE.Vector3(),i=new THREE.Vector3();for(var h=0,g=this.faces.length;h<g;h++){var e=this.faces[h];var d=this.vertices[e.a];var c=this.vertices[e.b];var b=this.vertices[e.c];a.subVectors(b,c);i.subVectors(d,c);a.cross(i);a.normalize();e.normal.copy(a)}},computeVertexNormals:function(g){var m,d,h,l,k,j;if(this.__tmpVertices===undefined){this.__tmpVertices=new Array(this.vertices.length);j=this.__tmpVertices;for(m=0,d=this.vertices.length;m<d;m++){j[m]=new THREE.Vector3()}for(h=0,l=this.faces.length;h<l;h++){k=this.faces[h];k.vertexNormals=[new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3()]}}else{j=this.__tmpVertices;for(m=0,d=this.vertices.length;m<d;m++){j[m].set(0,0,0)}}if(g){var c,b,a,q;var e=new THREE.Vector3(),p=new THREE.Vector3(),o=new THREE.Vector3(),n=new THREE.Vector3(),i=new THREE.Vector3();for(h=0,l=this.faces.length;h<l;h++){k=this.faces[h];c=this.vertices[k.a];b=this.vertices[k.b];a=this.vertices[k.c];e.subVectors(a,b);p.subVectors(c,b);e.cross(p);j[k.a].add(e);j[k.b].add(e);j[k.c].add(e)}}else{for(h=0,l=this.faces.length;h<l;h++){k=this.faces[h];j[k.a].add(k.normal);j[k.b].add(k.normal);j[k.c].add(k.normal)}}for(m=0,d=this.vertices.length;m<d;m++){j[m].normalize()}for(h=0,l=this.faces.length;h<l;h++){k=this.faces[h];k.vertexNormals[0].copy(j[k.a]);k.vertexNormals[1].copy(j[k.b]);k.vertexNormals[2].copy(j[k.c])}},computeMorphNormals:function(){var e,l,g,m,h;for(g=0,m=this.faces.length;g<m;g++){h=this.faces[g];if(!h.__originalFaceNormal){h.__originalFaceNormal=h.normal.clone()}else{h.__originalFaceNormal.copy(h.normal)}if(!h.__originalVertexNormals){h.__originalVertexNormals=[]}for(e=0,l=h.vertexNormals.length;e<l;e++){if(!h.__originalVertexNormals[e]){h.__originalVertexNormals[e]=h.vertexNormals[e].clone()}else{h.__originalVertexNormals[e].copy(h.vertexNormals[e])}}}var c=new THREE.Geometry();c.faces=this.faces;for(e=0,l=this.morphTargets.length;e<l;e++){if(!this.morphNormals[e]){this.morphNormals[e]={};this.morphNormals[e].faceNormals=[];this.morphNormals[e].vertexNormals=[];var d=this.morphNormals[e].faceNormals;var a=this.morphNormals[e].vertexNormals;var k,b;for(g=0,m=this.faces.length;g<m;g++){h=this.faces[g];k=new THREE.Vector3();b={a:new THREE.Vector3(),b:new THREE.Vector3(),c:new THREE.Vector3()};d.push(k);a.push(b)}}var j=this.morphNormals[e];c.vertices=this.morphTargets[e].vertices;c.computeFaceNormals();c.computeVertexNormals();var k,b;for(g=0,m=this.faces.length;g<m;g++){h=this.faces[g];k=j.faceNormals[g];b=j.vertexNormals[g];k.copy(h.normal);b.a.copy(h.vertexNormals[0]);b.b.copy(h.vertexNormals[1]);b.c.copy(h.vertexNormals[2])}}for(g=0,m=this.faces.length;g<m;g++){h=this.faces[g];h.normal=h.__originalFaceNormal;h.vertexNormals=h.__originalVertexNormals}},computeTangents:function(){var O,m,E,k,N,p,C,g,o,K,H,G,e,d,c,j,h,V,U,A,u,R,Q,s,q,I,F,b,T=[],S=[],a=new THREE.Vector3(),l=new THREE.Vector3(),L=new THREE.Vector3(),P=new THREE.Vector3(),M=new THREE.Vector3(),D;for(E=0,k=this.vertices.length;E<k;E++){T[E]=new THREE.Vector3();S[E]=new THREE.Vector3()}function B(v,i,f,W,t,r,n){K=v.vertices[i];H=v.vertices[f];G=v.vertices[W];e=o[t];d=o[r];c=o[n];j=H.x-K.x;h=G.x-K.x;V=H.y-K.y;U=G.y-K.y;A=H.z-K.z;u=G.z-K.z;R=d.x-e.x;Q=c.x-e.x;s=d.y-e.y;q=c.y-e.y;I=1/(R*q-Q*s);a.set((q*j-s*h)*I,(q*V-s*U)*I,(q*A-s*u)*I);l.set((R*h-Q*j)*I,(R*U-Q*V)*I,(R*u-Q*A)*I);T[i].add(a);T[f].add(a);T[W].add(a);S[i].add(l);S[f].add(l);S[W].add(l)}for(O=0,m=this.faces.length;O<m;O++){g=this.faces[O];o=this.faceVertexUvs[0][O];B(this,g.a,g.b,g.c,0,1,2)}var J=["a","b","c","d"];for(O=0,m=this.faces.length;O<m;O++){g=this.faces[O];for(N=0;N<Math.min(g.vertexNormals.length,3);N++){M.copy(g.vertexNormals[N]);C=g[J[N]];F=T[C];L.copy(F);L.sub(M.multiplyScalar(M.dot(F))).normalize();P.crossVectors(g.vertexNormals[N],F);b=P.dot(S[C]);D=(b<0)?-1:1;g.vertexTangents[N]=new THREE.Vector4(L.x,L.y,L.z,D)}}this.hasTangents=true},computeLineDistances:function(){var e=0;var b=this.vertices;for(var c=0,a=b.length;c<a;c++){if(c>0){e+=b[c].distanceTo(b[c-1])}this.lineDistances[c]=e}},computeBoundingBox:function(){if(this.boundingBox===null){this.boundingBox=new THREE.Box3()}this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){if(this.boundingSphere===null){this.boundingSphere=new THREE.Sphere()}this.boundingSphere.setFromPoints(this.vertices)},mergeVertices:function(){var b={};var a=[],C=[];var f,D;var h=4;var B=Math.pow(10,h);var t,e,d;var c,r,s,A,g;this.__tmpVertices=undefined;for(t=0,e=this.vertices.length;t<e;t++){f=this.vertices[t];D=Math.round(f.x*B)+"_"+Math.round(f.y*B)+"_"+Math.round(f.z*B);if(b[D]===undefined){b[D]=t;a.push(this.vertices[t]);C[t]=a.length-1}else{C[t]=C[b[D]]}}var o=[];for(t=0,e=this.faces.length;t<e;t++){d=this.faces[t];d.a=C[d.a];d.b=C[d.b];d.c=C[d.c];c=[d.a,d.b,d.c];var q=-1;for(var p=0;p<3;p++){if(c[p]==c[(p+1)%3]){q=p;o.push(t);break}}}for(t=o.length-1;t>=0;t--){var m=o[t];this.faces.splice(m,1);for(s=0,A=this.faceVertexUvs.length;s<A;s++){this.faceVertexUvs[s].splice(m,1)}}var l=this.vertices.length-a.length;this.vertices=a;return l},clone:function(){var k=new THREE.Geometry();var h=this.vertices;for(var g=0,l=h.length;g<l;g++){k.vertices.push(h[g].clone())}var c=this.faces;for(var g=0,l=c.length;g<l;g++){k.faces.push(c[g].clone())}var e=this.faceVertexUvs[0];for(var g=0,l=e.length;g<l;g++){var b=e[g],a=[];for(var d=0,f=b.length;d<f;d++){a.push(new THREE.Vector2(b[d].x,b[d].y))}k.faceVertexUvs[0].push(a)}return k},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Geometry.prototype);THREE.GeometryIdCount=0;THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.attributes={};this.dynamic=true;this.offsets=[];this.boundingBox=null;this.boundingSphere=null;this.hasTangents=false;this.morphTargets=[]};THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addAttribute:function(a,c,b,d){this.attributes[a]={itemSize:d,array:new c(b*d)}},applyMatrix:function(b){var a;var c;if(this.attributes.position){a=this.attributes.position.array}if(this.attributes.normal){c=this.attributes.normal.array}if(a!==undefined){b.multiplyVector3Array(a);this.verticesNeedUpdate=true}if(c!==undefined){var d=new THREE.Matrix3().getNormalMatrix(b);d.multiplyVector3Array(c);this.normalizeNormals();this.normalsNeedUpdate=true}},computeBoundingBox:function(){if(this.boundingBox===null){this.boundingBox=new THREE.Box3()}var b=this.attributes.position.array;if(b){var f=this.boundingBox;var a,g,e;if(b.length>=3){f.min.x=f.max.x=b[0];f.min.y=f.max.y=b[1];f.min.z=f.max.z=b[2]}for(var d=3,c=b.length;d<c;d+=3){a=b[d];g=b[d+1];e=b[d+2];if(a<f.min.x){f.min.x=a}else{if(a>f.max.x){f.max.x=a}}if(g<f.min.y){f.min.y=g}else{if(g>f.max.y){f.max.y=g}}if(e<f.min.z){f.min.z=e}else{if(e>f.max.z){f.max.z=e}}}}if(b===undefined||b.length===0){this.boundingBox.min.set(0,0,0);this.boundingBox.max.set(0,0,0)}},computeBoundingSphere:function(){var b=new THREE.Box3();var a=new THREE.Vector3();return function(){if(this.boundingSphere===null){this.boundingSphere=new THREE.Sphere()}var e=this.attributes.position.array;if(e){var c=this.boundingSphere.center;for(var g=0,f=e.length;g<f;g+=3){a.set(e[g],e[g+1],e[g+2]);b.addPoint(a)}b.center(c);var d=0;for(var g=0,f=e.length;g<f;g+=3){a.set(e[g],e[g+1],e[g+2]);d=Math.max(d,c.distanceToSquared(a))}this.boundingSphere.radius=Math.sqrt(d)}}}(),computeVertexNormals:function(){if(this.attributes.position){var t,k;var q,v;var B=this.attributes.position.array.length;if(this.attributes.normal===undefined){this.attributes.normal={itemSize:3,array:new Float32Array(B)}}else{for(t=0,k=this.attributes.normal.array.length;t<k;t++){this.attributes.normal.array[t]=0}}var f=this.attributes.position.array;var m=this.attributes.normal.array;var A,u,s,l,h,g,r=new THREE.Vector3(),p=new THREE.Vector3(),o=new THREE.Vector3(),n=new THREE.Vector3(),C=new THREE.Vector3();if(this.attributes.index){var c=this.attributes.index.array;var b=this.offsets;for(q=0,v=b.length;q<v;++q){var a=b[q].start;var e=b[q].count;var d=b[q].index;for(t=a,k=a+e;t<k;t+=3){A=d+c[t];u=d+c[t+1];s=d+c[t+2];l=f[A*3];h=f[A*3+1];g=f[A*3+2];r.set(l,h,g);l=f[u*3];h=f[u*3+1];g=f[u*3+2];p.set(l,h,g);l=f[s*3];h=f[s*3+1];g=f[s*3+2];o.set(l,h,g);n.subVectors(o,p);C.subVectors(r,p);n.cross(C);m[A*3]+=n.x;m[A*3+1]+=n.y;m[A*3+2]+=n.z;m[u*3]+=n.x;m[u*3+1]+=n.y;m[u*3+2]+=n.z;m[s*3]+=n.x;m[s*3+1]+=n.y;m[s*3+2]+=n.z}}}else{for(t=0,k=f.length;t<k;t+=9){l=f[t];h=f[t+1];g=f[t+2];r.set(l,h,g);l=f[t+3];h=f[t+4];g=f[t+5];p.set(l,h,g);l=f[t+6];h=f[t+7];g=f[t+8];o.set(l,h,g);n.subVectors(o,p);C.subVectors(r,p);n.cross(C);m[t]=n.x;m[t+1]=n.y;m[t+2]=n.z;m[t+3]=n.x;m[t+4]=n.y;m[t+5]=n.z;m[t+6]=n.x;m[t+7]=n.y;m[t+8]=n.z}}this.normalizeNormals();this.normalsNeedUpdate=true}},normalizeNormals:function(){var d=this.attributes.normal.array;var a,g,e,f;for(var c=0,b=d.length;c<b;c+=3){a=d[c];g=d[c+1];e=d[c+2];f=1/Math.sqrt(a*a+g*g+e*e);d[c]*=f;d[c+1]*=f;d[c+2]*=f}},computeTangents:function(){if(this.attributes.index===undefined||this.attributes.position===undefined||this.attributes.normal===undefined||this.attributes.uv===undefined){console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");return}var f=this.attributes.index.array;var s=this.attributes.position.array;var B=this.attributes.normal.array;var T=this.attributes.uv.array;var A=s.length/3;if(this.attributes.tangent===undefined){var C=4*A;this.attributes.tangent={itemSize:4,array:new Float32Array(C)}}var J=this.attributes.tangent.array;var an=[],am=[];for(var ag=0;ag<A;ag++){an[ag]=new THREE.Vector3();am[ag]=new THREE.Vector3()}var m,ae,I,l,ad,H,h,ab,F,g,aa,e,Y,d,W,v,u,ap,ao,R,Q,al,ak,P,O,X;var o=new THREE.Vector3(),L=new THREE.Vector3();function S(j,i,k){m=s[j*3];ae=s[j*3+1];I=s[j*3+2];l=s[i*3];ad=s[i*3+1];H=s[i*3+2];h=s[k*3];ab=s[k*3+1];F=s[k*3+2];g=T[j*2];aa=T[j*2+1];e=T[i*2];Y=T[i*2+1];d=T[k*2];W=T[k*2+1];v=l-m;u=h-m;ap=ad-ae;ao=ab-ae;R=H-I;Q=F-I;al=e-g;ak=d-g;P=Y-aa;O=W-aa;X=1/(al*O-ak*P);o.set((O*v-P*u)*X,(O*ap-P*ao)*X,(O*R-P*Q)*X);L.set((al*u-ak*v)*X,(al*ao-ak*ap)*X,(al*Q-ak*R)*X);an[j].add(o);an[i].add(o);an[k].add(o);am[j].add(L);am[i].add(L);am[k].add(L)}var ai,M;var ah,q;var c,b,a;var E=this.offsets;for(ah=0,q=E.length;ah<q;++ah){var G=E[ah].start;var Z=E[ah].count;var N=E[ah].index;for(ai=G,M=G+Z;ai<M;ai+=3){c=N+f[ai];b=N+f[ai+1];a=N+f[ai+2];S(c,b,a)}}var ac=new THREE.Vector3(),aj=new THREE.Vector3();var af=new THREE.Vector3(),K=new THREE.Vector3();var U,V,p;function D(i){af.x=B[i*3];af.y=B[i*3+1];af.z=B[i*3+2];K.copy(af);V=an[i];ac.copy(V);ac.sub(af.multiplyScalar(af.dot(V))).normalize();aj.crossVectors(K,V);p=aj.dot(am[i]);U=(p<0)?-1:1;J[i*4]=ac.x;J[i*4+1]=ac.y;J[i*4+2]=ac.z;J[i*4+3]=U}for(ah=0,q=E.length;ah<q;++ah){var G=E[ah].start;var Z=E[ah].count;var N=E[ah].index;for(ai=G,M=G+Z;ai<M;ai+=3){c=N+f[ai];b=N+f[ai+1];a=N+f[ai+2];D(c);D(b);D(a)}}this.hasTangents=true;this.tangentsNeedUpdate=true},clone:function(){var j=new THREE.BufferGeometry();var d=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];for(var f in this.attributes){var g=this.attributes[f];var e=g.array;var a={itemSize:g.itemSize,numItems:g.numItems,array:null};for(var c=0,k=d.length;c<k;c++){var h=d[c];if(e instanceof h){a.array=new h(e);break}}j.attributes[f]=a}for(var c=0,k=this.offsets.length;c<k;c++){var b=this.offsets[c];j.offsets.push({start:b.start,index:b.index,count:b.count})}return j},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.BufferGeometry.prototype);THREE.Camera=function(){THREE.Object3D.call(this);this.matrixWorldInverse=new THREE.Matrix4();this.projectionMatrix=new THREE.Matrix4();this.projectionMatrixInverse=new THREE.Matrix4()};THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);THREE.Camera.prototype.lookAt=function(){var a=new THREE.Matrix4();return function(b){a.lookAt(this.position,b,this.up);this.quaternion.setFromRotationMatrix(a)}}();THREE.Camera.prototype.clone=function(a){if(a===undefined){a=new THREE.Camera()}THREE.Object3D.prototype.clone.call(this,a);a.matrixWorldInverse.copy(this.matrixWorldInverse);a.projectionMatrix.copy(this.projectionMatrix);a.projectionMatrixInverse.copy(this.projectionMatrixInverse);return a};THREE.OrthographicCamera=function(f,c,e,b,d,a){THREE.Camera.call(this);this.left=f;this.right=c;this.top=e;this.bottom=b;this.near=(d!==undefined)?d:0.1;this.far=(a!==undefined)?a:2000;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)};THREE.OrthographicCamera.prototype.clone=function(){var a=new THREE.OrthographicCamera();THREE.Camera.prototype.clone.call(this,a);a.left=this.left;a.right=this.right;a.top=this.top;a.bottom=this.bottom;a.near=this.near;a.far=this.far;return a};THREE.PerspectiveCamera=function(c,b,d,a){THREE.Camera.call(this);this.fov=c!==undefined?c:50;this.aspect=b!==undefined?b:1;this.near=d!==undefined?d:0.1;this.far=a!==undefined?a:2000;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);THREE.PerspectiveCamera.prototype.setLens=function(b,a){if(a===undefined){a=24}this.fov=2*THREE.Math.radToDeg(Math.atan(a/(b*2)));this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.setViewOffset=function(e,c,b,f,d,a){this.fullWidth=e;this.fullHeight=c;this.x=b;this.y=f;this.width=d;this.height=a;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var c=this.fullWidth/this.fullHeight;var g=Math.tan(THREE.Math.degToRad(this.fov*0.5))*this.near;var b=-g;var f=c*b;var d=c*g;var e=Math.abs(d-f);var a=Math.abs(g-b);this.projectionMatrix.makeFrustum(f+this.x*e/this.fullWidth,f+(this.x+this.width)*e/this.fullWidth,g-(this.y+this.height)*a/this.fullHeight,g-this.y*a/this.fullHeight,this.near,this.far)}else{this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)}};THREE.PerspectiveCamera.prototype.clone=function(){var a=new THREE.PerspectiveCamera();THREE.Camera.prototype.clone.call(this,a);a.fov=this.fov;a.aspect=this.aspect;a.near=this.near;a.far=this.far;return a};THREE.Light=function(a){THREE.Object3D.call(this);this.color=new THREE.Color(a)};THREE.Light.prototype=Object.create(THREE.Object3D.prototype);THREE.Light.prototype.clone=function(a){if(a===undefined){a=new THREE.Light()}THREE.Object3D.prototype.clone.call(this,a);a.color.copy(this.color);return a};THREE.AmbientLight=function(a){THREE.Light.call(this,a)};THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype);THREE.AmbientLight.prototype.clone=function(){var a=new THREE.AmbientLight();THREE.Light.prototype.clone.call(this,a);return a};THREE.AreaLight=function(b,a){THREE.Light.call(this,b);this.normal=new THREE.Vector3(0,-1,0);this.right=new THREE.Vector3(1,0,0);this.intensity=(a!==undefined)?a:1;this.width=1;this.height=1;this.constantAttenuation=1.5;this.linearAttenuation=0.5;this.quadraticAttenuation=0.1};THREE.AreaLight.prototype=Object.create(THREE.Light.prototype);THREE.DirectionalLight=function(b,a){THREE.Light.call(this,b);this.position.set(0,1,0);this.target=new THREE.Object3D();this.intensity=(a!==undefined)?a:1;this.castShadow=false;this.onlyShadow=false;this.shadowCameraNear=50;this.shadowCameraFar=5000;this.shadowCameraLeft=-500;this.shadowCameraRight=500;this.shadowCameraTop=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=false;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapWidth=512;this.shadowMapHeight=512;this.shadowCascade=false;this.shadowCascadeOffset=new THREE.Vector3(0,0,-1000);this.shadowCascadeCount=2;this.shadowCascadeBias=[0,0,0];this.shadowCascadeWidth=[512,512,512];this.shadowCascadeHeight=[512,512,512];this.shadowCascadeNearZ=[-1,0.99,0.998];this.shadowCascadeFarZ=[0.99,0.998,1];this.shadowCascadeArray=[];this.shadowMap=null;this.shadowMapSize=null;this.shadowCamera=null;this.shadowMatrix=null};THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype);THREE.DirectionalLight.prototype.clone=function(){var a=new THREE.DirectionalLight();THREE.Light.prototype.clone.call(this,a);a.target=this.target.clone();a.intensity=this.intensity;a.castShadow=this.castShadow;a.onlyShadow=this.onlyShadow;return a};THREE.HemisphereLight=function(b,c,a){THREE.Light.call(this,b);this.position.set(0,100,0);this.groundColor=new THREE.Color(c);this.intensity=(a!==undefined)?a:1};THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype);THREE.HemisphereLight.prototype.clone=function(){var a=new THREE.HemisphereLight();THREE.Light.prototype.clone.call(this,a);a.groundColor.copy(this.groundColor);a.intensity=this.intensity;return a};THREE.PointLight=function(b,a,c){THREE.Light.call(this,b);this.intensity=(a!==undefined)?a:1;this.distance=(c!==undefined)?c:0};THREE.PointLight.prototype=Object.create(THREE.Light.prototype);THREE.PointLight.prototype.clone=function(){var a=new THREE.PointLight();THREE.Light.prototype.clone.call(this,a);a.intensity=this.intensity;a.distance=this.distance;return a};THREE.SpotLight=function(b,a,e,d,c){THREE.Light.call(this,b);this.position.set(0,1,0);this.target=new THREE.Object3D();this.intensity=(a!==undefined)?a:1;this.distance=(e!==undefined)?e:0;this.angle=(d!==undefined)?d:Math.PI/3;this.exponent=(c!==undefined)?c:10;this.castShadow=false;this.onlyShadow=false;this.shadowCameraNear=50;this.shadowCameraFar=5000;this.shadowCameraFov=50;this.shadowCameraVisible=false;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapWidth=512;this.shadowMapHeight=512;this.shadowMap=null;this.shadowMapSize=null;this.shadowCamera=null;this.shadowMatrix=null};THREE.SpotLight.prototype=Object.create(THREE.Light.prototype);THREE.SpotLight.prototype.clone=function(){var a=new THREE.SpotLight();THREE.Light.prototype.clone.call(this,a);a.target=this.target.clone();a.intensity=this.intensity;a.distance=this.distance;a.angle=this.angle;a.exponent=this.exponent;a.castShadow=this.castShadow;a.onlyShadow=this.onlyShadow;return a};THREE.Loader=function(a){this.showStatus=a;this.statusDomElement=a?THREE.Loader.prototype.addStatusElement():null;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"anonymous",addStatusElement:function(){var a=document.createElement("div");a.style.position="absolute";a.style.right="0px";a.style.top="0px";a.style.fontSize="0.8em";a.style.textAlign="left";a.style.background="rgba(0,0,0,0.25)";a.style.color="#fff";a.style.width="120px";a.style.padding="0.5em 0.5em 0.5em 0.5em";a.style.zIndex=1000;a.innerHTML="Loading ...";return a},updateProgress:function(a){var b="Loaded ";if(a.total){b+=(100*a.loaded/a.total).toFixed(0)+"%"}else{b+=(a.loaded/1000).toFixed(2)+" KB"}this.statusDomElement.innerHTML=b},extractUrlBase:function(a){var b=a.split("/");b.pop();return(b.length<1?".":b.join("/"))+"/"},initMaterials:function(a,c){var d=[];for(var b=0;b<a.length;++b){d[b]=THREE.Loader.prototype.createMaterial(a[b],c)}return d},needsTangents:function(b){for(var d=0,c=b.length;d<c;d++){var a=b[d];if(a instanceof THREE.ShaderMaterial){return true}}return false},createMaterial:function(f,c){var h=this;function e(q){var m=Math.log(q)/Math.LN2;return Math.floor(m)==m}function a(q){var m=Math.log(q)/Math.LN2;return Math.pow(2,Math.round(m))}function n(q,m){var r=new Image();r.onload=function(){if(!e(this.width)||!e(this.height)){var t=a(this.width);var s=a(this.height);q.image.width=t;q.image.height=s;q.image.getContext("2d").drawImage(this,0,0,t,s)}else{q.image=this}q.needsUpdate=true};r.crossOrigin=h.crossOrigin;r.src=m}function j(B,q,v,r,A,s,m){var u=/\.dds$/i.test(v);var t=c+"/"+v;if(u){var C=THREE.ImageUtils.loadCompressedTexture(t);B[q]=C}else{var C=document.createElement("canvas");B[q]=new THREE.Texture(C)}B[q].sourceFile=v;if(r){B[q].repeat.set(r[0],r[1]);if(r[0]!==1){B[q].wrapS=THREE.RepeatWrapping}if(r[1]!==1){B[q].wrapT=THREE.RepeatWrapping}}if(A){B[q].offset.set(A[0],A[1])}if(s){var D={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};if(D[s[0]]!==undefined){B[q].wrapS=D[s[0]]}if(D[s[1]]!==undefined){B[q].wrapT=D[s[1]]}}if(m){B[q].anisotropy=m}if(!u){n(B[q],t)}}function b(m){return(m[0]*255<<16)+(m[1]*255<<8)+m[2]*255}var d="MeshLambertMaterial";var l={color:15658734,opacity:1,map:null,lightMap:null,normalMap:null,bumpMap:null,wireframe:false};if(f.shading){var k=f.shading.toLowerCase();if(k==="phong"){d="MeshPhongMaterial"}else{if(k==="basic"){d="MeshBasicMaterial"}}}if(f.blending!==undefined&&THREE[f.blending]!==undefined){l.blending=THREE[f.blending]}if(f.transparent!==undefined||f.opacity<1){l.transparent=f.transparent}if(f.depthTest!==undefined){l.depthTest=f.depthTest}if(f.depthWrite!==undefined){l.depthWrite=f.depthWrite}if(f.visible!==undefined){l.visible=f.visible}if(f.flipSided!==undefined){l.side=THREE.BackSide}if(f.doubleSided!==undefined){l.side=THREE.DoubleSide}if(f.wireframe!==undefined){l.wireframe=f.wireframe}if(f.vertexColors!==undefined){if(f.vertexColors==="face"){l.vertexColors=THREE.FaceColors}else{if(f.vertexColors){l.vertexColors=THREE.VertexColors}}}if(f.colorDiffuse){l.color=b(f.colorDiffuse)}else{if(f.DbgColor){l.color=f.DbgColor}}if(f.colorSpecular){l.specular=b(f.colorSpecular)}if(f.colorAmbient){l.ambient=b(f.colorAmbient)}if(f.transparency){l.opacity=f.transparency}if(f.specularCoef){l.shininess=f.specularCoef}if(f.mapDiffuse&&c){j(l,"map",f.mapDiffuse,f.mapDiffuseRepeat,f.mapDiffuseOffset,f.mapDiffuseWrap,f.mapDiffuseAnisotropy)}if(f.mapLight&&c){j(l,"lightMap",f.mapLight,f.mapLightRepeat,f.mapLightOffset,f.mapLightWrap,f.mapLightAnisotropy)}if(f.mapBump&&c){j(l,"bumpMap",f.mapBump,f.mapBumpRepeat,f.mapBumpOffset,f.mapBumpWrap,f.mapBumpAnisotropy)}if(f.mapNormal&&c){j(l,"normalMap",f.mapNormal,f.mapNormalRepeat,f.mapNormalOffset,f.mapNormalWrap,f.mapNormalAnisotropy)}if(f.mapSpecular&&c){j(l,"specularMap",f.mapSpecular,f.mapSpecularRepeat,f.mapSpecularOffset,f.mapSpecularWrap,f.mapSpecularAnisotropy)}if(f.mapBumpScale){l.bumpScale=f.mapBumpScale}if(f.mapNormal){var g=THREE.ShaderLib.normalmap;var o=THREE.UniformsUtils.clone(g.uniforms);o.tNormal.value=l.normalMap;if(f.mapNormalFactor){o.uNormalScale.value.set(f.mapNormalFactor,f.mapNormalFactor)}if(l.map){o.tDiffuse.value=l.map;o.enableDiffuse.value=true}if(l.specularMap){o.tSpecular.value=l.specularMap;o.enableSpecular.value=true}if(l.lightMap){o.tAO.value=l.lightMap;o.enableAO.value=true}o.uDiffuseColor.value.setHex(l.color);o.uSpecularColor.value.setHex(l.specular);o.uAmbientColor.value.setHex(l.ambient);o.uShininess.value=l.shininess;if(l.opacity!==undefined){o.uOpacity.value=l.opacity}var p={fragmentShader:g.fragmentShader,vertexShader:g.vertexShader,uniforms:o,lights:true,fog:true};var i=new THREE.ShaderMaterial(p);if(l.transparent){i.transparent=true}}else{var i=new THREE[d](l)}if(f.DbgName!==undefined){i.name=f.DbgName}return i}};THREE.XHRLoader=function(a){this.manager=(a!==undefined)?a:THREE.DefaultLoadingManager};THREE.XHRLoader.prototype={constructor:THREE.XHRLoader,load:function(a,c,f,e){var b=this;var d=new XMLHttpRequest();if(c!==undefined){d.addEventListener("load",function(g){c(g.target.responseText);b.manager.itemEnd(a)},false)}if(f!==undefined){d.addEventListener("progress",function(g){f(g)},false)}if(e!==undefined){d.addEventListener("error",function(g){e(g)},false)}if(this.crossOrigin!==undefined){d.crossOrigin=this.crossOrigin}d.open("GET",a,true);d.send(null);b.manager.itemStart(a)},setCrossOrigin:function(a){this.crossOrigin=a}};THREE.ImageLoader=function(a){this.manager=(a!==undefined)?a:THREE.DefaultLoadingManager};THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,load:function(a,c,f,d){var b=this;var e=document.createElement("img");if(c!==undefined){e.addEventListener("load",function(g){b.manager.itemEnd(a);c(this)},false)}if(f!==undefined){e.addEventListener("progress",function(g){f(g)},false)}if(d!==undefined){e.addEventListener("error",function(g){d(g)},false)}if(this.crossOrigin!==undefined){e.crossOrigin=this.crossOrigin}e.src=a;b.manager.itemStart(a);return e},setCrossOrigin:function(a){this.crossOrigin=a}};THREE.JSONLoader=function(a){THREE.Loader.call(this,a);this.withCredentials=false};THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype);THREE.JSONLoader.prototype.load=function(a,d,c){var b=this;c=c&&(typeof c==="string")?c:this.extractUrlBase(a);this.onLoadStart();this.loadAjaxJSON(this,a,d,c)};THREE.JSONLoader.prototype.loadAjaxJSON=function(b,a,g,e,d){var f=new XMLHttpRequest();var c=0;f.onreadystatechange=function(){if(f.readyState===f.DONE){if(f.status===200||f.status===0){if(f.responseText){var i=JSON.parse(f.responseText);var h=b.parse(i,e);g(h.geometry,h.materials)}else{console.warn("THREE.JSONLoader: ["+a+"] seems to be unreachable or file there is empty")}b.onLoadComplete()}else{console.error("THREE.JSONLoader: Couldn't load ["+a+"] ["+f.status+"]")}}else{if(f.readyState===f.LOADING){if(d){if(c===0){c=f.getResponseHeader("Content-Length")}d({total:c,loaded:f.responseText.length})}}else{if(f.readyState===f.HEADERS_RECEIVED){if(d!==undefined){c=f.getResponseHeader("Content-Length")}}}}};f.open("GET",a,true);f.withCredentials=this.withCredentials;f.send(null)};THREE.JSONLoader.prototype.parse=function(i,c){var h=this,e=new THREE.Geometry(),d=(i.scale!==undefined)?1/i.scale:1;a(d);f();b(d);e.computeCentroids();e.computeFaceNormals();e.computeBoundingSphere();function a(X){function B(u,j){return u&(1<<j)}var S,R,H,s,r,q,V,K,D,o,I,L,k,U,Q,O,M,T,E,n,m,P,C,W,p,A,J,G,l=i.faces,t=i.vertices,N=i.normals,F=i.colors,Y=0;if(i.uvs!==undefined){for(S=0;S<i.uvs.length;S++){if(i.uvs[S].length){Y++}}for(S=0;S<Y;S++){e.faceVertexUvs[S]=[]}}s=0;r=t.length;while(s<r){T=new THREE.Vector3();T.x=t[s++]*X;T.y=t[s++]*X;T.z=t[s++]*X;e.vertices.push(T)}s=0;r=l.length;while(s<r){o=l[s++];I=B(o,0);L=B(o,1);k=B(o,3);U=B(o,4);Q=B(o,5);O=B(o,6);M=B(o,7);if(I){n=new THREE.Face3();n.a=l[s];n.b=l[s+1];n.c=l[s+3];m=new THREE.Face3();m.a=l[s+1];m.b=l[s+2];m.c=l[s+3];s+=4;if(L){D=l[s++];n.materialIndex=D;m.materialIndex=D}H=e.faces.length;if(k){for(S=0;S<Y;S++){p=i.uvs[S];e.faceVertexUvs[S][H]=[];e.faceVertexUvs[S][H+1]=[];for(R=0;R<4;R++){K=l[s++];J=p[K*2];G=p[K*2+1];A=new THREE.Vector2(J,G);if(R!==2){e.faceVertexUvs[S][H].push(A)}if(R!==0){e.faceVertexUvs[S][H+1].push(A)}}}}if(U){V=l[s++]*3;n.normal.set(N[V++],N[V++],N[V]);m.normal.copy(n.normal)}if(Q){for(S=0;S<4;S++){V=l[s++]*3;W=new THREE.Vector3(N[V++],N[V++],N[V]);if(S!==2){n.vertexNormals.push(W)}if(S!==0){m.vertexNormals.push(W)}}}if(O){q=l[s++];C=F[q];n.color.setHex(C);m.color.setHex(C)}if(M){for(S=0;S<4;S++){q=l[s++];C=F[q];if(S!==2){n.vertexColors.push(new THREE.Color(C))}if(S!==0){m.vertexColors.push(new THREE.Color(C))}}}e.faces.push(n);e.faces.push(m)}else{E=new THREE.Face3();E.a=l[s++];E.b=l[s++];E.c=l[s++];if(L){D=l[s++];E.materialIndex=D}H=e.faces.length;if(k){for(S=0;S<Y;S++){p=i.uvs[S];e.faceVertexUvs[S][H]=[];for(R=0;R<3;R++){K=l[s++];J=p[K*2];G=p[K*2+1];A=new THREE.Vector2(J,G);e.faceVertexUvs[S][H].push(A)}}}if(U){V=l[s++]*3;E.normal.set(N[V++],N[V++],N[V])}if(Q){for(S=0;S<3;S++){V=l[s++]*3;W=new THREE.Vector3(N[V++],N[V++],N[V]);E.vertexNormals.push(W)}}if(O){q=l[s++];E.color.setHex(F[q])}if(M){for(S=0;S<3;S++){q=l[s++];E.vertexColors.push(new THREE.Color(F[q]))}}e.faces.push(E)}}}function f(){var k,j,s,p,o,t,r,q,n,m;if(i.skinWeights){for(k=0,j=i.skinWeights.length;k<j;k+=2){s=i.skinWeights[k];p=i.skinWeights[k+1];o=0;t=0;e.skinWeights.push(new THREE.Vector4(s,p,o,t))}}if(i.skinIndices){for(k=0,j=i.skinIndices.length;k<j;k+=2){r=i.skinIndices[k];q=i.skinIndices[k+1];n=0;m=0;e.skinIndices.push(new THREE.Vector4(r,q,n,m))}}e.bones=i.bones;e.animation=i.animation;e.animations=i.animations}function b(m){if(i.morphTargets!==undefined){var p,n,A,k,r,B;for(p=0,n=i.morphTargets.length;p<n;p++){e.morphTargets[p]={};e.morphTargets[p].name=i.morphTargets[p].name;e.morphTargets[p].vertices=[];r=e.morphTargets[p].vertices;B=i.morphTargets[p].vertices;for(A=0,k=B.length;A<k;A+=3){var q=new THREE.Vector3();q.x=B[A]*m;q.y=B[A+1]*m;q.z=B[A+2]*m;r.push(q)}}}if(i.morphColors!==undefined){var p,n,s,u,t,j,o;for(p=0,n=i.morphColors.length;p<n;p++){e.morphColors[p]={};e.morphColors[p].name=i.morphColors[p].name;e.morphColors[p].colors=[];t=e.morphColors[p].colors;j=i.morphColors[p].colors;for(s=0,u=j.length;s<u;s+=3){o=new THREE.Color(16755200);o.setRGB(j[s],j[s+1],j[s+2]);t.push(o)}}}}if(i.materials===undefined){return{geometry:e}}else{var g=this.initMaterials(i.materials,c);if(this.needsTangents(g)){e.computeTangents()}return{geometry:e,materials:g}}};THREE.LoadingManager=function(c,f,e){var b=this;var a=0,d=0;this.onLoad=c;this.onProgress=f;this.onError=e;this.itemStart=function(g){d++};this.itemEnd=function(g){a++;if(b.onProgress!==undefined){b.onProgress(g,a,d)}if(a===d&&b.onLoad!==undefined){b.onLoad()}}};THREE.DefaultLoadingManager=new THREE.LoadingManager();THREE.BufferGeometryLoader=function(a){this.manager=(a!==undefined)?a:THREE.DefaultLoadingManager};THREE.BufferGeometryLoader.prototype={constructor:THREE.BufferGeometryLoader,load:function(b,d,f,e){var c=this;var a=new THREE.XHRLoader();a.setCrossOrigin(this.crossOrigin);a.load(b,function(g){d(c.parse(JSON.parse(g)))})},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(c){var g=new THREE.BufferGeometry();var a=c.attributes;var f=c.offsets;var d=c.boundingSphere;for(var b in a){var e=a[b];g.attributes[b]={itemSize:e.itemSize,array:new self[e.type](e.array)}}if(f!==undefined){g.offsets=JSON.parse(JSON.stringify(f))}if(d!==undefined){g.boundingSphere=new THREE.Sphere(new THREE.Vector3().fromArray(d.center!==undefined?d.center:[0,0,0]),d.radius)}return g}};THREE.GeometryLoader=function(a){this.manager=(a!==undefined)?a:THREE.DefaultLoadingManager};THREE.GeometryLoader.prototype={constructor:THREE.GeometryLoader,load:function(b,d,f,e){var c=this;var a=new THREE.XHRLoader();a.setCrossOrigin(this.crossOrigin);a.load(b,function(g){d(c.parse(JSON.parse(g)))})},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(a){}};THREE.MaterialLoader=function(a){this.manager=(a!==undefined)?a:THREE.DefaultLoadingManager};THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,load:function(b,d,f,e){var c=this;var a=new THREE.XHRLoader();a.setCrossOrigin(this.crossOrigin);a.load(b,function(g){d(c.parse(JSON.parse(g)))})},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(c){var d=new THREE[c.type];if(c.color!==undefined){d.color.setHex(c.color)}if(c.ambient!==undefined){d.ambient.setHex(c.ambient)}if(c.emissive!==undefined){d.emissive.setHex(c.emissive)}if(c.specular!==undefined){d.specular.setHex(c.specular)}if(c.shininess!==undefined){d.shininess=c.shininess}if(c.vertexColors!==undefined){d.vertexColors=c.vertexColors}if(c.blending!==undefined){d.blending=c.blending}if(c.side!==undefined){d.side=c.side}if(c.opacity!==undefined){d.opacity=c.opacity}if(c.transparent!==undefined){d.transparent=c.transparent}if(c.wireframe!==undefined){d.wireframe=c.wireframe}if(c.materials!==undefined){for(var b=0,a=c.materials.length;b<a;b++){d.materials.push(this.parse(c.materials[b]))}}return d}};THREE.ObjectLoader=function(a){this.manager=(a!==undefined)?a:THREE.DefaultLoadingManager};THREE.ObjectLoader.prototype={constructor:THREE.ObjectLoader,load:function(b,d,f,e){var c=this;var a=new THREE.XHRLoader(c.manager);a.setCrossOrigin(this.crossOrigin);a.load(b,function(g){d(c.parse(JSON.parse(g)))})},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(c){var d=this.parseGeometries(c.geometries);var a=this.parseMaterials(c.materials);var b=this.parseObject(c.object,d,a);return b},parseGeometries:function(d){var e={};if(d!==undefined){var b=new THREE.JSONLoader();var g=new THREE.BufferGeometryLoader();for(var c=0,a=d.length;c<a;c++){var h;var f=d[c];switch(f.type){case"PlaneGeometry":h=new THREE.PlaneGeometry(f.width,f.height,f.widthSegments,f.heightSegments);break;case"CircleGeometry":h=new THREE.CircleGeometry(f.radius,f.segments);break;case"CubeGeometry":h=new THREE.CubeGeometry(f.width,f.height,f.depth,f.widthSegments,f.heightSegments,f.depthSegments);break;case"CylinderGeometry":h=new THREE.CylinderGeometry(f.radiusTop,f.radiusBottom,f.height,f.radialSegments,f.heightSegments,f.openEnded);break;case"SphereGeometry":h=new THREE.SphereGeometry(f.radius,f.widthSegments,f.heightSegments,f.phiStart,f.phiLength,f.thetaStart,f.thetaLength);break;case"IcosahedronGeometry":h=new THREE.IcosahedronGeometry(f.radius,f.detail);break;case"TorusGeometry":h=new THREE.TorusGeometry(f.radius,f.tube,f.radialSegments,f.tubularSegments,f.arc);break;case"TorusKnotGeometry":h=new THREE.TorusKnotGeometry(f.radius,f.tube,f.radialSegments,f.tubularSegments,f.p,f.q,f.heightScale);break;case"BufferGeometry":h=g.parse(f.data);break;case"Geometry":h=b.parse(f.data).geometry;break}h.uuid=f.uuid;if(f.name!==undefined){h.name=f.name}e[f.uuid]=h}}return e},parseMaterials:function(e){var c={};if(e!==undefined){var a=new THREE.MaterialLoader();for(var d=0,b=e.length;d<b;d++){var g=e[d];var f=a.parse(g);f.uuid=g.uuid;if(g.name!==undefined){f.name=g.name}c[g.uuid]=f}}return c},parseObject:function(){var a=new THREE.Matrix4();return function(f,e,b){var c;switch(f.type){case"Scene":c=new THREE.Scene();break;case"PerspectiveCamera":c=new THREE.PerspectiveCamera(f.fov,f.aspect,f.near,f.far);break;case"OrthographicCamera":c=new THREE.OrthographicCamera(f.left,f.right,f.top,f.bottom,f.near,f.far);break;case"AmbientLight":c=new THREE.AmbientLight(f.color);break;case"DirectionalLight":c=new THREE.DirectionalLight(f.color,f.intensity);break;case"PointLight":c=new THREE.PointLight(f.color,f.intensity,f.distance);break;case"SpotLight":c=new THREE.SpotLight(f.color,f.intensity,f.distance,f.angle,f.exponent);break;case"HemisphereLight":c=new THREE.HemisphereLight(f.color,f.groundColor,f.intensity);break;case"Mesh":var g=e[f.geometry];var d=b[f.material];if(g===undefined){console.error("THREE.ObjectLoader: Undefined geometry "+f.geometry)}if(d===undefined){console.error("THREE.ObjectLoader: Undefined material "+f.material)}c=new THREE.Mesh(g,d);break;case"Sprite":var d=b[f.material];if(d===undefined){console.error("THREE.ObjectLoader: Undefined material "+f.material)}c=new THREE.Sprite(d);break;default:c=new THREE.Object3D()}c.uuid=f.uuid;if(f.name!==undefined){c.name=f.name}if(f.matrix!==undefined){a.fromArray(f.matrix);a.decompose(c.position,c.quaternion,c.scale)}else{if(f.position!==undefined){c.position.fromArray(f.position)}if(f.rotation!==undefined){c.rotation.fromArray(f.rotation)}if(f.scale!==undefined){c.scale.fromArray(f.scale)}}if(f.visible!==undefined){c.visible=f.visible}if(f.userData!==undefined){c.userData=f.userData}if(f.children!==undefined){for(var h in f.children){c.add(this.parseObject(f.children[h],e,b))}}return c}}()};THREE.SceneLoader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){};this.callbackSync=function(){};this.callbackProgress=function(){};this.geometryHandlers={};this.hierarchyHandlers={};this.addGeometryHandler("ascii",THREE.JSONLoader)};THREE.SceneLoader.prototype={constructor:THREE.SceneLoader,load:function(b,d,f,e){var c=this;var a=new THREE.XHRLoader(c.manager);a.setCrossOrigin(this.crossOrigin);a.load(b,function(g){c.parse(JSON.parse(g),d,b)})},setCrossOrigin:function(a){this.crossOrigin=a},addGeometryHandler:function(a,b){this.geometryHandlers[a]={loaderClass:b}},addHierarchyHandler:function(a,b){this.hierarchyHandlers[a]={loaderClass:b}},parse:function(Z,a,E){var al=this;var d=THREE.Loader.prototype.extractUrlBase(E);var am,aB,av,B,ap,p,C,aj,ak,f,e,ax,t,S,aC;var af=[];var v=Z;for(var aw in this.geometryHandlers){var g=this.geometryHandlers[aw]["loaderClass"];this.geometryHandlers[aw]["loaderObject"]=new g()}for(var aw in this.hierarchyHandlers){var g=this.hierarchyHandlers[aw]["loaderClass"];this.hierarchyHandlers[aw]["loaderObject"]=new g()}e=0;ax=0;aC={scene:new THREE.Scene(),geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}};if(v.transform){var an=v.transform.position,O=v.transform.rotation,at=v.transform.scale;if(an){aC.scene.position.fromArray(an)}if(O){aC.scene.rotation.fromArray(O)}if(at){aC.scene.scale.fromArray(at)}if(an||O||at){aC.scene.updateMatrix();aC.scene.updateMatrixWorld()}}function I(i,n){if(n=="relativeToHTML"){return i}else{return d+"/"+i}}function az(){ah(aC.scene,v.objects)}function ah(aR,aJ){var aX,a1,aM,aP,n,aF;for(var aG in aJ){var aZ=aC.objects[aG];var aN=aJ[aG];if(aZ===undefined){if(aN.type&&(aN.type in al.hierarchyHandlers)){if(aN.loading===undefined){var aH={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1};var aQ={};for(var aO in aN){if(!(aO in aH)){aQ[aO]=aN[aO]}}aB=aC.materials[aN.material];aN.loading=true;var aS=al.hierarchyHandlers[aN.type]["loaderObject"];if(aS.options){aS.load(I(aN.url,v.urlBaseType),T(aG,aR,aB,aN))}else{aS.load(I(aN.url,v.urlBaseType),T(aG,aR,aB,aN),aQ)}}}else{if(aN.geometry!==undefined){am=aC.geometries[aN.geometry];if(am){var aK=false;aB=aC.materials[aN.material];aK=aB instanceof THREE.ShaderMaterial;aM=aN.position;aP=aN.rotation;n=aN.scale;aX=aN.matrix;aF=aN.quaternion;if(!aN.material){aB=new THREE.MeshFaceMaterial(aC.face_materials[aN.geometry])}if((aB instanceof THREE.MeshFaceMaterial)&&aB.materials.length===0){aB=new THREE.MeshFaceMaterial(aC.face_materials[aN.geometry])}if(aB instanceof THREE.MeshFaceMaterial){for(var aW=0;aW<aB.materials.length;aW++){aK=aK||(aB.materials[aW] instanceof THREE.ShaderMaterial)}}if(aK){am.computeTangents()}if(aN.skin){aZ=new THREE.SkinnedMesh(am,aB)}else{if(aN.morph){aZ=new THREE.MorphAnimMesh(am,aB);if(aN.duration!==undefined){aZ.duration=aN.duration}if(aN.time!==undefined){aZ.time=aN.time}if(aN.mirroredLoop!==undefined){aZ.mirroredLoop=aN.mirroredLoop}if(aB.morphNormals){am.computeMorphNormals()}}else{aZ=new THREE.Mesh(am,aB)}}aZ.name=aG;if(aX){aZ.matrixAutoUpdate=false;aZ.matrix.set(aX[0],aX[1],aX[2],aX[3],aX[4],aX[5],aX[6],aX[7],aX[8],aX[9],aX[10],aX[11],aX[12],aX[13],aX[14],aX[15])}else{aZ.position.fromArray(aM);if(aF){aZ.quaternion.fromArray(aF)}else{aZ.rotation.fromArray(aP)}aZ.scale.fromArray(n)}aZ.visible=aN.visible;aZ.castShadow=aN.castShadow;aZ.receiveShadow=aN.receiveShadow;aR.add(aZ);aC.objects[aG]=aZ}}else{if(aN.type==="AmbientLight"||aN.type==="PointLight"||aN.type==="DirectionalLight"||aN.type==="SpotLight"||aN.type==="HemisphereLight"||aN.type==="AreaLight"){var aV=aN.color;var aL=aN.intensity;var aI=aN.distance;var aY=aN.position;var aU=aN.rotation;switch(aN.type){case"AmbientLight":aj=new THREE.AmbientLight(aV);break;case"PointLight":aj=new THREE.PointLight(aV,aL,aI);aj.position.fromArray(aY);break;case"DirectionalLight":aj=new THREE.DirectionalLight(aV,aL);aj.position.fromArray(aN.direction);break;case"SpotLight":aj=new THREE.SpotLight(aV,aL,aI,1);aj.angle=aN.angle;aj.position.fromArray(aY);aj.target.set(aY[0],aY[1]-aI,aY[2]);aj.target.applyEuler(new THREE.Euler(aU[0],aU[1],aU[2],"XYZ"));break;case"HemisphereLight":aj=new THREE.DirectionalLight(aV,aL,aI);aj.target.set(aY[0],aY[1]-aI,aY[2]);aj.target.applyEuler(new THREE.Euler(aU[0],aU[1],aU[2],"XYZ"));break;case"AreaLight":aj=new THREE.AreaLight(aV,aL);aj.position.fromArray(aY);aj.width=aN.size;aj.height=aN.size_y;break}aR.add(aj);aj.name=aG;aC.lights[aG]=aj;aC.objects[aG]=aj}else{if(aN.type==="PerspectiveCamera"||aN.type==="OrthographicCamera"){aM=aN.position;aP=aN.rotation;aF=aN.quaternion;if(aN.type==="PerspectiveCamera"){av=new THREE.PerspectiveCamera(aN.fov,aN.aspect,aN.near,aN.far)}else{if(aN.type==="OrthographicCamera"){av=new THREE.OrthographicCamera(aN.left,aN.right,aN.top,aN.bottom,aN.near,aN.far)}}av.name=aG;av.position.fromArray(aM);if(aF!==undefined){av.quaternion.fromArray(aF)}else{if(aP!==undefined){av.rotation.fromArray(aP)}}aR.add(av);aC.cameras[aG]=av;aC.objects[aG]=av}else{aM=aN.position;aP=aN.rotation;n=aN.scale;aF=aN.quaternion;aZ=new THREE.Object3D();aZ.name=aG;aZ.position.fromArray(aM);if(aF){aZ.quaternion.fromArray(aF)}else{aZ.rotation.fromArray(aP)}aZ.scale.fromArray(n);aZ.visible=(aN.visible!==undefined)?aN.visible:false;aR.add(aZ);aC.objects[aG]=aZ;aC.empties[aG]=aZ}}}}if(aZ){if(aN.userData!==undefined){for(var a0 in aN.userData){var aT=aN.userData[a0];aZ.userData[a0]=aT}}if(aN.groups!==undefined){for(var aW=0;aW<aN.groups.length;aW++){var aE=aN.groups[aW];if(aC.groups[aE]===undefined){aC.groups[aE]=[]}aC.groups[aE].push(aG)}}}}if(aZ!==undefined&&aN.children!==undefined){ah(aZ,aN.children)}}}function ai(n,i,aE){aC.geometries[aE]=n;aC.face_materials[aE]=i;az()}function ad(aH,aE,aK,aJ,aI){var aF=aI.position;var i=aI.rotation;var n=aI.quaternion;var aL=aI.scale;aH.position.fromArray(aF);if(n){aH.quaternion.fromArray(n)}else{aH.rotation.fromArray(i)}aH.scale.fromArray(aL);if(aJ){aH.traverse(function(aM){aM.material=aJ})}var aG=(aI.visible!==undefined)?aI.visible:true;aH.traverse(function(aM){aM.visible=aG});aK.add(aH);aH.name=aE;aC.objects[aE]=aH;az()}function k(i){return function(aE,n){aE.name=i;ai(aE,n,i);e-=1;al.onLoadComplete();Y()}}function T(aF,n,i,aE){return function(aH){var aG;if(aH.content){aG=aH.content}else{if(aH.dae){aG=aH.scene}else{aG=aH}}ad(aG,aF,n,i,aE);e-=1;al.onLoadComplete();Y()}}function H(i){return function(aE,n){aE.name=i;aC.geometries[i]=aE;aC.face_materials[i]=n}}function Y(){var i={totalModels:t,totalTextures:S,loadedModels:t-e,loadedTextures:S-ax};al.callbackProgress(i,aC);al.onLoadProgress();if(e===0&&ax===0){aD();a(aC)}}function aD(){for(var aE=0;aE<af.length;aE++){var n=af[aE];var aF=aC.objects[n.targetName];if(aF){n.object.target=aF}else{n.object.target=new THREE.Object3D();aC.scene.add(n.object.target)}n.object.target.userData.targetInverse=n.object}}var ag=function(i){ax-=i;Y();al.onLoadComplete()};var r=function(i){return function(){ag(i)}};function N(i,aE){aE(i);if(i.children!==undefined){for(var n in i.children){N(i.children[n],aE)}}}var D,au;for(D in v.fogs){au=v.fogs[D];if(au.type==="linear"){B=new THREE.Fog(0,au.near,au.far)}else{if(au.type==="exp2"){B=new THREE.FogExp2(0,au.density)}}C=au.color;B.color.setRGB(C[0],C[1],C[2]);aC.fogs[D]=B}var X,ac;for(X in v.geometries){ac=v.geometries[X];if(ac.type in this.geometryHandlers){e+=1;al.onLoadStart()}}for(var j in v.objects){N(v.objects[j],function(i){if(i.type&&(i.type in al.hierarchyHandlers)){e+=1;al.onLoadStart()}})}t=e;for(X in v.geometries){ac=v.geometries[X];if(ac.type==="cube"){am=new THREE.CubeGeometry(ac.width,ac.height,ac.depth,ac.widthSegments,ac.heightSegments,ac.depthSegments);am.name=X;aC.geometries[X]=am}else{if(ac.type==="plane"){am=new THREE.PlaneGeometry(ac.width,ac.height,ac.widthSegments,ac.heightSegments);am.name=X;aC.geometries[X]=am}else{if(ac.type==="sphere"){am=new THREE.SphereGeometry(ac.radius,ac.widthSegments,ac.heightSegments);am.name=X;aC.geometries[X]=am}else{if(ac.type==="cylinder"){am=new THREE.CylinderGeometry(ac.topRad,ac.botRad,ac.height,ac.radSegs,ac.heightSegs);am.name=X;aC.geometries[X]=am}else{if(ac.type==="torus"){am=new THREE.TorusGeometry(ac.radius,ac.tube,ac.segmentsR,ac.segmentsT);am.name=X;aC.geometries[X]=am}else{if(ac.type==="icosahedron"){am=new THREE.IcosahedronGeometry(ac.radius,ac.subdivisions);am.name=X;aC.geometries[X]=am}else{if(ac.type in this.geometryHandlers){var V={};for(var L in ac){if(L!=="type"&&L!=="url"){V[L]=ac[L]}}var J=this.geometryHandlers[ac.type]["loaderObject"];J.load(I(ac.url,v.urlBaseType),k(X),V)}else{if(ac.type==="embedded"){var m=v.embeds[ac.id],b="";m.metadata=v.metadata;if(m){var Q=this.geometryHandlers.ascii["loaderObject"];var F=Q.parse(m,b);H(X)(F.geometry,F.materials)}}}}}}}}}}var ao,ab;for(ao in v.textures){ab=v.textures[ao];if(ab.url instanceof Array){ax+=ab.url.length;for(var P=0;P<ab.url.length;P++){al.onLoadStart()}}else{ax+=1;al.onLoadStart()}}S=ax;for(ao in v.textures){ab=v.textures[ao];if(ab.mapping!==undefined&&THREE[ab.mapping]!==undefined){ab.mapping=new THREE[ab.mapping]()}if(ab.url instanceof Array){var h=ab.url.length;var M=[];for(var R=0;R<h;R++){M[R]=I(ab.url[R],v.urlBaseType)}var l=/\.dds$/i.test(M[0]);if(l){ap=THREE.ImageUtils.loadCompressedTextureCube(M,ab.mapping,r(h))}else{ap=THREE.ImageUtils.loadTextureCube(M,ab.mapping,r(h))}}else{var l=/\.dds$/i.test(ab.url);var ar=I(ab.url,v.urlBaseType);var aA=r(1);if(l){ap=THREE.ImageUtils.loadCompressedTexture(ar,ab.mapping,aA)}else{ap=THREE.ImageUtils.loadTexture(ar,ab.mapping,aA)}if(THREE[ab.minFilter]!==undefined){ap.minFilter=THREE[ab.minFilter]}if(THREE[ab.magFilter]!==undefined){ap.magFilter=THREE[ab.magFilter]}if(ab.anisotropy){ap.anisotropy=ab.anisotropy}if(ab.repeat){ap.repeat.set(ab.repeat[0],ab.repeat[1]);if(ab.repeat[0]!==1){ap.wrapS=THREE.RepeatWrapping}if(ab.repeat[1]!==1){ap.wrapT=THREE.RepeatWrapping}}if(ab.offset){ap.offset.set(ab.offset[0],ab.offset[1])}if(ab.wrap){var U={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping};if(U[ab.wrap[0]]!==undefined){ap.wrapS=U[ab.wrap[0]]}if(U[ab.wrap[1]]!==undefined){ap.wrapT=U[ab.wrap[1]]}}}aC.textures[ao]=ap}var s,ay;var ae;for(s in v.materials){ay=v.materials[s];for(ae in ay.parameters){if(ae==="envMap"||ae==="map"||ae==="lightMap"||ae==="bumpMap"){ay.parameters[ae]=aC.textures[ay.parameters[ae]]}else{if(ae==="shading"){ay.parameters[ae]=(ay.parameters[ae]==="flat")?THREE.FlatShading:THREE.SmoothShading}else{if(ae==="side"){if(ay.parameters[ae]=="double"){ay.parameters[ae]=THREE.DoubleSide}else{if(ay.parameters[ae]=="back"){ay.parameters[ae]=THREE.BackSide}else{ay.parameters[ae]=THREE.FrontSide}}}else{if(ae==="blending"){ay.parameters[ae]=ay.parameters[ae] in THREE?THREE[ay.parameters[ae]]:THREE.NormalBlending}else{if(ae==="combine"){ay.parameters[ae]=ay.parameters[ae] in THREE?THREE[ay.parameters[ae]]:THREE.MultiplyOperation}else{if(ae==="vertexColors"){if(ay.parameters[ae]=="face"){ay.parameters[ae]=THREE.FaceColors}else{if(ay.parameters[ae]){ay.parameters[ae]=THREE.VertexColors}}}else{if(ae==="wrapRGB"){var aa=ay.parameters[ae];ay.parameters[ae]=new THREE.Vector3(aa[0],aa[1],aa[2])}}}}}}}}if(ay.parameters.opacity!==undefined&&ay.parameters.opacity<1){ay.parameters.transparent=true}if(ay.parameters.normalMap){var aq=THREE.ShaderLib.normalmap;var u=THREE.UniformsUtils.clone(aq.uniforms);var o=ay.parameters.color;var c=ay.parameters.specular;var K=ay.parameters.ambient;var W=ay.parameters.shininess;u.tNormal.value=aC.textures[ay.parameters.normalMap];if(ay.parameters.normalScale){u.uNormalScale.value.set(ay.parameters.normalScale[0],ay.parameters.normalScale[1])}if(ay.parameters.map){u.tDiffuse.value=ay.parameters.map;u.enableDiffuse.value=true}if(ay.parameters.envMap){u.tCube.value=ay.parameters.envMap;u.enableReflection.value=true;u.uReflectivity.value=ay.parameters.reflectivity}if(ay.parameters.lightMap){u.tAO.value=ay.parameters.lightMap;u.enableAO.value=true}if(ay.parameters.specularMap){u.tSpecular.value=aC.textures[ay.parameters.specularMap];u.enableSpecular.value=true}if(ay.parameters.displacementMap){u.tDisplacement.value=aC.textures[ay.parameters.displacementMap];u.enableDisplacement.value=true;u.uDisplacementBias.value=ay.parameters.displacementBias;u.uDisplacementScale.value=ay.parameters.displacementScale}u.uDiffuseColor.value.setHex(o);u.uSpecularColor.value.setHex(c);u.uAmbientColor.value.setHex(K);u.uShininess.value=W;if(ay.parameters.opacity){u.uOpacity.value=ay.parameters.opacity}var G={fragmentShader:aq.fragmentShader,vertexShader:aq.vertexShader,uniforms:u,lights:true,fog:true};aB=new THREE.ShaderMaterial(G)}else{aB=new THREE[ay.type](ay.parameters)}aB.name=s;aC.materials[s]=aB}for(s in v.materials){ay=v.materials[s];if(ay.parameters.materials){var A=[];for(var R=0;R<ay.parameters.materials.length;R++){var q=ay.parameters.materials[R];A.push(aC.materials[q])}aC.materials[s].materials=A}}az();if(aC.cameras&&v.defaults.camera){aC.currentCamera=aC.cameras[v.defaults.camera]}if(aC.fogs&&v.defaults.fog){aC.scene.fog=aC.fogs[v.defaults.fog]}al.callbackSync(aC);Y()}};THREE.TextureLoader=function(a){this.manager=(a!==undefined)?a:THREE.DefaultLoadingManager};THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,load:function(b,d,f,e){var c=this;var a=new THREE.ImageLoader(c.manager);a.setCrossOrigin(this.crossOrigin);a.load(b,function(h){var g=new THREE.Texture(h);g.needsUpdate=true;if(d!==undefined){d(g)}})},setCrossOrigin:function(a){this.crossOrigin=a}};THREE.Material=function(){this.id=THREE.MaterialIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.side=THREE.FrontSide;this.opacity=1;this.transparent=false;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.depthTest=true;this.depthWrite=true;this.polygonOffset=false;this.polygonOffsetFactor=0;this.polygonOffsetUnits=0;this.alphaTest=0;this.overdraw=0;this.visible=true;this.needsUpdate=true};THREE.Material.prototype={constructor:THREE.Material,setValues:function(a){if(a===undefined){return}for(var b in a){var d=a[b];if(d===undefined){console.warn("THREE.Material: '"+b+"' parameter is undefined.");continue}if(b in this){var c=this[b];if(c instanceof THREE.Color){c.set(d)}else{if(c instanceof THREE.Vector3&&d instanceof THREE.Vector3){c.copy(d)}else{if(b=="overdraw"){this[b]=Number(d)}else{this[b]=d}}}}}},clone:function(a){if(a===undefined){a=new THREE.Material()}a.name=this.name;a.side=this.side;a.opacity=this.opacity;a.transparent=this.transparent;a.blending=this.blending;a.blendSrc=this.blendSrc;a.blendDst=this.blendDst;a.blendEquation=this.blendEquation;a.depthTest=this.depthTest;a.depthWrite=this.depthWrite;a.polygonOffset=this.polygonOffset;a.polygonOffsetFactor=this.polygonOffsetFactor;a.polygonOffsetUnits=this.polygonOffsetUnits;a.alphaTest=this.alphaTest;a.overdraw=this.overdraw;a.visible=this.visible;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Material.prototype);THREE.MaterialIdCount=0;THREE.LineBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.linewidth=1;this.linecap="round";this.linejoin="round";this.vertexColors=false;this.fog=true;this.setValues(a)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineBasicMaterial.prototype.clone=function(){var a=new THREE.LineBasicMaterial();THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.linecap=this.linecap;a.linejoin=this.linejoin;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};THREE.LineDashedMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.linewidth=1;this.scale=1;this.dashSize=3;this.gapSize=1;this.vertexColors=false;this.fog=true;this.setValues(a)};THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineDashedMaterial.prototype.clone=function(){var a=new THREE.LineDashedMaterial();THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.linewidth=this.linewidth;a.scale=this.scale;a.dashSize=this.dashSize;a.gapSize=this.gapSize;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};THREE.MeshBasicMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=null;this.lightMap=null;this.specularMap=null;this.envMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=true;this.shading=THREE.SmoothShading;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.vertexColors=THREE.NoColors;this.skinning=false;this.morphTargets=false;this.setValues(a)};THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshBasicMaterial.prototype.clone=function(){var a=new THREE.MeshBasicMaterial();THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;return a};THREE.MeshLambertMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.wrapAround=false;this.wrapRGB=new THREE.Vector3(1,1,1);this.map=null;this.lightMap=null;this.specularMap=null;this.envMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=true;this.shading=THREE.SmoothShading;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.vertexColors=THREE.NoColors;this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(a)};THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshLambertMaterial.prototype.clone=function(){var a=new THREE.MeshLambertMaterial();THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};THREE.MeshPhongMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.specular=new THREE.Color(1118481);this.shininess=30;this.metal=false;this.perPixel=true;this.wrapAround=false;this.wrapRGB=new THREE.Vector3(1,1,1);this.map=null;this.lightMap=null;this.bumpMap=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.specularMap=null;this.envMap=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=true;this.shading=THREE.SmoothShading;this.wireframe=false;this.wireframeLinewidth=1;this.wireframeLinecap="round";this.wireframeLinejoin="round";this.vertexColors=THREE.NoColors;this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.setValues(a)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshPhongMaterial.prototype.clone=function(){var a=new THREE.MeshPhongMaterial();THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.specular.copy(this.specular);a.shininess=this.shininess;a.metal=this.metal;a.perPixel=this.perPixel;a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.bumpMap=this.bumpMap;a.bumpScale=this.bumpScale;a.normalMap=this.normalMap;a.normalScale.copy(this.normalScale);a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.wireframeLinecap=this.wireframeLinecap;a.wireframeLinejoin=this.wireframeLinejoin;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};THREE.MeshDepthMaterial=function(a){THREE.Material.call(this);this.wireframe=false;this.wireframeLinewidth=1;this.setValues(a)};THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshDepthMaterial.prototype.clone=function(){var a=new THREE.MeshDepthMaterial();THREE.Material.prototype.clone.call(this,a);a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};THREE.MeshNormalMaterial=function(a){THREE.Material.call(this,a);this.shading=THREE.FlatShading;this.wireframe=false;this.wireframeLinewidth=1;this.morphTargets=false;this.setValues(a)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshNormalMaterial.prototype.clone=function(){var a=new THREE.MeshNormalMaterial();THREE.Material.prototype.clone.call(this,a);a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;return a};THREE.MeshFaceMaterial=function(a){this.materials=a instanceof Array?a:[]};THREE.MeshFaceMaterial.prototype.clone=function(){var b=new THREE.MeshFaceMaterial();for(var a=0;a<this.materials.length;a++){b.materials.push(this.materials[a].clone())}return b};THREE.ParticleSystemMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=null;this.size=1;this.sizeAttenuation=true;this.vertexColors=false;this.fog=true;this.setValues(a)};THREE.ParticleSystemMaterial.prototype=Object.create(THREE.Material.prototype);THREE.ParticleSystemMaterial.prototype.clone=function(){var a=new THREE.ParticleSystemMaterial();THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.size=this.size;a.sizeAttenuation=this.sizeAttenuation;a.vertexColors=this.vertexColors;a.fog=this.fog;return a};THREE.ParticleBasicMaterial=THREE.ParticleSystemMaterial;THREE.ShaderMaterial=function(a){THREE.Material.call(this);this.fragmentShader="void main() {}";this.vertexShader="void main() {}";this.uniforms={};this.defines={};this.attributes=null;this.shading=THREE.SmoothShading;this.linewidth=1;this.wireframe=false;this.wireframeLinewidth=1;this.fog=false;this.lights=false;this.vertexColors=THREE.NoColors;this.skinning=false;this.morphTargets=false;this.morphNormals=false;this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName="position";this.setValues(a)};THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype);THREE.ShaderMaterial.prototype.clone=function(){var a=new THREE.ShaderMaterial();THREE.Material.prototype.clone.call(this,a);a.fragmentShader=this.fragmentShader;a.vertexShader=this.vertexShader;a.uniforms=THREE.UniformsUtils.clone(this.uniforms);a.attributes=this.attributes;a.defines=this.defines;a.shading=this.shading;a.wireframe=this.wireframe;a.wireframeLinewidth=this.wireframeLinewidth;a.fog=this.fog;a.lights=this.lights;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};THREE.SpriteMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=null;this.rotation=0;this.fog=false;this.uvOffset=new THREE.Vector2(0,0);this.uvScale=new THREE.Vector2(1,1);this.setValues(a)};THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype);THREE.SpriteMaterial.prototype.clone=function(){var a=new THREE.SpriteMaterial();THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.rotation=this.rotation;a.uvOffset.copy(this.uvOffset);a.uvScale.copy(this.uvScale);a.fog=this.fog;return a};THREE.SpriteCanvasMaterial=function(a){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.program=function(c,b){};this.setValues(a)};THREE.SpriteCanvasMaterial.prototype=Object.create(THREE.Material.prototype);THREE.SpriteCanvasMaterial.prototype.clone=function(){var a=new THREE.SpriteCanvasMaterial();THREE.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.program=this.program;return a};THREE.ParticleCanvasMaterial=THREE.SpriteCanvasMaterial;THREE.Texture=function(d,b,f,e,i,c,h,g,a){this.id=THREE.TextureIdCount++;this.uuid=THREE.Math.generateUUID();this.name="";this.image=d;this.mipmaps=[];this.mapping=b!==undefined?b:new THREE.UVMapping();this.wrapS=f!==undefined?f:THREE.ClampToEdgeWrapping;this.wrapT=e!==undefined?e:THREE.ClampToEdgeWrapping;this.magFilter=i!==undefined?i:THREE.LinearFilter;this.minFilter=c!==undefined?c:THREE.LinearMipMapLinearFilter;this.anisotropy=a!==undefined?a:1;this.format=h!==undefined?h:THREE.RGBAFormat;this.type=g!==undefined?g:THREE.UnsignedByteType;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=true;this.premultiplyAlpha=false;this.flipY=true;this.unpackAlignment=4;this.needsUpdate=false;this.onUpdate=null};THREE.Texture.prototype={constructor:THREE.Texture,clone:function(a){if(a===undefined){a=new THREE.Texture()}a.image=this.image;a.mipmaps=this.mipmaps.slice(0);a.mapping=this.mapping;a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.format=this.format;a.type=this.type;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.generateMipmaps=this.generateMipmaps;a.premultiplyAlpha=this.premultiplyAlpha;a.flipY=this.flipY;a.unpackAlignment=this.unpackAlignment;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.Texture.prototype);THREE.TextureIdCount=0;THREE.CompressedTexture=function(e,d,k,i,h,b,g,f,j,c,a){THREE.Texture.call(this,null,b,g,f,j,c,i,h,a);this.image={width:d,height:k};this.mipmaps=e;this.generateMipmaps=false};THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CompressedTexture.prototype.clone=function(){var a=new THREE.CompressedTexture();THREE.Texture.prototype.clone.call(this,a);return a};THREE.DataTexture=function(f,d,k,i,h,b,g,e,j,c,a){THREE.Texture.call(this,null,b,g,e,j,c,i,h,a);this.image={data:f,width:d,height:k}};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);THREE.DataTexture.prototype.clone=function(){var a=new THREE.DataTexture();THREE.Texture.prototype.clone.call(this,a);return a};THREE.ParticleSystem=function(b,a){THREE.Object3D.call(this);this.geometry=b!==undefined?b:new THREE.Geometry();this.material=a!==undefined?a:new THREE.ParticleSystemMaterial({color:Math.random()*16777215});this.sortParticles=false;this.frustumCulled=false};THREE.ParticleSystem.prototype=Object.create(THREE.Object3D.prototype);THREE.ParticleSystem.prototype.clone=function(a){if(a===undefined){a=new THREE.ParticleSystem(this.geometry,this.material)}a.sortParticles=this.sortParticles;THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Line=function(c,b,a){THREE.Object3D.call(this);this.geometry=c!==undefined?c:new THREE.Geometry();this.material=b!==undefined?b:new THREE.LineBasicMaterial({color:Math.random()*16777215});this.type=(a!==undefined)?a:THREE.LineStrip};THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=Object.create(THREE.Object3D.prototype);THREE.Line.prototype.clone=function(a){if(a===undefined){a=new THREE.Line(this.geometry,this.material,this.type)}THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Mesh=function(b,a){THREE.Object3D.call(this);this.geometry=b!==undefined?b:new THREE.Geometry();this.material=a!==undefined?a:new THREE.MeshBasicMaterial({color:Math.random()*16777215});this.updateMorphTargets()};THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);THREE.Mesh.prototype.updateMorphTargets=function(){if(this.geometry.morphTargets.length>0){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var a=0,b=this.geometry.morphTargets.length;a<b;a++){this.morphTargetInfluences.push(0);this.morphTargetDictionary[this.geometry.morphTargets[a].name]=a}}};THREE.Mesh.prototype.getMorphTargetIndexByName=function(a){if(this.morphTargetDictionary[a]!==undefined){return this.morphTargetDictionary[a]}console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+a+" does not exist. Returning 0.");return 0};THREE.Mesh.prototype.clone=function(a){if(a===undefined){a=new THREE.Mesh(this.geometry,this.material)}THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Bone=function(a){THREE.Object3D.call(this);this.skin=a;this.skinMatrix=new THREE.Matrix4()};THREE.Bone.prototype=Object.create(THREE.Object3D.prototype);THREE.Bone.prototype.update=function(d,b){if(this.matrixAutoUpdate){b|=this.updateMatrix()}if(b||this.matrixWorldNeedsUpdate){if(d){this.skinMatrix.multiplyMatrices(d,this.matrix)}else{this.skinMatrix.copy(this.matrix)}this.matrixWorldNeedsUpdate=false;b=true}var e,c,a=this.children.length;for(c=0;c<a;c++){this.children[c].update(this.skinMatrix,b)}};THREE.SkinnedMesh=function(f,e,d){THREE.Mesh.call(this,f,e);this.useVertexTexture=d!==undefined?d:true;this.identityMatrix=new THREE.Matrix4();this.bones=[];this.boneMatrices=[];var g,i,j,c,a,l;if(this.geometry&&this.geometry.bones!==undefined){for(g=0;g<this.geometry.bones.length;g++){j=this.geometry.bones[g];c=j.pos;a=j.rotq;l=j.scl;i=this.addBone();i.name=j.name;i.position.set(c[0],c[1],c[2]);i.quaternion.set(a[0],a[1],a[2],a[3]);if(l!==undefined){i.scale.set(l[0],l[1],l[2])}else{i.scale.set(1,1,1)}}for(g=0;g<this.bones.length;g++){j=this.geometry.bones[g];i=this.bones[g];if(j.parent===-1){this.add(i)}else{this.bones[j.parent].add(i)}}var h=this.bones.length;if(this.useVertexTexture){var k;if(h>256){k=64}else{if(h>64){k=32}else{if(h>16){k=16}else{k=8}}}this.boneTextureWidth=k;this.boneTextureHeight=k;this.boneMatrices=new Float32Array(this.boneTextureWidth*this.boneTextureHeight*4);this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType);this.boneTexture.minFilter=THREE.NearestFilter;this.boneTexture.magFilter=THREE.NearestFilter;this.boneTexture.generateMipmaps=false;this.boneTexture.flipY=false}else{this.boneMatrices=new Float32Array(16*h)}this.pose()}};THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.SkinnedMesh.prototype.addBone=function(a){if(a===undefined){a=new THREE.Bone(this)}this.bones.push(a);return a};THREE.SkinnedMesh.prototype.updateMatrixWorld=function(){var a=new THREE.Matrix4();return function(g){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||g){if(this.parent){this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)}else{this.matrixWorld.copy(this.matrix)}this.matrixWorldNeedsUpdate=false;g=true}for(var f=0,e=this.children.length;f<e;f++){var j=this.children[f];if(j instanceof THREE.Bone){j.update(this.identityMatrix,false)}else{j.updateMatrixWorld(true)}}if(this.boneInverses==undefined){this.boneInverses=[];for(var c=0,h=this.bones.length;c<h;c++){var d=new THREE.Matrix4();d.getInverse(this.bones[c].skinMatrix);this.boneInverses.push(d)}}for(var c=0,h=this.bones.length;c<h;c++){a.multiplyMatrices(this.bones[c].skinMatrix,this.boneInverses[c]);a.flattenToArrayOffset(this.boneMatrices,c*16)}if(this.useVertexTexture){this.boneTexture.needsUpdate=true}}}();THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(true);this.normalizeSkinWeights()};THREE.SkinnedMesh.prototype.normalizeSkinWeights=function(){if(this.geometry instanceof THREE.Geometry){for(var b=0;b<this.geometry.skinIndices.length;b++){var a=this.geometry.skinWeights[b];var c=1/a.lengthManhattan();if(c!==Infinity){a.multiplyScalar(c)}else{a.set(1)}}}else{}};THREE.SkinnedMesh.prototype.clone=function(a){if(a===undefined){a=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture)}THREE.Mesh.prototype.clone.call(this,a);return a};THREE.MorphAnimMesh=function(b,a){THREE.Mesh.call(this,b,a);this.duration=1000;this.mirroredLoop=false;this.time=0;this.lastKeyframe=0;this.currentKeyframe=0;this.direction=1;this.directionBackwards=false;this.setFrameRange(0,this.geometry.morphTargets.length-1)};THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.MorphAnimMesh.prototype.setFrameRange=function(b,a){this.startKeyframe=b;this.endKeyframe=a;this.length=this.endKeyframe-this.startKeyframe+1};THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1;this.directionBackwards=false};THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1;this.directionBackwards=true};THREE.MorphAnimMesh.prototype.parseAnimations=function(){var g=this.geometry;if(!g.animations){g.animations={}}var a,l=g.animations;var f=/([a-z]+)(\d+)/;for(var d=0,j=g.morphTargets.length;d<j;d++){var k=g.morphTargets[d];var c=k.name.match(f);if(c&&c.length>1){var h=c[1];var e=c[2];if(!l[h]){l[h]={start:Infinity,end:-Infinity}}var b=l[h];if(d<b.start){b.start=d}if(d>b.end){b.end=d}if(!a){a=h}}}g.firstAnimation=a};THREE.MorphAnimMesh.prototype.setAnimationLabel=function(b,c,a){if(!this.geometry.animations){this.geometry.animations={}}this.geometry.animations[b]={start:c,end:a}};THREE.MorphAnimMesh.prototype.playAnimation=function(a,c){var b=this.geometry.animations[a];if(b){this.setFrameRange(b.start,b.end);this.duration=1000*((b.end-b.start)/c);this.time=0}else{console.warn("animation["+a+"] undefined")}};THREE.MorphAnimMesh.prototype.updateAnimation=function(d){var c=this.duration/this.length;this.time+=this.direction*d;if(this.mirroredLoop){if(this.time>this.duration||this.time<0){this.direction*=-1;if(this.time>this.duration){this.time=this.duration;this.directionBackwards=true}if(this.time<0){this.time=0;this.directionBackwards=false}}}else{this.time=this.time%this.duration;if(this.time<0){this.time+=this.duration}}var a=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/c),0,this.length-1);if(a!==this.currentKeyframe){this.morphTargetInfluences[this.lastKeyframe]=0;this.morphTargetInfluences[this.currentKeyframe]=1;this.morphTargetInfluences[a]=0;this.lastKeyframe=this.currentKeyframe;this.currentKeyframe=a}var b=(this.time%c)/c;if(this.directionBackwards){b=1-b}this.morphTargetInfluences[this.currentKeyframe]=b;this.morphTargetInfluences[this.lastKeyframe]=1-b};THREE.MorphAnimMesh.prototype.clone=function(a){if(a===undefined){a=new THREE.MorphAnimMesh(this.geometry,this.material)}a.duration=this.duration;a.mirroredLoop=this.mirroredLoop;a.time=this.time;a.lastKeyframe=this.lastKeyframe;a.currentKeyframe=this.currentKeyframe;a.direction=this.direction;a.directionBackwards=this.directionBackwards;THREE.Mesh.prototype.clone.call(this,a);return a};THREE.LOD=function(){THREE.Object3D.call(this);this.objects=[]};THREE.LOD.prototype=Object.create(THREE.Object3D.prototype);THREE.LOD.prototype.addLevel=function(b,c){if(c===undefined){c=0}c=Math.abs(c);for(var a=0;a<this.objects.length;a++){if(c<this.objects[a].distance){break}}this.objects.splice(a,0,{distance:c,object:b});this.add(b)};THREE.LOD.prototype.getObjectForDistance=function(c){for(var b=1,a=this.objects.length;b<a;b++){if(c<this.objects[b].distance){break}}return this.objects[b-1].object};THREE.LOD.prototype.update=function(){var b=new THREE.Vector3();var a=new THREE.Vector3();return function(e){if(this.objects.length>1){b.setFromMatrixPosition(e.matrixWorld);a.setFromMatrixPosition(this.matrixWorld);var f=b.distanceTo(a);this.objects[0].object.visible=true;for(var d=1,c=this.objects.length;d<c;d++){if(f>=this.objects[d].distance){this.objects[d-1].object.visible=false;this.objects[d].object.visible=true}else{break}}for(;d<c;d++){this.objects[d].object.visible=false}}}}();THREE.LOD.prototype.clone=function(){};THREE.Sprite=function(a){THREE.Object3D.call(this);this.material=(a!==undefined)?a:new THREE.SpriteMaterial()};THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype);THREE.Sprite.prototype.updateMatrix=function(){this.matrix.compose(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=true};THREE.Sprite.prototype.clone=function(a){if(a===undefined){a=new THREE.Sprite(this.material)}THREE.Object3D.prototype.clone.call(this,a);return a};THREE.Particle=THREE.Sprite;THREE.Scene=function(){THREE.Object3D.call(this);this.fog=null;this.overrideMaterial=null;this.autoUpdate=true;this.matrixAutoUpdate=false;this.__lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);THREE.Scene.prototype.__addObject=function(a){if(a instanceof THREE.Light){if(this.__lights.indexOf(a)===-1){this.__lights.push(a)}if(a.target&&a.target.parent===undefined){this.add(a.target)}}else{if(!(a instanceof THREE.Camera||a instanceof THREE.Bone)){this.__objectsAdded.push(a);var b=this.__objectsRemoved.indexOf(a);if(b!==-1){this.__objectsRemoved.splice(b,1)}}}for(var d=0;d<a.children.length;d++){this.__addObject(a.children[d])}};THREE.Scene.prototype.__removeObject=function(b){if(b instanceof THREE.Light){var d=this.__lights.indexOf(b);if(d!==-1){this.__lights.splice(d,1)}if(b.shadowCascadeArray){for(var a=0;a<b.shadowCascadeArray.length;a++){this.__removeObject(b.shadowCascadeArray[a])}}}else{if(!(b instanceof THREE.Camera)){this.__objectsRemoved.push(b);var d=this.__objectsAdded.indexOf(b);if(d!==-1){this.__objectsAdded.splice(d,1)}}}for(var e=0;e<b.children.length;e++){this.__removeObject(b.children[e])}};THREE.Scene.prototype.clone=function(a){if(a===undefined){a=new THREE.Scene()}THREE.Object3D.prototype.clone.call(this,a);if(this.fog!==null){a.fog=this.fog.clone()}if(this.overrideMaterial!==null){a.overrideMaterial=this.overrideMaterial.clone()}a.autoUpdate=this.autoUpdate;a.matrixAutoUpdate=this.matrixAutoUpdate;return a};THREE.Fog=function(c,b,a){this.name="";this.color=new THREE.Color(c);this.near=(b!==undefined)?b:1;this.far=(a!==undefined)?a:1000};THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)};THREE.FogExp2=function(b,a){this.name="";this.color=new THREE.Color(b);this.density=(a!==undefined)?a:0.00025};THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)};THREE.CanvasRenderer=function(H){console.log("THREE.CanvasRenderer",THREE.REVISION);var aI=THREE.Math.smoothstep;H=H||{};var A=this,E,J,m,a=new THREE.Projector(),i=H.canvas!==undefined?H.canvas:document.createElement("canvas"),C=i.width,aH=i.height,ao=Math.floor(C/2),M=Math.floor(aH/2),e=i.getContext("2d"),K=new THREE.Color(0),aD=0,aJ=1,aF=0,B=null,aE=null,P=null,k=null,aA=null,N=null,av=0,aT,an,al,aj,ai,ah=new THREE.RenderableVertex(),af=new THREE.RenderableVertex(),v,u,d,b,aR,aO,aC,aB,ab,Z,S,R,f=new THREE.Color(),r=new THREE.Color(),q=new THREE.Color(),p=new THREE.Color(),o=new THREE.Color(),ad=new THREE.Color(),s=new THREE.Color(),ax=new THREE.Color(),L={},W={},V,aW,ae,j,aQ,aM,az,aw,aa,Y,aV=new THREE.Box2(),t=new THREE.Box2(),D=new THREE.Box2(),aL=new THREE.Color(),G=new THREE.Color(),ak=new THREE.Color(),l=new THREE.Vector3(),aP,h,aS,U,Q,T,am=16;aP=document.createElement("canvas");aP.width=aP.height=2;h=aP.getContext("2d");h.fillStyle="rgba(0,0,0,1)";h.fillRect(0,0,2,2);aS=h.getImageData(0,0,2,2);U=aS.data;Q=document.createElement("canvas");Q.width=Q.height=am;T=Q.getContext("2d");T.translate(-am/2,-am/2);T.scale(am,am);am--;if(e.setLineDash===undefined){if(e.mozDash!==undefined){e.setLineDash=function(aY){e.mozDash=aY[0]!==null?aY:null}}else{e.setLineDash=function(){}}}this.domElement=i;this.devicePixelRatio=H.devicePixelRatio!==undefined?H.devicePixelRatio:self.devicePixelRatio!==undefined?self.devicePixelRatio:1;this.autoClear=true;this.sortObjects=true;this.sortElements=true;this.info={render:{vertices:0,faces:0}};this.supportsVertexTextures=function(){};this.setFaceCulling=function(){};this.setSize=function(aZ,aY,a0){C=aZ*this.devicePixelRatio;aH=aY*this.devicePixelRatio;ao=Math.floor(C/2);M=Math.floor(aH/2);i.width=C;i.height=aH;if(this.devicePixelRatio!==1&&a0!==false){i.style.width=aZ+"px";i.style.height=aY+"px"}aV.set(new THREE.Vector2(-ao,-M),new THREE.Vector2(ao,M));t.set(new THREE.Vector2(-ao,-M),new THREE.Vector2(ao,M));aJ=1;aF=0;B=null;aE=null;P=null;k=null;aA=null};this.setClearColor=function(aY,aZ){K.set(aY);aD=aZ!==undefined?aZ:1;t.set(new THREE.Vector2(-ao,-M),new THREE.Vector2(ao,M))};this.setClearColorHex=function(aY,aZ){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(aY,aZ)};this.getMaxAnisotropy=function(){return 0};this.clear=function(){e.setTransform(1,0,0,-1,ao,M);if(t.empty()===false){t.intersect(aV);t.expandByScalar(2);if(aD<1){e.clearRect(t.min.x|0,t.min.y|0,(t.max.x-t.min.x)|0,(t.max.y-t.min.y)|0)}if(aD>0){ar(THREE.NormalBlending);F(1);ap("rgba("+Math.floor(K.r*255)+","+Math.floor(K.g*255)+","+Math.floor(K.b*255)+","+aD+")");e.fillRect(t.min.x|0,t.min.y|0,(t.max.x-t.min.x)|0,(t.max.y-t.min.y)|0)}t.makeEmpty()}};this.clearColor=function(){};this.clearDepth=function(){};this.clearStencil=function(){};this.render=function(a3,a1){if(a1 instanceof THREE.Camera===false){console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");return}if(this.autoClear===true){this.clear()}e.setTransform(1,0,0,-1,ao,M);A.info.render.vertices=0;A.info.render.faces=0;E=a.projectScene(a3,a1,this.sortObjects,this.sortElements);J=E.elements;m=E.lights;aT=a1;au();for(var a2=0,a0=J.length;a2<a0;a2++){var aY=J[a2];var aZ=aY.material;if(aZ===undefined||aZ.visible===false){continue}D.makeEmpty();if(aY instanceof THREE.RenderableSprite){an=aY;an.x*=ao;an.y*=M;n(an,aY,aZ)}else{if(aY instanceof THREE.RenderableLine){an=aY.v1;al=aY.v2;an.positionScreen.x*=ao;an.positionScreen.y*=M;al.positionScreen.x*=ao;al.positionScreen.y*=M;D.setFromPoints([an.positionScreen,al.positionScreen]);if(aV.isIntersectionBox(D)===true){ay(an,al,aY,aZ)}}else{if(aY instanceof THREE.RenderableFace3){an=aY.v1;al=aY.v2;aj=aY.v3;if(an.positionScreen.z<-1||an.positionScreen.z>1){continue}if(al.positionScreen.z<-1||al.positionScreen.z>1){continue}if(aj.positionScreen.z<-1||aj.positionScreen.z>1){continue}an.positionScreen.x*=ao;an.positionScreen.y*=M;al.positionScreen.x*=ao;al.positionScreen.y*=M;aj.positionScreen.x*=ao;aj.positionScreen.y*=M;if(aZ.overdraw>0){aq(an.positionScreen,al.positionScreen,aZ.overdraw);aq(al.positionScreen,aj.positionScreen,aZ.overdraw);aq(aj.positionScreen,an.positionScreen,aZ.overdraw)}D.setFromPoints([an.positionScreen,al.positionScreen,aj.positionScreen]);if(aV.isIntersectionBox(D)===true){aX(an,al,aj,0,1,2,aY,aZ)}}}}t.union(D)}e.setTransform(1,0,0,1,0,0)};function au(){aL.setRGB(0,0,0);G.setRGB(0,0,0);ak.setRGB(0,0,0);for(var a0=0,a1=m.length;a0<a1;a0++){var aZ=m[a0];var aY=aZ.color;if(aZ instanceof THREE.AmbientLight){aL.add(aY)}else{if(aZ instanceof THREE.DirectionalLight){G.add(aY)}else{if(aZ instanceof THREE.PointLight){ak.add(aY)}}}}}function c(aY,a5,a2){for(var a1=0,a4=m.length;a1<a4;a1++){var a0=m[a1];ax.copy(a0.color);if(a0 instanceof THREE.DirectionalLight){var aZ=l.setFromMatrixPosition(a0.matrixWorld).normalize();var a3=a5.dot(aZ);if(a3<=0){continue}a3*=a0.intensity;a2.add(ax.multiplyScalar(a3))}else{if(a0 instanceof THREE.PointLight){var aZ=l.setFromMatrixPosition(a0.matrixWorld);var a3=a5.dot(l.subVectors(aZ,aY).normalize());if(a3<=0){continue}a3*=a0.distance==0?1:1-Math.min(aY.distanceTo(aZ)/a0.distance,1);if(a3==0){continue}a3*=a0.intensity;a2.add(ax.multiplyScalar(a3))}}}}function n(a4,a0,a1){F(a1.opacity);ar(a1.blending);var aZ=a0.scale.x*ao;var aY=a0.scale.y*M;var a3=0.5*Math.sqrt(aZ*aZ+aY*aY);D.min.set(a4.x-a3,a4.y-a3);D.max.set(a4.x+a3,a4.y+a3);if(aV.isIntersectionBox(D)===false){D.makeEmpty();return}if(a1 instanceof THREE.SpriteMaterial||a1 instanceof THREE.ParticleSystemMaterial){if(a1.map!==null){var a2=a1.map.image;e.save();e.translate(a4.x,a4.y);e.rotate(a1.rotation);e.scale(aZ,-aY);e.drawImage(a2,0,0,a2.width,a2.height,-0.5,-0.5,1,1);e.restore()}else{ap(a1.color.getStyle());e.save();e.translate(a4.x,a4.y);e.rotate(a1.rotation);e.scale(aZ,-aY);e.fillRect(-0.5,-0.5,1,1);e.restore()}}else{if(a1 instanceof THREE.SpriteCanvasMaterial){aG(a1.color.getStyle());ap(a1.color.getStyle());e.save();e.translate(a4.x,a4.y);e.rotate(-a0.rotation);e.scale(aZ,aY);a1.program(e);e.restore()}}}function ay(a5,a3,a1,a2){F(a2.opacity);ar(a2.blending);e.beginPath();e.moveTo(a5.positionScreen.x,a5.positionScreen.y);e.lineTo(a3.positionScreen.x,a3.positionScreen.y);if(a2 instanceof THREE.LineBasicMaterial){O(a2.linewidth);ag(a2.linecap);aN(a2.linejoin);if(a2.vertexColors!==THREE.VertexColors){aG(a2.color.getStyle())}else{var a0=a1.vertexColors[0].getStyle();var aY=a1.vertexColors[1].getStyle();if(a0===aY){aG(a0)}else{try{var a4=e.createLinearGradient(a5.positionScreen.x,a5.positionScreen.y,a3.positionScreen.x,a3.positionScreen.y);a4.addColorStop(0,a0);a4.addColorStop(1,aY)}catch(aZ){a4=a0}aG(a4)}}e.stroke();D.expandByScalar(a2.linewidth*2)}else{if(a2 instanceof THREE.LineDashedMaterial){O(a2.linewidth);ag(a2.linecap);aN(a2.linejoin);aG(a2.color.getStyle());ac(a2.dashSize,a2.gapSize);e.stroke();D.expandByScalar(a2.linewidth*2);ac(null,null)}}}function aX(a6,a5,a4,a0,aZ,aY,a1,a3){A.info.render.vertices+=3;A.info.render.faces++;F(a3.opacity);ar(a3.blending);v=a6.positionScreen.x;u=a6.positionScreen.y;d=a5.positionScreen.x;b=a5.positionScreen.y;aR=a4.positionScreen.x;aO=a4.positionScreen.y;X(v,u,d,b,aR,aO);if((a3 instanceof THREE.MeshLambertMaterial||a3 instanceof THREE.MeshPhongMaterial)&&a3.map===null){ad.copy(a3.color);s.copy(a3.emissive);if(a3.vertexColors===THREE.FaceColors){ad.multiply(a1.color)}if(a3.wireframe===false&&a3.shading===THREE.SmoothShading&&a1.vertexNormalsLength===3){r.copy(aL);q.copy(aL);p.copy(aL);c(a1.v1.positionWorld,a1.vertexNormalsModel[0],r);c(a1.v2.positionWorld,a1.vertexNormalsModel[1],q);c(a1.v3.positionWorld,a1.vertexNormalsModel[2],p);r.multiply(ad).add(s);q.multiply(ad).add(s);p.multiply(ad).add(s);o.addColors(q,p).multiplyScalar(0.5);ae=aK(r,q,p,o);I(v,u,d,b,aR,aO,0,0,1,0,0,1,ae)}else{f.copy(aL);c(a1.centroidModel,a1.normalModel,f);f.multiply(ad).add(s);a3.wireframe===true?aU(f,a3.wireframeLinewidth,a3.wireframeLinecap,a3.wireframeLinejoin):g(f)}}else{if(a3 instanceof THREE.MeshBasicMaterial||a3 instanceof THREE.MeshLambertMaterial||a3 instanceof THREE.MeshPhongMaterial){if(a3.map!==null){if(a3.map.mapping instanceof THREE.UVMapping){j=a1.uvs[0];at(v,u,d,b,aR,aO,j[a0].x,j[a0].y,j[aZ].x,j[aZ].y,j[aY].x,j[aY].y,a3.map)}}else{if(a3.envMap!==null){if(a3.envMap.mapping instanceof THREE.SphericalReflectionMapping){l.copy(a1.vertexNormalsModelView[a0]);aQ=0.5*l.x+0.5;aM=0.5*l.y+0.5;l.copy(a1.vertexNormalsModelView[aZ]);az=0.5*l.x+0.5;aw=0.5*l.y+0.5;l.copy(a1.vertexNormalsModelView[aY]);aa=0.5*l.x+0.5;Y=0.5*l.y+0.5;at(v,u,d,b,aR,aO,aQ,aM,az,aw,aa,Y,a3.envMap)}}else{f.copy(a3.color);if(a3.vertexColors===THREE.FaceColors){f.multiply(a1.color)}a3.wireframe===true?aU(f,a3.wireframeLinewidth,a3.wireframeLinecap,a3.wireframeLinejoin):g(f)}}}else{if(a3 instanceof THREE.MeshDepthMaterial){V=aT.near;aW=aT.far;r.r=r.g=r.b=1-aI(a6.positionScreen.z*a6.positionScreen.w,V,aW);q.r=q.g=q.b=1-aI(a5.positionScreen.z*a5.positionScreen.w,V,aW);p.r=p.g=p.b=1-aI(a4.positionScreen.z*a4.positionScreen.w,V,aW);o.addColors(q,p).multiplyScalar(0.5);ae=aK(r,q,p,o);I(v,u,d,b,aR,aO,0,0,1,0,0,1,ae)}else{if(a3 instanceof THREE.MeshNormalMaterial){var a2;if(a3.shading===THREE.FlatShading){a2=a1.normalModelView;f.setRGB(a2.x,a2.y,a2.z).multiplyScalar(0.5).addScalar(0.5);a3.wireframe===true?aU(f,a3.wireframeLinewidth,a3.wireframeLinecap,a3.wireframeLinejoin):g(f)}else{if(a3.shading===THREE.SmoothShading){a2=a1.vertexNormalsModelView[a0];r.setRGB(a2.x,a2.y,a2.z).multiplyScalar(0.5).addScalar(0.5);a2=a1.vertexNormalsModelView[aZ];q.setRGB(a2.x,a2.y,a2.z).multiplyScalar(0.5).addScalar(0.5);a2=a1.vertexNormalsModelView[aY];p.setRGB(a2.x,a2.y,a2.z).multiplyScalar(0.5).addScalar(0.5);o.addColors(q,p).multiplyScalar(0.5);ae=aK(r,q,p,o);I(v,u,d,b,aR,aO,0,0,1,0,0,1,ae)}}}}}}}function X(a1,a3,aZ,a2,aY,a0){e.beginPath();e.moveTo(a1,a3);e.lineTo(aZ,a2);e.lineTo(aY,a0);e.closePath()}function aU(aY,a1,a0,aZ){O(a1);ag(a0);aN(aZ);aG(aY.getStyle());e.stroke();D.expandByScalar(a1*2)}function g(aY){ap(aY.getStyle());e.fill()}function at(bi,a5,bf,a3,bd,a1,be,a2,bc,a0,bb,aY,a8){if(a8 instanceof THREE.DataTexture||a8.image===undefined||a8.image.width===0){return}if(a8.needsUpdate===true){var bq=a8.wrapS===THREE.RepeatWrapping;var bo=a8.wrapT===THREE.RepeatWrapping;L[a8.id]=e.createPattern(a8.image,bq===true&&bo===true?"repeat":bq===true&&bo===false?"repeat-x":bq===false&&bo===true?"repeat-y":"no-repeat");a8.needsUpdate=false}L[a8.id]===undefined?ap("rgba(0,0,0,1)"):ap(L[a8.id]);var br,bp,bn,bm,bk,bh,a6,bl,bj=a8.offset.x/a8.repeat.x,bg=a8.offset.y/a8.repeat.y,ba=a8.image.width*a8.repeat.x,a9=a8.image.height*a8.repeat.y;be=(be+bj)*ba;a2=(1-a2+bg)*a9;bc=(bc+bj)*ba;a0=(1-a0+bg)*a9;bb=(bb+bj)*ba;aY=(1-aY+bg)*a9;bf-=bi;a3-=a5;bd-=bi;a1-=a5;bc-=be;a0-=a2;bb-=be;aY-=a2;a6=bc*aY-bb*a0;if(a6===0){if(W[a8.id]===undefined){var a4=document.createElement("canvas");a4.width=a8.image.width;a4.height=a8.image.height;var aZ=a4.getContext("2d");aZ.drawImage(a8.image,0,0);W[a8.id]=aZ.getImageData(0,0,a8.image.width,a8.image.height).data}var bs=W[a8.id];var a7=(Math.floor(be)+Math.floor(a2)*a8.image.width)*4;f.setRGB(bs[a7]/255,bs[a7+1]/255,bs[a7+2]/255);g(f);return}bl=1/a6;br=(aY*bf-a0*bd)*bl;bp=(aY*a3-a0*a1)*bl;bn=(bc*bd-bb*bf)*bl;bm=(bc*a1-bb*a3)*bl;bk=bi-br*be-bn*a2;bh=a5-bp*be-bm*a2;e.save();e.transform(br,bp,bn,bm,bk,bh);e.fill();e.restore()}function I(be,a3,bc,a2,ba,a0,bb,a1,a9,aZ,a8,aY,a6){var bk,bj,bi,bh,bf,bd,a4,bg,a7=a6.width-1,a5=a6.height-1;bb*=a7;a1*=a5;a9*=a7;aZ*=a5;a8*=a7;aY*=a5;bc-=be;a2-=a3;ba-=be;a0-=a3;a9-=bb;aZ-=a1;a8-=bb;aY-=a1;a4=a9*aY-a8*aZ;bg=1/a4;bk=(aY*bc-aZ*ba)*bg;bj=(aY*a2-aZ*a0)*bg;bi=(a9*ba-a8*bc)*bg;bh=(a9*a0-a8*a2)*bg;bf=be-bk*bb-bi*a1;bd=a3-bj*bb-bh*a1;e.save();e.transform(bk,bj,bi,bh,bf,bd);e.clip();e.drawImage(a6,0,0);e.restore()}function aK(aZ,aY,a1,a0){U[0]=(aZ.r*255)|0;U[1]=(aZ.g*255)|0;U[2]=(aZ.b*255)|0;U[4]=(aY.r*255)|0;U[5]=(aY.g*255)|0;U[6]=(aY.b*255)|0;U[8]=(a1.r*255)|0;U[9]=(a1.g*255)|0;U[10]=(a1.b*255)|0;U[12]=(a0.r*255)|0;U[13]=(a0.g*255)|0;U[14]=(a0.b*255)|0;h.putImageData(aS,0,0);T.drawImage(aP,0,0);return Q}function aq(a4,a1,a3){var aY=a1.x-a4.x,a2=a1.y-a4.y,aZ=aY*aY+a2*a2,a0;if(aZ===0){return}a0=a3/Math.sqrt(aZ);aY*=a0;a2*=a0;a1.x+=aY;a1.y+=a2;a4.x-=aY;a4.y-=a2}function F(aY){if(aJ!==aY){e.globalAlpha=aY;aJ=aY}}function ar(aY){if(aF!==aY){if(aY===THREE.NormalBlending){e.globalCompositeOperation="source-over"}else{if(aY===THREE.AdditiveBlending){e.globalCompositeOperation="lighter"}else{if(aY===THREE.SubtractiveBlending){e.globalCompositeOperation="darker"}}}aF=aY}}function O(aY){if(P!==aY){e.lineWidth=aY;P=aY}}function ag(aY){if(k!==aY){e.lineCap=aY;k=aY}}function aN(aY){if(aA!==aY){e.lineJoin=aY;aA=aY}}function aG(aY){if(B!==aY){e.strokeStyle=aY;B=aY}}function ap(aY){if(aE!==aY){e.fillStyle=aY;aE=aY}}function ac(aY,aZ){if(N!==aY||av!==aZ){e.setLineDash([aY,aZ]);N=aY;av=aZ}}};THREE.ShaderChunk={fog_pars_fragment:["#ifdef USE_FOG","uniform vec3 fogColor;","#ifdef FOG_EXP2","uniform float fogDensity;","#else","uniform float fogNear;","uniform float fogFar;","#endif","#endif"].join("\n"),fog_fragment:["#ifdef USE_FOG","float depth = gl_FragCoord.z / gl_FragCoord.w;","#ifdef FOG_EXP2","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","#else","float fogFactor = smoothstep( fogNear, fogFar, depth );","#endif","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","#endif"].join("\n"),envmap_pars_fragment:["#ifdef USE_ENVMAP","uniform float reflectivity;","uniform samplerCube envMap;","uniform float flipEnvMap;","uniform int combine;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","uniform bool useRefract;","uniform float refractionRatio;","#else","varying vec3 vReflect;","#endif","#endif"].join("\n"),envmap_fragment:["#ifdef USE_ENVMAP","vec3 reflectVec;","#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )","vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","if ( useRefract ) {","reflectVec = refract( cameraToVertex, normal, refractionRatio );","} else { ","reflectVec = reflect( cameraToVertex, normal );","}","#else","reflectVec = vReflect;","#endif","#ifdef DOUBLE_SIDED","float flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );","vec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );","#else","vec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );","#endif","#ifdef GAMMA_INPUT","cubeColor.xyz *= cubeColor.xyz;","#endif","if ( combine == 1 ) {","gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );","} else if ( combine == 2 ) {","gl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;","} else {","gl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );","}","#endif"].join("\n"),envmap_pars_vertex:["#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )","varying vec3 vReflect;","uniform float refractionRatio;","uniform bool useRefract;","#endif"].join("\n"),worldpos_vertex:["#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )","#ifdef USE_SKINNING","vec4 worldPosition = modelMatrix * skinned;","#endif","#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )","vec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );","#endif","#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","#endif","#endif"].join("\n"),envmap_vertex:["#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )","vec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;","worldNormal = normalize( worldNormal );","vec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );","if ( useRefract ) {","vReflect = refract( cameraToVertex, worldNormal, refractionRatio );","} else {","vReflect = reflect( cameraToVertex, worldNormal );","}","#endif"].join("\n"),map_particle_pars_fragment:["#ifdef USE_MAP","uniform sampler2D map;","#endif"].join("\n"),map_particle_fragment:["#ifdef USE_MAP","gl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );","#endif"].join("\n"),map_pars_vertex:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","varying vec2 vUv;","uniform vec4 offsetRepeat;","#endif"].join("\n"),map_pars_fragment:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","varying vec2 vUv;","#endif","#ifdef USE_MAP","uniform sampler2D map;","#endif"].join("\n"),map_vertex:["#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )","vUv = uv * offsetRepeat.zw + offsetRepeat.xy;","#endif"].join("\n"),map_fragment:["#ifdef USE_MAP","vec4 texelColor = texture2D( map, vUv );","#ifdef GAMMA_INPUT","texelColor.xyz *= texelColor.xyz;","#endif","gl_FragColor = gl_FragColor * texelColor;","#endif"].join("\n"),lightmap_pars_fragment:["#ifdef USE_LIGHTMAP","varying vec2 vUv2;","uniform sampler2D lightMap;","#endif"].join("\n"),lightmap_pars_vertex:["#ifdef USE_LIGHTMAP","varying vec2 vUv2;","#endif"].join("\n"),lightmap_fragment:["#ifdef USE_LIGHTMAP","gl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );","#endif"].join("\n"),lightmap_vertex:["#ifdef USE_LIGHTMAP","vUv2 = uv2;","#endif"].join("\n"),bumpmap_pars_fragment:["#ifdef USE_BUMPMAP","uniform sampler2D bumpMap;","uniform float bumpScale;","vec2 dHdxy_fwd() {","vec2 dSTdx = dFdx( vUv );","vec2 dSTdy = dFdy( vUv );","float Hll = bumpScale * texture2D( bumpMap, vUv ).x;","float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;","float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;","return vec2( dBx, dBy );","}","vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {","vec3 vSigmaX = dFdx( surf_pos );","vec3 vSigmaY = dFdy( surf_pos );","vec3 vN = surf_norm;","vec3 R1 = cross( vSigmaY, vN );","vec3 R2 = cross( vN, vSigmaX );","float fDet = dot( vSigmaX, R1 );","vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );","return normalize( abs( fDet ) * surf_norm - vGrad );","}","#endif"].join("\n"),normalmap_pars_fragment:["#ifdef USE_NORMALMAP","uniform sampler2D normalMap;","uniform vec2 normalScale;","vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {","vec3 q0 = dFdx( eye_pos.xyz );","vec3 q1 = dFdy( eye_pos.xyz );","vec2 st0 = dFdx( vUv.st );","vec2 st1 = dFdy( vUv.st );","vec3 S = normalize(  q0 * st1.t - q1 * st0.t );","vec3 T = normalize( -q0 * st1.s + q1 * st0.s );","vec3 N = normalize( surf_norm );","vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;","mapN.xy = normalScale * mapN.xy;","mat3 tsn = mat3( S, T, N );","return normalize( tsn * mapN );","}","#endif"].join("\n"),specularmap_pars_fragment:["#ifdef USE_SPECULARMAP","uniform sampler2D specularMap;","#endif"].join("\n"),specularmap_fragment:["float specularStrength;","#ifdef USE_SPECULARMAP","vec4 texelSpecular = texture2D( specularMap, vUv );","specularStrength = texelSpecular.r;","#else","specularStrength = 1.0;","#endif"].join("\n"),lights_lambert_pars_vertex:["uniform vec3 ambient;","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif"].join("\n"),lights_lambert_vertex:["vLightFront = vec3( 0.0 );","#ifdef DOUBLE_SIDED","vLightBack = vec3( 0.0 );","#endif","transformedNormal = normalize( transformedNormal );","#if MAX_DIR_LIGHTS > 0","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","float dotProduct = dot( transformedNormal, dirVector );","vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","directionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","directionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += directionalLightColor[ i ] * directionalLightWeighting;","#ifdef DOUBLE_SIDED","vLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;","#endif","}","#endif","#if MAX_POINT_LIGHTS > 0","for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float dotProduct = dot( transformedNormal, lVector );","vec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","pointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","pointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;","#ifdef DOUBLE_SIDED","vLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","float dotProduct = dot( transformedNormal, lVector );","vec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );","#ifdef DOUBLE_SIDED","vec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );","#ifdef WRAP_AROUND","vec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );","#endif","#endif","#ifdef WRAP_AROUND","vec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );","spotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );","#ifdef DOUBLE_SIDED","spotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );","#endif","#endif","vLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;","#ifdef DOUBLE_SIDED","vLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;","#endif","}","}","#endif","#if MAX_HEMI_LIGHTS > 0","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( transformedNormal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","float hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;","vLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","#ifdef DOUBLE_SIDED","vLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );","#endif","}","#endif","vLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;","#ifdef DOUBLE_SIDED","vLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;","#endif"].join("\n"),lights_phong_pars_vertex:["#ifndef PHONG_PER_PIXEL","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","varying vec4 vPointLight[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","varying vec3 vWorldPosition;","#endif"].join("\n"),lights_phong_vertex:["#ifndef PHONG_PER_PIXEL","#if MAX_POINT_LIGHTS > 0","for( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","vPointLight[ i ] = vec4( lVector, lDistance );","}","#endif","#if MAX_SPOT_LIGHTS > 0","for( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz - mvPosition.xyz;","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","vSpotLight[ i ] = vec4( lVector, lDistance );","}","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","vWorldPosition = worldPosition.xyz;","#endif"].join("\n"),lights_phong_pars_fragment:["uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","#ifdef PHONG_PER_PIXEL","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#else","varying vec4 vPointLight[ MAX_POINT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","#ifdef PHONG_PER_PIXEL","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#else","varying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];","#endif","#endif","#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )","varying vec3 vWorldPosition;","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif","varying vec3 vViewPosition;","varying vec3 vNormal;"].join("\n"),lights_phong_fragment:["vec3 normal = normalize( vNormal );","vec3 viewPosition = normalize( vViewPosition );","#ifdef DOUBLE_SIDED","normal = normal * ( -1.0 + 2.0 * float( normal.z > 0.0 ));","#endif","#ifdef USE_NORMALMAP","normal = perturbNormal2Arb( -vViewPosition, normal );","#elif defined( USE_BUMPMAP )","normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );","#endif","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse  = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","#ifdef PHONG_PER_PIXEL","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","#else","vec3 lVector = normalize( vPointLight[ i ].xyz );","float lDistance = vPointLight[ i ].w;","#endif","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float pointDiffuseWeightFull = max( dotProduct, 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","#else","float pointDiffuseWeight = max( dotProduct, 0.0 );","#endif","pointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;","vec3 pointHalfVector = normalize( lVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );","pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;","#else","pointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","vec3 spotDiffuse  = vec3( 0.0 );","vec3 spotSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","#ifdef PHONG_PER_PIXEL","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 lVector = lPosition.xyz + vViewPosition.xyz;","float lDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","lDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );","lVector = normalize( lVector );","#else","vec3 lVector = normalize( vSpotLight[ i ].xyz );","float lDistance = vSpotLight[ i ].w;","#endif","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","float dotProduct = dot( normal, lVector );","#ifdef WRAP_AROUND","float spotDiffuseWeightFull = max( dotProduct, 0.0 );","float spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","#else","float spotDiffuseWeight = max( dotProduct, 0.0 );","#endif","spotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;","vec3 spotHalfVector = normalize( lVector + viewPosition );","float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","float spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );","spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;","#else","spotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;","#endif","}","}","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse  = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, dirVector );","#ifdef WRAP_AROUND","float dirDiffuseWeightFull = max( dotProduct, 0.0 );","float dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );","#else","float dirDiffuseWeight = max( dotProduct, 0.0 );","#endif","dirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );","dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","#else","dirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;","#endif","}","#endif","#if MAX_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","hemiDiffuse += diffuse * hemiColor;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","float hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","float hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float dotProductGround = dot( normal, lVectorGround );","float specularNormalization = ( shininess + 2.0001 ) / 8.0;","vec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );","vec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );","hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","#else","hemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;","#endif","}","#endif","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","#if MAX_DIR_LIGHTS > 0","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#if MAX_HEMI_LIGHTS > 0","totalDiffuse += hemiDiffuse;","totalSpecular += hemiSpecular;","#endif","#if MAX_POINT_LIGHTS > 0","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif","#if MAX_SPOT_LIGHTS > 0","totalDiffuse += spotDiffuse;","totalSpecular += spotSpecular;","#endif","#ifdef METAL","gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );","#else","gl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;","#endif"].join("\n"),color_pars_fragment:["#ifdef USE_COLOR","varying vec3 vColor;","#endif"].join("\n"),color_fragment:["#ifdef USE_COLOR","gl_FragColor = gl_FragColor * vec4( vColor, 1.0 );","#endif"].join("\n"),color_pars_vertex:["#ifdef USE_COLOR","varying vec3 vColor;","#endif"].join("\n"),color_vertex:["#ifdef USE_COLOR","#ifdef GAMMA_INPUT","vColor = color * color;","#else","vColor = color;","#endif","#endif"].join("\n"),skinning_pars_vertex:["#ifdef USE_SKINNING","#ifdef BONE_TEXTURE","uniform sampler2D boneTexture;","uniform int boneTextureWidth;","uniform int boneTextureHeight;","mat4 getBoneMatrix( const in float i ) {","float j = i * 4.0;","float x = mod( j, float( boneTextureWidth ) );","float y = floor( j / float( boneTextureWidth ) );","float dx = 1.0 / float( boneTextureWidth );","float dy = 1.0 / float( boneTextureHeight );","y = dy * ( y + 0.5 );","vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );","vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );","vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );","vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );","mat4 bone = mat4( v1, v2, v3, v4 );","return bone;","}","#else","uniform mat4 boneGlobalMatrices[ MAX_BONES ];","mat4 getBoneMatrix( const in float i ) {","mat4 bone = boneGlobalMatrices[ int(i) ];","return bone;","}","#endif","#endif"].join("\n"),skinbase_vertex:["#ifdef USE_SKINNING","mat4 boneMatX = getBoneMatrix( skinIndex.x );","mat4 boneMatY = getBoneMatrix( skinIndex.y );","#endif"].join("\n"),skinning_vertex:["#ifdef USE_SKINNING","#ifdef USE_MORPHTARGETS","vec4 skinVertex = vec4( morphed, 1.0 );","#else","vec4 skinVertex = vec4( position, 1.0 );","#endif","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","#endif"].join("\n"),morphtarget_pars_vertex:["#ifdef USE_MORPHTARGETS","#ifndef USE_MORPHNORMALS","uniform float morphTargetInfluences[ 8 ];","#else","uniform float morphTargetInfluences[ 4 ];","#endif","#endif"].join("\n"),morphtarget_vertex:["#ifdef USE_MORPHTARGETS","vec3 morphed = vec3( 0.0 );","morphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];","morphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];","morphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];","morphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];","#ifndef USE_MORPHNORMALS","morphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];","morphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];","morphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];","morphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];","#endif","morphed += position;","#endif"].join("\n"),default_vertex:["vec4 mvPosition;","#ifdef USE_SKINNING","mvPosition = modelViewMatrix * skinned;","#endif","#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )","mvPosition = modelViewMatrix * vec4( morphed, 1.0 );","#endif","#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )","mvPosition = modelViewMatrix * vec4( position, 1.0 );","#endif","gl_Position = projectionMatrix * mvPosition;"].join("\n"),morphnormal_vertex:["#ifdef USE_MORPHNORMALS","vec3 morphedNormal = vec3( 0.0 );","morphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];","morphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];","morphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];","morphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];","morphedNormal += normal;","#endif"].join("\n"),skinnormal_vertex:["#ifdef USE_SKINNING","mat4 skinMatrix = skinWeight.x * boneMatX;","skinMatrix 	+= skinWeight.y * boneMatY;","#ifdef USE_MORPHNORMALS","vec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );","#else","vec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );","#endif","#endif"].join("\n"),defaultnormal_vertex:["vec3 objectNormal;","#ifdef USE_SKINNING","objectNormal = skinnedNormal.xyz;","#endif","#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )","objectNormal = morphedNormal;","#endif","#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )","objectNormal = normal;","#endif","#ifdef FLIP_SIDED","objectNormal = -objectNormal;","#endif","vec3 transformedNormal = normalMatrix * objectNormal;"].join("\n"),shadowmap_pars_fragment:["#ifdef USE_SHADOWMAP","uniform sampler2D shadowMap[ MAX_SHADOWS ];","uniform vec2 shadowMapSize[ MAX_SHADOWS ];","uniform float shadowDarkness[ MAX_SHADOWS ];","uniform float shadowBias[ MAX_SHADOWS ];","varying vec4 vShadowCoord[ MAX_SHADOWS ];","float unpackDepth( const in vec4 rgba_depth ) {","const vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );","float depth = dot( rgba_depth, bit_shift );","return depth;","}","#endif"].join("\n"),shadowmap_fragment:["#ifdef USE_SHADOWMAP","#ifdef SHADOWMAP_DEBUG","vec3 frustumColors[3];","frustumColors[0] = vec3( 1.0, 0.5, 0.0 );","frustumColors[1] = vec3( 0.0, 1.0, 0.8 );","frustumColors[2] = vec3( 0.0, 0.5, 1.0 );","#endif","#ifdef SHADOWMAP_CASCADE","int inFrustumCount = 0;","#endif","float fDepth;","vec3 shadowColor = vec3( 1.0 );","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;","bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );","bool inFrustum = all( inFrustumVec );","#ifdef SHADOWMAP_CASCADE","inFrustumCount += int( inFrustum );","bvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );","#else","bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );","#endif","bool frustumTest = all( frustumTestVec );","if ( frustumTest ) {","shadowCoord.z += shadowBias[ i ];","#if defined( SHADOWMAP_TYPE_PCF )","float shadow = 0.0;","const float shadowDelta = 1.0 / 9.0;","float xPixelOffset = 1.0 / shadowMapSize[ i ].x;","float yPixelOffset = 1.0 / shadowMapSize[ i ].y;","float dx0 = -1.25 * xPixelOffset;","float dy0 = -1.25 * yPixelOffset;","float dx1 = 1.25 * xPixelOffset;","float dy1 = 1.25 * yPixelOffset;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","fDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );","if ( fDepth < shadowCoord.z ) shadow += shadowDelta;","shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );","#elif defined( SHADOWMAP_TYPE_PCF_SOFT )","float shadow = 0.0;","float xPixelOffset = 1.0 / shadowMapSize[ i ].x;","float yPixelOffset = 1.0 / shadowMapSize[ i ].y;","float dx0 = -1.0 * xPixelOffset;","float dy0 = -1.0 * yPixelOffset;","float dx1 = 1.0 * xPixelOffset;","float dy1 = 1.0 * yPixelOffset;","mat3 shadowKernel;","mat3 depthKernel;","depthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );","depthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );","depthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );","depthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );","depthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );","depthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );","depthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );","depthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );","depthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );","vec3 shadowZ = vec3( shadowCoord.z );","shadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));","shadowKernel[0] *= vec3(0.25);","shadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));","shadowKernel[1] *= vec3(0.25);","shadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));","shadowKernel[2] *= vec3(0.25);","vec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );","shadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );","shadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );","vec4 shadowValues;","shadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );","shadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );","shadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );","shadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );","shadow = dot( shadowValues, vec4( 1.0 ) );","shadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );","#else","vec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );","float fDepth = unpackDepth( rgbaDepth );","if ( fDepth < shadowCoord.z )","shadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );","#endif","}","#ifdef SHADOWMAP_DEBUG","#ifdef SHADOWMAP_CASCADE","if ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];","#else","if ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];","#endif","#endif","}","#ifdef GAMMA_OUTPUT","shadowColor *= shadowColor;","#endif","gl_FragColor.xyz = gl_FragColor.xyz * shadowColor;","#endif"].join("\n"),shadowmap_pars_vertex:["#ifdef USE_SHADOWMAP","varying vec4 vShadowCoord[ MAX_SHADOWS ];","uniform mat4 shadowMatrix[ MAX_SHADOWS ];","#endif"].join("\n"),shadowmap_vertex:["#ifdef USE_SHADOWMAP","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","}","#endif"].join("\n"),alphatest_fragment:["#ifdef ALPHATEST","if ( gl_FragColor.a < ALPHATEST ) discard;","#endif"].join("\n"),linear_to_gamma_fragment:["#ifdef GAMMA_OUTPUT","gl_FragColor.xyz = sqrt( gl_FragColor.xyz );","#endif"].join("\n")};THREE.UniformsUtils={merge:function(b){var c,e,d,a={};for(c=0;c<b.length;c++){d=this.clone(b[c]);for(e in d){a[e]=d[e]}}return a},clone:function(a){var d,e,f,c,b={};for(d in a){b[d]={};for(e in a[d]){c=a[d][e];if(c instanceof THREE.Color||c instanceof THREE.Vector2||c instanceof THREE.Vector3||c instanceof THREE.Vector4||c instanceof THREE.Matrix4||c instanceof THREE.Texture){b[d][e]=c.clone()}else{if(c instanceof Array){b[d][e]=c.slice()}else{b[d][e]=c}}}}return b}};THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:0.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:0.00025},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2000},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:0.00025},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2000},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.skinbase_vertex,"#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","varying vec3 vLightBack;","#endif",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vLightFront;","#ifdef DOUBLE_SIDED","varying vec3 vLightBack;","#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"#ifdef DOUBLE_SIDED","if ( gl_FrontFacing )","gl_FragColor.xyz *= vLightFront;","else","gl_FragColor.xyz *= vLightBack;","#else","gl_FragColor.xyz *= vLightFront;","#endif",THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG","varying vec3 vViewPosition;","varying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform vec3 ambient;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {","gl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;","uniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","#ifdef USE_SIZEATTENUATION","gl_PointSize = size * ( scale / length( mvPosition.xyz ) );","#else","gl_PointSize = size;","#endif","gl_Position = projectionMatrix * mvPosition;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;","uniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {","gl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;","attribute float lineDistance;","varying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vLineDistance = scale * lineDistance;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 diffuse;","uniform float opacity;","uniform float dashSize;","uniform float totalSize;","varying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {","if ( mod( vLineDistance, totalSize ) > dashSize ) {","discard;","}","gl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2000},opacity:{type:"f",value:1}},vertexShader:["void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","uniform float opacity;","void main() {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float color = 1.0 - smoothstep( mNear, mFar, depth );","gl_FragColor = vec4( vec3( color ), opacity );","}"].join("\n")},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {","vNormal = normalize( normalMatrix * normal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;","varying vec3 vNormal;","void main() {","gl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );","}"].join("\n")},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new THREE.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(16777215)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(16777215)},uShininess:{type:"f",value:30},uOpacity:{type:"f",value:1},useRefract:{type:"i",value:0},uRefractionRatio:{type:"f",value:0.98},uReflectivity:{type:"f",value:0.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;","uniform vec3 uDiffuseColor;","uniform vec3 uSpecularColor;","uniform float uShininess;","uniform float uOpacity;","uniform bool enableDiffuse;","uniform bool enableSpecular;","uniform bool enableAO;","uniform bool enableReflection;","uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tSpecular;","uniform sampler2D tAO;","uniform samplerCube tCube;","uniform vec2 uNormalScale;","uniform bool useRefract;","uniform float uRefractionRatio;","uniform float uReflectivity;","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","uniform vec3 ambientLightColor;","#if MAX_DIR_LIGHTS > 0","uniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];","uniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];","#endif","#if MAX_HEMI_LIGHTS > 0","uniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];","uniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];","#endif","#if MAX_POINT_LIGHTS > 0","uniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];","uniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];","uniform float pointLightDistance[ MAX_POINT_LIGHTS ];","#endif","#if MAX_SPOT_LIGHTS > 0","uniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];","uniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];","uniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];","uniform float spotLightExponent[ MAX_SPOT_LIGHTS ];","uniform float spotLightDistance[ MAX_SPOT_LIGHTS ];","#endif","#ifdef WRAP_AROUND","uniform vec3 wrapRGB;","#endif","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {","gl_FragColor = vec4( vec3( 1.0 ), uOpacity );","vec3 specularTex = vec3( 1.0 );","vec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;","normalTex.xy *= uNormalScale;","normalTex = normalize( normalTex );","if( enableDiffuse ) {","#ifdef GAMMA_INPUT","vec4 texelColor = texture2D( tDiffuse, vUv );","texelColor.xyz *= texelColor.xyz;","gl_FragColor = gl_FragColor * texelColor;","#else","gl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );","#endif","}","if( enableAO ) {","#ifdef GAMMA_INPUT","vec4 aoColor = texture2D( tAO, vUv );","aoColor.xyz *= aoColor.xyz;","gl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;","#else","gl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;","#endif","}","if( enableSpecular )","specularTex = texture2D( tSpecular, vUv ).xyz;","mat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );","vec3 finalNormal = tsb * normalTex;","#ifdef FLIP_SIDED","finalNormal = -finalNormal;","#endif","vec3 normal = normalize( finalNormal );","vec3 viewPosition = normalize( vViewPosition );","#if MAX_POINT_LIGHTS > 0","vec3 pointDiffuse = vec3( 0.0 );","vec3 pointSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );","vec3 pointVector = lPosition.xyz + vViewPosition.xyz;","float pointDistance = 1.0;","if ( pointLightDistance[ i ] > 0.0 )","pointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );","pointVector = normalize( pointVector );","#ifdef WRAP_AROUND","float pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );","float pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );","vec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );","#else","float pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );","#endif","pointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;","vec3 pointHalfVector = normalize( pointVector + viewPosition );","float pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );","float pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );","pointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;","#else","pointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;","#endif","}","#endif","#if MAX_SPOT_LIGHTS > 0","vec3 spotDiffuse = vec3( 0.0 );","vec3 spotSpecular = vec3( 0.0 );","for ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {","vec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );","vec3 spotVector = lPosition.xyz + vViewPosition.xyz;","float spotDistance = 1.0;","if ( spotLightDistance[ i ] > 0.0 )","spotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );","spotVector = normalize( spotVector );","float spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );","if ( spotEffect > spotLightAngleCos[ i ] ) {","spotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );","#ifdef WRAP_AROUND","float spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );","float spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );","vec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );","#else","float spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );","#endif","spotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;","vec3 spotHalfVector = normalize( spotVector + viewPosition );","float spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );","float spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );","spotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;","#else","spotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;","#endif","}","}","#endif","#if MAX_DIR_LIGHTS > 0","vec3 dirDiffuse = vec3( 0.0 );","vec3 dirSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {","vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );","vec3 dirVector = normalize( lDirection.xyz );","#ifdef WRAP_AROUND","float directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );","float directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );","vec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );","#else","float dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );","#endif","dirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;","vec3 dirHalfVector = normalize( dirVector + viewPosition );","float dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );","float dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );","dirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;","#else","dirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;","#endif","}","#endif","#if MAX_HEMI_LIGHTS > 0","vec3 hemiDiffuse  = vec3( 0.0 );","vec3 hemiSpecular = vec3( 0.0 );","for( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {","vec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );","vec3 lVector = normalize( lDirection.xyz );","float dotProduct = dot( normal, lVector );","float hemiDiffuseWeight = 0.5 * dotProduct + 0.5;","vec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );","hemiDiffuse += uDiffuseColor * hemiColor;","vec3 hemiHalfVectorSky = normalize( lVector + viewPosition );","float hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;","float hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );","vec3 lVectorGround = -lVector;","vec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );","float hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;","float hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );","#ifdef PHYSICALLY_BASED_SHADING","float dotProductGround = dot( normal, lVectorGround );","float specularNormalization = ( uShininess + 2.0001 ) / 8.0;","vec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );","vec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );","hemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );","#else","hemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;","#endif","}","#endif","vec3 totalDiffuse = vec3( 0.0 );","vec3 totalSpecular = vec3( 0.0 );","#if MAX_DIR_LIGHTS > 0","totalDiffuse += dirDiffuse;","totalSpecular += dirSpecular;","#endif","#if MAX_HEMI_LIGHTS > 0","totalDiffuse += hemiDiffuse;","totalSpecular += hemiSpecular;","#endif","#if MAX_POINT_LIGHTS > 0","totalDiffuse += pointDiffuse;","totalSpecular += pointSpecular;","#endif","#if MAX_SPOT_LIGHTS > 0","totalDiffuse += spotDiffuse;","totalSpecular += spotSpecular;","#endif","#ifdef METAL","gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );","#else","gl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;","#endif","if ( enableReflection ) {","vec3 vReflect;","vec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );","if ( useRefract ) {","vReflect = refract( cameraToVertex, normal, uRefractionRatio );","} else {","vReflect = reflect( cameraToVertex, normal );","}","vec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","#ifdef GAMMA_INPUT","cubeColor.xyz *= cubeColor.xyz;","#endif","gl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );","}",THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;","uniform vec2 uOffset;","uniform vec2 uRepeat;","uniform bool enableDisplacement;","#ifdef VERTEX_TEXTURES","uniform sampler2D tDisplacement;","uniform float uDisplacementScale;","uniform float uDisplacementBias;","#endif","varying vec3 vTangent;","varying vec3 vBinormal;","varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vWorldPosition;","varying vec3 vViewPosition;",THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,"#ifdef USE_SKINNING","vNormal = normalize( normalMatrix * skinnedNormal.xyz );","vec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );","vTangent = normalize( normalMatrix * skinnedTangent.xyz );","#else","vNormal = normalize( normalMatrix * normal );","vTangent = normalize( normalMatrix * tangent.xyz );","#endif","vBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );","vUv = uv * uRepeat + uOffset;","vec3 displacedPosition;","#ifdef VERTEX_TEXTURES","if ( enableDisplacement ) {","vec3 dv = texture2D( tDisplacement, uv ).xyz;","float df = uDisplacementScale * dv.x + uDisplacementBias;","displacedPosition = position + normalize( normal ) * df;","} else {","#ifdef USE_SKINNING","vec4 skinVertex = vec4( position, 1.0 );","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","displacedPosition  = skinned.xyz;","#else","displacedPosition = position;","#endif","}","#else","#ifdef USE_SKINNING","vec4 skinVertex = vec4( position, 1.0 );","vec4 skinned  = boneMatX * skinVertex * skinWeight.x;","skinned 	  += boneMatY * skinVertex * skinWeight.y;","displacedPosition  = skinned.xyz;","#else","displacedPosition = position;","#endif","#endif","vec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );","vec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );","gl_Position = projectionMatrix * mvPosition;","vWorldPosition = worldPosition.xyz;","vViewPosition = -mvPosition.xyz;","#ifdef USE_SHADOWMAP","for( int i = 0; i < MAX_SHADOWS; i ++ ) {","vShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;","}","#endif","}"].join("\n")},cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:["varying vec3 vWorldPosition;","void main() {","vec4 worldPosition = modelMatrix * vec4( position, 1.0 );","vWorldPosition = worldPosition.xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","uniform float tFlip;","varying vec3 vWorldPosition;","void main() {","gl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );","}"].join("\n")},depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:["vec4 pack_depth( const in float depth ) {","const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );","const vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );","vec4 res = fract( depth * bit_shift );","res -= res.xxyz * bit_mask;","return res;","}","void main() {","gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );","}"].join("\n")}};THREE.WebGLRenderer=function(aN){console.log("THREE.WebGLRenderer",THREE.REVISION);aN=aN||{};var aY=aN.canvas!==undefined?aN.canvas:document.createElement("canvas"),j=aN.precision!==undefined?aN.precision:"highp",bD=aN.alpha!==undefined?aN.alpha:false,a1=aN.premultipliedAlpha!==undefined?aN.premultipliedAlpha:true,bY=aN.antialias!==undefined?aN.antialias:false,e=aN.stencil!==undefined?aN.stencil:true,Y=aN.preserveDrawingBuffer!==undefined?aN.preserveDrawingBuffer:false,bs=new THREE.Color(0),X=0;this.domElement=aY;this.context=null;this.devicePixelRatio=aN.devicePixelRatio!==undefined?aN.devicePixelRatio:self.devicePixelRatio!==undefined?self.devicePixelRatio:1;this.autoClear=true;this.autoClearColor=true;this.autoClearDepth=true;this.autoClearStencil=true;this.sortObjects=true;this.autoUpdateObjects=true;this.gammaInput=false;this.gammaOutput=false;this.physicallyBasedShading=false;this.shadowMapEnabled=false;this.shadowMapAutoUpdate=true;this.shadowMapType=THREE.PCFShadowMap;this.shadowMapCullFace=THREE.CullFaceFront;this.shadowMapDebug=false;this.shadowMapCascade=false;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=true;this.renderPluginsPre=[];this.renderPluginsPost=[];this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var aO=this,bE=[],aB=0,am=null,bG=null,a2=-1,F=null,aL=null,V=0,bf=0,bl=-1,k=-1,i=-1,aj=-1,bQ=-1,au=-1,a=-1,bz=-1,aK=null,bO=null,bb=null,bn=null,a4=0,a3=0,bS=aY.width,aV=aY.height,D=0,aU=0,N={},bt=new THREE.Frustum(),a0=new THREE.Matrix4(),G=new THREE.Matrix4(),W=new THREE.Vector3(),aM=new THREE.Vector3(),bZ=true,bq={ambient:[0,0,0],directional:{length:0,colors:new Array(),positions:new Array()},point:{length:0,colors:new Array(),positions:new Array(),distances:new Array()},spot:{length:0,colors:new Array(),positions:new Array(),distances:new Array(),directions:new Array(),anglesCos:new Array(),exponents:new Array()},hemi:{length:0,skyColors:new Array(),groundColors:new Array(),positions:new Array()}};var c;var m;var A;var be;var q;var aF;br();bd();this.context=c;var bJ=c.getParameter(c.MAX_TEXTURE_IMAGE_UNITS);var b=c.getParameter(c.MAX_VERTEX_TEXTURE_IMAGE_UNITS);var C=c.getParameter(c.MAX_TEXTURE_SIZE);var ao=c.getParameter(c.MAX_CUBE_MAP_TEXTURE_SIZE);var bC=q?c.getParameter(q.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0;var aW=(b>0);var Z=aW&&m;var bA=aF?c.getParameter(c.COMPRESSED_TEXTURE_FORMATS):[];var bx=c.getShaderPrecisionFormat(c.VERTEX_SHADER,c.HIGH_FLOAT);var bR=c.getShaderPrecisionFormat(c.VERTEX_SHADER,c.MEDIUM_FLOAT);var bN=c.getShaderPrecisionFormat(c.VERTEX_SHADER,c.LOW_FLOAT);var an=c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.HIGH_FLOAT);var bF=c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.MEDIUM_FLOAT);var az=c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.LOW_FLOAT);var l=c.getShaderPrecisionFormat(c.VERTEX_SHADER,c.HIGH_INT);var aG=c.getShaderPrecisionFormat(c.VERTEX_SHADER,c.MEDIUM_INT);var Q=c.getShaderPrecisionFormat(c.VERTEX_SHADER,c.LOW_INT);var bv=c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.HIGH_INT);var t=c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.MEDIUM_INT);var bk=c.getShaderPrecisionFormat(c.FRAGMENT_SHADER,c.LOW_INT);var bT=bx.precision>0&&an.precision>0;var bj=bR.precision>0&&bF.precision>0;if(j==="highp"&&!bT){if(bj){j="mediump";console.warn("WebGLRenderer: highp not supported, using mediump")}else{j="lowp";console.warn("WebGLRenderer: highp and mediump not supported, using lowp")}}if(j==="mediump"&&!bj){j="lowp";console.warn("WebGLRenderer: mediump not supported, using lowp")}this.getContext=function(){return c};this.supportsVertexTextures=function(){return aW};this.supportsFloatTextures=function(){return m};this.supportsStandardDerivatives=function(){return be};this.supportsCompressedTextureS3TC=function(){return aF};this.getMaxAnisotropy=function(){return bC};this.getPrecision=function(){return j};this.setSize=function(b1,b0,b2){aY.width=b1*this.devicePixelRatio;aY.height=b0*this.devicePixelRatio;if(this.devicePixelRatio!==1&&b2!==false){aY.style.width=b1+"px";aY.style.height=b0+"px"}this.setViewport(0,0,aY.width,aY.height)};this.setViewport=function(b1,b3,b2,b0){a4=b1!==undefined?b1:0;a3=b3!==undefined?b3:0;bS=b2!==undefined?b2:aY.width;aV=b0!==undefined?b0:aY.height;c.viewport(a4,a3,bS,aV)};this.setScissor=function(b1,b3,b2,b0){c.scissor(b1,b3,b2,b0)};this.enableScissorTest=function(b0){b0?c.enable(c.SCISSOR_TEST):c.disable(c.SCISSOR_TEST)};this.setClearColor=function(b0,b1){bs.set(b0);X=b1!==undefined?b1:1;c.clearColor(bs.r,bs.g,bs.b,X)};this.setClearColorHex=function(b0,b1){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(b0,b1)};this.getClearColor=function(){return bs};this.getClearAlpha=function(){return X};this.clear=function(b0,b3,b1){var b2=0;if(b0===undefined||b0){b2|=c.COLOR_BUFFER_BIT}if(b3===undefined||b3){b2|=c.DEPTH_BUFFER_BIT}if(b1===undefined||b1){b2|=c.STENCIL_BUFFER_BIT}c.clear(b2)};this.clearColor=function(){c.clear(c.COLOR_BUFFER_BIT)};this.clearDepth=function(){c.clear(c.DEPTH_BUFFER_BIT)};this.clearStencil=function(){c.clear(c.STENCIL_BUFFER_BIT)};this.clearTarget=function(b2,b0,b3,b1){this.setRenderTarget(b2);this.clear(b0,b3,b1)};this.addPostPlugin=function(b0){b0.init(this);this.renderPluginsPost.push(b0)};this.addPrePlugin=function(b0){b0.init(this);this.renderPluginsPre.push(b0)};this.updateShadowMap=function(b1,b0){am=null;i=-1;a=-1;bz=-1;F=-1;a2=-1;bZ=true;bl=-1;k=-1;this.shadowMapPlugin.update(b1,b0)};function H(b0){b0.__webglVertexBuffer=c.createBuffer();b0.__webglColorBuffer=c.createBuffer();aO.info.memory.geometries++}function ae(b0){b0.__webglVertexBuffer=c.createBuffer();b0.__webglColorBuffer=c.createBuffer();b0.__webglLineDistanceBuffer=c.createBuffer();aO.info.memory.geometries++}function aE(b1){b1.__webglVertexBuffer=c.createBuffer();b1.__webglNormalBuffer=c.createBuffer();b1.__webglTangentBuffer=c.createBuffer();b1.__webglColorBuffer=c.createBuffer();b1.__webglUVBuffer=c.createBuffer();b1.__webglUV2Buffer=c.createBuffer();b1.__webglSkinIndicesBuffer=c.createBuffer();b1.__webglSkinWeightsBuffer=c.createBuffer();b1.__webglFaceBuffer=c.createBuffer();b1.__webglLineBuffer=c.createBuffer();var b0,b2;if(b1.numMorphTargets){b1.__webglMorphTargetsBuffers=[];for(b0=0,b2=b1.numMorphTargets;b0<b2;b0++){b1.__webglMorphTargetsBuffers.push(c.createBuffer())}}if(b1.numMorphNormals){b1.__webglMorphNormalsBuffers=[];for(b0=0,b2=b1.numMorphNormals;b0<b2;b0++){b1.__webglMorphNormalsBuffers.push(c.createBuffer())}}aO.info.memory.geometries++}var aZ=function(b0){var b1=b0.target;b1.removeEventListener("dispose",aZ);bU(b1)};var ah=function(b1){var b0=b1.target;b0.removeEventListener("dispose",ah);J(b0);aO.info.memory.textures--};var T=function(b0){var b1=b0.target;b1.removeEventListener("dispose",T);aC(b1);aO.info.memory.textures--};var bi=function(b1){var b0=b1.target;b0.removeEventListener("dispose",bi);S(b0)};var o=function(b0){if(b0.__webglVertexBuffer!==undefined){c.deleteBuffer(b0.__webglVertexBuffer)}if(b0.__webglNormalBuffer!==undefined){c.deleteBuffer(b0.__webglNormalBuffer)}if(b0.__webglTangentBuffer!==undefined){c.deleteBuffer(b0.__webglTangentBuffer)}if(b0.__webglColorBuffer!==undefined){c.deleteBuffer(b0.__webglColorBuffer)}if(b0.__webglUVBuffer!==undefined){c.deleteBuffer(b0.__webglUVBuffer)}if(b0.__webglUV2Buffer!==undefined){c.deleteBuffer(b0.__webglUV2Buffer)}if(b0.__webglSkinIndicesBuffer!==undefined){c.deleteBuffer(b0.__webglSkinIndicesBuffer)}if(b0.__webglSkinWeightsBuffer!==undefined){c.deleteBuffer(b0.__webglSkinWeightsBuffer)}if(b0.__webglFaceBuffer!==undefined){c.deleteBuffer(b0.__webglFaceBuffer)}if(b0.__webglLineBuffer!==undefined){c.deleteBuffer(b0.__webglLineBuffer)}if(b0.__webglLineDistanceBuffer!==undefined){c.deleteBuffer(b0.__webglLineDistanceBuffer)}if(b0.__webglCustomAttributesList!==undefined){for(var b1 in b0.__webglCustomAttributesList){c.deleteBuffer(b0.__webglCustomAttributesList[b1].buffer)}}aO.info.memory.geometries--};var bU=function(b5){b5.__webglInit=undefined;if(b5 instanceof THREE.BufferGeometry){var b2=b5.attributes;for(var b3 in b2){if(b2[b3].buffer!==undefined){c.deleteBuffer(b2[b3].buffer)}}aO.info.memory.geometries--}else{if(b5.geometryGroups!==undefined){for(var b4 in b5.geometryGroups){var b1=b5.geometryGroups[b4];if(b1.numMorphTargets!==undefined){for(var b0=0,b6=b1.numMorphTargets;b0<b6;b0++){c.deleteBuffer(b1.__webglMorphTargetsBuffers[b0])}}if(b1.numMorphNormals!==undefined){for(var b0=0,b6=b1.numMorphNormals;b0<b6;b0++){c.deleteBuffer(b1.__webglMorphNormalsBuffers[b0])}}o(b1)}}else{o(b5)}}};var J=function(b0){if(b0.image&&b0.image.__webglTextureCube){c.deleteTexture(b0.image.__webglTextureCube)}else{if(!b0.__webglInit){return}b0.__webglInit=false;c.deleteTexture(b0.__webglTexture)}};var aC=function(b1){if(!b1||!b1.__webglTexture){return}c.deleteTexture(b1.__webglTexture);if(b1 instanceof THREE.WebGLRenderTargetCube){for(var b0=0;b0<6;b0++){c.deleteFramebuffer(b1.__webglFramebuffer[b0]);c.deleteRenderbuffer(b1.__webglRenderbuffer[b0])}}else{c.deleteFramebuffer(b1.__webglFramebuffer);c.deleteRenderbuffer(b1.__webglRenderbuffer)}};var S=function(b6){var b2=b6.program;if(b2===undefined){return}b6.program=undefined;var b3,b1,b5;var b4=false;for(b3=0,b1=bE.length;b3<b1;b3++){b5=bE[b3];if(b5.program===b2){b5.usedTimes--;if(b5.usedTimes===0){b4=true}break}}if(b4===true){var b0=[];for(b3=0,b1=bE.length;b3<b1;b3++){b5=bE[b3];if(b5.program!==b2){b0.push(b5)}}bE=b0;c.deleteProgram(b2);aO.info.memory.programs--}};function bV(b6,b1){var b3=b6.vertices.length;var b4=b1.material;if(b4.attributes){if(b6.__webglCustomAttributesList===undefined){b6.__webglCustomAttributesList=[]}for(var b0 in b4.attributes){var b5=b4.attributes[b0];if(!b5.__webglInitialized||b5.createUniqueBuffers){b5.__webglInitialized=true;var b2=1;if(b5.type==="v2"){b2=2}else{if(b5.type==="v3"){b2=3}else{if(b5.type==="v4"){b2=4}else{if(b5.type==="c"){b2=3}}}}b5.size=b2;b5.array=new Float32Array(b3*b2);b5.buffer=c.createBuffer();b5.buffer.belongsToAttribute=b0;b5.needsUpdate=true}b6.__webglCustomAttributesList.push(b5)}}}function bK(b2,b0){var b1=b2.vertices.length;b2.__vertexArray=new Float32Array(b1*3);b2.__colorArray=new Float32Array(b1*3);b2.__sortArray=[];b2.__webglParticleCount=b1;bV(b2,b0)}function K(b2,b0){var b1=b2.vertices.length;b2.__vertexArray=new Float32Array(b1*3);b2.__colorArray=new Float32Array(b1*3);b2.__lineDistanceArray=new Float32Array(b1*1);b2.__webglLineCount=b1;bV(b2,b0)}function al(b8,cg){var b0=cg.geometry,ch=b8.faces3,cb=ch.length*3,b3=ch.length*1,b5=ch.length*3,b2=L(cg,b8),b7=bu(b2),b9=aR(b2),ce=bM(b2);b8.__vertexArray=new Float32Array(cb*3);if(b9){b8.__normalArray=new Float32Array(cb*3)}if(b0.hasTangents){b8.__tangentArray=new Float32Array(cb*4)}if(ce){b8.__colorArray=new Float32Array(cb*3)}if(b7){if(b0.faceVertexUvs.length>0){b8.__uvArray=new Float32Array(cb*2)}if(b0.faceVertexUvs.length>1){b8.__uv2Array=new Float32Array(cb*2)}}if(cg.geometry.skinWeights.length&&cg.geometry.skinIndices.length){b8.__skinIndexArray=new Float32Array(cb*4);b8.__skinWeightArray=new Float32Array(cb*4)}b8.__faceArray=new Uint16Array(b3*3);b8.__lineArray=new Uint16Array(b5*2);var ca,cd;if(b8.numMorphTargets){b8.__morphTargetsArrays=[];for(ca=0,cd=b8.numMorphTargets;ca<cd;ca++){b8.__morphTargetsArrays.push(new Float32Array(cb*3))}}if(b8.numMorphNormals){b8.__morphNormalsArrays=[];for(ca=0,cd=b8.numMorphNormals;ca<cd;ca++){b8.__morphNormalsArrays.push(new Float32Array(cb*3))}}b8.__webglFaceCount=b3*3;b8.__webglLineCount=b5*2;if(b2.attributes){if(b8.__webglCustomAttributesList===undefined){b8.__webglCustomAttributesList=[]}for(var cf in b2.attributes){var cc=b2.attributes[cf];var b4={};for(var b1 in cc){b4[b1]=cc[b1]}if(!b4.__webglInitialized||b4.createUniqueBuffers){b4.__webglInitialized=true;var b6=1;if(b4.type==="v2"){b6=2}else{if(b4.type==="v3"){b6=3}else{if(b4.type==="v4"){b6=4}else{if(b4.type==="c"){b6=3}}}}b4.size=b6;b4.array=new Float32Array(cb*b6);b4.buffer=c.createBuffer();b4.buffer.belongsToAttribute=cf;cc.needsUpdate=true;b4.__original=cc}b8.__webglCustomAttributesList.push(b4)}}b8.__inittedArrays=true}function L(b1,b0){return b1.material instanceof THREE.MeshFaceMaterial?b1.material.materials[b0.materialIndex]:b1.material}function bB(b0){return b0&&b0.shading!==undefined&&b0.shading===THREE.SmoothShading}function aR(b0){if((b0 instanceof THREE.MeshBasicMaterial&&!b0.envMap)||b0 instanceof THREE.MeshDepthMaterial){return false}if(bB(b0)){return THREE.SmoothShading}else{return THREE.FlatShading}}function bM(b0){if(b0.vertexColors){return b0.vertexColors}return false}function bu(b0){if(b0.map||b0.lightMap||b0.bumpMap||b0.normalMap||b0.specularMap||b0 instanceof THREE.ShaderMaterial){return true}return false}function E(b3){var b0,b2,b1;for(b0 in b3.attributes){if(b0==="index"){b1=c.ELEMENT_ARRAY_BUFFER}else{b1=c.ARRAY_BUFFER}b2=b3.attributes[b0];if(b2.numItems===undefined){b2.numItems=b2.array.length}b2.buffer=c.createBuffer();c.bindBuffer(b1,b2.buffer);c.bufferData(b1,b2.array,c.STATIC_DRAW)}}function a7(b1,ce,cs){var cc,cq,co,b3,b6,ck,b4=b1.vertices,cp=b4.length,b8=b1.colors,b7=b8.length,cd=b1.__vertexArray,b0=b1.__colorArray,b2=b1.__sortArray,ci=b1.verticesNeedUpdate,b5=b1.elementsNeedUpdate,cf=b1.colorsNeedUpdate,ch=b1.__webglCustomAttributesList,cm,b9,cr,cg,cb,cj,cn;if(cs.sortParticles){G.copy(a0);G.multiply(cs.matrixWorld);for(cc=0;cc<cp;cc++){co=b4[cc];W.copy(co);W.applyProjection(G);b2[cc]=[W.z,cc]}b2.sort(ac);for(cc=0;cc<cp;cc++){co=b4[b2[cc][1]];b3=cc*3;cd[b3]=co.x;cd[b3+1]=co.y;cd[b3+2]=co.z}for(cq=0;cq<b7;cq++){b3=cq*3;ck=b8[b2[cq][1]];b0[b3]=ck.r;b0[b3+1]=ck.g;b0[b3+2]=ck.b}if(ch){for(cm=0,b9=ch.length;cm<b9;cm++){cn=ch[cm];if(!(cn.boundTo===undefined||cn.boundTo==="vertices")){continue}b3=0;cb=cn.value.length;if(cn.size===1){for(cg=0;cg<cb;cg++){b6=b2[cg][1];cn.array[cg]=cn.value[b6]}}else{if(cn.size===2){for(cg=0;cg<cb;cg++){b6=b2[cg][1];cj=cn.value[b6];cn.array[b3]=cj.x;cn.array[b3+1]=cj.y;b3+=2}}else{if(cn.size===3){if(cn.type==="c"){for(cg=0;cg<cb;cg++){b6=b2[cg][1];cj=cn.value[b6];cn.array[b3]=cj.r;cn.array[b3+1]=cj.g;cn.array[b3+2]=cj.b;b3+=3}}else{for(cg=0;cg<cb;cg++){b6=b2[cg][1];cj=cn.value[b6];cn.array[b3]=cj.x;cn.array[b3+1]=cj.y;cn.array[b3+2]=cj.z;b3+=3}}}else{if(cn.size===4){for(cg=0;cg<cb;cg++){b6=b2[cg][1];cj=cn.value[b6];cn.array[b3]=cj.x;cn.array[b3+1]=cj.y;cn.array[b3+2]=cj.z;cn.array[b3+3]=cj.w;b3+=4}}}}}}}}else{if(ci){for(cc=0;cc<cp;cc++){co=b4[cc];b3=cc*3;cd[b3]=co.x;cd[b3+1]=co.y;cd[b3+2]=co.z}}if(cf){for(cq=0;cq<b7;cq++){ck=b8[cq];b3=cq*3;b0[b3]=ck.r;b0[b3+1]=ck.g;b0[b3+2]=ck.b}}if(ch){for(cm=0,b9=ch.length;cm<b9;cm++){cn=ch[cm];if(cn.needsUpdate&&(cn.boundTo===undefined||cn.boundTo==="vertices")){cb=cn.value.length;b3=0;if(cn.size===1){for(cg=0;cg<cb;cg++){cn.array[cg]=cn.value[cg]}}else{if(cn.size===2){for(cg=0;cg<cb;cg++){cj=cn.value[cg];cn.array[b3]=cj.x;cn.array[b3+1]=cj.y;b3+=2}}else{if(cn.size===3){if(cn.type==="c"){for(cg=0;cg<cb;cg++){cj=cn.value[cg];cn.array[b3]=cj.r;cn.array[b3+1]=cj.g;cn.array[b3+2]=cj.b;b3+=3}}else{for(cg=0;cg<cb;cg++){cj=cn.value[cg];cn.array[b3]=cj.x;cn.array[b3+1]=cj.y;cn.array[b3+2]=cj.z;b3+=3}}}else{if(cn.size===4){for(cg=0;cg<cb;cg++){cj=cn.value[cg];cn.array[b3]=cj.x;cn.array[b3+1]=cj.y;cn.array[b3+2]=cj.z;cn.array[b3+3]=cj.w;b3+=4}}}}}}}}}if(ci||cs.sortParticles){c.bindBuffer(c.ARRAY_BUFFER,b1.__webglVertexBuffer);c.bufferData(c.ARRAY_BUFFER,cd,ce)}if(cf||cs.sortParticles){c.bindBuffer(c.ARRAY_BUFFER,b1.__webglColorBuffer);c.bufferData(c.ARRAY_BUFFER,b0,ce)}if(ch){for(cm=0,b9=ch.length;cm<b9;cm++){cn=ch[cm];if(cn.needsUpdate||cs.sortParticles){c.bindBuffer(c.ARRAY_BUFFER,cn.buffer);c.bufferData(c.ARRAY_BUFFER,cn.array,ce)}}}}function bo(b3,ce){var cb,cs,cq,cp,b4,ck,b5=b3.vertices,b7=b3.colors,cd=b3.lineDistances,cr=b5.length,b6=b7.length,cm=cd.length,cc=b3.__vertexArray,b2=b3.__colorArray,b0=b3.__lineDistanceArray,ci=b3.verticesNeedUpdate,cf=b3.colorsNeedUpdate,b1=b3.lineDistancesNeedUpdate,ch=b3.__webglCustomAttributesList,cn,b8,ct,cg,b9,cj,co;if(ci){for(cb=0;cb<cr;cb++){cp=b5[cb];b4=cb*3;cc[b4]=cp.x;cc[b4+1]=cp.y;cc[b4+2]=cp.z}c.bindBuffer(c.ARRAY_BUFFER,b3.__webglVertexBuffer);c.bufferData(c.ARRAY_BUFFER,cc,ce)}if(cf){for(cs=0;cs<b6;cs++){ck=b7[cs];b4=cs*3;b2[b4]=ck.r;b2[b4+1]=ck.g;b2[b4+2]=ck.b}c.bindBuffer(c.ARRAY_BUFFER,b3.__webglColorBuffer);c.bufferData(c.ARRAY_BUFFER,b2,ce)}if(b1){for(cq=0;cq<cm;cq++){b0[cq]=cd[cq]}c.bindBuffer(c.ARRAY_BUFFER,b3.__webglLineDistanceBuffer);c.bufferData(c.ARRAY_BUFFER,b0,ce)}if(ch){for(cn=0,b8=ch.length;cn<b8;cn++){co=ch[cn];if(co.needsUpdate&&(co.boundTo===undefined||co.boundTo==="vertices")){b4=0;b9=co.value.length;if(co.size===1){for(cg=0;cg<b9;cg++){co.array[cg]=co.value[cg]}}else{if(co.size===2){for(cg=0;cg<b9;cg++){cj=co.value[cg];co.array[b4]=cj.x;co.array[b4+1]=cj.y;b4+=2}}else{if(co.size===3){if(co.type==="c"){for(cg=0;cg<b9;cg++){cj=co.value[cg];co.array[b4]=cj.r;co.array[b4+1]=cj.g;co.array[b4+2]=cj.b;b4+=3}}else{for(cg=0;cg<b9;cg++){cj=co.value[cg];co.array[b4]=cj.x;co.array[b4+1]=cj.y;co.array[b4+2]=cj.z;b4+=3}}}else{if(co.size===4){for(cg=0;cg<b9;cg++){cj=co.value[cg];co.array[b4]=cj.x;co.array[b4+1]=cj.y;co.array[b4+2]=cj.z;co.array[b4+3]=cj.w;b4+=4}}}}}c.bindBuffer(c.ARRAY_BUFFER,co.buffer);c.bufferData(c.ARRAY_BUFFER,co.array,ce)}}}}function n(dj,dq,dT,ce,dR){if(!dj.__inittedArrays){return}var cL=aR(dR),cb=bM(dR),di=bu(dR),cA=(cL===THREE.SmoothShading);var cR,dC,dI,b1,ci,b6,cW,cj,cK,b2,cJ,dO,c9,c8,c7,c6,dP,dN,dL,dJ,dH,dE,dD,dB,dg,df,dd,dc,dx,dw,dt,ds,ca,b9,b8,b7,cG,cE,cD,cC,co,cn,cl,ck,cN,dm,cQ,cI,ct,db,dh,cu,cB,cM,de,cS,da,cV,cq=0,cg=0,dl=0,dM=0,cO=0,cz=0,ch=0,c5=0,cf=0,cP=0,b0=0,cc=0,cm=0,cF,b5=dj.__vertexArray,cy=dj.__uvArray,cd=dj.__uv2Array,dr=dj.__normalArray,dv=dj.__tangentArray,cY=dj.__colorArray,dp=dj.__skinIndexArray,dG=dj.__skinWeightArray,dF=dj.__morphTargetsArrays,cv=dj.__morphNormalsArrays,cx=dj.__webglCustomAttributesList,b4,dK=dj.__faceArray,cU=dj.__lineArray,dk=dq.geometry,cs=dk.verticesNeedUpdate,cT=dk.elementsNeedUpdate,cZ=dk.uvsNeedUpdate,b3=dk.normalsNeedUpdate,dQ=dk.tangentsNeedUpdate,du=dk.colorsNeedUpdate,dU=dk.morphTargetsNeedUpdate,c0=dk.vertices,cp=dj.faces3,dy=dk.faces,cX=dk.faceVertexUvs[0],cw=dk.faceVertexUvs[1],dz=dk.colors,cH=dk.skinIndices,dA=dk.skinWeights,dS=dk.morphTargets,dn=dk.morphNormals;if(cs){for(cR=0,dC=cp.length;cR<dC;cR++){b1=dy[cp[cR]];c9=c0[b1.a];c8=c0[b1.b];c7=c0[b1.c];b5[cg]=c9.x;b5[cg+1]=c9.y;b5[cg+2]=c9.z;b5[cg+3]=c8.x;b5[cg+4]=c8.y;b5[cg+5]=c8.z;b5[cg+6]=c7.x;b5[cg+7]=c7.y;b5[cg+8]=c7.z;cg+=9}c.bindBuffer(c.ARRAY_BUFFER,dj.__webglVertexBuffer);c.bufferData(c.ARRAY_BUFFER,b5,dT)}if(dU){for(cu=0,cB=dS.length;cu<cB;cu++){b0=0;for(cR=0,dC=cp.length;cR<dC;cR++){cS=cp[cR];b1=dy[cS];c9=dS[cu].vertices[b1.a];c8=dS[cu].vertices[b1.b];c7=dS[cu].vertices[b1.c];cM=dF[cu];cM[b0]=c9.x;cM[b0+1]=c9.y;cM[b0+2]=c9.z;cM[b0+3]=c8.x;cM[b0+4]=c8.y;cM[b0+5]=c8.z;cM[b0+6]=c7.x;cM[b0+7]=c7.y;cM[b0+8]=c7.z;if(dR.morphNormals){if(cA){da=dn[cu].vertexNormals[cS];dH=da.a;dE=da.b;dD=da.c}else{dH=dn[cu].faceNormals[cS];dE=dH;dD=dH}de=cv[cu];de[b0]=dH.x;de[b0+1]=dH.y;de[b0+2]=dH.z;de[b0+3]=dE.x;de[b0+4]=dE.y;de[b0+5]=dE.z;de[b0+6]=dD.x;de[b0+7]=dD.y;de[b0+8]=dD.z}b0+=9}c.bindBuffer(c.ARRAY_BUFFER,dj.__webglMorphTargetsBuffers[cu]);c.bufferData(c.ARRAY_BUFFER,dF[cu],dT);if(dR.morphNormals){c.bindBuffer(c.ARRAY_BUFFER,dj.__webglMorphNormalsBuffers[cu]);c.bufferData(c.ARRAY_BUFFER,cv[cu],dT)}}}if(dA.length){for(cR=0,dC=cp.length;cR<dC;cR++){b1=dy[cp[cR]];dx=dA[b1.a];dw=dA[b1.b];dt=dA[b1.c];dG[cP]=dx.x;dG[cP+1]=dx.y;dG[cP+2]=dx.z;dG[cP+3]=dx.w;dG[cP+4]=dw.x;dG[cP+5]=dw.y;dG[cP+6]=dw.z;dG[cP+7]=dw.w;dG[cP+8]=dt.x;dG[cP+9]=dt.y;dG[cP+10]=dt.z;dG[cP+11]=dt.w;ca=cH[b1.a];b9=cH[b1.b];b8=cH[b1.c];dp[cP]=ca.x;dp[cP+1]=ca.y;dp[cP+2]=ca.z;dp[cP+3]=ca.w;dp[cP+4]=b9.x;dp[cP+5]=b9.y;dp[cP+6]=b9.z;dp[cP+7]=b9.w;dp[cP+8]=b8.x;dp[cP+9]=b8.y;dp[cP+10]=b8.z;dp[cP+11]=b8.w;cP+=12}if(cP>0){c.bindBuffer(c.ARRAY_BUFFER,dj.__webglSkinIndicesBuffer);c.bufferData(c.ARRAY_BUFFER,dp,dT);c.bindBuffer(c.ARRAY_BUFFER,dj.__webglSkinWeightsBuffer);c.bufferData(c.ARRAY_BUFFER,dG,dT)}}if(du&&cb){for(cR=0,dC=cp.length;cR<dC;cR++){b1=dy[cp[cR]];cj=b1.vertexColors;cK=b1.color;if(cj.length===3&&cb===THREE.VertexColors){dg=cj[0];df=cj[1];dd=cj[2]}else{dg=cK;df=cK;dd=cK}cY[cf]=dg.r;cY[cf+1]=dg.g;cY[cf+2]=dg.b;cY[cf+3]=df.r;cY[cf+4]=df.g;cY[cf+5]=df.b;cY[cf+6]=dd.r;cY[cf+7]=dd.g;cY[cf+8]=dd.b;cf+=9}if(cf>0){c.bindBuffer(c.ARRAY_BUFFER,dj.__webglColorBuffer);c.bufferData(c.ARRAY_BUFFER,cY,dT)}}if(dQ&&dk.hasTangents){for(cR=0,dC=cp.length;cR<dC;cR++){b1=dy[cp[cR]];b2=b1.vertexTangents;dP=b2[0];dN=b2[1];dL=b2[2];dv[ch]=dP.x;dv[ch+1]=dP.y;dv[ch+2]=dP.z;dv[ch+3]=dP.w;dv[ch+4]=dN.x;dv[ch+5]=dN.y;dv[ch+6]=dN.z;dv[ch+7]=dN.w;dv[ch+8]=dL.x;dv[ch+9]=dL.y;dv[ch+10]=dL.z;dv[ch+11]=dL.w;ch+=12}c.bindBuffer(c.ARRAY_BUFFER,dj.__webglTangentBuffer);c.bufferData(c.ARRAY_BUFFER,dv,dT)}if(b3&&cL){for(cR=0,dC=cp.length;cR<dC;cR++){b1=dy[cp[cR]];ci=b1.vertexNormals;b6=b1.normal;if(ci.length===3&&cA){for(cQ=0;cQ<3;cQ++){ct=ci[cQ];dr[cz]=ct.x;dr[cz+1]=ct.y;dr[cz+2]=ct.z;cz+=3}}else{for(cQ=0;cQ<3;cQ++){dr[cz]=b6.x;dr[cz+1]=b6.y;dr[cz+2]=b6.z;cz+=3}}}c.bindBuffer(c.ARRAY_BUFFER,dj.__webglNormalBuffer);c.bufferData(c.ARRAY_BUFFER,dr,dT)}if(cZ&&cX&&di){for(cR=0,dC=cp.length;cR<dC;cR++){dI=cp[cR];cJ=cX[dI];if(cJ===undefined){continue}for(cQ=0;cQ<3;cQ++){db=cJ[cQ];cy[dl]=db.x;cy[dl+1]=db.y;dl+=2}}if(dl>0){c.bindBuffer(c.ARRAY_BUFFER,dj.__webglUVBuffer);c.bufferData(c.ARRAY_BUFFER,cy,dT)}}if(cZ&&cw&&di){for(cR=0,dC=cp.length;cR<dC;cR++){dI=cp[cR];dO=cw[dI];if(dO===undefined){continue}for(cQ=0;cQ<3;cQ++){dh=dO[cQ];cd[dM]=dh.x;cd[dM+1]=dh.y;dM+=2}}if(dM>0){c.bindBuffer(c.ARRAY_BUFFER,dj.__webglUV2Buffer);c.bufferData(c.ARRAY_BUFFER,cd,dT)}}if(cT){for(cR=0,dC=cp.length;cR<dC;cR++){dK[cO]=cq;dK[cO+1]=cq+1;dK[cO+2]=cq+2;cO+=3;cU[c5]=cq;cU[c5+1]=cq+1;cU[c5+2]=cq;cU[c5+3]=cq+2;cU[c5+4]=cq+1;cU[c5+5]=cq+2;c5+=6;cq+=3}c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,dj.__webglFaceBuffer);c.bufferData(c.ELEMENT_ARRAY_BUFFER,dK,dT);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,dj.__webglLineBuffer);c.bufferData(c.ELEMENT_ARRAY_BUFFER,cU,dT)}if(cx){for(cQ=0,cI=cx.length;cQ<cI;cQ++){b4=cx[cQ];if(!b4.__original.needsUpdate){continue}cc=0;cm=0;if(b4.size===1){if(b4.boundTo===undefined||b4.boundTo==="vertices"){for(cR=0,dC=cp.length;cR<dC;cR++){b1=dy[cp[cR]];b4.array[cc]=b4.value[b1.a];b4.array[cc+1]=b4.value[b1.b];b4.array[cc+2]=b4.value[b1.c];cc+=3}}else{if(b4.boundTo==="faces"){for(cR=0,dC=cp.length;cR<dC;cR++){cF=b4.value[cp[cR]];b4.array[cc]=cF;b4.array[cc+1]=cF;b4.array[cc+2]=cF;cc+=3}}}}else{if(b4.size===2){if(b4.boundTo===undefined||b4.boundTo==="vertices"){for(cR=0,dC=cp.length;cR<dC;cR++){b1=dy[cp[cR]];c9=b4.value[b1.a];c8=b4.value[b1.b];c7=b4.value[b1.c];b4.array[cc]=c9.x;b4.array[cc+1]=c9.y;b4.array[cc+2]=c8.x;b4.array[cc+3]=c8.y;b4.array[cc+4]=c7.x;b4.array[cc+5]=c7.y;cc+=6}}else{if(b4.boundTo==="faces"){for(cR=0,dC=cp.length;cR<dC;cR++){cF=b4.value[cp[cR]];c9=cF;c8=cF;c7=cF;b4.array[cc]=c9.x;b4.array[cc+1]=c9.y;b4.array[cc+2]=c8.x;b4.array[cc+3]=c8.y;b4.array[cc+4]=c7.x;b4.array[cc+5]=c7.y;cc+=6}}}}else{if(b4.size===3){var cr;if(b4.type==="c"){cr=["r","g","b"]}else{cr=["x","y","z"]}if(b4.boundTo===undefined||b4.boundTo==="vertices"){for(cR=0,dC=cp.length;cR<dC;cR++){b1=dy[cp[cR]];c9=b4.value[b1.a];c8=b4.value[b1.b];c7=b4.value[b1.c];b4.array[cc]=c9[cr[0]];b4.array[cc+1]=c9[cr[1]];b4.array[cc+2]=c9[cr[2]];b4.array[cc+3]=c8[cr[0]];b4.array[cc+4]=c8[cr[1]];b4.array[cc+5]=c8[cr[2]];b4.array[cc+6]=c7[cr[0]];b4.array[cc+7]=c7[cr[1]];b4.array[cc+8]=c7[cr[2]];cc+=9}}else{if(b4.boundTo==="faces"){for(cR=0,dC=cp.length;cR<dC;cR++){cF=b4.value[cp[cR]];c9=cF;c8=cF;c7=cF;b4.array[cc]=c9[cr[0]];b4.array[cc+1]=c9[cr[1]];b4.array[cc+2]=c9[cr[2]];b4.array[cc+3]=c8[cr[0]];b4.array[cc+4]=c8[cr[1]];b4.array[cc+5]=c8[cr[2]];b4.array[cc+6]=c7[cr[0]];b4.array[cc+7]=c7[cr[1]];b4.array[cc+8]=c7[cr[2]];cc+=9}}else{if(b4.boundTo==="faceVertices"){for(cR=0,dC=cp.length;cR<dC;cR++){cF=b4.value[cp[cR]];c9=cF[0];c8=cF[1];c7=cF[2];b4.array[cc]=c9[cr[0]];b4.array[cc+1]=c9[cr[1]];b4.array[cc+2]=c9[cr[2]];b4.array[cc+3]=c8[cr[0]];b4.array[cc+4]=c8[cr[1]];b4.array[cc+5]=c8[cr[2]];b4.array[cc+6]=c7[cr[0]];b4.array[cc+7]=c7[cr[1]];b4.array[cc+8]=c7[cr[2]];cc+=9}}}}}else{if(b4.size===4){if(b4.boundTo===undefined||b4.boundTo==="vertices"){for(cR=0,dC=cp.length;cR<dC;cR++){b1=dy[cp[cR]];c9=b4.value[b1.a];c8=b4.value[b1.b];c7=b4.value[b1.c];b4.array[cc]=c9.x;b4.array[cc+1]=c9.y;b4.array[cc+2]=c9.z;b4.array[cc+3]=c9.w;b4.array[cc+4]=c8.x;b4.array[cc+5]=c8.y;b4.array[cc+6]=c8.z;b4.array[cc+7]=c8.w;b4.array[cc+8]=c7.x;b4.array[cc+9]=c7.y;b4.array[cc+10]=c7.z;b4.array[cc+11]=c7.w;cc+=12}}else{if(b4.boundTo==="faces"){for(cR=0,dC=cp.length;cR<dC;cR++){cF=b4.value[cp[cR]];c9=cF;c8=cF;c7=cF;b4.array[cc]=c9.x;b4.array[cc+1]=c9.y;b4.array[cc+2]=c9.z;b4.array[cc+3]=c9.w;b4.array[cc+4]=c8.x;b4.array[cc+5]=c8.y;b4.array[cc+6]=c8.z;b4.array[cc+7]=c8.w;b4.array[cc+8]=c7.x;b4.array[cc+9]=c7.y;b4.array[cc+10]=c7.z;b4.array[cc+11]=c7.w;cc+=12}}else{if(b4.boundTo==="faceVertices"){for(cR=0,dC=cp.length;cR<dC;cR++){cF=b4.value[cp[cR]];c9=cF[0];c8=cF[1];c7=cF[2];b4.array[cc]=c9.x;b4.array[cc+1]=c9.y;b4.array[cc+2]=c9.z;b4.array[cc+3]=c9.w;b4.array[cc+4]=c8.x;b4.array[cc+5]=c8.y;b4.array[cc+6]=c8.z;b4.array[cc+7]=c8.w;b4.array[cc+8]=c7.x;b4.array[cc+9]=c7.y;b4.array[cc+10]=c7.z;b4.array[cc+11]=c7.w;cc+=12}}}}}}}}c.bindBuffer(c.ARRAY_BUFFER,b4.buffer);c.bufferData(c.ARRAY_BUFFER,b4.array,dT)}}if(ce){delete dj.__inittedArrays;delete dj.__colorArray;delete dj.__normalArray;delete dj.__tangentArray;delete dj.__uvArray;delete dj.__uv2Array;delete dj.__faceArray;delete dj.__vertexArray;delete dj.__lineArray;delete dj.__skinIndexArray;delete dj.__skinWeightArray}}function ax(b5,b4,b3){var b0=b5.attributes;var b1,b2;for(b1 in b0){b2=b0[b1];if(b2.needsUpdate){if(b1==="index"){c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,b2.buffer);c.bufferData(c.ELEMENT_ARRAY_BUFFER,b2.array,b4)}else{c.bindBuffer(c.ARRAY_BUFFER,b2.buffer);c.bufferData(c.ARRAY_BUFFER,b2.array,b4)}b2.needsUpdate=false}if(b3&&!b2.dynamic){b2.array=null}}}this.renderBufferImmediate=function(cf,b3,b5){if(cf.hasPositions&&!cf.__webglVertexBuffer){cf.__webglVertexBuffer=c.createBuffer()}if(cf.hasNormals&&!cf.__webglNormalBuffer){cf.__webglNormalBuffer=c.createBuffer()}if(cf.hasUvs&&!cf.__webglUvBuffer){cf.__webglUvBuffer=c.createBuffer()}if(cf.hasColors&&!cf.__webglColorBuffer){cf.__webglColorBuffer=c.createBuffer()}if(cf.hasPositions){c.bindBuffer(c.ARRAY_BUFFER,cf.__webglVertexBuffer);c.bufferData(c.ARRAY_BUFFER,cf.positionArray,c.DYNAMIC_DRAW);c.enableVertexAttribArray(b3.attributes.position);c.vertexAttribPointer(b3.attributes.position,3,c.FLOAT,false,0,0)}if(cf.hasNormals){c.bindBuffer(c.ARRAY_BUFFER,cf.__webglNormalBuffer);if(b5.shading===THREE.FlatShading){var cd,cc,ca,b2,b8,ch,b1,b7,cg,b0,b6,ce,cb,b9,b4=cf.count*3;for(b9=0;b9<b4;b9+=9){cb=cf.normalArray;b2=cb[b9];b1=cb[b9+1];b0=cb[b9+2];b8=cb[b9+3];b7=cb[b9+4];b6=cb[b9+5];ch=cb[b9+6];cg=cb[b9+7];ce=cb[b9+8];cd=(b2+b8+ch)/3;cc=(b1+b7+cg)/3;ca=(b0+b6+ce)/3;cb[b9]=cd;cb[b9+1]=cc;cb[b9+2]=ca;cb[b9+3]=cd;cb[b9+4]=cc;cb[b9+5]=ca;cb[b9+6]=cd;cb[b9+7]=cc;cb[b9+8]=ca}}c.bufferData(c.ARRAY_BUFFER,cf.normalArray,c.DYNAMIC_DRAW);c.enableVertexAttribArray(b3.attributes.normal);c.vertexAttribPointer(b3.attributes.normal,3,c.FLOAT,false,0,0)}if(cf.hasUvs&&b5.map){c.bindBuffer(c.ARRAY_BUFFER,cf.__webglUvBuffer);c.bufferData(c.ARRAY_BUFFER,cf.uvArray,c.DYNAMIC_DRAW);c.enableVertexAttribArray(b3.attributes.uv);c.vertexAttribPointer(b3.attributes.uv,2,c.FLOAT,false,0,0)}if(cf.hasColors&&b5.vertexColors!==THREE.NoColors){c.bindBuffer(c.ARRAY_BUFFER,cf.__webglColorBuffer);c.bufferData(c.ARRAY_BUFFER,cf.colorArray,c.DYNAMIC_DRAW);c.enableVertexAttribArray(b3.attributes.color);c.vertexAttribPointer(b3.attributes.color,3,c.FLOAT,false,0,0)}c.drawArrays(c.TRIANGLES,0,cf.count);cf.count=0};this.renderBufferDirect=function(ci,cn,b0,ca,b3,cp){if(ca.visible===false){return}var ch,cm,cb;var b9,cc,cd,b1;var b7=aQ(ci,cn,b0,ca,cp);var ck=b7.attributes;var b5=b3.attributes;var ce=false,cg=ca.wireframe?1:0,cl=(b3.id*16777215)+(b7.id*2)+cg;if(cl!==F){F=cl;ce=true}if(ce){by()}if(cp instanceof THREE.Mesh){var b6=b5.index;if(b6){var b4=b3.offsets;if(b4.length>1){ce=true}for(var cf=0,b8=b4.length;cf<b8;cf++){var b2=b4[cf].index;if(ce){for(cc in ck){cd=ck[cc];b9=b5[cc];if(cd>=0){if(b9){b1=b9.itemSize;c.bindBuffer(c.ARRAY_BUFFER,b9.buffer);ai(cd);c.vertexAttribPointer(cd,b1,c.FLOAT,false,0,b2*b1*4)}else{if(ca.defaultAttributeValues){if(ca.defaultAttributeValues[cc].length===2){c.vertexAttrib2fv(cd,ca.defaultAttributeValues[cc])}else{if(ca.defaultAttributeValues[cc].length===3){c.vertexAttrib3fv(cd,ca.defaultAttributeValues[cc])}}}}}}c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,b6.buffer)}c.drawElements(c.TRIANGLES,b4[cf].count,c.UNSIGNED_SHORT,b4[cf].start*2);aO.info.render.calls++;aO.info.render.vertices+=b4[cf].count;aO.info.render.faces+=b4[cf].count/3}}else{if(ce){for(cc in ck){if(cc==="index"){continue}cd=ck[cc];b9=b5[cc];if(cd>=0){if(b9){b1=b9.itemSize;c.bindBuffer(c.ARRAY_BUFFER,b9.buffer);ai(cd);c.vertexAttribPointer(cd,b1,c.FLOAT,false,0,0)}else{if(ca.defaultAttributeValues&&ca.defaultAttributeValues[cc]){if(ca.defaultAttributeValues[cc].length===2){c.vertexAttrib2fv(cd,ca.defaultAttributeValues[cc])}else{if(ca.defaultAttributeValues[cc].length===3){c.vertexAttrib3fv(cd,ca.defaultAttributeValues[cc])}}}}}}}var co=b3.attributes.position;c.drawArrays(c.TRIANGLES,0,co.numItems/3);aO.info.render.calls++;aO.info.render.vertices+=co.numItems/3;aO.info.render.faces+=co.numItems/3/3}}else{if(cp instanceof THREE.ParticleSystem){if(ce){for(cc in ck){cd=ck[cc];b9=b5[cc];if(cd>=0){if(b9){b1=b9.itemSize;c.bindBuffer(c.ARRAY_BUFFER,b9.buffer);ai(cd);c.vertexAttribPointer(cd,b1,c.FLOAT,false,0,0)}else{if(ca.defaultAttributeValues&&ca.defaultAttributeValues[cc]){if(ca.defaultAttributeValues[cc].length===2){c.vertexAttrib2fv(cd,ca.defaultAttributeValues[cc])}else{if(ca.defaultAttributeValues[cc].length===3){c.vertexAttrib3fv(cd,ca.defaultAttributeValues[cc])}}}}}}var co=b5.position;c.drawArrays(c.POINTS,0,co.numItems/3);aO.info.render.calls++;aO.info.render.points+=co.numItems/3}}else{if(cp instanceof THREE.Line){if(ce){for(cc in ck){cd=ck[cc];b9=b5[cc];if(cd>=0){if(b9){b1=b9.itemSize;c.bindBuffer(c.ARRAY_BUFFER,b9.buffer);ai(cd);c.vertexAttribPointer(cd,b1,c.FLOAT,false,0,0)}else{if(ca.defaultAttributeValues&&ca.defaultAttributeValues[cc]){if(ca.defaultAttributeValues[cc].length===2){c.vertexAttrib2fv(cd,ca.defaultAttributeValues[cc])}else{if(ca.defaultAttributeValues[cc].length===3){c.vertexAttrib3fv(cd,ca.defaultAttributeValues[cc])}}}}}}var cj=(cp.type===THREE.LineStrip)?c.LINE_STRIP:c.LINES;aI(ca.linewidth);var co=b5.position;c.drawArrays(cj,0,co.numItems/3);aO.info.render.calls++;aO.info.render.points+=co.numItems}}}}};this.renderBuffer=function(ca,b7,b0,cb,b4,b3){if(cb.visible===false){return}var cd,cf,b1,b9,ce;var b8=aQ(ca,b7,b0,cb,b3);var b6=b8.attributes;var b2=false,cc=cb.wireframe?1:0,b5=(b4.id*16777215)+(b8.id*2)+cc;if(b5!==F){F=b5;b2=true}if(b2){by()}if(!cb.morphTargets&&b6.position>=0){if(b2){c.bindBuffer(c.ARRAY_BUFFER,b4.__webglVertexBuffer);ai(b6.position);c.vertexAttribPointer(b6.position,3,c.FLOAT,false,0,0)}}else{if(b3.morphTargetBase){v(cb,b4,b3)}}if(b2){if(b4.__webglCustomAttributesList){for(b9=0,ce=b4.__webglCustomAttributesList.length;b9<ce;b9++){b1=b4.__webglCustomAttributesList[b9];if(b6[b1.buffer.belongsToAttribute]>=0){c.bindBuffer(c.ARRAY_BUFFER,b1.buffer);ai(b6[b1.buffer.belongsToAttribute]);c.vertexAttribPointer(b6[b1.buffer.belongsToAttribute],b1.size,c.FLOAT,false,0,0)}}}if(b6.color>=0){if(b3.geometry.colors.length>0||b3.geometry.faces.length>0){c.bindBuffer(c.ARRAY_BUFFER,b4.__webglColorBuffer);ai(b6.color);c.vertexAttribPointer(b6.color,3,c.FLOAT,false,0,0)}else{if(cb.defaultAttributeValues){c.vertexAttrib3fv(b6.color,cb.defaultAttributeValues.color)}}}if(b6.normal>=0){c.bindBuffer(c.ARRAY_BUFFER,b4.__webglNormalBuffer);ai(b6.normal);c.vertexAttribPointer(b6.normal,3,c.FLOAT,false,0,0)}if(b6.tangent>=0){c.bindBuffer(c.ARRAY_BUFFER,b4.__webglTangentBuffer);ai(b6.tangent);c.vertexAttribPointer(b6.tangent,4,c.FLOAT,false,0,0)}if(b6.uv>=0){if(b3.geometry.faceVertexUvs[0]){c.bindBuffer(c.ARRAY_BUFFER,b4.__webglUVBuffer);ai(b6.uv);c.vertexAttribPointer(b6.uv,2,c.FLOAT,false,0,0)}else{if(cb.defaultAttributeValues){c.vertexAttrib2fv(b6.uv,cb.defaultAttributeValues.uv)}}}if(b6.uv2>=0){if(b3.geometry.faceVertexUvs[1]){c.bindBuffer(c.ARRAY_BUFFER,b4.__webglUV2Buffer);ai(b6.uv2);c.vertexAttribPointer(b6.uv2,2,c.FLOAT,false,0,0)}else{if(cb.defaultAttributeValues){c.vertexAttrib2fv(b6.uv2,cb.defaultAttributeValues.uv2)}}}if(cb.skinning&&b6.skinIndex>=0&&b6.skinWeight>=0){c.bindBuffer(c.ARRAY_BUFFER,b4.__webglSkinIndicesBuffer);ai(b6.skinIndex);c.vertexAttribPointer(b6.skinIndex,4,c.FLOAT,false,0,0);c.bindBuffer(c.ARRAY_BUFFER,b4.__webglSkinWeightsBuffer);ai(b6.skinWeight);c.vertexAttribPointer(b6.skinWeight,4,c.FLOAT,false,0,0)}if(b6.lineDistance>=0){c.bindBuffer(c.ARRAY_BUFFER,b4.__webglLineDistanceBuffer);ai(b6.lineDistance);c.vertexAttribPointer(b6.lineDistance,1,c.FLOAT,false,0,0)}}if(b3 instanceof THREE.Mesh){if(cb.wireframe){aI(cb.wireframeLinewidth);if(b2){c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,b4.__webglLineBuffer)}c.drawElements(c.LINES,b4.__webglLineCount,c.UNSIGNED_SHORT,0)}else{if(b2){c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,b4.__webglFaceBuffer)}c.drawElements(c.TRIANGLES,b4.__webglFaceCount,c.UNSIGNED_SHORT,0)}aO.info.render.calls++;aO.info.render.vertices+=b4.__webglFaceCount;aO.info.render.faces+=b4.__webglFaceCount/3}else{if(b3 instanceof THREE.Line){var cg=(b3.type===THREE.LineStrip)?c.LINE_STRIP:c.LINES;aI(cb.linewidth);c.drawArrays(cg,0,b4.__webglLineCount);aO.info.render.calls++}else{if(b3 instanceof THREE.ParticleSystem){c.drawArrays(c.POINTS,0,b4.__webglParticleCount);aO.info.render.calls++;aO.info.render.points+=b4.__webglParticleCount}}}};function ai(b0){if(!N[b0]){c.enableVertexAttribArray(b0);N[b0]=true}}function by(){for(var b0 in N){if(N[b0]){c.disableVertexAttribArray(b0);N[b0]=false}}}function v(b8,b4,b3){var b6=b8.program.attributes;if(b3.morphTargetBase!==-1&&b6.position>=0){c.bindBuffer(c.ARRAY_BUFFER,b4.__webglMorphTargetsBuffers[b3.morphTargetBase]);ai(b6.position);c.vertexAttribPointer(b6.position,3,c.FLOAT,false,0,0)}else{if(b6.position>=0){c.bindBuffer(c.ARRAY_BUFFER,b4.__webglVertexBuffer);ai(b6.position);c.vertexAttribPointer(b6.position,3,c.FLOAT,false,0,0)}}if(b3.morphTargetForcedOrder.length){var b0=0;var b1=b3.morphTargetForcedOrder;var ca=b3.morphTargetInfluences;while(b0<b8.numSupportedMorphTargets&&b0<b1.length){if(b6["morphTarget"+b0]>=0){c.bindBuffer(c.ARRAY_BUFFER,b4.__webglMorphTargetsBuffers[b1[b0]]);ai(b6["morphTarget"+b0]);c.vertexAttribPointer(b6["morphTarget"+b0],3,c.FLOAT,false,0,0)}if(b6["morphNormal"+b0]>=0&&b8.morphNormals){c.bindBuffer(c.ARRAY_BUFFER,b4.__webglMorphNormalsBuffers[b1[b0]]);ai(b6["morphNormal"+b0]);c.vertexAttribPointer(b6["morphNormal"+b0],3,c.FLOAT,false,0,0)}b3.__webglMorphTargetInfluences[b0]=ca[b1[b0]];b0++}}else{var b9,b2=[];var ca=b3.morphTargetInfluences;var b7,cb=ca.length;for(b7=0;b7<cb;b7++){b9=ca[b7];if(b9>0){b2.push([b9,b7])}}if(b2.length>b8.numSupportedMorphTargets){b2.sort(ac);b2.length=b8.numSupportedMorphTargets}else{if(b2.length>b8.numSupportedMorphNormals){b2.sort(ac)}else{if(b2.length===0){b2.push([0,0])}}}var b5,b0=0;while(b0<b8.numSupportedMorphTargets){if(b2[b0]){b5=b2[b0][1];if(b6["morphTarget"+b0]>=0){c.bindBuffer(c.ARRAY_BUFFER,b4.__webglMorphTargetsBuffers[b5]);ai(b6["morphTarget"+b0]);c.vertexAttribPointer(b6["morphTarget"+b0],3,c.FLOAT,false,0,0)}if(b6["morphNormal"+b0]>=0&&b8.morphNormals){c.bindBuffer(c.ARRAY_BUFFER,b4.__webglMorphNormalsBuffers[b5]);ai(b6["morphNormal"+b0]);c.vertexAttribPointer(b6["morphNormal"+b0],3,c.FLOAT,false,0,0)}b3.__webglMorphTargetInfluences[b0]=ca[b5]}else{b3.__webglMorphTargetInfluences[b0]=0}b0++}}if(b8.program.uniforms.morphTargetInfluences!==null){c.uniform1fv(b8.program.uniforms.morphTargetInfluences,b3.__webglMorphTargetInfluences)}}function aH(b1,b0){if(b1.z!==b0.z){return b0.z-b1.z}else{return b1.id-b0.id}}function ac(b1,b0){return b0[0]-b1[0]}this.render=function(b6,ca,b7,b8){if(ca instanceof THREE.Camera===false){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}var b4,cb,b5,b2,b0,b3=b6.__lights,b1=b6.fog;a2=-1;bZ=true;if(b6.autoUpdate===true){b6.updateMatrixWorld()}if(ca.parent===undefined){ca.updateMatrixWorld()}ca.matrixWorldInverse.getInverse(ca.matrixWorld);a0.multiplyMatrices(ca.projectionMatrix,ca.matrixWorldInverse);bt.setFromMatrix(a0);if(this.autoUpdateObjects){this.initWebGLObjects(b6)}p(this.renderPluginsPre,b6,ca);aO.info.render.calls=0;aO.info.render.vertices=0;aO.info.render.faces=0;aO.info.render.points=0;this.setRenderTarget(b7);if(this.autoClear||b8){this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil)}b0=b6.__webglObjects;for(b4=0,cb=b0.length;b4<cb;b4++){b5=b0[b4];b2=b5.object;b5.id=b4;b5.render=false;if(b2.visible){if(!(b2 instanceof THREE.Mesh||b2 instanceof THREE.ParticleSystem)||!(b2.frustumCulled)||bt.intersectsObject(b2)){bh(b2,ca);ap(b5);b5.render=true;if(this.sortObjects===true){if(b2.renderDepth!==null){b5.z=b2.renderDepth}else{W.setFromMatrixPosition(b2.matrixWorld);W.applyProjection(a0);b5.z=W.z}}}}}if(this.sortObjects){b0.sort(aH)}b0=b6.__webglObjectsImmediate;for(b4=0,cb=b0.length;b4<cb;b4++){b5=b0[b4];b2=b5.object;if(b2.visible){bh(b2,ca);aS(b5)}}if(b6.overrideMaterial){var b9=b6.overrideMaterial;this.setBlending(b9.blending,b9.blendEquation,b9.blendSrc,b9.blendDst);this.setDepthTest(b9.depthTest);this.setDepthWrite(b9.depthWrite);bW(b9.polygonOffset,b9.polygonOffsetFactor,b9.polygonOffsetUnits);bw(b6.__webglObjects,false,"",ca,b3,b1,true,b9);bL(b6.__webglObjectsImmediate,"",ca,b3,b1,false,b9)}else{var b9=null;this.setBlending(THREE.NoBlending);bw(b6.__webglObjects,true,"opaque",ca,b3,b1,false,b9);bL(b6.__webglObjectsImmediate,"opaque",ca,b3,b1,false,b9);bw(b6.__webglObjects,false,"transparent",ca,b3,b1,true,b9);bL(b6.__webglObjectsImmediate,"transparent",ca,b3,b1,true,b9)}p(this.renderPluginsPost,b6,ca);if(b7&&b7.generateMipmaps&&b7.minFilter!==THREE.NearestFilter&&b7.minFilter!==THREE.LinearFilter){aX(b7)}this.setDepthTest(true);this.setDepthWrite(true)};function p(b0,b4,b3){if(!b0.length){return}for(var b2=0,b1=b0.length;b2<b1;b2++){am=null;aL=null;i=-1;a=-1;bz=-1;bl=-1;k=-1;F=-1;a2=-1;bZ=true;b0[b2].render(b4,b3,D,aU);am=null;aL=null;i=-1;a=-1;bz=-1;bl=-1;k=-1;F=-1;a2=-1;bZ=true}}function bw(b0,cd,b9,cc,b6,b1,ca,ce){var b8,b4,b5,cb,b2,b3,cf;if(cd){b2=b0.length-1;b3=-1;cf=-1}else{b2=0;b3=b0.length;cf=1}for(var b7=b2;b7!==b3;b7+=cf){b8=b0[b7];if(b8.render){b4=b8.object;b5=b8.buffer;if(ce){cb=ce}else{cb=b8[b9];if(!cb){continue}if(ca){aO.setBlending(cb.blending,cb.blendEquation,cb.blendSrc,cb.blendDst)}aO.setDepthTest(cb.depthTest);aO.setDepthWrite(cb.depthWrite);bW(cb.polygonOffset,cb.polygonOffsetFactor,cb.polygonOffsetUnits)}aO.setMaterialFaces(cb);if(b5 instanceof THREE.BufferGeometry){aO.renderBufferDirect(cc,b6,b1,cb,b5,b4)}else{aO.renderBuffer(cc,b6,b1,cb,b5,b4)}}}}function bL(b0,b7,ca,b3,b1,b8,cb){var b6,b2,b9,b5;for(var b4=0,cc=b0.length;b4<cc;b4++){b6=b0[b4];b2=b6.object;if(b2.visible){if(cb){b9=cb}else{b9=b6[b7];if(!b9){continue}if(b8){aO.setBlending(b9.blending,b9.blendEquation,b9.blendSrc,b9.blendDst)}aO.setDepthTest(b9.depthTest);aO.setDepthWrite(b9.depthWrite);bW(b9.polygonOffset,b9.polygonOffsetFactor,b9.polygonOffsetUnits)}aO.renderImmediateObject(ca,b3,b1,b9,b2)}}}this.renderImmediateObject=function(b4,b2,b5,b3,b1){var b0=aQ(b4,b2,b5,b3,b1);F=-1;aO.setMaterialFaces(b3);if(b1.immediateRenderCallback){b1.immediateRenderCallback(b0,c,bt)}else{b1.render(function(b6){aO.renderBufferImmediate(b6,b0,b3)})}};function aS(b2){var b0=b2.object,b1=b0.material;if(b1.transparent){b2.transparent=b1;b2.opaque=null}else{b2.opaque=b1;b2.transparent=null}}function ap(b5){var b3=b5.object,b2=b5.buffer,b4,b1,b0;b0=b3.material;if(b0 instanceof THREE.MeshFaceMaterial){b1=b2.materialIndex;b4=b0.materials[b1];if(b4.transparent){b5.transparent=b4;b5.opaque=null}else{b5.opaque=b4;b5.transparent=null}}else{b4=b0;if(b4){if(b4.transparent){b5.transparent=b4;b5.opaque=null}else{b5.opaque=b4;b5.transparent=null}}}}function ay(b8,b5){var b3,ca,b7,cb,b6,b1,b4={};var b9=b8.morphTargets.length;var b0=b8.morphNormals.length;var cc=b5 instanceof THREE.MeshFaceMaterial;b8.geometryGroups={};for(b3=0,ca=b8.faces.length;b3<ca;b3++){b7=b8.faces[b3];cb=cc?b7.materialIndex:0;if(b4[cb]===undefined){b4[cb]={hash:cb,counter:0}}b1=b4[cb].hash+"_"+b4[cb].counter;if(b8.geometryGroups[b1]===undefined){b8.geometryGroups[b1]={faces3:[],materialIndex:cb,vertices:0,numMorphTargets:b9,numMorphNormals:b0}}b6=3;if(b8.geometryGroups[b1].vertices+b6>65535){b4[cb].counter+=1;b1=b4[cb].hash+"_"+b4[cb].counter;if(b8.geometryGroups[b1]===undefined){b8.geometryGroups[b1]={faces3:[],materialIndex:cb,vertices:0,numMorphTargets:b9,numMorphNormals:b0}}}b8.geometryGroups[b1].faces3.push(b3);b8.geometryGroups[b1].vertices+=b6}b8.geometryGroupsList=[];for(var b2 in b8.geometryGroups){b8.geometryGroups[b2].id=V++;b8.geometryGroupsList.push(b8.geometryGroups[b2])}}this.initWebGLObjects=function(b2){if(!b2.__webglObjects){b2.__webglObjects=[];b2.__webglObjectsImmediate=[];b2.__webglSprites=[];b2.__webglFlares=[]}while(b2.__objectsAdded.length){at(b2.__objectsAdded[0],b2);b2.__objectsAdded.splice(0,1)}while(b2.__objectsRemoved.length){O(b2.__objectsRemoved[0],b2);b2.__objectsRemoved.splice(0,1)}for(var b3=0,b1=b2.__webglObjects.length;b3<b1;b3++){var b0=b2.__webglObjects[b3].object;if(b0.__webglInit===undefined){if(b0.__webglActive!==undefined){O(b0,b2)}at(b0,b2)}M(b0)}};function at(b1,b4){var b3,b5,b2,b0;if(b1.__webglInit===undefined){b1.__webglInit=true;b1._modelViewMatrix=new THREE.Matrix4();b1._normalMatrix=new THREE.Matrix3();if(b1.geometry!==undefined&&b1.geometry.__webglInit===undefined){b1.geometry.__webglInit=true;b1.geometry.addEventListener("dispose",aZ)}b5=b1.geometry;if(b5===undefined){}else{if(b5 instanceof THREE.BufferGeometry){E(b5)}else{if(b1 instanceof THREE.Mesh){b2=b1.material;if(b5.geometryGroups===undefined){ay(b5,b2)}for(b3 in b5.geometryGroups){b0=b5.geometryGroups[b3];if(!b0.__webglVertexBuffer){aE(b0);al(b0,b1);b5.verticesNeedUpdate=true;b5.morphTargetsNeedUpdate=true;b5.elementsNeedUpdate=true;b5.uvsNeedUpdate=true;b5.normalsNeedUpdate=true;b5.tangentsNeedUpdate=true;b5.colorsNeedUpdate=true}}}else{if(b1 instanceof THREE.Line){if(!b5.__webglVertexBuffer){ae(b5);K(b5,b1);b5.verticesNeedUpdate=true;b5.colorsNeedUpdate=true;b5.lineDistancesNeedUpdate=true}}else{if(b1 instanceof THREE.ParticleSystem){if(!b5.__webglVertexBuffer){H(b5);bK(b5,b1);b5.verticesNeedUpdate=true;b5.colorsNeedUpdate=true}}}}}}}if(b1.__webglActive===undefined){if(b1 instanceof THREE.Mesh){b5=b1.geometry;if(b5 instanceof THREE.BufferGeometry){I(b4.__webglObjects,b5,b1)}else{if(b5 instanceof THREE.Geometry){for(b3 in b5.geometryGroups){b0=b5.geometryGroups[b3];I(b4.__webglObjects,b0,b1)}}}}else{if(b1 instanceof THREE.Line||b1 instanceof THREE.ParticleSystem){b5=b1.geometry;I(b4.__webglObjects,b5,b1)}else{if(b1 instanceof THREE.ImmediateRenderObject||b1.immediateRenderCallback){aD(b4.__webglObjectsImmediate,b1)}else{if(b1 instanceof THREE.Sprite){b4.__webglSprites.push(b1)}else{if(b1 instanceof THREE.LensFlare){b4.__webglFlares.push(b1)}}}}}b1.__webglActive=true}}function I(b2,b0,b1){b2.push({id:null,buffer:b0,object:b1,opaque:null,transparent:null,z:0})}function aD(b1,b0){b1.push({id:null,object:b0,opaque:null,transparent:null,z:0})}function M(b2){var b6=b2.geometry,b0,b4,b5;if(b6 instanceof THREE.BufferGeometry){ax(b6,c.DYNAMIC_DRAW,!b6.dynamic)}else{if(b2 instanceof THREE.Mesh){for(var b3=0,b1=b6.geometryGroupsList.length;b3<b1;b3++){b0=b6.geometryGroupsList[b3];b5=L(b2,b0);if(b6.buffersNeedUpdate){al(b0,b2)}b4=b5.attributes&&h(b5);if(b6.verticesNeedUpdate||b6.morphTargetsNeedUpdate||b6.elementsNeedUpdate||b6.uvsNeedUpdate||b6.normalsNeedUpdate||b6.colorsNeedUpdate||b6.tangentsNeedUpdate||b4){n(b0,b2,c.DYNAMIC_DRAW,!b6.dynamic,b5)}}b6.verticesNeedUpdate=false;b6.morphTargetsNeedUpdate=false;b6.elementsNeedUpdate=false;b6.uvsNeedUpdate=false;b6.normalsNeedUpdate=false;b6.colorsNeedUpdate=false;b6.tangentsNeedUpdate=false;b6.buffersNeedUpdate=false;b5.attributes&&av(b5)}else{if(b2 instanceof THREE.Line){b5=L(b2,b6);b4=b5.attributes&&h(b5);if(b6.verticesNeedUpdate||b6.colorsNeedUpdate||b6.lineDistancesNeedUpdate||b4){bo(b6,c.DYNAMIC_DRAW)}b6.verticesNeedUpdate=false;b6.colorsNeedUpdate=false;b6.lineDistancesNeedUpdate=false;b5.attributes&&av(b5)}else{if(b2 instanceof THREE.ParticleSystem){b5=L(b2,b6);b4=b5.attributes&&h(b5);if(b6.verticesNeedUpdate||b6.colorsNeedUpdate||b2.sortParticles||b4){a7(b6,c.DYNAMIC_DRAW,b2)}b6.verticesNeedUpdate=false;b6.colorsNeedUpdate=false;b5.attributes&&av(b5)}}}}}function h(b1){for(var b0 in b1.attributes){if(b1.attributes[b0].needsUpdate){return true}}return false}function av(b1){for(var b0 in b1.attributes){b1.attributes[b0].needsUpdate=false}}function O(b0,b1){if(b0 instanceof THREE.Mesh||b0 instanceof THREE.ParticleSystem||b0 instanceof THREE.Line){bX(b1.__webglObjects,b0)}else{if(b0 instanceof THREE.Sprite){aA(b1.__webglSprites,b0)}else{if(b0 instanceof THREE.LensFlare){aA(b1.__webglFlares,b0)}else{if(b0 instanceof THREE.ImmediateRenderObject||b0.immediateRenderCallback){bX(b1.__webglObjectsImmediate,b0)}}}}delete b0.__webglActive}function bX(b1,b0){for(var b2=b1.length-1;b2>=0;b2--){if(b1[b2].object===b0){b1.splice(b2,1)}}}function aA(b1,b0){for(var b2=b1.length-1;b2>=0;b2--){if(b1[b2]===b0){b1.splice(b2,1)}}}this.initMaterial=function(ca,b8,b1,b6){ca.addEventListener("dispose",bi);var cf,cc,cb,b9,ce,b4,b0,b5,cd;if(ca instanceof THREE.MeshDepthMaterial){cd="depth"}else{if(ca instanceof THREE.MeshNormalMaterial){cd="normal"}else{if(ca instanceof THREE.MeshBasicMaterial){cd="basic"}else{if(ca instanceof THREE.MeshLambertMaterial){cd="lambert"}else{if(ca instanceof THREE.MeshPhongMaterial){cd="phong"}else{if(ca instanceof THREE.LineBasicMaterial){cd="basic"}else{if(ca instanceof THREE.LineDashedMaterial){cd="dashed"}else{if(ca instanceof THREE.ParticleSystemMaterial){cd="particle_basic"}}}}}}}}if(cd){aq(ca,THREE.ShaderLib[cd])}b4=bg(b8);b5=aa(b8);b0=aJ(b6);ce={map:!!ca.map,envMap:!!ca.envMap,lightMap:!!ca.lightMap,bumpMap:!!ca.bumpMap,normalMap:!!ca.normalMap,specularMap:!!ca.specularMap,vertexColors:ca.vertexColors,fog:b1,useFog:ca.fog,fogExp:b1 instanceof THREE.FogExp2,sizeAttenuation:ca.sizeAttenuation,skinning:ca.skinning,maxBones:b0,useVertexTexture:Z&&b6&&b6.useVertexTexture,morphTargets:ca.morphTargets,morphNormals:ca.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:b4.directional,maxPointLights:b4.point,maxSpotLights:b4.spot,maxHemiLights:b4.hemi,maxShadows:b5,shadowMapEnabled:this.shadowMapEnabled&&b6.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:ca.alphaTest,metal:ca.metal,perPixel:ca.perPixel,wrapAround:ca.wrapAround,doubleSided:ca.side===THREE.DoubleSide,flipSided:ca.side===THREE.BackSide};ca.program=g(cd,ca.fragmentShader,ca.vertexShader,ca.uniforms,ca.attributes,ca.defines,ce,ca.index0AttributeName);var b7=ca.program.attributes;if(ca.morphTargets){ca.numSupportedMorphTargets=0;var b3,b2="morphTarget";for(b9=0;b9<this.maxMorphTargets;b9++){b3=b2+b9;if(b7[b3]>=0){ca.numSupportedMorphTargets++}}}if(ca.morphNormals){ca.numSupportedMorphNormals=0;var b3,b2="morphNormal";for(b9=0;b9<this.maxMorphNormals;b9++){b3=b2+b9;if(b7[b3]>=0){ca.numSupportedMorphNormals++}}}ca.uniformsList=[];for(cf in ca.uniforms){ca.uniformsList.push([ca.uniforms[cf],cf])}};function aq(b1,b0){b1.uniforms=THREE.UniformsUtils.clone(b0.uniforms);b1.vertexShader=b0.vertexShader;b1.fragmentShader=b0.fragmentShader}function aQ(b5,b2,b0,b6,b1){bf=0;if(b6.needsUpdate){if(b6.program){S(b6)}aO.initMaterial(b6,b2,b0,b1);b6.needsUpdate=false}if(b6.morphTargets){if(!b1.__webglMorphTargetInfluences){b1.__webglMorphTargetInfluences=new Float32Array(aO.maxMorphTargets)}}var b4=false;var b3=b6.program,b9=b3.uniforms,b7=b6.uniforms;if(b3!==am){c.useProgram(b3);am=b3;b4=true}if(b6.id!==a2){a2=b6.id;b4=true}if(b4||b5!==aL){c.uniformMatrix4fv(b9.projectionMatrix,false,b5.projectionMatrix.elements);if(b5!==aL){aL=b5}}if(b6.skinning){if(Z&&b1.useVertexTexture){if(b9.boneTexture!==null){var b8=aw();c.uniform1i(b9.boneTexture,b8);aO.setTexture(b1.boneTexture,b8)}if(b9.boneTextureWidth!==null){c.uniform1i(b9.boneTextureWidth,b1.boneTextureWidth)}if(b9.boneTextureHeight!==null){c.uniform1i(b9.boneTextureHeight,b1.boneTextureHeight)}}else{if(b9.boneGlobalMatrices!==null){c.uniformMatrix4fv(b9.boneGlobalMatrices,false,b1.boneMatrices)}}}if(b4){if(b0&&b6.fog){ab(b7,b0)}if(b6 instanceof THREE.MeshPhongMaterial||b6 instanceof THREE.MeshLambertMaterial||b6.lights){if(bZ){f(b3,b2);bZ=false}bc(b7,bq)}if(b6 instanceof THREE.MeshBasicMaterial||b6 instanceof THREE.MeshLambertMaterial||b6 instanceof THREE.MeshPhongMaterial){bH(b7,b6)}if(b6 instanceof THREE.LineBasicMaterial){ar(b7,b6)}else{if(b6 instanceof THREE.LineDashedMaterial){ar(b7,b6);ag(b7,b6)}else{if(b6 instanceof THREE.ParticleSystemMaterial){bp(b7,b6)}else{if(b6 instanceof THREE.MeshPhongMaterial){P(b7,b6)}else{if(b6 instanceof THREE.MeshLambertMaterial){bI(b7,b6)}else{if(b6 instanceof THREE.MeshDepthMaterial){b7.mNear.value=b5.near;b7.mFar.value=b5.far;b7.opacity.value=b6.opacity}else{if(b6 instanceof THREE.MeshNormalMaterial){b7.opacity.value=b6.opacity}}}}}}}if(b1.receiveShadow&&!b6._shadowPass){bP(b7,b2)}U(b3,b6.uniformsList);if(b6 instanceof THREE.ShaderMaterial||b6 instanceof THREE.MeshPhongMaterial||b6.envMap){if(b9.cameraPosition!==null){W.setFromMatrixPosition(b5.matrixWorld);c.uniform3f(b9.cameraPosition,W.x,W.y,W.z)}}if(b6 instanceof THREE.MeshPhongMaterial||b6 instanceof THREE.MeshLambertMaterial||b6 instanceof THREE.ShaderMaterial||b6.skinning){if(b9.viewMatrix!==null){c.uniformMatrix4fv(b9.viewMatrix,false,b5.matrixWorldInverse.elements)}}}u(b9,b1);if(b9.modelMatrix!==null){c.uniformMatrix4fv(b9.modelMatrix,false,b1.matrixWorld.elements)}return b3}function bH(b1,b2){b1.opacity.value=b2.opacity;if(aO.gammaInput){b1.diffuse.value.copyGammaToLinear(b2.color)}else{b1.diffuse.value=b2.color}b1.map.value=b2.map;b1.lightMap.value=b2.lightMap;b1.specularMap.value=b2.specularMap;if(b2.bumpMap){b1.bumpMap.value=b2.bumpMap;b1.bumpScale.value=b2.bumpScale}if(b2.normalMap){b1.normalMap.value=b2.normalMap;b1.normalScale.value.copy(b2.normalScale)}var b0;if(b2.map){b0=b2.map}else{if(b2.specularMap){b0=b2.specularMap}else{if(b2.normalMap){b0=b2.normalMap}else{if(b2.bumpMap){b0=b2.bumpMap}}}}if(b0!==undefined){var b4=b0.offset;var b3=b0.repeat;b1.offsetRepeat.value.set(b4.x,b4.y,b3.x,b3.y)}b1.envMap.value=b2.envMap;b1.flipEnvMap.value=(b2.envMap instanceof THREE.WebGLRenderTargetCube)?1:-1;if(aO.gammaInput){b1.reflectivity.value=b2.reflectivity}else{b1.reflectivity.value=b2.reflectivity}b1.refractionRatio.value=b2.refractionRatio;b1.combine.value=b2.combine;b1.useRefract.value=b2.envMap&&b2.envMap.mapping instanceof THREE.CubeRefractionMapping}function ar(b0,b1){b0.diffuse.value=b1.color;b0.opacity.value=b1.opacity}function ag(b0,b1){b0.dashSize.value=b1.dashSize;b0.totalSize.value=b1.dashSize+b1.gapSize;b0.scale.value=b1.scale}function bp(b0,b1){b0.psColor.value=b1.color;b0.opacity.value=b1.opacity;b0.size.value=b1.size;b0.scale.value=aY.height/2;b0.map.value=b1.map}function ab(b0,b1){b0.fogColor.value=b1.color;if(b1 instanceof THREE.Fog){b0.fogNear.value=b1.near;b0.fogFar.value=b1.far}else{if(b1 instanceof THREE.FogExp2){b0.fogDensity.value=b1.density}}}function P(b0,b1){b0.shininess.value=b1.shininess;if(aO.gammaInput){b0.ambient.value.copyGammaToLinear(b1.ambient);b0.emissive.value.copyGammaToLinear(b1.emissive);b0.specular.value.copyGammaToLinear(b1.specular)}else{b0.ambient.value=b1.ambient;b0.emissive.value=b1.emissive;b0.specular.value=b1.specular}if(b1.wrapAround){b0.wrapRGB.value.copy(b1.wrapRGB)}}function bI(b0,b1){if(aO.gammaInput){b0.ambient.value.copyGammaToLinear(b1.ambient);b0.emissive.value.copyGammaToLinear(b1.emissive)}else{b0.ambient.value=b1.ambient;b0.emissive.value=b1.emissive}if(b1.wrapAround){b0.wrapRGB.value.copy(b1.wrapRGB)}}function bc(b0,b1){b0.ambientLightColor.value=b1.ambient;b0.directionalLightColor.value=b1.directional.colors;b0.directionalLightDirection.value=b1.directional.positions;b0.pointLightColor.value=b1.point.colors;b0.pointLightPosition.value=b1.point.positions;b0.pointLightDistance.value=b1.point.distances;b0.spotLightColor.value=b1.spot.colors;b0.spotLightPosition.value=b1.spot.positions;b0.spotLightDistance.value=b1.spot.distances;b0.spotLightDirection.value=b1.spot.directions;b0.spotLightAngleCos.value=b1.spot.anglesCos;b0.spotLightExponent.value=b1.spot.exponents;b0.hemisphereLightSkyColor.value=b1.hemi.skyColors;b0.hemisphereLightGroundColor.value=b1.hemi.groundColors;b0.hemisphereLightDirection.value=b1.hemi.positions}function bP(b0,b4){if(b0.shadowMatrix){var b3=0;for(var b5=0,b2=b4.length;b5<b2;b5++){var b1=b4[b5];if(!b1.castShadow){continue}if(b1 instanceof THREE.SpotLight||(b1 instanceof THREE.DirectionalLight&&!b1.shadowCascade)){b0.shadowMap.value[b3]=b1.shadowMap;b0.shadowMapSize.value[b3]=b1.shadowMapSize;b0.shadowMatrix.value[b3]=b1.shadowMatrix;b0.shadowDarkness.value[b3]=b1.shadowDarkness;b0.shadowBias.value[b3]=b1.shadowBias;b3++}}}}function u(b0,b1){c.uniformMatrix4fv(b0.modelViewMatrix,false,b1._modelViewMatrix.elements);if(b0.normalMatrix){c.uniformMatrix3fv(b0.normalMatrix,false,b1._normalMatrix.elements)}}function aw(){var b0=bf;if(b0>=bJ){console.warn("WebGLRenderer: trying to use "+b0+" texture units while this GPU supports only "+bJ)}bf+=1;return b0}function U(b5,cb){var b0,b9,b7,ca,b6,cc,b4,b8,b2,b3,b1;for(b2=0,b3=cb.length;b2<b3;b2++){ca=b5.uniforms[cb[b2][1]];if(!ca){continue}b0=cb[b2][0];b7=b0.type;b9=b0.value;if(b7==="i"){c.uniform1i(ca,b9)}else{if(b7==="f"){c.uniform1f(ca,b9)}else{if(b7==="v2"){c.uniform2f(ca,b9.x,b9.y)}else{if(b7==="v3"){c.uniform3f(ca,b9.x,b9.y,b9.z)}else{if(b7==="v4"){c.uniform4f(ca,b9.x,b9.y,b9.z,b9.w)}else{if(b7==="c"){c.uniform3f(ca,b9.r,b9.g,b9.b)}else{if(b7==="iv1"){c.uniform1iv(ca,b9)}else{if(b7==="iv"){c.uniform3iv(ca,b9)}else{if(b7==="fv1"){c.uniform1fv(ca,b9)}else{if(b7==="fv"){c.uniform3fv(ca,b9)}else{if(b7==="v2v"){if(b0._array===undefined){b0._array=new Float32Array(2*b9.length)}for(b4=0,b8=b9.length;b4<b8;b4++){b1=b4*2;b0._array[b1]=b9[b4].x;b0._array[b1+1]=b9[b4].y}c.uniform2fv(ca,b0._array)}else{if(b7==="v3v"){if(b0._array===undefined){b0._array=new Float32Array(3*b9.length)}for(b4=0,b8=b9.length;b4<b8;b4++){b1=b4*3;b0._array[b1]=b9[b4].x;b0._array[b1+1]=b9[b4].y;b0._array[b1+2]=b9[b4].z}c.uniform3fv(ca,b0._array)}else{if(b7==="v4v"){if(b0._array===undefined){b0._array=new Float32Array(4*b9.length)}for(b4=0,b8=b9.length;b4<b8;b4++){b1=b4*4;b0._array[b1]=b9[b4].x;b0._array[b1+1]=b9[b4].y;b0._array[b1+2]=b9[b4].z;b0._array[b1+3]=b9[b4].w}c.uniform4fv(ca,b0._array)}else{if(b7==="m4"){if(b0._array===undefined){b0._array=new Float32Array(16)}b9.flattenToArray(b0._array);c.uniformMatrix4fv(ca,false,b0._array)}else{if(b7==="m4v"){if(b0._array===undefined){b0._array=new Float32Array(16*b9.length)}for(b4=0,b8=b9.length;b4<b8;b4++){b9[b4].flattenToArrayOffset(b0._array,b4*16)}c.uniformMatrix4fv(ca,false,b0._array)}else{if(b7==="t"){b6=b9;cc=aw();c.uniform1i(ca,cc);if(!b6){continue}if(b6.image instanceof Array&&b6.image.length===6){bm(b6,cc)}else{if(b6 instanceof THREE.WebGLRenderTargetCube){ba(b6,cc)}else{aO.setTexture(b6,cc)}}}else{if(b7==="tv"){if(b0._array===undefined){b0._array=[]}for(b4=0,b8=b0.value.length;b4<b8;b4++){b0._array[b4]=aw()}c.uniform1iv(ca,b0._array);for(b4=0,b8=b0.value.length;b4<b8;b4++){b6=b0.value[b4];cc=b0._array[b4];if(!b6){continue}aO.setTexture(b6,cc)}}else{console.warn("THREE.WebGLRenderer: Unknown uniform type: "+b7)}}}}}}}}}}}}}}}}}}}function bh(b0,b1){b0._modelViewMatrix.multiplyMatrices(b1.matrixWorldInverse,b0.matrixWorld);b0._normalMatrix.getNormalMatrix(b0._modelViewMatrix)}function a5(b3,b2,b0,b1){b3[b2]=b0.r*b0.r*b1;b3[b2+1]=b0.g*b0.g*b1;b3[b2+2]=b0.b*b0.b*b1}function a6(b3,b2,b1,b0){b3[b2]=b1.r*b0;b3[b2+1]=b1.g*b0;b3[b2+2]=b1.b*b0}function f(b0,b5){var cD,cr,ci,cz,cu=0,cE=0,cF=0,cp,b2,b9,cq,b8,ct,cg,cm=bq,ce=cm.directional.colors,b3=cm.directional.positions,cA=cm.point.colors,cw=cm.point.positions,co=cm.point.distances,cB=cm.spot.colors,b4=cm.spot.positions,cx=cm.spot.distances,cd=cm.spot.directions,b6=cm.spot.anglesCos,cf=cm.spot.exponents,b1=cm.hemi.skyColors,cC=cm.hemi.groundColors,cc=cm.hemi.positions,cG=0,cl=0,ch=0,ca=0,cn=0,ck=0,cj=0,b7=0,cb=0,cy=0,cv=0,cs=0;for(cD=0,cr=b5.length;cD<cr;cD++){ci=b5[cD];if(ci.onlyShadow){continue}cp=ci.color;cq=ci.intensity;cg=ci.distance;if(ci instanceof THREE.AmbientLight){if(!ci.visible){continue}if(aO.gammaInput){cu+=cp.r*cp.r;cE+=cp.g*cp.g;cF+=cp.b*cp.b}else{cu+=cp.r;cE+=cp.g;cF+=cp.b}}else{if(ci instanceof THREE.DirectionalLight){cn+=1;if(!ci.visible){continue}aM.setFromMatrixPosition(ci.matrixWorld);W.setFromMatrixPosition(ci.target.matrixWorld);aM.sub(W);aM.normalize();if(aM.x===0&&aM.y===0&&aM.z===0){continue}cb=cG*3;b3[cb]=aM.x;b3[cb+1]=aM.y;b3[cb+2]=aM.z;if(aO.gammaInput){a5(ce,cb,cp,cq*cq)}else{a6(ce,cb,cp,cq)}cG+=1}else{if(ci instanceof THREE.PointLight){ck+=1;if(!ci.visible){continue}cy=cl*3;if(aO.gammaInput){a5(cA,cy,cp,cq*cq)}else{a6(cA,cy,cp,cq)}W.setFromMatrixPosition(ci.matrixWorld);cw[cy]=W.x;cw[cy+1]=W.y;cw[cy+2]=W.z;co[cl]=cg;cl+=1}else{if(ci instanceof THREE.SpotLight){cj+=1;if(!ci.visible){continue}cv=ch*3;if(aO.gammaInput){a5(cB,cv,cp,cq*cq)}else{a6(cB,cv,cp,cq)}W.setFromMatrixPosition(ci.matrixWorld);b4[cv]=W.x;b4[cv+1]=W.y;b4[cv+2]=W.z;cx[ch]=cg;aM.copy(W);W.setFromMatrixPosition(ci.target.matrixWorld);aM.sub(W);aM.normalize();cd[cv]=aM.x;cd[cv+1]=aM.y;cd[cv+2]=aM.z;b6[ch]=Math.cos(ci.angle);cf[ch]=ci.exponent;ch+=1}else{if(ci instanceof THREE.HemisphereLight){b7+=1;if(!ci.visible){continue}aM.setFromMatrixPosition(ci.matrixWorld);aM.normalize();if(aM.x===0&&aM.y===0&&aM.z===0){continue}cs=ca*3;cc[cs]=aM.x;cc[cs+1]=aM.y;cc[cs+2]=aM.z;b2=ci.color;b9=ci.groundColor;if(aO.gammaInput){b8=cq*cq;a5(b1,cs,b2,b8);a5(cC,cs,b9,b8)}else{a6(b1,cs,b2,cq);a6(cC,cs,b9,cq)}ca+=1}}}}}}for(cD=cG*3,cr=Math.max(ce.length,cn*3);cD<cr;cD++){ce[cD]=0}for(cD=cl*3,cr=Math.max(cA.length,ck*3);cD<cr;cD++){cA[cD]=0}for(cD=ch*3,cr=Math.max(cB.length,cj*3);cD<cr;cD++){cB[cD]=0}for(cD=ca*3,cr=Math.max(b1.length,b7*3);cD<cr;cD++){b1[cD]=0}for(cD=ca*3,cr=Math.max(cC.length,b7*3);cD<cr;cD++){cC[cD]=0}cm.directional.length=cG;cm.point.length=cl;cm.spot.length=ch;cm.hemi.length=ca;cm.ambient[0]=cu;cm.ambient[1]=cE;cm.ambient[2]=cF}this.setFaceCulling=function(b1,b0){if(b1===THREE.CullFaceNone){c.disable(c.CULL_FACE)}else{if(b0===THREE.FrontFaceDirectionCW){c.frontFace(c.CW)}else{c.frontFace(c.CCW)}if(b1===THREE.CullFaceBack){c.cullFace(c.BACK)}else{if(b1===THREE.CullFaceFront){c.cullFace(c.FRONT)}else{c.cullFace(c.FRONT_AND_BACK)}}c.enable(c.CULL_FACE)}};this.setMaterialFaces=function(b2){var b0=b2.side===THREE.DoubleSide;var b1=b2.side===THREE.BackSide;if(bl!==b0){if(b0){c.disable(c.CULL_FACE)}else{c.enable(c.CULL_FACE)}bl=b0}if(k!==b1){if(b1){c.frontFace(c.CW)}else{c.frontFace(c.CCW)}k=b1}};this.setDepthTest=function(b0){if(a!==b0){if(b0){c.enable(c.DEPTH_TEST)}else{c.disable(c.DEPTH_TEST)}a=b0}};this.setDepthWrite=function(b0){if(bz!==b0){c.depthMask(b0);bz=b0}};function aI(b0){if(b0!==bn){c.lineWidth(b0);bn=b0}}function bW(b2,b1,b0){if(aK!==b2){if(b2){c.enable(c.POLYGON_OFFSET_FILL)}else{c.disable(c.POLYGON_OFFSET_FILL)}aK=b2}if(b2&&(bO!==b1||bb!==b0)){c.polygonOffset(b1,b0);bO=b1;bb=b0}}this.setBlending=function(b1,b0,b2,b3){if(b1!==i){if(b1===THREE.NoBlending){c.disable(c.BLEND)}else{if(b1===THREE.AdditiveBlending){c.enable(c.BLEND);c.blendEquation(c.FUNC_ADD);c.blendFunc(c.SRC_ALPHA,c.ONE)}else{if(b1===THREE.SubtractiveBlending){c.enable(c.BLEND);c.blendEquation(c.FUNC_ADD);c.blendFunc(c.ZERO,c.ONE_MINUS_SRC_COLOR)}else{if(b1===THREE.MultiplyBlending){c.enable(c.BLEND);c.blendEquation(c.FUNC_ADD);c.blendFunc(c.ZERO,c.SRC_COLOR)}else{if(b1===THREE.CustomBlending){c.enable(c.BLEND)}else{c.enable(c.BLEND);c.blendEquationSeparate(c.FUNC_ADD,c.FUNC_ADD);c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA)}}}}}i=b1}if(b1===THREE.CustomBlending){if(b0!==aj){c.blendEquation(aT(b0));aj=b0}if(b2!==bQ||b3!==au){c.blendFunc(aT(b2),aT(b3));bQ=b2;au=b3}}else{aj=null;bQ=null;au=null}};function R(b1){var b2,b0,b4=[];for(var b3 in b1){b2=b1[b3];if(b2===false){continue}b0="#define "+b3+" "+b2;b4.push(b0)}return b4.join("\n")}function g(b9,b0,b5,cn,cd,cj,cb,ck){var cg,cl,cm,cc,b1;var cf=[];if(b9){cf.push(b9)}else{cf.push(b0);cf.push(b5)}for(cm in cj){cf.push(cm);cf.push(cj[cm])}for(cg in cb){cf.push(cg);cf.push(cb[cg])}b1=cf.join();for(cg=0,cl=bE.length;cg<cl;cg++){var b8=bE[cg];if(b8.code===b1){b8.usedTimes++;return b8.program}}var b2="SHADOWMAP_TYPE_BASIC";if(cb.shadowMapType===THREE.PCFShadowMap){b2="SHADOWMAP_TYPE_PCF"}else{if(cb.shadowMapType===THREE.PCFSoftShadowMap){b2="SHADOWMAP_TYPE_PCF_SOFT"}}var b4=R(cj);cc=c.createProgram();var b3=["precision "+j+" float;","precision "+j+" int;",b4,aW?"#define VERTEX_TEXTURES":"",aO.gammaInput?"#define GAMMA_INPUT":"",aO.gammaOutput?"#define GAMMA_OUTPUT":"",aO.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+cb.maxDirLights,"#define MAX_POINT_LIGHTS "+cb.maxPointLights,"#define MAX_SPOT_LIGHTS "+cb.maxSpotLights,"#define MAX_HEMI_LIGHTS "+cb.maxHemiLights,"#define MAX_SHADOWS "+cb.maxShadows,"#define MAX_BONES "+cb.maxBones,cb.map?"#define USE_MAP":"",cb.envMap?"#define USE_ENVMAP":"",cb.lightMap?"#define USE_LIGHTMAP":"",cb.bumpMap?"#define USE_BUMPMAP":"",cb.normalMap?"#define USE_NORMALMAP":"",cb.specularMap?"#define USE_SPECULARMAP":"",cb.vertexColors?"#define USE_COLOR":"",cb.skinning?"#define USE_SKINNING":"",cb.useVertexTexture?"#define BONE_TEXTURE":"",cb.morphTargets?"#define USE_MORPHTARGETS":"",cb.morphNormals?"#define USE_MORPHNORMALS":"",cb.perPixel?"#define PHONG_PER_PIXEL":"",cb.wrapAround?"#define WRAP_AROUND":"",cb.doubleSided?"#define DOUBLE_SIDED":"",cb.flipSided?"#define FLIP_SIDED":"",cb.shadowMapEnabled?"#define USE_SHADOWMAP":"",cb.shadowMapEnabled?"#define "+b2:"",cb.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",cb.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",cb.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","attribute vec2 uv2;","#ifdef USE_COLOR","attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","attribute vec3 morphTarget0;","attribute vec3 morphTarget1;","attribute vec3 morphTarget2;","attribute vec3 morphTarget3;","#ifdef USE_MORPHNORMALS","attribute vec3 morphNormal0;","attribute vec3 morphNormal1;","attribute vec3 morphNormal2;","attribute vec3 morphNormal3;","#else","attribute vec3 morphTarget4;","attribute vec3 morphTarget5;","attribute vec3 morphTarget6;","attribute vec3 morphTarget7;","#endif","#endif","#ifdef USE_SKINNING","attribute vec4 skinIndex;","attribute vec4 skinWeight;","#endif",""].join("\n");var b7=["precision "+j+" float;","precision "+j+" int;",(cb.bumpMap||cb.normalMap)?"#extension GL_OES_standard_derivatives : enable":"",b4,"#define MAX_DIR_LIGHTS "+cb.maxDirLights,"#define MAX_POINT_LIGHTS "+cb.maxPointLights,"#define MAX_SPOT_LIGHTS "+cb.maxSpotLights,"#define MAX_HEMI_LIGHTS "+cb.maxHemiLights,"#define MAX_SHADOWS "+cb.maxShadows,cb.alphaTest?"#define ALPHATEST "+cb.alphaTest:"",aO.gammaInput?"#define GAMMA_INPUT":"",aO.gammaOutput?"#define GAMMA_OUTPUT":"",aO.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",(cb.useFog&&cb.fog)?"#define USE_FOG":"",(cb.useFog&&cb.fogExp)?"#define FOG_EXP2":"",cb.map?"#define USE_MAP":"",cb.envMap?"#define USE_ENVMAP":"",cb.lightMap?"#define USE_LIGHTMAP":"",cb.bumpMap?"#define USE_BUMPMAP":"",cb.normalMap?"#define USE_NORMALMAP":"",cb.specularMap?"#define USE_SPECULARMAP":"",cb.vertexColors?"#define USE_COLOR":"",cb.metal?"#define METAL":"",cb.perPixel?"#define PHONG_PER_PIXEL":"",cb.wrapAround?"#define WRAP_AROUND":"",cb.doubleSided?"#define DOUBLE_SIDED":"",cb.flipSided?"#define FLIP_SIDED":"",cb.shadowMapEnabled?"#define USE_SHADOWMAP":"",cb.shadowMapEnabled?"#define "+b2:"",cb.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",cb.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",""].join("\n");var b6=d("vertex",b3+b5);var ch=d("fragment",b7+b0);c.attachShader(cc,b6);c.attachShader(cc,ch);if(ck){c.bindAttribLocation(cc,0,ck)}c.linkProgram(cc);if(!c.getProgramParameter(cc,c.LINK_STATUS)){console.error("Could not initialise shader\nVALIDATE_STATUS: "+c.getProgramParameter(cc,c.VALIDATE_STATUS)+", gl error ["+c.getError()+"]");console.error("Program Info Log: "+c.getProgramInfoLog(cc))}c.deleteShader(ch);c.deleteShader(b6);cc.uniforms={};cc.attributes={};var ca,ce,co,ci;ca=["viewMatrix","modelViewMatrix","projectionMatrix","normalMatrix","modelMatrix","cameraPosition","morphTargetInfluences"];if(cb.useVertexTexture){ca.push("boneTexture");ca.push("boneTextureWidth");ca.push("boneTextureHeight")}else{ca.push("boneGlobalMatrices")}for(ce in cn){ca.push(ce)}af(cc,ca);ca=["position","normal","uv","uv2","tangent","color","skinIndex","skinWeight","lineDistance"];for(ci=0;ci<cb.maxMorphTargets;ci++){ca.push("morphTarget"+ci)}for(ci=0;ci<cb.maxMorphNormals;ci++){ca.push("morphNormal"+ci)}for(co in cd){ca.push(co)}B(cc,ca);cc.id=aB++;bE.push({program:cc,code:b1,usedTimes:1});aO.info.memory.programs=bE.length;return cc}function af(b2,b0){var b3,b1,b4;for(b3=0,b1=b0.length;b3<b1;b3++){b4=b0[b3];b2.uniforms[b4]=c.getUniformLocation(b2,b4)}}function B(b2,b0){var b3,b1,b4;for(b3=0,b1=b0.length;b3<b1;b3++){b4=b0[b3];b2.attributes[b4]=c.getAttribLocation(b2,b4)}}function ad(b1){var b3=b1.split("\n");for(var b2=0,b0=b3.length;b2<b0;b2++){b3[b2]=(b2+1)+": "+b3[b2]}return b3.join("\n")}function d(b1,b0){var b2;if(b1==="fragment"){b2=c.createShader(c.FRAGMENT_SHADER)}else{if(b1==="vertex"){b2=c.createShader(c.VERTEX_SHADER)}}c.shaderSource(b2,b0);c.compileShader(b2);if(!c.getShaderParameter(b2,c.COMPILE_STATUS)){console.error(c.getShaderInfoLog(b2));console.error(ad(b0));return null}return b2}function a8(b0){return(b0&(b0-1))===0}function ak(b0,b1,b2){if(b2){c.texParameteri(b0,c.TEXTURE_WRAP_S,aT(b1.wrapS));c.texParameteri(b0,c.TEXTURE_WRAP_T,aT(b1.wrapT));c.texParameteri(b0,c.TEXTURE_MAG_FILTER,aT(b1.magFilter));c.texParameteri(b0,c.TEXTURE_MIN_FILTER,aT(b1.minFilter))}else{c.texParameteri(b0,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(b0,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);c.texParameteri(b0,c.TEXTURE_MAG_FILTER,aP(b1.magFilter));c.texParameteri(b0,c.TEXTURE_MIN_FILTER,aP(b1.minFilter))}if(q&&b1.type!==THREE.FloatType){if(b1.anisotropy>1||b1.__oldAnisotropy){c.texParameterf(b0,q.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b1.anisotropy,bC));b1.__oldAnisotropy=b1.anisotropy}}}this.setTexture=function(b7,b9){if(b7.needsUpdate){if(!b7.__webglInit){b7.__webglInit=true;b7.addEventListener("dispose",ah);b7.__webglTexture=c.createTexture();aO.info.memory.textures++}c.activeTexture(c.TEXTURE0+b9);c.bindTexture(c.TEXTURE_2D,b7.__webglTexture);c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,b7.flipY);c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b7.premultiplyAlpha);c.pixelStorei(c.UNPACK_ALIGNMENT,b7.unpackAlignment);var b3=b7.image,b6=a8(b3.width)&&a8(b3.height),b0=aT(b7.format),b2=aT(b7.type);ak(c.TEXTURE_2D,b7,b6);var b1,b4=b7.mipmaps;if(b7 instanceof THREE.DataTexture){if(b4.length>0&&b6){for(var b5=0,b8=b4.length;b5<b8;b5++){b1=b4[b5];c.texImage2D(c.TEXTURE_2D,b5,b0,b1.width,b1.height,0,b0,b2,b1.data)}b7.generateMipmaps=false}else{c.texImage2D(c.TEXTURE_2D,0,b0,b3.width,b3.height,0,b0,b2,b3.data)}}else{if(b7 instanceof THREE.CompressedTexture){for(var b5=0,b8=b4.length;b5<b8;b5++){b1=b4[b5];if(b7.format!==THREE.RGBAFormat){c.compressedTexImage2D(c.TEXTURE_2D,b5,b0,b1.width,b1.height,0,b1.data)}else{c.texImage2D(c.TEXTURE_2D,b5,b0,b1.width,b1.height,0,b0,b2,b1.data)}}}else{if(b4.length>0&&b6){for(var b5=0,b8=b4.length;b5<b8;b5++){b1=b4[b5];c.texImage2D(c.TEXTURE_2D,b5,b0,b0,b2,b1)}b7.generateMipmaps=false}else{c.texImage2D(c.TEXTURE_2D,0,b0,b0,b2,b7.image)}}}if(b7.generateMipmaps&&b6){c.generateMipmap(c.TEXTURE_2D)}b7.needsUpdate=false;if(b7.onUpdate){b7.onUpdate()}}else{c.activeTexture(c.TEXTURE0+b9);c.bindTexture(c.TEXTURE_2D,b7.__webglTexture)}};function s(b5,b6){if(b5.width<=b6&&b5.height<=b6){return b5}var b4=Math.max(b5.width,b5.height);var b3=Math.floor(b5.width*b6/b4);var b1=Math.floor(b5.height*b6/b4);var b2=document.createElement("canvas");b2.width=b3;b2.height=b1;var b0=b2.getContext("2d");b0.drawImage(b5,0,0,b5.width,b5.height,0,0,b3,b1);return b2}function bm(cb,cc){if(cb.image.length===6){if(cb.needsUpdate){if(!cb.image.__webglTextureCube){cb.addEventListener("dispose",ah);cb.image.__webglTextureCube=c.createTexture();aO.info.memory.textures++}c.activeTexture(c.TEXTURE0+cc);c.bindTexture(c.TEXTURE_CUBE_MAP,cb.image.__webglTextureCube);c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,cb.flipY);var b3=cb instanceof THREE.CompressedTexture;var b0=[];for(var b9=0;b9<6;b9++){if(aO.autoScaleCubemaps&&!b3){b0[b9]=s(cb.image[b9],ao)}else{b0[b9]=cb.image[b9]}}var b6=b0[0],ca=a8(b6.width)&&a8(b6.height),b1=aT(cb.format),b4=aT(cb.type);ak(c.TEXTURE_CUBE_MAP,cb,ca);for(var b9=0;b9<6;b9++){if(!b3){c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+b9,0,b1,b1,b4,b0[b9])}else{var b2,b5=b0[b9].mipmaps;for(var b7=0,b8=b5.length;b7<b8;b7++){b2=b5[b7];if(cb.format!==THREE.RGBAFormat){c.compressedTexImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+b9,b7,b1,b2.width,b2.height,0,b2.data)}else{c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+b9,b7,b1,b2.width,b2.height,0,b1,b4,b2.data)}}}}if(cb.generateMipmaps&&ca){c.generateMipmap(c.TEXTURE_CUBE_MAP)}cb.needsUpdate=false;if(cb.onUpdate){cb.onUpdate()}}else{c.activeTexture(c.TEXTURE0+cc);c.bindTexture(c.TEXTURE_CUBE_MAP,cb.image.__webglTextureCube)}}}function ba(b0,b1){c.activeTexture(c.TEXTURE0+b1);c.bindTexture(c.TEXTURE_CUBE_MAP,b0.__webglTexture)}function a9(b2,b1,b0){c.bindFramebuffer(c.FRAMEBUFFER,b2);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,b0,b1.__webglTexture,0)}function r(b0,b1){c.bindRenderbuffer(c.RENDERBUFFER,b0);if(b1.depthBuffer&&!b1.stencilBuffer){c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,b1.width,b1.height);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,b0)}else{if(b1.depthBuffer&&b1.stencilBuffer){c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_STENCIL,b1.width,b1.height);c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,b0)}else{c.renderbufferStorage(c.RENDERBUFFER,c.RGBA4,b1.width,b1.height)}}}this.setRenderTarget=function(b4){var b6=(b4 instanceof THREE.WebGLRenderTargetCube);if(b4&&!b4.__webglFramebuffer){if(b4.depthBuffer===undefined){b4.depthBuffer=true}if(b4.stencilBuffer===undefined){b4.stencilBuffer=true}b4.addEventListener("dispose",T);b4.__webglTexture=c.createTexture();aO.info.memory.textures++;var b7=a8(b4.width)&&a8(b4.height),b0=aT(b4.format),b2=aT(b4.type);if(b6){b4.__webglFramebuffer=[];b4.__webglRenderbuffer=[];c.bindTexture(c.TEXTURE_CUBE_MAP,b4.__webglTexture);ak(c.TEXTURE_CUBE_MAP,b4,b7);for(var b3=0;b3<6;b3++){b4.__webglFramebuffer[b3]=c.createFramebuffer();b4.__webglRenderbuffer[b3]=c.createRenderbuffer();c.texImage2D(c.TEXTURE_CUBE_MAP_POSITIVE_X+b3,0,b0,b4.width,b4.height,0,b0,b2,null);a9(b4.__webglFramebuffer[b3],b4,c.TEXTURE_CUBE_MAP_POSITIVE_X+b3);r(b4.__webglRenderbuffer[b3],b4)}if(b7){c.generateMipmap(c.TEXTURE_CUBE_MAP)}}else{b4.__webglFramebuffer=c.createFramebuffer();if(b4.shareDepthFrom){b4.__webglRenderbuffer=b4.shareDepthFrom.__webglRenderbuffer}else{b4.__webglRenderbuffer=c.createRenderbuffer()}c.bindTexture(c.TEXTURE_2D,b4.__webglTexture);ak(c.TEXTURE_2D,b4,b7);c.texImage2D(c.TEXTURE_2D,0,b0,b4.width,b4.height,0,b0,b2,null);a9(b4.__webglFramebuffer,b4,c.TEXTURE_2D);if(b4.shareDepthFrom){if(b4.depthBuffer&&!b4.stencilBuffer){c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,b4.__webglRenderbuffer)}else{if(b4.depthBuffer&&b4.stencilBuffer){c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_STENCIL_ATTACHMENT,c.RENDERBUFFER,b4.__webglRenderbuffer)}}}else{r(b4.__webglRenderbuffer,b4)}if(b7){c.generateMipmap(c.TEXTURE_2D)}}if(b6){c.bindTexture(c.TEXTURE_CUBE_MAP,null)}else{c.bindTexture(c.TEXTURE_2D,null)}c.bindRenderbuffer(c.RENDERBUFFER,null);c.bindFramebuffer(c.FRAMEBUFFER,null)}var b9,b1,ca,b8,b5;if(b4){if(b6){b9=b4.__webglFramebuffer[b4.activeCubeFace]}else{b9=b4.__webglFramebuffer}b1=b4.width;ca=b4.height;b8=0;b5=0}else{b9=null;b1=bS;ca=aV;b8=a4;b5=a3}if(b9!==bG){c.bindFramebuffer(c.FRAMEBUFFER,b9);c.viewport(b8,b5,b1,ca);bG=b9}D=b1;aU=ca};function aX(b0){if(b0 instanceof THREE.WebGLRenderTargetCube){c.bindTexture(c.TEXTURE_CUBE_MAP,b0.__webglTexture);c.generateMipmap(c.TEXTURE_CUBE_MAP);c.bindTexture(c.TEXTURE_CUBE_MAP,null)}else{c.bindTexture(c.TEXTURE_2D,b0.__webglTexture);c.generateMipmap(c.TEXTURE_2D);c.bindTexture(c.TEXTURE_2D,null)}}function aP(b0){if(b0===THREE.NearestFilter||b0===THREE.NearestMipMapNearestFilter||b0===THREE.NearestMipMapLinearFilter){return c.NEAREST}return c.LINEAR}function aT(b0){if(b0===THREE.RepeatWrapping){return c.REPEAT}if(b0===THREE.ClampToEdgeWrapping){return c.CLAMP_TO_EDGE}if(b0===THREE.MirroredRepeatWrapping){return c.MIRRORED_REPEAT}if(b0===THREE.NearestFilter){return c.NEAREST}if(b0===THREE.NearestMipMapNearestFilter){return c.NEAREST_MIPMAP_NEAREST}if(b0===THREE.NearestMipMapLinearFilter){return c.NEAREST_MIPMAP_LINEAR}if(b0===THREE.LinearFilter){return c.LINEAR}if(b0===THREE.LinearMipMapNearestFilter){return c.LINEAR_MIPMAP_NEAREST}if(b0===THREE.LinearMipMapLinearFilter){return c.LINEAR_MIPMAP_LINEAR}if(b0===THREE.UnsignedByteType){return c.UNSIGNED_BYTE}if(b0===THREE.UnsignedShort4444Type){return c.UNSIGNED_SHORT_4_4_4_4}if(b0===THREE.UnsignedShort5551Type){return c.UNSIGNED_SHORT_5_5_5_1}if(b0===THREE.UnsignedShort565Type){return c.UNSIGNED_SHORT_5_6_5}if(b0===THREE.ByteType){return c.BYTE}if(b0===THREE.ShortType){return c.SHORT}if(b0===THREE.UnsignedShortType){return c.UNSIGNED_SHORT}if(b0===THREE.IntType){return c.INT}if(b0===THREE.UnsignedIntType){return c.UNSIGNED_INT}if(b0===THREE.FloatType){return c.FLOAT}if(b0===THREE.AlphaFormat){return c.ALPHA}if(b0===THREE.RGBFormat){return c.RGB}if(b0===THREE.RGBAFormat){return c.RGBA}if(b0===THREE.LuminanceFormat){return c.LUMINANCE}if(b0===THREE.LuminanceAlphaFormat){return c.LUMINANCE_ALPHA}if(b0===THREE.AddEquation){return c.FUNC_ADD}if(b0===THREE.SubtractEquation){return c.FUNC_SUBTRACT}if(b0===THREE.ReverseSubtractEquation){return c.FUNC_REVERSE_SUBTRACT}if(b0===THREE.ZeroFactor){return c.ZERO}if(b0===THREE.OneFactor){return c.ONE}if(b0===THREE.SrcColorFactor){return c.SRC_COLOR}if(b0===THREE.OneMinusSrcColorFactor){return c.ONE_MINUS_SRC_COLOR}if(b0===THREE.SrcAlphaFactor){return c.SRC_ALPHA}if(b0===THREE.OneMinusSrcAlphaFactor){return c.ONE_MINUS_SRC_ALPHA}if(b0===THREE.DstAlphaFactor){return c.DST_ALPHA}if(b0===THREE.OneMinusDstAlphaFactor){return c.ONE_MINUS_DST_ALPHA}if(b0===THREE.DstColorFactor){return c.DST_COLOR}if(b0===THREE.OneMinusDstColorFactor){return c.ONE_MINUS_DST_COLOR}if(b0===THREE.SrcAlphaSaturateFactor){return c.SRC_ALPHA_SATURATE}if(aF!==undefined){if(b0===THREE.RGB_S3TC_DXT1_Format){return aF.COMPRESSED_RGB_S3TC_DXT1_EXT}if(b0===THREE.RGBA_S3TC_DXT1_Format){return aF.COMPRESSED_RGBA_S3TC_DXT1_EXT}if(b0===THREE.RGBA_S3TC_DXT3_Format){return aF.COMPRESSED_RGBA_S3TC_DXT3_EXT}if(b0===THREE.RGBA_S3TC_DXT5_Format){return aF.COMPRESSED_RGBA_S3TC_DXT5_EXT}}return 0}function aJ(b3){if(Z&&b3&&b3.useVertexTexture){return 1024}else{var b1=c.getParameter(c.MAX_VERTEX_UNIFORM_VECTORS);var b2=Math.floor((b1-20)/4);var b0=b2;if(b3!==undefined&&b3 instanceof THREE.SkinnedMesh){b0=Math.min(b3.bones.length,b0);if(b0<b3.bones.length){console.warn("WebGLRenderer: too many bones - "+b3.bones.length+", this GPU supports just "+b0+" (try OpenGL instead of ANGLE)")}}return b0}}function bg(b2){var b3=0;var b7=0;var b5=0;var b6=0;for(var b1=0,b4=b2.length;b1<b4;b1++){var b0=b2[b1];if(b0.onlyShadow){continue}if(b0 instanceof THREE.DirectionalLight){b3++}if(b0 instanceof THREE.PointLight){b7++}if(b0 instanceof THREE.SpotLight){b5++}if(b0 instanceof THREE.HemisphereLight){b6++}}return{directional:b3,point:b7,spot:b5,hemi:b6}}function aa(b2){var b3=0;for(var b1=0,b4=b2.length;b1<b4;b1++){var b0=b2[b1];if(!b0.castShadow){continue}if(b0 instanceof THREE.SpotLight){b3++}if(b0 instanceof THREE.DirectionalLight&&!b0.shadowCascade){b3++}}return b3}function br(){try{var b0={alpha:bD,premultipliedAlpha:a1,antialias:bY,stencil:e,preserveDrawingBuffer:Y};c=aY.getContext("webgl",b0)||aY.getContext("experimental-webgl",b0);if(c===null){throw"Error creating WebGL context."}}catch(b1){console.error(b1)}m=c.getExtension("OES_texture_float");A=c.getExtension("OES_texture_float_linear");be=c.getExtension("OES_standard_derivatives");q=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic");aF=c.getExtension("WEBGL_compressed_texture_s3tc")||c.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||c.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");if(!m){console.log("THREE.WebGLRenderer: Float textures not supported.")}if(!be){console.log("THREE.WebGLRenderer: Standard derivatives not supported.")}if(!q){console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported.")}if(!aF){console.log("THREE.WebGLRenderer: S3TC compressed textures not supported.")}if(c.getShaderPrecisionFormat===undefined){c.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}}}}function bd(){c.clearColor(0,0,0,1);c.clearDepth(1);c.clearStencil(0);c.enable(c.DEPTH_TEST);c.depthFunc(c.LEQUAL);c.frontFace(c.CCW);c.cullFace(c.BACK);c.enable(c.CULL_FACE);c.enable(c.BLEND);c.blendEquation(c.FUNC_ADD);c.blendFunc(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA);c.viewport(a4,a3,bS,aV);c.clearColor(bs.r,bs.g,bs.b,X)}this.shadowMapPlugin=new THREE.ShadowMapPlugin();this.addPrePlugin(this.shadowMapPlugin);this.addPostPlugin(new THREE.SpritePlugin());this.addPostPlugin(new THREE.LensFlarePlugin())};THREE.WebGLRenderTarget=function(c,a,b){this.width=c;this.height=a;b=b||{};this.wrapS=b.wrapS!==undefined?b.wrapS:THREE.ClampToEdgeWrapping;this.wrapT=b.wrapT!==undefined?b.wrapT:THREE.ClampToEdgeWrapping;this.magFilter=b.magFilter!==undefined?b.magFilter:THREE.LinearFilter;this.minFilter=b.minFilter!==undefined?b.minFilter:THREE.LinearMipMapLinearFilter;this.anisotropy=b.anisotropy!==undefined?b.anisotropy:1;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.format=b.format!==undefined?b.format:THREE.RGBAFormat;this.type=b.type!==undefined?b.type:THREE.UnsignedByteType;this.depthBuffer=b.depthBuffer!==undefined?b.depthBuffer:true;this.stencilBuffer=b.stencilBuffer!==undefined?b.stencilBuffer:true;this.generateMipmaps=true;this.shareDepthFrom=null};THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,clone:function(){var a=new THREE.WebGLRenderTarget(this.width,this.height);a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.format=this.format;a.type=this.type;a.depthBuffer=this.depthBuffer;a.stencilBuffer=this.stencilBuffer;a.generateMipmaps=this.generateMipmaps;a.shareDepthFrom=this.shareDepthFrom;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.EventDispatcher.prototype.apply(THREE.WebGLRenderTarget.prototype);THREE.WebGLRenderTargetCube=function(c,a,b){THREE.WebGLRenderTarget.call(this,c,a,b);this.activeCubeFace=0};THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype);THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3();this.positionScreen=new THREE.Vector4();this.visible=true};THREE.RenderableVertex.prototype.copy=function(a){this.positionWorld.copy(a.positionWorld);this.positionScreen.copy(a.positionScreen)};THREE.RenderableFace3=function(){this.id=0;this.v1=new THREE.RenderableVertex();this.v2=new THREE.RenderableVertex();this.v3=new THREE.RenderableVertex();this.centroidModel=new THREE.Vector3();this.normalModel=new THREE.Vector3();this.normalModelView=new THREE.Vector3();this.vertexNormalsLength=0;this.vertexNormalsModel=[new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3()];this.vertexNormalsModelView=[new THREE.Vector3(),new THREE.Vector3(),new THREE.Vector3()];this.color=null;this.material=null;this.uvs=[[]];this.z=0};THREE.RenderableObject=function(){this.id=0;this.object=null;this.z=0};THREE.RenderableSprite=function(){this.id=0;this.object=null;this.x=0;this.y=0;this.z=0;this.rotation=0;this.scale=new THREE.Vector2();this.material=null};THREE.RenderableLine=function(){this.id=0;this.v1=new THREE.RenderableVertex();this.v2=new THREE.RenderableVertex();this.vertexColors=[new THREE.Color(),new THREE.Color()];this.material=null;this.z=0};THREE.GeometryUtils={merge:function(o,k,H){var v,h,n=o.vertices.length,s=o.faceVertexUvs[0].length,m=k instanceof THREE.Mesh?k.geometry:k,d=o.vertices,c=m.vertices,b=o.faces,a=m.faces,E=o.faceVertexUvs[0],D=m.faceVertexUvs[0];if(H===undefined){H=0}if(k instanceof THREE.Mesh){k.matrixAutoUpdate&&k.updateMatrix();v=k.matrix;h=new THREE.Matrix3().getNormalMatrix(v)}for(var A=0,l=c.length;A<l;A++){var F=c[A];var r=F.clone();if(v){r.applyMatrix4(v)}d.push(r)}for(A=0,l=a.length;A<l;A++){var g=a[A],q,G,t,p=g.vertexNormals,C=g.vertexColors;q=new THREE.Face3(g.a+n,g.b+n,g.c+n);q.normal.copy(g.normal);if(h){q.normal.applyMatrix3(h).normalize()}for(var u=0,B=p.length;u<B;u++){G=p[u].clone();if(h){G.applyMatrix3(h).normalize()}q.vertexNormals.push(G)}q.color.copy(g.color);for(var u=0,B=C.length;u<B;u++){t=C[u];q.vertexColors.push(t.clone())}q.materialIndex=g.materialIndex+H;q.centroid.copy(g.centroid);if(v){q.centroid.applyMatrix4(v)}b.push(q)}for(A=0,l=D.length;A<l;A++){var f=D[A],e=[];for(var u=0,B=f.length;u<B;u++){e.push(new THREE.Vector2(f[u].x,f[u].y))}E.push(e)}},randomPointInTriangle:function(){var a=new THREE.Vector3();return function(h,f,j){var e=new THREE.Vector3();var g=THREE.Math.random16();var d=THREE.Math.random16();if((g+d)>1){g=1-g;d=1-d}var i=1-g-d;e.copy(h);e.multiplyScalar(g);a.copy(f);a.multiplyScalar(d);e.add(a);a.copy(j);a.multiplyScalar(i);e.add(a);return e}}(),randomPointInFace:function(e,g,f){var d,c,b,a;d=g.vertices[e.a];c=g.vertices[e.b];b=g.vertices[e.c];return THREE.GeometryUtils.randomPointInTriangle(d,c,b)},randomPointsInGeometry:function(b,k){var e,o,a=b.faces,c=b.vertices,f=a.length,q=0,t=[],s,p,m,l;for(o=0;o<f;o++){e=a[o];s=c[e.a];p=c[e.b];m=c[e.c];e._area=THREE.GeometryUtils.triangleArea(s,p,m);q+=e._area;t[o]=q}function h(n){function r(B,v){if(v<B){return B}var A=B+Math.floor((v-B)/2);if(t[A]>n){return r(B,A-1)}else{if(t[A]<n){return r(A+1,v)}else{return A}}}var i=r(0,t.length-1);return i}var j,d,g=[];var u={};for(o=0;o<k;o++){j=THREE.Math.random16()*q;d=h(j);g[o]=THREE.GeometryUtils.randomPointInFace(a[d],b,true);if(!u[d]){u[d]=1}else{u[d]+=1}}return g},triangleArea:function(){var b=new THREE.Vector3();var a=new THREE.Vector3();return function(d,c,e){b.subVectors(c,d);a.subVectors(e,d);b.cross(a);return 0.5*b.length()}}(),center:function(c){c.computeBoundingBox();var b=c.boundingBox;var a=new THREE.Vector3();a.addVectors(b.min,b.max);a.multiplyScalar(-0.5);c.applyMatrix(new THREE.Matrix4().makeTranslation(a.x,a.y,a.z));c.computeBoundingBox();return a},triangulateQuads:function(h){var e,b,c,d;var a=[];var g=[];for(e=0,b=h.faceVertexUvs.length;e<b;e++){g[e]=[]}for(e=0,b=h.faces.length;e<b;e++){var f=h.faces[e];a.push(f);for(c=0,d=h.faceVertexUvs.length;c<d;c++){g[c].push(h.faceVertexUvs[c][e])}}h.faces=a;h.faceVertexUvs=g;h.computeCentroids();h.computeFaceNormals();h.computeVertexNormals();if(h.hasTangents){h.computeTangents()}}};THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(c,b,d,f){var a=new THREE.ImageLoader();a.crossOrigin=this.crossOrigin;var e=new THREE.Texture(undefined,b);var g=a.load(c,function(){e.needsUpdate=true;if(d){d(e)}});e.image=g;e.sourceFile=c;return e},loadCompressedTexture:function(b,a,c,f){var e=new THREE.CompressedTexture();e.mapping=a;var d=new XMLHttpRequest();d.onload=function(){var g=d.response;var h=THREE.ImageUtils.parseDDS(g,true);e.format=h.format;e.mipmaps=h.mipmaps;e.image.width=h.width;e.image.height=h.height;e.generateMipmaps=false;e.needsUpdate=true;if(c){c(e)}};d.onerror=f;d.open("GET",b,true);d.responseType="arraybuffer";d.send(null);return e},loadTextureCube:function(e,b,g,d){var h=[];h.loadCount=0;var f=new THREE.Texture();f.image=h;if(b!==undefined){f.mapping=b}f.flipY=false;for(var c=0,j=e.length;c<j;++c){var a=new Image();h[c]=a;a.onload=function(){h.loadCount+=1;if(h.loadCount===6){f.needsUpdate=true;if(g){g(f)}}};a.onerror=d;a.crossOrigin=this.crossOrigin;a.src=e[c]}return f},loadCompressedTextureCube:function(h,b,k,g){var l=[];l.loadCount=0;var j=new THREE.CompressedTexture();j.image=l;if(b!==undefined){j.mapping=b}j.flipY=false;j.generateMipmaps=false;var d=function(n,i){return function(){var o=n.response;var p=THREE.ImageUtils.parseDDS(o,true);i.format=p.format;i.mipmaps=p.mipmaps;i.width=p.width;i.height=p.height;l.loadCount+=1;if(l.loadCount===6){j.format=p.format;j.needsUpdate=true;if(k){k(j)}}}};if(h instanceof Array){for(var f=0,m=h.length;f<m;++f){var a={};l[f]=a;var e=new XMLHttpRequest();e.onload=d(e,a);e.onerror=g;var c=h[f];e.open("GET",c,true);e.responseType="arraybuffer";e.send(null)}}else{var c=h;var e=new XMLHttpRequest();e.onload=function(){var o=e.response;var p=THREE.ImageUtils.parseDDS(o,true);if(p.isCubemap){var n=p.mipmaps.length/p.mipmapCount;for(var r=0;r<n;r++){l[r]={mipmaps:[]};for(var q=0;q<p.mipmapCount;q++){l[r].mipmaps.push(p.mipmaps[r*p.mipmapCount+q]);l[r].format=p.format;l[r].width=p.width;l[r].height=p.height}}j.format=p.format;j.needsUpdate=true;if(k){k(j)}}};e.onerror=g;e.open("GET",c,true);e.responseType="arraybuffer";e.send(null)}return j},loadDDSTexture:function(c,b,d,g){var a=[];a.loadCount=0;var f=new THREE.CompressedTexture();f.image=a;if(b!==undefined){f.mapping=b}f.flipY=false;f.generateMipmaps=false;var e=new XMLHttpRequest();e.onload=function(){var j=e.response;var k=THREE.ImageUtils.parseDDS(j,true);if(k.isCubemap){var h=k.mipmaps.length/k.mipmapCount;for(var m=0;m<h;m++){a[m]={mipmaps:[]};for(var l=0;l<k.mipmapCount;l++){a[m].mipmaps.push(k.mipmaps[m*k.mipmapCount+l]);a[m].format=k.format;a[m].width=k.width;a[m].height=k.height}}}else{f.image.width=k.width;f.image.height=k.height;f.mipmaps=k.mipmaps}f.format=k.format;f.needsUpdate=true;if(d){d(f)}};e.onerror=g;e.open("GET",c,true);e.responseType="arraybuffer";e.send(null);return f},parseDDS:function(L,am){var W={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};var J=542327876;var aa=1,I=2,ap=4,O=8,ac=4096,Y=131072,E=524288,f=8388608;var af=8,o=4194304,n=4096;var ae=512,X=1024,ak=2048,V=4096,aj=8192,U=16384,ag=32768,s=2097152;var H=1,P=2,at=4,v=64,ad=512,F=131072;function ar(i){return i.charCodeAt(0)+(i.charCodeAt(1)<<8)+(i.charCodeAt(2)<<16)+(i.charCodeAt(3)<<24)}function D(i){return String.fromCharCode(i&255,(i>>8)&255,(i>>16)&255,(i>>24)&255)}function m(ay,az,aw,aH){var ax=aw*aH*4;var aA=new Uint8Array(ay,az,ax);var av=new Uint8Array(ax);var aC=0;var au=0;for(var aE=0;aE<aH;aE++){for(var aG=0;aG<aw;aG++){var aD=aA[au];au++;var aB=aA[au];au++;var i=aA[au];au++;var aF=aA[au];au++;av[aC]=i;aC++;av[aC]=aB;aC++;av[aC]=aD;aC++;av[aC]=aF;aC++}}return av}var l=ar("DXT1");var j=ar("DXT3");var g=ar("DXT5");var b=31;var G=0;var ai=1;var aq=2;var al=3;var T=4;var r=7;var Z=20;var d=21;var N=22;var ah=23;var ao=24;var M=25;var K=26;var q=27;var u=28;var t=29;var p=30;var h=new Int32Array(L,0,b);if(h[G]!==J){console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header");return W}if(!h[Z]&at){console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code");return W}var R;var Q=h[d];var k=false;switch(Q){case l:R=8;W.format=THREE.RGB_S3TC_DXT1_Format;break;case j:R=16;W.format=THREE.RGBA_S3TC_DXT3_Format;break;case g:R=16;W.format=THREE.RGBA_S3TC_DXT5_Format;break;default:if(h[N]==32&&h[ah]&16711680&&h[ao]&65280&&h[M]&255&&h[K]&4278190080){k=true;R=64;W.format=THREE.RGBAFormat}else{console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",D(Q));return W}}W.mipmapCount=1;if(h[aq]&Y&&am!==false){W.mipmapCount=Math.max(1,h[r])}W.isCubemap=h[u]&ae?true:false;W.width=h[T];W.height=h[al];var ab=h[ai]+4;var a=W.width;var e=W.height;var C=W.isCubemap?6:1;for(var B=0;B<C;B++){for(var an=0;an<W.mipmapCount;an++){if(k){var S=m(L,ab,a,e);var A=S.length}else{var A=Math.max(4,a)/4*Math.max(4,e)/4*R;var S=new Uint8Array(L,ab,A)}var c={data:S,width:a,height:e};W.mipmaps.push(c);ab+=A;a=Math.max(a*0.5,1);e=Math.max(e*0.5,1)}a=W.width;e=W.height}return W},getNormalMap:function(q,E){var d=function(G,i){return[G[1]*i[2]-G[2]*i[1],G[2]*i[0]-G[0]*i[2],G[0]*i[1]-G[1]*i[0]]};var v=function(G,i){return[G[0]-i[0],G[1]-i[1],G[2]-i[2]]};var s=function(G){var i=Math.sqrt(G[0]*G[0]+G[1]*G[1]+G[2]*G[2]);return[G[0]/i,G[1]/i,G[2]/i]};E=E|1;var r=q.width;var p=q.height;var e=document.createElement("canvas");e.width=r;e.height=p;var c=e.getContext("2d");c.drawImage(q,0,0);var F=c.getImageData(0,0,r,p).data;var A=c.createImageData(r,p);var k=A.data;for(var m=0;m<r;m++){for(var l=0;l<p;l++){var f=l-1<0?0:l-1;var h=l+1>p-1?p-1:l+1;var g=m-1<0?0:m-1;var j=m+1>r-1?r-1:m+1;var u=[];var D=[0,0,F[(l*r+m)*4]/255*E];u.push([-1,0,F[(l*r+g)*4]/255*E]);u.push([-1,-1,F[(f*r+g)*4]/255*E]);u.push([0,-1,F[(f*r+m)*4]/255*E]);u.push([1,-1,F[(f*r+j)*4]/255*E]);u.push([1,0,F[(l*r+j)*4]/255*E]);u.push([1,1,F[(h*r+j)*4]/255*E]);u.push([0,1,F[(h*r+m)*4]/255*E]);u.push([-1,1,F[(h*r+g)*4]/255*E]);var o=[];var B=u.length;for(var t=0;t<B;t++){var b=u[t];var a=u[(t+1)%B];b=v(b,D);a=v(a,D);o.push(s(d(b,a)))}var C=[0,0,0];for(var t=0;t<o.length;t++){C[0]+=o[t][0];C[1]+=o[t][1];C[2]+=o[t][2]}C[0]/=o.length;C[1]/=o.length;C[2]/=o.length;var n=(l*r+m)*4;k[n]=((C[0]+1)/2*255)|0;k[n+1]=((C[1]+1)/2*255)|0;k[n+2]=(C[2]*255)|0;k[n+3]=255}}c.putImageData(A,0,0);return e},generateDataTexture:function(c,l,d){var m=c*l;var f=new Uint8Array(3*m);var a=Math.floor(d.r*255);var h=Math.floor(d.g*255);var k=Math.floor(d.b*255);for(var e=0;e<m;e++){f[e*3]=a;f[e*3+1]=h;f[e*3+2]=k}var j=new THREE.DataTexture(f,c,l,THREE.RGBFormat);j.needsUpdate=true;return j}};THREE.SceneUtils={createMultiMaterialObject:function(e,b){var d=new THREE.Object3D();for(var c=0,a=b.length;c<a;c++){d.add(new THREE.Mesh(e,b[c]))}return d},detach:function(c,a,b){c.applyMatrix(a.matrixWorld);a.remove(c);b.add(c)},attach:function(d,c,a){var b=new THREE.Matrix4();b.getInverse(a.matrixWorld);d.applyMatrix(b);c.remove(d);a.add(d)}};THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(d){var a=d.familyName.toLowerCase();var b=this;b.faces[a]=b.faces[a]||{};b.faces[a][d.cssFontWeight]=b.faces[a][d.cssFontWeight]||{};b.faces[a][d.cssFontWeight][d.cssFontStyle]=d;var c=b.faces[a][d.cssFontWeight][d.cssFontStyle]=d;return d},drawText:function(n){var a=[],e=[];var j,c,l=this.getFace(),g=this.size/l.resolution,h=0,m=String(n).split(""),d=m.length;var f=[];for(j=0;j<d;j++){var o=new THREE.Path();var k=this.extractGlyphPoints(m[j],l,g,h,o);h+=k.offset;f.push(k.path)}var b=h/2;return{paths:f,offset:b}},extractGlyphPoints:function(E,j,I,f,r){var J=[];var v,s,d,e,u,b,G,D,l,k,h,g,q,C,o,B,n,A,a,m=j.glyphs[E]||j.glyphs["?"];if(!m){return}if(m.o){e=m._cachedOutline||(m._cachedOutline=m.o.split(" "));b=e.length;G=I;D=I;for(v=0;v<b;){u=e[v++];switch(u){case"m":l=e[v++]*G+f;k=e[v++]*D;r.moveTo(l,k);break;case"l":l=e[v++]*G+f;k=e[v++]*D;r.lineTo(l,k);break;case"q":h=e[v++]*G+f;g=e[v++]*D;o=e[v++]*G+f;B=e[v++]*D;r.quadraticCurveTo(o,B,h,g);a=J[J.length-1];if(a){q=a.x;C=a.y;for(s=1,d=this.divisions;s<=d;s++){var p=s/d;var H=THREE.Shape.Utils.b2(p,q,o,h);var F=THREE.Shape.Utils.b2(p,C,B,g)}}break;case"b":h=e[v++]*G+f;g=e[v++]*D;o=e[v++]*G+f;B=e[v++]*-D;n=e[v++]*G+f;A=e[v++]*-D;r.bezierCurveTo(h,g,o,B,n,A);a=J[J.length-1];if(a){q=a.x;C=a.y;for(s=1,d=this.divisions;s<=d;s++){var p=s/d;var H=THREE.Shape.Utils.b3(p,q,o,n,h);var F=THREE.Shape.Utils.b3(p,C,B,A,g)}}break}}}return{offset:m.ha*I,path:r}}};THREE.FontUtils.generateShapes=function(i,j){j=j||{};var l=j.size!==undefined?j.size:100;var h=j.curveSegments!==undefined?j.curveSegments:4;var d=j.font!==undefined?j.font:"helvetiker";var g=j.weight!==undefined?j.weight:"normal";var a=j.style!==undefined?j.style:"normal";THREE.FontUtils.size=l;THREE.FontUtils.divisions=h;THREE.FontUtils.face=d;THREE.FontUtils.weight=g;THREE.FontUtils.style=a;var f=THREE.FontUtils.drawText(i);var k=f.paths;var c=[];for(var b=0,e=k.length;b<e;b++){Array.prototype.push.apply(c,k[b].toShapes())}return c};(function(c){var b=1e-10;var e=function(g,r){var f=g.length;if(f<3){return null}var D=[],p=[],j=[];var A,q,o;if(d(g)>0){for(q=0;q<f;q++){p[q]=q}}else{for(q=0;q<f;q++){p[q]=(f-1)-q}}var i=f;var h=2*i;for(q=i-1;i>2;){if((h--)<=0){console.log("Warning, unable to triangulate polygon!");if(r){return j}return D}A=q;if(i<=A){A=0}q=A+1;if(i<=q){q=0}o=q+1;if(i<=o){o=0}if(a(g,A,q,o,i,p)){var m,l,k,C,B;m=p[A];l=p[q];k=p[o];D.push([g[m],g[l],g[k]]);j.push([p[A],p[q],p[o]]);for(C=q,B=q+1;B<i;C++,B++){p[C]=p[B]}i--;h=2*i}}if(r){return j}return D};var d=function(g){var j=g.length;var f=0;for(var i=j-1,h=0;h<j;i=h++){f+=g[i].x*g[h].y-g[h].x*g[i].y}return f*0.5};var a=function(J,D,C,t,I,Q){var H;var A,r,O,M;var i,g,G,F;A=J[Q[D]].x;r=J[Q[D]].y;O=J[Q[C]].x;M=J[Q[C]].y;i=J[Q[t]].x;g=J[Q[t]].y;if(b>(((O-A)*(g-r))-((M-r)*(i-A)))){return false}var h,f,B,s,P,N;var l,k,L,K,o,m;var j,q,E;h=i-O;f=g-M;B=A-i;s=r-g;P=O-A;N=M-r;for(H=0;H<I;H++){if((H===D)||(H===C)||(H===t)){continue}G=J[Q[H]].x;F=J[Q[H]].y;l=G-A;k=F-r;L=G-O;K=F-M;o=G-i;m=F-g;E=h*K-f*L;j=P*k-N*l;q=B*m-s*o;if((E>=-b)&&(q>=-b)&&(j>=-b)){return false}}return true};c.Triangulate=e;c.Triangulate.area=d;return c})(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.typeface_js=self._typeface_js;THREE.Curve=function(){};THREE.Curve.prototype.getPoint=function(a){console.log("Warning, getPoint() not implemented!");return null};THREE.Curve.prototype.getPointAt=function(a){var b=this.getUtoTmapping(a);return this.getPoint(b)};THREE.Curve.prototype.getPoints=function(a){if(!a){a=5}var c,b=[];for(c=0;c<=a;c++){b.push(this.getPoint(c/a))}return b};THREE.Curve.prototype.getSpacedPoints=function(a){if(!a){a=5}var c,b=[];for(c=0;c<=a;c++){b.push(this.getPointAt(c/a))}return b};THREE.Curve.prototype.getLength=function(){var a=this.getLengths();return a[a.length-1]};THREE.Curve.prototype.getLengths=function(b){if(!b){b=(this.__arcLengthDivisions)?(this.__arcLengthDivisions):200}if(this.cacheArcLengths&&(this.cacheArcLengths.length==b+1)&&!this.needsUpdate){return this.cacheArcLengths}this.needsUpdate=false;var a=[];var f,d=this.getPoint(0);var e,c=0;a.push(0);for(e=1;e<=b;e++){f=this.getPoint(e/b);c+=f.distanceTo(d);a.push(c);d=f}this.cacheArcLengths=a;return a};THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=true;this.getLengths()};THREE.Curve.prototype.getUtoTmapping=function(m,a){var b=this.getLengths();var e=0,j=b.length;var k;if(a){k=a}else{k=m*b[j-1]}var h=0,d=j-1,l;while(h<=d){e=Math.floor(h+(d-h)/2);l=b[e]-k;if(l<0){h=e+1;continue}else{if(l>0){d=e-1;continue}else{d=e;break}}}e=d;if(b[e]==k){var o=e/(j-1);return o}var f=b[e];var n=b[e+1];var c=n-f;var g=(k-f)/c;var o=(e+g)/(j-1);return o};THREE.Curve.prototype.getTangent=function(b){var g=0.0001;var d=b-g;var c=b+g;if(d<0){d=0}if(c>1){c=1}var f=this.getPoint(d);var e=this.getPoint(c);var a=e.clone().sub(f);return a.normalize()};THREE.Curve.prototype.getTangentAt=function(a){var b=this.getUtoTmapping(a);return this.getTangent(b)};THREE.Curve.Utils={tangentQuadraticBezier:function(a,d,c,b){return 2*(1-a)*(c-d)+2*a*(b-c)},tangentCubicBezier:function(a,e,d,c,b){return -3*e*(1-a)*(1-a)+3*d*(1-a)*(1-a)-6*a*d*(1-a)+6*a*c*(1-a)-3*a*a*c+3*a*a*b},tangentSpline:function(i,h,g,f,d){var e=6*i*i-6*i;var b=3*i*i-4*i+1;var c=-6*i*i+6*i;var a=3*i*i-2*i;return e+b+c+a},interpolate:function(h,g,e,d,i){var f=(e-h)*0.5;var c=(d-g)*0.5;var b=i*i;var a=i*b;return(2*g-2*e+f+c)*a+(-3*g+3*e-2*f-c)*b+f*i+g}};THREE.Curve.create=function(a,b){a.prototype=Object.create(THREE.Curve.prototype);a.prototype.getPoint=b;return a};THREE.CurvePath=function(){this.curves=[];this.bends=[];this.autoClose=false};THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype);THREE.CurvePath.prototype.add=function(a){this.curves.push(a)};THREE.CurvePath.prototype.checkConnection=function(){};THREE.CurvePath.prototype.closePath=function(){var b=this.curves[0].getPoint(0);var a=this.curves[this.curves.length-1].getPoint(1);if(!b.equals(a)){this.curves.push(new THREE.LineCurve(a,b))}};THREE.CurvePath.prototype.getPoint=function(c){var h=c*this.getLength();var g=this.getCurveLengths();var b=0,e,f;while(b<g.length){if(g[b]>=h){e=g[b]-h;f=this.curves[b];var a=1-e/f.getLength();return f.getPointAt(a);break}b++}return null};THREE.CurvePath.prototype.getLength=function(){var a=this.getCurveLengths();return a[a.length-1]};THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length){return this.cacheLengths}var d=[],c=0;var b,a=this.curves.length;for(b=0;b<a;b++){c+=this.curves[b].getLength();d.push(c)}this.cacheLengths=d;return d};THREE.CurvePath.prototype.getBoundingBox=function(){var m=this.getPoints();var b,a,n;var f,e,d;b=a=Number.NEGATIVE_INFINITY;f=e=Number.POSITIVE_INFINITY;var c,g,l,h;var k=m[0] instanceof THREE.Vector3;h=k?new THREE.Vector3():new THREE.Vector2();for(g=0,l=m.length;g<l;g++){c=m[g];if(c.x>b){b=c.x}else{if(c.x<f){f=c.x}}if(c.y>a){a=c.y}else{if(c.y<e){e=c.y}}if(k){if(c.z>n){n=c.z}else{if(c.z<d){d=c.z}}}h.add(c)}var j={minX:f,minY:e,maxX:b,maxY:a,centroid:h.divideScalar(l)};if(k){j.maxZ=n;j.minZ=d}return j};THREE.CurvePath.prototype.createPointsGeometry=function(a){var b=this.getPoints(a,true);return this.createGeometry(b)};THREE.CurvePath.prototype.createSpacedPointsGeometry=function(a){var b=this.getSpacedPoints(a,true);return this.createGeometry(b)};THREE.CurvePath.prototype.createGeometry=function(b){var c=new THREE.Geometry();for(var a=0;a<b.length;a++){c.vertices.push(new THREE.Vector3(b[a].x,b[a].y,b[a].z||0))}return c};THREE.CurvePath.prototype.addWrapPath=function(a){this.bends.push(a)};THREE.CurvePath.prototype.getTransformedPoints=function(c,e){var b=this.getPoints(c);var d,a;if(!e){e=this.bends}for(d=0,a=e.length;d<a;d++){b=this.getWrapPoints(b,e[d])}return b};THREE.CurvePath.prototype.getTransformedSpacedPoints=function(c,e){var b=this.getSpacedPoints(c);var d,a;if(!e){e=this.bends}for(d=0,a=e.length;d<a;d++){b=this.getWrapPoints(b,e[d])}return b};THREE.CurvePath.prototype.getWrapPoints=function(f,l){var a=this.getBoundingBox();var d,g,b,j,h,k;for(d=0,g=f.length;d<g;d++){b=f[d];j=b.x;h=b.y;k=j/a.maxX;k=l.getUtoTmapping(k,j);var c=l.getPoint(k);var e=l.getTangent(k);e.set(-e.y,e.x).multiplyScalar(h);b.x=c.x+e.x;b.y=c.y+e.y}return f};THREE.Gyroscope=function(){THREE.Object3D.call(this)};THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype);THREE.Gyroscope.prototype.updateMatrixWorld=function(c){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||c){if(this.parent){this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix);this.matrixWorld.decompose(this.translationWorld,this.quaternionWorld,this.scaleWorld);this.matrix.decompose(this.translationObject,this.quaternionObject,this.scaleObject);this.matrixWorld.compose(this.translationWorld,this.quaternionObject,this.scaleWorld)}else{this.matrixWorld.copy(this.matrix)}this.matrixWorldNeedsUpdate=false;c=true}for(var b=0,a=this.children.length;b<a;b++){this.children[b].updateMatrixWorld(c)}};THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3();THREE.Gyroscope.prototype.translationObject=new THREE.Vector3();THREE.Gyroscope.prototype.quaternionWorld=new THREE.Quaternion();THREE.Gyroscope.prototype.quaternionObject=new THREE.Quaternion();THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3();THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3();THREE.Path=function(a){THREE.CurvePath.call(this);this.actions=[];if(a){this.fromPoints(a)}};THREE.Path.prototype=Object.create(THREE.CurvePath.prototype);THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"};THREE.Path.prototype.fromPoints=function(b){this.moveTo(b[0].x,b[0].y);for(var a=1,c=b.length;a<c;a++){this.lineTo(b[a].x,b[a].y)}};THREE.Path.prototype.moveTo=function(a,c){var b=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:b})};THREE.Path.prototype.lineTo=function(a,g){var b=Array.prototype.slice.call(arguments);var e=this.actions[this.actions.length-1].args;var c=e[e.length-2];var d=e[e.length-1];var f=new THREE.LineCurve(new THREE.Vector2(c,d),new THREE.Vector2(a,g));this.curves.push(f);this.actions.push({action:THREE.PathActions.LINE_TO,args:b})};THREE.Path.prototype.quadraticCurveTo=function(e,b,g,f){var h=Array.prototype.slice.call(arguments);var a=this.actions[this.actions.length-1].args;var c=a[a.length-2];var i=a[a.length-1];var d=new THREE.QuadraticBezierCurve(new THREE.Vector2(c,i),new THREE.Vector2(e,b),new THREE.Vector2(g,f));this.curves.push(d);this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:h})};THREE.Path.prototype.bezierCurveTo=function(e,c,k,j,g,f){var h=Array.prototype.slice.call(arguments);var a=this.actions[this.actions.length-1].args;var b=a[a.length-2];var i=a[a.length-1];var d=new THREE.CubicBezierCurve(new THREE.Vector2(b,i),new THREE.Vector2(e,c),new THREE.Vector2(k,j),new THREE.Vector2(g,f));this.curves.push(d);this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:h})};THREE.Path.prototype.splineThru=function(g){var a=Array.prototype.slice.call(arguments);var d=this.actions[this.actions.length-1].args;var b=d[d.length-2];var c=d[d.length-1];var f=[new THREE.Vector2(b,c)];Array.prototype.push.apply(f,g);var e=new THREE.SplineCurve(f);this.curves.push(e);this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:a})};THREE.Path.prototype.arc=function(h,f,g,d,a,b){var c=this.actions[this.actions.length-1].args;var e=c[c.length-2];var i=c[c.length-1];this.absarc(h+e,f+i,g,d,a,b)};THREE.Path.prototype.absarc=function(e,d,f,c,b,a){this.absellipse(e,d,f,f,c,b,a)};THREE.Path.prototype.ellipse=function(g,f,i,h,d,a,b){var c=this.actions[this.actions.length-1].args;var e=c[c.length-2];var j=c[c.length-1];this.absellipse(g+e,f+j,i,h,d,a,b)};THREE.Path.prototype.absellipse=function(f,e,j,g,c,a,b){var h=Array.prototype.slice.call(arguments);var d=new THREE.EllipseCurve(f,e,j,g,c,a,b);this.curves.push(d);var i=d.getPoint(1);h.push(i.x);h.push(i.y);this.actions.push({action:THREE.PathActions.ELLIPSE,args:h})};THREE.Path.prototype.getSpacedPoints=function(b,d){if(!b){b=40}var c=[];for(var a=0;a<b;a++){c.push(this.getPoint(a/b))}return c};THREE.Path.prototype.getPoints=function(S,Q){if(this.useSpacedPoints){console.log("tata");return this.getSpacedPoints(S,Q)}S=S||12;var E=[];var N,u,r,c,I;var F,C,R,v,T,A,a,B,b,M,H,L,K;for(N=0,u=this.actions.length;N<u;N++){r=this.actions[N];c=r.action;I=r.args;switch(c){case THREE.PathActions.MOVE_TO:E.push(new THREE.Vector2(I[0],I[1]));break;case THREE.PathActions.LINE_TO:E.push(new THREE.Vector2(I[0],I[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:F=I[2];C=I[3];T=I[0];A=I[1];if(E.length>0){b=E[E.length-1];a=b.x;B=b.y}else{b=this.actions[N-1].args;a=b[b.length-2];B=b[b.length-1]}for(M=1;M<=S;M++){H=M/S;L=THREE.Shape.Utils.b2(H,a,T,F);K=THREE.Shape.Utils.b2(H,B,A,C);E.push(new THREE.Vector2(L,K))}break;case THREE.PathActions.BEZIER_CURVE_TO:F=I[4];C=I[5];T=I[0];A=I[1];R=I[2];v=I[3];if(E.length>0){b=E[E.length-1];a=b.x;B=b.y}else{b=this.actions[N-1].args;a=b[b.length-2];B=b[b.length-1]}for(M=1;M<=S;M++){H=M/S;L=THREE.Shape.Utils.b3(H,a,T,R,F);K=THREE.Shape.Utils.b3(H,B,A,v,C);E.push(new THREE.Vector2(L,K))}break;case THREE.PathActions.CSPLINE_THRU:b=this.actions[N-1].args;var k=new THREE.Vector2(b[b.length-2],b[b.length-1]);var f=[k];var J=S*I[0].length;f=f.concat(I[0]);var P=new THREE.SplineCurve(f);for(M=1;M<=J;M++){E.push(P.getPointAt(M/J))}break;case THREE.PathActions.ARC:var o=I[0],m=I[1],p=I[2],O=I[3],G=I[4],h=!!I[5];var D=G-O;var l;var d=S*2;for(M=1;M<=d;M++){H=M/d;if(!h){H=1-H}l=O+H*D;L=o+p*Math.cos(l);K=m+p*Math.sin(l);E.push(new THREE.Vector2(L,K))}break;case THREE.PathActions.ELLIPSE:var o=I[0],m=I[1],q=I[2],s=I[3],O=I[4],G=I[5],h=!!I[6];var D=G-O;var l;var d=S*2;for(M=1;M<=d;M++){H=M/d;if(!h){H=1-H}l=O+H*D;L=o+q*Math.cos(l);K=m+s*Math.sin(l);E.push(new THREE.Vector2(L,K))}break}}var e=E[E.length-1];var g=1e-10;if(Math.abs(e.x-E[0].x)<g&&Math.abs(e.y-E[0].y)<g){E.splice(E.length-1,1)}if(Q){E.push(E[0])}return E};THREE.Path.prototype.toShapes=function(b){var d,h,l,c,f;var g=[],k=new THREE.Path();for(d=0,h=this.actions.length;d<h;d++){l=this.actions[d];f=l.args;c=l.action;if(c==THREE.PathActions.MOVE_TO){if(k.actions.length!=0){g.push(k);k=new THREE.Path()}}k[c].apply(k,f)}if(k.actions.length!=0){g.push(k)}if(g.length==0){return[]}var e,n,m,a=[];if(g.length==1){n=g[0];m=new THREE.Shape();m.actions=n.actions;m.curves=n.curves;a.push(m);return a}var j=!THREE.Shape.Utils.isClockWise(g[0].getPoints());j=b?!j:j;if(j){m=new THREE.Shape();for(d=0,h=g.length;d<h;d++){n=g[d];e=THREE.Shape.Utils.isClockWise(n.getPoints());e=b?!e:e;if(e){m.actions=n.actions;m.curves=n.curves;a.push(m);m=new THREE.Shape()}else{m.holes.push(n)}}}else{m=undefined;for(d=0,h=g.length;d<h;d++){n=g[d];e=THREE.Shape.Utils.isClockWise(n.getPoints());e=b?!e:e;if(e){if(m){a.push(m)}m=new THREE.Shape();m.actions=n.actions;m.curves=n.curves}else{m.holes.push(n)}}a.push(m)}return a};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=Object.create(THREE.Path.prototype);THREE.Shape.prototype.extrude=function(b){var a=new THREE.ExtrudeGeometry(this,b);return a};THREE.Shape.prototype.makeGeometry=function(a){var b=new THREE.ShapeGeometry(this,a);return b};THREE.Shape.prototype.getPointsHoles=function(c){var b,a=this.holes.length,d=[];for(b=0;b<a;b++){d[b]=this.holes[b].getTransformedPoints(c,this.bends)}return d};THREE.Shape.prototype.getSpacedPointsHoles=function(c){var b,a=this.holes.length,d=[];for(b=0;b<a;b++){d[b]=this.holes[b].getTransformedSpacedPoints(c,this.bends)}return d};THREE.Shape.prototype.extractAllPoints=function(a){return{shape:this.getTransformedPoints(a),holes:this.getPointsHoles(a)}};THREE.Shape.prototype.extractPoints=function(a){if(this.useSpacedPoints){return this.extractAllSpacedPoints(a)}return this.extractAllPoints(a)};THREE.Shape.prototype.extractAllSpacedPoints=function(a){return{shape:this.getTransformedSpacedPoints(a),holes:this.getSpacedPointsHoles(a)}};THREE.Shape.Utils={removeHoles:function(G,m){var k=G.concat();var E=k.concat();var B,c,t,P,D,u,F,i,N,s,r,q,Q,H,o,n,S,R,b,a,M=[];for(N=0;N<m.length;N++){r=m[N];Array.prototype.push.apply(E,r);q=Number.POSITIVE_INFINITY;for(s=0;s<r.length;s++){o=r[s];var e=[];for(H=0;H<k.length;H++){n=k[H];Q=o.distanceToSquared(n);e.push(Q);if(Q<q){q=Q;D=s;u=H}}}B=(u-1)>=0?u-1:k.length-1;t=(D-1)>=0?D-1:r.length-1;var f=[r[D],k[u],k[B]];var L=THREE.FontUtils.Triangulate.area(f);var C=[r[D],r[t],k[u]];var K=THREE.FontUtils.Triangulate.area(C);var l=1;var I=-1;var v=u,J=D;u+=l;D+=I;if(u<0){u+=k.length}u%=k.length;if(D<0){D+=r.length}D%=r.length;B=(u-1)>=0?u-1:k.length-1;t=(D-1)>=0?D-1:r.length-1;f=[r[D],k[u],k[B]];var O=THREE.FontUtils.Triangulate.area(f);C=[r[D],r[t],k[u]];var A=THREE.FontUtils.Triangulate.area(C);if((L+K)>(O+A)){u=v;D=J;if(u<0){u+=k.length}u%=k.length;if(D<0){D+=r.length}D%=r.length;B=(u-1)>=0?u-1:k.length-1;t=(D-1)>=0?D-1:r.length-1}else{}S=k.slice(0,u);R=k.slice(u);b=r.slice(D);a=r.slice(0,D);var j=[r[D],k[u],k[B]];var g=[r[D],r[t],k[u]];M.push(j);M.push(g);k=S.concat(b).concat(a).concat(R)}return{shape:k,isolatedPts:M,allpoints:E}},triangulateShape:function(d,c){var h=THREE.Shape.Utils.removeHoles(d,c);var l=h.shape,a=h.allpoints,o=h.isolatedPts;var b=THREE.FontUtils.Triangulate(l,false);var e,n,k,m,p,j,g={},q={};for(e=0,n=a.length;e<n;e++){p=a[e].x+":"+a[e].y;if(g[p]!==undefined){console.log("Duplicate point",p)}g[p]=e}for(e=0,n=b.length;e<n;e++){m=b[e];for(k=0;k<3;k++){p=m[k].x+":"+m[k].y;j=g[p];if(j!==undefined){m[k]=j}}}for(e=0,n=o.length;e<n;e++){m=o[e];for(k=0;k<3;k++){p=m[k].x+":"+m[k].y;j=g[p];if(j!==undefined){m[k]=j}}}return b.concat(o)},isClockWise:function(a){return THREE.FontUtils.Triangulate.area(a)<0},b2p0:function(b,c){var a=1-b;return a*a*c},b2p1:function(a,b){return 2*(1-a)*a*b},b2p2:function(a,b){return a*a*b},b2:function(a,d,c,b){return this.b2p0(a,d)+this.b2p1(a,c)+this.b2p2(a,b)},b3p0:function(b,c){var a=1-b;return a*a*a*c},b3p1:function(b,c){var a=1-b;return 3*a*a*b*c},b3p2:function(b,c){var a=1-b;return 3*a*b*b*c},b3p3:function(a,b){return a*a*a*b},b3:function(a,e,d,c,b){return this.b3p0(a,e)+this.b3p1(a,d)+this.b3p2(a,c)+this.b3p3(a,b)}};THREE.LineCurve=function(b,a){this.v1=b;this.v2=a};THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.LineCurve.prototype.getPoint=function(b){var a=this.v2.clone().sub(this.v1);a.multiplyScalar(b).add(this.v1);return a};THREE.LineCurve.prototype.getPointAt=function(a){return this.getPoint(a)};THREE.LineCurve.prototype.getTangent=function(a){var b=this.v2.clone().sub(this.v1);return b.normalize()};THREE.QuadraticBezierCurve=function(a,c,b){this.v0=a;this.v1=c;this.v2=b};THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.QuadraticBezierCurve.prototype.getPoint=function(c){var b,a;b=THREE.Shape.Utils.b2(c,this.v0.x,this.v1.x,this.v2.x);a=THREE.Shape.Utils.b2(c,this.v0.y,this.v1.y,this.v2.y);return new THREE.Vector2(b,a)};THREE.QuadraticBezierCurve.prototype.getTangent=function(c){var b,a;b=THREE.Curve.Utils.tangentQuadraticBezier(c,this.v0.x,this.v1.x,this.v2.x);a=THREE.Curve.Utils.tangentQuadraticBezier(c,this.v0.y,this.v1.y,this.v2.y);var d=new THREE.Vector2(b,a);d.normalize();return d};THREE.CubicBezierCurve=function(a,d,c,b){this.v0=a;this.v1=d;this.v2=c;this.v3=b};THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.CubicBezierCurve.prototype.getPoint=function(c){var b,a;b=THREE.Shape.Utils.b3(c,this.v0.x,this.v1.x,this.v2.x,this.v3.x);a=THREE.Shape.Utils.b3(c,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new THREE.Vector2(b,a)};THREE.CubicBezierCurve.prototype.getTangent=function(c){var b,a;b=THREE.Curve.Utils.tangentCubicBezier(c,this.v0.x,this.v1.x,this.v2.x,this.v3.x);a=THREE.Curve.Utils.tangentCubicBezier(c,this.v0.y,this.v1.y,this.v2.y,this.v3.y);var d=new THREE.Vector2(b,a);d.normalize();return d};THREE.SplineCurve=function(a){this.points=(a==undefined)?[]:a};THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.SplineCurve.prototype.getPoint=function(d){var b=new THREE.Vector2();var h=[];var e=this.points,a,g,f;a=(e.length-1)*d;g=Math.floor(a);f=a-g;h[0]=g==0?g:g-1;h[1]=g;h[2]=g>e.length-2?e.length-1:g+1;h[3]=g>e.length-3?e.length-1:g+2;b.x=THREE.Curve.Utils.interpolate(e[h[0]].x,e[h[1]].x,e[h[2]].x,e[h[3]].x,f);b.y=THREE.Curve.Utils.interpolate(e[h[0]].y,e[h[1]].y,e[h[2]].y,e[h[3]].y,f);return b};THREE.EllipseCurve=function(f,e,g,a,d,c,b){this.aX=f;this.aY=e;this.xRadius=g;this.yRadius=a;this.aStartAngle=d;this.aEndAngle=c;this.aClockwise=b};THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype);THREE.EllipseCurve.prototype.getPoint=function(c){var d;var e=this.aEndAngle-this.aStartAngle;if(e<0){e+=Math.PI*2}if(e>Math.PI*2){e-=Math.PI*2}if(this.aClockwise===true){d=this.aEndAngle+(1-c)*(Math.PI*2-e)}else{d=this.aStartAngle+c*e}var b=this.aX+this.xRadius*Math.cos(d);var a=this.aY+this.yRadius*Math.sin(d);return new THREE.Vector2(b,a)};THREE.ArcCurve=function(e,d,f,c,b,a){THREE.EllipseCurve.call(this,e,d,f,f,c,b,a)};THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype);THREE.LineCurve3=THREE.Curve.create(function(b,a){this.v1=b;this.v2=a},function(a){var b=new THREE.Vector3();b.subVectors(this.v2,this.v1);b.multiplyScalar(a);b.add(this.v1);return b});THREE.QuadraticBezierCurve3=THREE.Curve.create(function(a,c,b){this.v0=a;this.v1=c;this.v2=b},function(c){var b,a,d;b=THREE.Shape.Utils.b2(c,this.v0.x,this.v1.x,this.v2.x);a=THREE.Shape.Utils.b2(c,this.v0.y,this.v1.y,this.v2.y);d=THREE.Shape.Utils.b2(c,this.v0.z,this.v1.z,this.v2.z);return new THREE.Vector3(b,a,d)});THREE.CubicBezierCurve3=THREE.Curve.create(function(a,d,c,b){this.v0=a;this.v1=d;this.v2=c;this.v3=b},function(c){var b,a,d;b=THREE.Shape.Utils.b3(c,this.v0.x,this.v1.x,this.v2.x,this.v3.x);a=THREE.Shape.Utils.b3(c,this.v0.y,this.v1.y,this.v2.y,this.v3.y);d=THREE.Shape.Utils.b3(c,this.v0.z,this.v1.z,this.v2.z,this.v3.z);return new THREE.Vector3(b,a,d)});THREE.SplineCurve3=THREE.Curve.create(function(a){this.points=(a==undefined)?[]:a},function(l){var j=new THREE.Vector3();var d=[];var i=this.points,g,a,b;g=(i.length-1)*l;a=Math.floor(g);b=g-a;d[0]=a==0?a:a-1;d[1]=a;d[2]=a>i.length-2?i.length-1:a+1;d[3]=a>i.length-3?i.length-1:a+2;var k=i[d[0]],h=i[d[1]],f=i[d[2]],e=i[d[3]];j.x=THREE.Curve.Utils.interpolate(k.x,h.x,f.x,e.x,b);j.y=THREE.Curve.Utils.interpolate(k.y,h.y,f.y,e.y,b);j.z=THREE.Curve.Utils.interpolate(k.z,h.z,f.z,e.z,b);return j});THREE.ClosedSplineCurve3=THREE.Curve.create(function(a){this.points=(a==undefined)?[]:a},function(d){var b=new THREE.Vector3();var h=[];var e=this.points,a,g,f;a=(e.length-0)*d;g=Math.floor(a);f=a-g;g+=g>0?0:(Math.floor(Math.abs(g)/e.length)+1)*e.length;h[0]=(g-1)%e.length;h[1]=(g)%e.length;h[2]=(g+1)%e.length;h[3]=(g+2)%e.length;b.x=THREE.Curve.Utils.interpolate(e[h[0]].x,e[h[1]].x,e[h[2]].x,e[h[3]].x,f);b.y=THREE.Curve.Utils.interpolate(e[h[0]].y,e[h[1]].y,e[h[2]].y,e[h[3]].y,f);b.z=THREE.Curve.Utils.interpolate(e[h[0]].z,e[h[1]].z,e[h[2]].z,e[h[3]].z,f);return b});THREE.AnimationHandler=(function(){var c=[];var b={};var d={};d.update=function(g){for(var f=0;f<c.length;f++){c[f].update(g)}};d.addToUpdate=function(f){if(c.indexOf(f)===-1){c.push(f)}};d.removeFromUpdate=function(g){var f=c.indexOf(g);if(f!==-1){c.splice(f,1)}};d.add=function(f){if(b[f.name]!==undefined){console.log("THREE.AnimationHandler.add: Warning! "+f.name+" already exists in library. Overwriting.")}b[f.name]=f;a(f)};d.get=function(f){if(typeof f==="string"){if(b[f]){return b[f]}else{console.log("THREE.AnimationHandler.get: Couldn't find animation "+f);return null}}else{}};d.parse=function(g){var h=[];if(g instanceof THREE.SkinnedMesh){for(var f=0;f<g.bones.length;f++){h.push(g.bones[f])}}else{e(g,h)}return h};var e=function(f,g){g.push(f);for(var h=0;h<f.children.length;h++){e(f.children[h],g)}};var a=function(j){if(j.initialized===true){return}for(var l=0;l<j.hierarchy.length;l++){for(var i=0;i<j.hierarchy[l].keys.length;i++){if(j.hierarchy[l].keys[i].time<0){j.hierarchy[l].keys[i].time=0}if(j.hierarchy[l].keys[i].rot!==undefined&&!(j.hierarchy[l].keys[i].rot instanceof THREE.Quaternion)){var f=j.hierarchy[l].keys[i].rot;j.hierarchy[l].keys[i].rot=new THREE.Quaternion(f[0],f[1],f[2],f[3])}}if(j.hierarchy[l].keys.length&&j.hierarchy[l].keys[0].morphTargets!==undefined){var p={};for(var i=0;i<j.hierarchy[l].keys.length;i++){for(var g=0;g<j.hierarchy[l].keys[i].morphTargets.length;g++){var n=j.hierarchy[l].keys[i].morphTargets[g];p[n]=-1}}j.hierarchy[l].usedMorphTargets=p;for(var i=0;i<j.hierarchy[l].keys.length;i++){var o={};for(var n in p){for(var g=0;g<j.hierarchy[l].keys[i].morphTargets.length;g++){if(j.hierarchy[l].keys[i].morphTargets[g]===n){o[n]=j.hierarchy[l].keys[i].morphTargetsInfluences[g];break}}if(g===j.hierarchy[l].keys[i].morphTargets.length){o[n]=0}}j.hierarchy[l].keys[i].morphTargetsInfluences=o}}for(var i=1;i<j.hierarchy[l].keys.length;i++){if(j.hierarchy[l].keys[i].time===j.hierarchy[l].keys[i-1].time){j.hierarchy[l].keys.splice(i,1);i--}}for(var i=0;i<j.hierarchy[l].keys.length;i++){j.hierarchy[l].keys[i].index=i}}var q=parseInt(j.length*j.fps,10);j.JIT={};j.JIT.hierarchy=[];for(var l=0;l<j.hierarchy.length;l++){j.JIT.hierarchy.push(new Array(q))}j.initialized=true};d.LINEAR=0;d.CATMULLROM=1;d.CATMULLROM_FORWARD=2;return d}());THREE.Animation=function(a,b,c){this.root=a;this.data=THREE.AnimationHandler.get(b);this.hierarchy=THREE.AnimationHandler.parse(a);this.currentTime=0;this.timeScale=1;this.isPlaying=false;this.isPaused=true;this.loop=true;this.interpolationType=c!==undefined?c:THREE.AnimationHandler.LINEAR;this.points=[];this.target=new THREE.Vector3()};THREE.Animation.prototype.play=function(d,c){if(this.isPlaying===false){this.isPlaying=true;this.loop=d!==undefined?d:true;this.currentTime=c!==undefined?c:0;var g,b=this.hierarchy.length,e;for(g=0;g<b;g++){e=this.hierarchy[g];e.matrixAutoUpdate=true;if(e.animationCache===undefined){e.animationCache={};e.animationCache.prevKey={pos:0,rot:0,scl:0};e.animationCache.nextKey={pos:0,rot:0,scl:0};e.animationCache.originalMatrix=e instanceof THREE.Bone?e.skinMatrix:e.matrix}var f=e.animationCache.prevKey;var a=e.animationCache.nextKey;f.pos=this.data.hierarchy[g].keys[0];f.rot=this.data.hierarchy[g].keys[0];f.scl=this.data.hierarchy[g].keys[0];a.pos=this.getNextKeyWith("pos",g,1);a.rot=this.getNextKeyWith("rot",g,1);a.scl=this.getNextKeyWith("scl",g,1)}this.update(0)}this.isPaused=false;THREE.AnimationHandler.addToUpdate(this)};THREE.Animation.prototype.pause=function(){if(this.isPaused===true){THREE.AnimationHandler.addToUpdate(this)}else{THREE.AnimationHandler.removeFromUpdate(this)}this.isPaused=!this.isPaused};THREE.Animation.prototype.stop=function(){this.isPlaying=false;this.isPaused=false;THREE.AnimationHandler.removeFromUpdate(this)};THREE.Animation.prototype.update=function(l){if(this.isPlaying===false){return}var g=["pos","rot","scl"];var d;var v;var b;var m,c;var s,e;var u;var k;var j;var r=this.data.JIT.hierarchy;var o,q;var f,A,p;this.currentTime+=l*this.timeScale;q=this.currentTime;while(this.currentTime>this.data.length){this.currentTime-=this.data.length}o=this.currentTime=this.currentTime%this.data.length;j=parseInt(Math.min(o*this.data.fps,this.data.length*this.data.fps),10);for(var n=0,a=this.hierarchy.length;n<a;n++){u=this.hierarchy[n];k=u.animationCache;for(var i=0;i<3;i++){d=g[i];s=k.prevKey[d];e=k.nextKey[d];if(e.time<=q){if(o<=q){if(this.loop){s=this.data.hierarchy[n].keys[0];e=this.getNextKeyWith(d,n,1);while(e!==null&&e.time<o&&e.index>s.index){s=e;e=this.getNextKeyWith(d,n,e.index+1)}}else{this.stop();return}}else{do{s=e;e=this.getNextKeyWith(d,n,e.index+1)}while(e!==null&&e.time<o&&e.index>s.index)}k.prevKey[d]=s;k.nextKey[d]=e}u.matrixAutoUpdate=true;u.matrixWorldNeedsUpdate=true;v=(o-s.time)/(e.time-s.time);m=s[d];c=e[d];if(v<0||v>1){console.log("THREE.Animation.update: Warning! Scale out of bounds:"+v+" on bone "+n);v=v<0?0:1}if(d==="pos"){b=u.position;if(this.interpolationType===THREE.AnimationHandler.LINEAR){b.x=m[0]+(c[0]-m[0])*v;b.y=m[1]+(c[1]-m[1])*v;b.z=m[2]+(c[2]-m[2])*v}else{if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD){this.points[0]=this.getPrevKeyWith("pos",n,s.index-1)["pos"];this.points[1]=m;this.points[2]=c;this.points[3]=this.getNextKeyWith("pos",n,e.index+1)["pos"];v=v*0.33+0.33;f=this.interpolateCatmullRom(this.points,v);b.x=f[0];b.y=f[1];b.z=f[2];if(this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD){A=this.interpolateCatmullRom(this.points,v*1.01);this.target.set(A[0],A[1],A[2]);this.target.sub(b);this.target.y=0;this.target.normalize();p=Math.atan2(this.target.x,this.target.z);u.rotation.set(0,p,0)}}}}else{if(d==="rot"){THREE.Quaternion.slerp(m,c,u.quaternion,v)}else{if(d==="scl"){b=u.scale;b.x=m[0]+(c[0]-m[0])*v;b.y=m[1]+(c[1]-m[1])*v;b.z=m[2]+(c[2]-m[2])*v}}}}}};THREE.Animation.prototype.interpolateCatmullRom=function(n,b){var h=[],j=[],m,a,f,e,d,l,k,i,g;m=(n.length-1)*b;a=Math.floor(m);f=m-a;h[0]=a===0?a:a-1;h[1]=a;h[2]=a>n.length-2?a:a+1;h[3]=a>n.length-3?a:a+2;l=n[h[0]];k=n[h[1]];i=n[h[2]];g=n[h[3]];e=f*f;d=f*e;j[0]=this.interpolate(l[0],k[0],i[0],g[0],f,e,d);j[1]=this.interpolate(l[1],k[1],i[1],g[1],f,e,d);j[2]=this.interpolate(l[2],k[2],i[2],g[2],f,e,d);return j};THREE.Animation.prototype.interpolate=function(h,g,e,d,i,b,a){var f=(e-h)*0.5,c=(d-g)*0.5;return(2*(g-e)+f+c)*a+(-3*(g-e)-2*f-c)*b+f*i+g};THREE.Animation.prototype.getNextKeyWith=function(c,b,a){var d=this.data.hierarchy[b].keys;if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD){a=a<d.length-1?a:d.length-1}else{a=a%d.length}for(;a<d.length;a++){if(d[a][c]!==undefined){return d[a]}}return this.data.hierarchy[b].keys[0]};THREE.Animation.prototype.getPrevKeyWith=function(c,b,a){var d=this.data.hierarchy[b].keys;if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD){a=a>0?a:0}else{a=a>=0?a:a+d.length}for(;a>=0;a--){if(d[a][c]!==undefined){return d[a]}}return this.data.hierarchy[b].keys[d.length-1]};THREE.KeyFrameAnimation=function(j,e,i){this.root=j;this.data=THREE.AnimationHandler.get(e);this.hierarchy=THREE.AnimationHandler.parse(j);this.currentTime=0;this.timeScale=0.001;this.isPlaying=false;this.isPaused=true;this.loop=true;this.JITCompile=i!==undefined?i:true;for(var g=0,c=this.hierarchy.length;g<c;g++){var k=this.data.hierarchy[g].keys,a=this.data.hierarchy[g].sids,d=this.hierarchy[g];if(k.length&&a){for(var l=0;l<a.length;l++){var b=a[l],f=this.getNextKeyWith(b,g,0);if(f){f.apply(b)}}d.matrixAutoUpdate=false;this.data.hierarchy[g].node.updateMatrix();d.matrixWorldNeedsUpdate=true}}};THREE.KeyFrameAnimation.prototype.play=function(c,b){if(!this.isPlaying){this.isPlaying=true;this.loop=c!==undefined?c:true;this.currentTime=b!==undefined?b:0;this.startTimeMs=b;this.startTime=10000000;this.endTime=-this.startTime;var e,a=this.hierarchy.length,d,g;for(e=0;e<a;e++){d=this.hierarchy[e];g=this.data.hierarchy[e];if(g.animationCache===undefined){g.animationCache={};g.animationCache.prevKey=null;g.animationCache.nextKey=null;g.animationCache.originalMatrix=d instanceof THREE.Bone?d.skinMatrix:d.matrix}var f=this.data.hierarchy[e].keys;if(f.length){g.animationCache.prevKey=f[0];g.animationCache.nextKey=f[1];this.startTime=Math.min(f[0].time,this.startTime);this.endTime=Math.max(f[f.length-1].time,this.endTime)}}this.update(0)}this.isPaused=false;THREE.AnimationHandler.addToUpdate(this)};THREE.KeyFrameAnimation.prototype.pause=function(){if(this.isPaused){THREE.AnimationHandler.addToUpdate(this)}else{THREE.AnimationHandler.removeFromUpdate(this)}this.isPaused=!this.isPaused};THREE.KeyFrameAnimation.prototype.stop=function(){this.isPlaying=false;this.isPaused=false;THREE.AnimationHandler.removeFromUpdate(this);for(var b=0;b<this.data.hierarchy.length;b++){var d=this.hierarchy[b];var c=this.data.hierarchy[b];if(c.animationCache!==undefined){var a=c.animationCache.originalMatrix;if(d instanceof THREE.Bone){a.copy(d.skinMatrix);d.skinMatrix=a}else{a.copy(d.matrix);d.matrix=a}delete c.animationCache}}};THREE.KeyFrameAnimation.prototype.update=function(n){if(!this.isPlaying){return}var v,d;var A;var l;var g;var u=this.data.JIT.hierarchy;var q,t;var e;this.currentTime+=n*this.timeScale;t=this.currentTime;q=this.currentTime=this.currentTime%this.data.length;if(q<this.startTimeMs){q=this.currentTime=this.startTimeMs+q}g=parseInt(Math.min(q*this.data.fps,this.data.length*this.data.fps),10);e=q<t;if(e&&!this.loop){for(var o=0,a=this.hierarchy.length;o<a;o++){var j=this.data.hierarchy[o].keys,r=this.data.hierarchy[o].sids,b=j.length-1,f=this.hierarchy[o];if(j.length){for(var i=0;i<r.length;i++){var c=r[i],k=this.getPrevKeyWith(c,o,b);if(k){k.apply(c)}}this.data.hierarchy[o].node.updateMatrix();f.matrixWorldNeedsUpdate=true}}this.stop();return}if(q<this.startTime){return}for(var o=0,a=this.hierarchy.length;o<a;o++){A=this.hierarchy[o];l=this.data.hierarchy[o];var j=l.keys,m=l.animationCache;if(this.JITCompile&&u[o][g]!==undefined){if(A instanceof THREE.Bone){A.skinMatrix=u[o][g];A.matrixWorldNeedsUpdate=false}else{A.matrix=u[o][g];A.matrixWorldNeedsUpdate=true}}else{if(j.length){if(this.JITCompile&&m){if(A instanceof THREE.Bone){A.skinMatrix=m.originalMatrix}else{A.matrix=m.originalMatrix}}v=m.prevKey;d=m.nextKey;if(v&&d){if(d.time<=t){if(e&&this.loop){v=j[0];d=j[1];while(d.time<q){v=d;d=j[v.index+1]}}else{if(!e){var p=j.length-1;while(d.time<q&&d.index!==p){v=d;d=j[v.index+1]}}}m.prevKey=v;m.nextKey=d}if(d.time>=q){v.interpolate(d,q)}else{v.interpolate(d,d.time)}}this.data.hierarchy[o].node.updateMatrix();A.matrixWorldNeedsUpdate=true}}}if(this.JITCompile){if(u[0][g]===undefined){this.hierarchy[0].updateMatrixWorld(true);for(var o=0;o<this.hierarchy.length;o++){if(this.hierarchy[o] instanceof THREE.Bone){u[o][g]=this.hierarchy[o].skinMatrix.clone()}else{u[o][g]=this.hierarchy[o].matrix.clone()}}}}};THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(a,c,b){var d=this.data.hierarchy[c].keys;b=b%d.length;for(;b<d.length;b++){if(d[b].hasTarget(a)){return d[b]}}return d[0]};THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(a,c,b){var d=this.data.hierarchy[c].keys;b=b>=0?b:b+d.length;for(;b>=0;b--){if(d[b].hasTarget(a)){return d[b]}}return d[d.length-1]};THREE.CubeCamera=function(f,e,g){THREE.Object3D.call(this);var d=90,b=1;var c=new THREE.PerspectiveCamera(d,b,f,e);c.up.set(0,-1,0);c.lookAt(new THREE.Vector3(1,0,0));this.add(c);var j=new THREE.PerspectiveCamera(d,b,f,e);j.up.set(0,-1,0);j.lookAt(new THREE.Vector3(-1,0,0));this.add(j);var a=new THREE.PerspectiveCamera(d,b,f,e);a.up.set(0,0,1);a.lookAt(new THREE.Vector3(0,1,0));this.add(a);var i=new THREE.PerspectiveCamera(d,b,f,e);i.up.set(0,0,-1);i.lookAt(new THREE.Vector3(0,-1,0));this.add(i);var k=new THREE.PerspectiveCamera(d,b,f,e);k.up.set(0,-1,0);k.lookAt(new THREE.Vector3(0,0,1));this.add(k);var h=new THREE.PerspectiveCamera(d,b,f,e);h.up.set(0,-1,0);h.lookAt(new THREE.Vector3(0,0,-1));this.add(h);this.renderTarget=new THREE.WebGLRenderTargetCube(g,g,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updateCubeMap=function(n,o){var m=this.renderTarget;var l=m.generateMipmaps;m.generateMipmaps=false;m.activeCubeFace=0;n.render(o,c,m);m.activeCubeFace=1;n.render(o,j,m);m.activeCubeFace=2;n.render(o,a,m);m.activeCubeFace=3;n.render(o,i,m);m.activeCubeFace=4;n.render(o,k,m);m.generateMipmaps=l;m.activeCubeFace=5;n.render(o,h,m)}};THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype);THREE.CombinedCamera=function(h,a,e,g,b,f,d){THREE.Camera.call(this);this.fov=e;this.left=-h/2;this.right=h/2;this.top=a/2;this.bottom=-a/2;this.cameraO=new THREE.OrthographicCamera(h/-2,h/2,a/2,a/-2,f,d);this.cameraP=new THREE.PerspectiveCamera(e,h/a,g,b);this.zoom=1;this.toPerspective();var c=h/a};THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype);THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near;this.far=this.cameraP.far;this.cameraP.fov=this.fov/this.zoom;this.cameraP.updateProjectionMatrix();this.projectionMatrix=this.cameraP.projectionMatrix;this.inPerspectiveMode=true;this.inOrthographicMode=false};THREE.CombinedCamera.prototype.toOrthographic=function(){var d=this.fov;var b=this.cameraP.aspect;var f=this.cameraP.near;var e=this.cameraP.far;var g=(f+e)/2;var h=Math.tan(d/2)*g;var a=2*h;var i=a*b;var c=i/2;h/=this.zoom;c/=this.zoom;this.cameraO.left=-c;this.cameraO.right=c;this.cameraO.top=h;this.cameraO.bottom=-h;this.cameraO.updateProjectionMatrix();this.near=this.cameraO.near;this.far=this.cameraO.far;this.projectionMatrix=this.cameraO.projectionMatrix;this.inPerspectiveMode=false;this.inOrthographicMode=true};THREE.CombinedCamera.prototype.setSize=function(b,a){this.cameraP.aspect=b/a;this.left=-b/2;this.right=b/2;this.top=a/2;this.bottom=-a/2};THREE.CombinedCamera.prototype.setFov=function(a){this.fov=a;if(this.inPerspectiveMode){this.toPerspective()}else{this.toOrthographic()}};THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){if(this.inPerspectiveMode){this.toPerspective()}else{this.toPerspective();this.toOrthographic()}};THREE.CombinedCamera.prototype.setLens=function(c,b){if(b===undefined){b=24}var a=2*THREE.Math.radToDeg(Math.atan(b/(c*2)));this.setFov(a);return a};THREE.CombinedCamera.prototype.setZoom=function(a){this.zoom=a;if(this.inPerspectiveMode){this.toPerspective()}else{this.toOrthographic()}};THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=false};THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0;this.rotation.y=Math.PI;this.rotation.z=0;this.rotationAutoUpdate=false};THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0;this.rotation.y=-Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=false};THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0;this.rotation.y=Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=false};THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=false};THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=false};THREE.CircleGeometry=function(k,g,d,b){THREE.Geometry.call(this);this.radius=k=k||50;this.segments=g=g!==undefined?Math.max(3,g):8;this.thetaStart=d=d!==undefined?d:0;this.thetaLength=b=b!==undefined?b:Math.PI*2;var f,e=[],a=new THREE.Vector3(),o=new THREE.Vector2(0.5,0.5);this.vertices.push(a);e.push(o);for(f=0;f<=g;f++){var j=new THREE.Vector3();var h=d+f/g*b;j.x=k*Math.cos(h);j.y=k*Math.sin(h);this.vertices.push(j);e.push(new THREE.Vector2((j.x/k+1)/2,(j.y/k+1)/2))}var c=new THREE.Vector3(0,0,1);for(f=1;f<=g;f++){var p=f;var m=f+1;var l=0;this.faces.push(new THREE.Face3(p,m,l,[c.clone(),c.clone(),c.clone()]));this.faceVertexUvs[0].push([e[f].clone(),e[f+1].clone(),o.clone()])}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3(),k)};THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CubeGeometry=function(a,i,e,b,h,d){THREE.Geometry.call(this);var k=this;this.width=a;this.height=i;this.depth=e;this.widthSegments=b||1;this.heightSegments=h||1;this.depthSegments=d||1;var j=this.width/2;var g=this.height/2;var c=this.depth/2;f("z","y",-1,-1,this.depth,this.height,j,0);f("z","y",1,-1,this.depth,this.height,-j,1);f("x","z",1,1,this.width,this.depth,g,2);f("x","z",1,-1,this.width,this.depth,-g,3);f("x","y",1,-1,this.width,this.height,c,4);f("x","y",-1,-1,this.width,this.height,-c,5);function f(E,D,l,s,G,F,V,A){var C,q,p,K=k.widthSegments,I=k.heightSegments,r=G/2,o=F/2,t=k.vertices.length;if((E==="x"&&D==="y")||(E==="y"&&D==="x")){C="z"}else{if((E==="x"&&D==="z")||(E==="z"&&D==="x")){C="y";I=k.depthSegments}else{if((E==="z"&&D==="y")||(E==="y"&&D==="z")){C="x";K=k.depthSegments}}}var M=K+1,n=I+1,U=G/K,P=F/I,T=new THREE.Vector3();T[C]=V>0?1:-1;for(p=0;p<n;p++){for(q=0;q<M;q++){var m=new THREE.Vector3();m[E]=(q*U-r)*l;m[D]=(p*P-o)*s;m[C]=V;k.vertices.push(m)}}for(p=0;p<I;p++){for(q=0;q<K;q++){var S=q+M*p;var R=q+M*(p+1);var Q=(q+1)+M*(p+1);var O=(q+1)+M*p;var N=new THREE.Vector2(q/K,1-p/I);var L=new THREE.Vector2(q/K,1-(p+1)/I);var J=new THREE.Vector2((q+1)/K,1-(p+1)/I);var H=new THREE.Vector2((q+1)/K,1-p/I);var B=new THREE.Face3(S+t,R+t,O+t);B.normal.copy(T);B.vertexNormals.push(T.clone(),T.clone(),T.clone());B.materialIndex=A;k.faces.push(B);k.faceVertexUvs[0].push([N,L,H]);B=new THREE.Face3(R+t,Q+t,O+t);B.normal.copy(T);B.vertexNormals.push(T.clone(),T.clone(),T.clone());B.materialIndex=A;k.faces.push(B);k.faceVertexUvs[0].push([L.clone(),J,H.clone()])}}}this.computeCentroids();this.mergeVertices()};THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.CylinderGeometry=function(k,L,B,e,t,I){THREE.Geometry.call(this);this.radiusTop=k=k!==undefined?k:20;this.radiusBottom=L=L!==undefined?L:20;this.height=B=B!==undefined?B:100;this.radialSegments=e=e||8;this.heightSegments=t=t||1;this.openEnded=I=I!==undefined?I:false;var C=B/2;var p,o,g=[],q=[];for(o=0;o<=t;o++){var A=[];var K=[];var r=o/t;var f=r*(L-k)+k;for(p=0;p<=e;p++){var s=p/e;var G=new THREE.Vector3();G.x=f*Math.sin(s*Math.PI*2);G.y=-r*B+C;G.z=f*Math.cos(s*Math.PI*2);this.vertices.push(G);A.push(this.vertices.length-1);K.push(new THREE.Vector2(s,1-r))}g.push(A);q.push(K)}var E=(L-k)/B;var m,j;for(p=0;p<e;p++){if(k!==0){m=this.vertices[g[0][p]].clone();j=this.vertices[g[0][p+1]].clone()}else{m=this.vertices[g[1][p]].clone();j=this.vertices[g[1][p+1]].clone()}m.setY(Math.sqrt(m.x*m.x+m.z*m.z)*E).normalize();j.setY(Math.sqrt(j.x*j.x+j.z*j.z)*E).normalize();for(o=0;o<t;o++){var d=g[o][p];var c=g[o+1][p];var b=g[o+1][p+1];var a=g[o][p+1];var n=m.clone();var l=m.clone();var i=j.clone();var h=j.clone();var J=q[o][p].clone();var H=q[o+1][p].clone();var F=q[o+1][p+1].clone();var D=q[o][p+1].clone();this.faces.push(new THREE.Face3(d,c,a,[n,l,h]));this.faceVertexUvs[0].push([J,H,D]);this.faces.push(new THREE.Face3(c,b,a,[l.clone(),i,h.clone()]));this.faceVertexUvs[0].push([H.clone(),F,D.clone()])}}if(I===false&&k>0){this.vertices.push(new THREE.Vector3(0,C,0));for(p=0;p<e;p++){var d=g[0][p];var c=g[0][p+1];var b=this.vertices.length-1;var n=new THREE.Vector3(0,1,0);var l=new THREE.Vector3(0,1,0);var i=new THREE.Vector3(0,1,0);var J=q[0][p].clone();var H=q[0][p+1].clone();var F=new THREE.Vector2(H.x,0);this.faces.push(new THREE.Face3(d,c,b,[n,l,i]));this.faceVertexUvs[0].push([J,H,F])}}if(I===false&&L>0){this.vertices.push(new THREE.Vector3(0,-C,0));for(p=0;p<e;p++){var d=g[o][p+1];var c=g[o][p];var b=this.vertices.length-1;var n=new THREE.Vector3(0,-1,0);var l=new THREE.Vector3(0,-1,0);var i=new THREE.Vector3(0,-1,0);var J=q[o][p+1].clone();var H=q[o][p].clone();var F=new THREE.Vector2(H.x,1);this.faces.push(new THREE.Face3(d,c,b,[n,l,i]));this.faceVertexUvs[0].push([J,H,F])}}this.computeCentroids();this.computeFaceNormals()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry=function(a,b){if(typeof(a)==="undefined"){a=[];return}THREE.Geometry.call(this);a=a instanceof Array?a:[a];this.shapebb=a[a.length-1].getBoundingBox();this.addShapeList(a,b);this.computeCentroids();this.computeFaceNormals()};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.addShapeList=function(b,d){var a=b.length;for(var e=0;e<a;e++){var c=b[e];this.addShape(c,d)}};THREE.ExtrudeGeometry.prototype.addShape=function(H,Q){var g=Q.amount!==undefined?Q.amount:100;var f=Q.bevelThickness!==undefined?Q.bevelThickness:6;var R=Q.bevelSize!==undefined?Q.bevelSize:f-2;var E=Q.bevelSegments!==undefined?Q.bevelSegments:3;var a=Q.bevelEnabled!==undefined?Q.bevelEnabled:true;var P=Q.curveSegments!==undefined?Q.curveSegments:12;var aa=Q.steps!==undefined?Q.steps:1;var r=Q.extrudePath;var V,u=false;var an=Q.material;var o=Q.extrudeMaterial;var G=Q.UVGenerator!==undefined?Q.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator;var Z=this.shapebb;var B,ad,ah,aw;if(r){V=r.getSpacedPoints(aa);u=true;a=false;B=Q.frames!==undefined?Q.frames:new THREE.TubeGeometry.FrenetFrames(r,aa,false);ad=new THREE.Vector3();ah=new THREE.Vector3();aw=new THREE.Vector3()}if(!a){E=0;f=0;R=0}var az,au,av;var ab=this;var N=[];var X=this.vertices.length;var F=H.extractPoints(P);var d=F.shape;var L=F.holes;var aj=!THREE.Shape.Utils.isClockWise(d);if(aj){d=d.reverse();for(au=0,av=L.length;au<av;au++){az=L[au];if(THREE.Shape.Utils.isClockWise(az)){L[au]=az.reverse()}}aj=false}var q=THREE.Shape.Utils.triangulateShape(d,L);var am=d;for(au=0,av=L.length;au<av;au++){az=L[au];d=d.concat(az)}function S(i,h,b){if(!h){console.log("die")}return h.clone().multiplyScalar(b).add(i)}var ay,ak,ag,ac,A,al=d.length,p,n=q.length,Y,c=am.length;var W=180/Math.PI;function J(i,h,b){return C(i,h,b)}function D(j,i,h){var t=Math.atan2(i.y-j.y,i.x-j.x);var s=Math.atan2(h.y-j.y,h.x-j.x);if(t>s){s+=Math.PI*2}var k=(t+s)/2;var aA=-Math.cos(k);var v=-Math.sin(k);var b=new THREE.Vector2(aA,v);return b}function C(aB,aA,t){var aG=THREE.ExtrudeGeometry.__v1,aD=THREE.ExtrudeGeometry.__v2,aF=THREE.ExtrudeGeometry.__v3,aC=THREE.ExtrudeGeometry.__v4,j=THREE.ExtrudeGeometry.__v5,i=THREE.ExtrudeGeometry.__v6,aI,aH,k,aE,aJ,h;aG.set(aB.x-aA.x,aB.y-aA.y);aD.set(aB.x-t.x,aB.y-t.y);aI=aG.normalize();aH=aD.normalize();aF.set(-aI.y,aI.x);aC.set(aH.y,-aH.x);j.copy(aB).add(aF);i.copy(aB).add(aC);if(j.equals(i)){return aC.clone()}j.copy(aA).add(aF);i.copy(t).add(aC);k=aI.dot(aC);aE=i.sub(j).dot(aC);if(k===0){console.log("Either infinite or no solutions!");if(aE===0){console.log("Its finite solutions.")}else{console.log("Too bad, no solutions.")}}aJ=aE/k;if(aJ<0){return D(aB,aA,t)}h=aI.multiplyScalar(aJ).add(j);return h.sub(aB).clone()}var aq=[];for(var at=0,U=am.length,ap=U-1,ao=at+1;at<U;at++,ap++,ao++){if(ap===U){ap=0}if(ao===U){ao=0}var M=am[at];var K=am[ap];var I=am[ao];aq[at]=J(am[at],am[ap],am[ao])}var T=[],af,e=aq.concat();for(au=0,av=L.length;au<av;au++){az=L[au];af=[];for(at=0,U=az.length,ap=U-1,ao=at+1;at<U;at++,ap++,ao++){if(ap===U){ap=0}if(ao===U){ao=0}af[at]=J(az[at],az[ap],az[ao])}T.push(af);e=e.concat(af)}for(ay=0;ay<E;ay++){ag=ay/E;ac=f*(1-ag);ak=R*(Math.sin(ag*Math.PI/2));for(at=0,U=am.length;at<U;at++){A=S(am[at],aq[at],ak);ae(A.x,A.y,-ac)}for(au=0,av=L.length;au<av;au++){az=L[au];af=T[au];for(at=0,U=az.length;at<U;at++){A=S(az[at],af[at],ak);ae(A.x,A.y,-ac)}}}ak=R;for(at=0;at<al;at++){A=a?S(d[at],e[at],ak):d[at];if(!u){ae(A.x,A.y,0)}else{ah.copy(B.normals[0]).multiplyScalar(A.x);ad.copy(B.binormals[0]).multiplyScalar(A.y);aw.copy(V[0]).add(ah).add(ad);ae(aw.x,aw.y,aw.z)}}var ai;for(ai=1;ai<=aa;ai++){for(at=0;at<al;at++){A=a?S(d[at],e[at],ak):d[at];if(!u){ae(A.x,A.y,g/aa*ai)}else{ah.copy(B.normals[ai]).multiplyScalar(A.x);ad.copy(B.binormals[ai]).multiplyScalar(A.y);aw.copy(V[ai]).add(ah).add(ad);ae(aw.x,aw.y,aw.z)}}}for(ay=E-1;ay>=0;ay--){ag=ay/E;ac=f*(1-ag);ak=R*Math.sin(ag*Math.PI/2);for(at=0,U=am.length;at<U;at++){A=S(am[at],aq[at],ak);ae(A.x,A.y,g+ac)}for(au=0,av=L.length;au<av;au++){az=L[au];af=T[au];for(at=0,U=az.length;at<U;at++){A=S(az[at],af[at],ak);if(!u){ae(A.x,A.y,g+ac)}else{ae(A.x,A.y+V[aa-1].y,V[aa-1].x+ac)}}}}O();ax();function O(){if(a){var b=0;var h=al*b;for(at=0;at<n;at++){p=q[at];m(p[2]+h,p[1]+h,p[0]+h,true)}b=aa+E*2;h=al*b;for(at=0;at<n;at++){p=q[at];m(p[0]+h,p[1]+h,p[2]+h,false)}}else{for(at=0;at<n;at++){p=q[at];m(p[2],p[1],p[0],true)}for(at=0;at<n;at++){p=q[at];m(p[0]+al*aa,p[1]+al*aa,p[2]+al*aa,false)}}}function ax(){var b=0;ar(am,b);b+=am.length;for(au=0,av=L.length;au<av;au++){az=L[au];ar(az,b);b+=az.length}}function ar(aC,h){var aA,v;at=aC.length;while(--at>=0){aA=at;v=at-1;if(v<0){v=aC.length-1}var aH=0,i=aa+E*2;for(aH=0;aH<i;aH++){var aB=al*aH;var t=al*(aH+1);var aG=h+aA+aB,aF=h+v+aB,aE=h+v+t,aD=h+aA+t;l(aG,aF,aE,aD,aC,aH,i,aA,v)}}}function ae(b,i,h){ab.vertices.push(new THREE.Vector3(b,i,h))}function m(i,h,s,k){i+=X;h+=X;s+=X;ab.faces.push(new THREE.Face3(i,h,s,null,null,an));var j=k?G.generateBottomUV(ab,H,Q,i,h,s):G.generateTopUV(ab,H,Q,i,h,s);ab.faceVertexUvs[0].push(j)}function l(aB,aA,t,s,h,j,aC,v,k){aB+=X;aA+=X;t+=X;s+=X;ab.faces.push(new THREE.Face3(aB,aA,s,null,null,o));ab.faces.push(new THREE.Face3(aA,t,s,null,null,o));var i=G.generateSideWallUV(ab,H,h,Q,aB,aA,t,s,j,aC,v,k);ab.faceVertexUvs[0].push([i[0],i[1],i[3]]);ab.faceVertexUvs[0].push([i[1],i[2],i[3]])}};THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(g,h,d,k,j,i){var a=g.vertices[k].x,l=g.vertices[k].y,f=g.vertices[j].x,e=g.vertices[j].y,c=g.vertices[i].x,b=g.vertices[i].y;return[new THREE.Vector2(a,l),new THREE.Vector2(f,e),new THREE.Vector2(c,b)]},generateBottomUV:function(f,c,a,e,d,b){return this.generateTopUV(f,c,a,e,d,b)},generateSideWallUV:function(f,m,b,t,B,A,v,u,a,n,s,r){var k=f.vertices[B].x,i=f.vertices[B].y,g=f.vertices[B].z,q=f.vertices[A].x,p=f.vertices[A].y,o=f.vertices[A].z,e=f.vertices[v].x,d=f.vertices[v].y,c=f.vertices[v].z,l=f.vertices[u].x,j=f.vertices[u].y,h=f.vertices[u].z;if(Math.abs(i-p)<0.01){return[new THREE.Vector2(k,1-g),new THREE.Vector2(q,1-o),new THREE.Vector2(e,1-c),new THREE.Vector2(l,1-h)]}else{return[new THREE.Vector2(i,1-g),new THREE.Vector2(p,1-o),new THREE.Vector2(d,1-c),new THREE.Vector2(j,1-h)]}}};THREE.ExtrudeGeometry.__v1=new THREE.Vector2();THREE.ExtrudeGeometry.__v2=new THREE.Vector2();THREE.ExtrudeGeometry.__v3=new THREE.Vector2();THREE.ExtrudeGeometry.__v4=new THREE.Vector2();THREE.ExtrudeGeometry.__v5=new THREE.Vector2();THREE.ExtrudeGeometry.__v6=new THREE.Vector2();THREE.ShapeGeometry=function(a,b){THREE.Geometry.call(this);if(a instanceof Array===false){a=[a]}this.shapebb=a[a.length-1].getBoundingBox();this.addShapeList(a,b);this.computeCentroids();this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ShapeGeometry.prototype.addShapeList=function(b,c){for(var d=0,a=b.length;d<a;d++){this.addShape(b[d],c)}return this};THREE.ShapeGeometry.prototype.addShape=function(e,h){if(h===undefined){h={}}var d=h.curveSegments!==undefined?h.curveSegments:12;var q=h.material;var E=h.UVGenerator===undefined?THREE.ExtrudeGeometry.WorldUVGenerator:h.UVGenerator;var r=this.shapebb;var C,B,t,v;var p=this.vertices.length;var F=e.extractPoints(d);var j=F.shape;var m=F.holes;var o=!THREE.Shape.Utils.isClockWise(j);if(o){j=j.reverse();for(C=0,B=m.length;C<B;C++){t=m[C];if(THREE.Shape.Utils.isClockWise(t)){m[C]=t.reverse()}}o=false}var f=THREE.Shape.Utils.triangulateShape(j,m);var A=j;for(C=0,B=m.length;C<B;C++){t=m[C];j=j.concat(t)}var D,k=j.length;var n,J=f.length;var g,u=A.length;for(C=0;C<k;C++){D=j[C];this.vertices.push(new THREE.Vector3(D.x,D.y,0))}for(C=0;C<J;C++){n=f[C];var I=n[0]+p;var H=n[1]+p;var G=n[2]+p;this.faces.push(new THREE.Face3(I,H,G,null,null,q));this.faceVertexUvs[0].push(E.generateBottomUV(this,e,h,I,H,G))}};THREE.LatheGeometry=function(t,q,n,p){THREE.Geometry.call(this);q=q||12;n=n||0;p=p||2*Math.PI;var E=1/(t.length-1);var D=1/q;for(var u=0,l=q;u<=l;u++){var g=n+u*D*p;var G=Math.cos(g),m=Math.sin(g);for(var r=0,A=t.length;r<A;r++){var o=t[r];var C=new THREE.Vector3();C.x=G*o.x-m*o.y;C.y=m*o.x+G*o.y;C.z=o.z;this.vertices.push(C)}}var e=t.length;for(var u=0,l=q;u<l;u++){for(var r=0,A=t.length-1;r<A;r++){var k=r+e*u;var I=k;var H=k+e;var G=k+1+e;var F=k+1;var B=u*D;var h=r*E;var v=B+D;var f=h+E;this.faces.push(new THREE.Face3(I,H,F));this.faceVertexUvs[0].push([new THREE.Vector2(B,h),new THREE.Vector2(v,h),new THREE.Vector2(B,f)]);this.faces.push(new THREE.Face3(H,G,F));this.faceVertexUvs[0].push([new THREE.Vector2(v,h),new THREE.Vector2(v,f),new THREE.Vector2(B,f)])}}this.mergeVertices();this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.PlaneGeometry=function(p,o,e,n){THREE.Geometry.call(this);this.width=p;this.height=o;this.widthSegments=e||1;this.heightSegments=n||1;var h,f;var i=p/2;var g=o/2;var t=this.widthSegments;var q=this.heightSegments;var v=t+1;var m=q+1;var H=this.width/t;var C=this.height/q;var G=new THREE.Vector3(0,0,1);for(f=0;f<m;f++){for(h=0;h<v;h++){var l=h*H-i;var k=f*C-g;this.vertices.push(new THREE.Vector3(l,-k,0))}}for(f=0;f<q;f++){for(h=0;h<t;h++){var F=h+v*f;var E=h+v*(f+1);var D=(h+1)+v*(f+1);var B=(h+1)+v*f;var A=new THREE.Vector2(h/t,1-f/q);var u=new THREE.Vector2(h/t,1-(f+1)/q);var s=new THREE.Vector2((h+1)/t,1-(f+1)/q);var r=new THREE.Vector2((h+1)/t,1-f/q);var j=new THREE.Face3(F,E,B);j.normal.copy(G);j.vertexNormals.push(G.clone(),G.clone(),G.clone());this.faces.push(j);this.faceVertexUvs[0].push([A,u,r]);j=new THREE.Face3(E,D,B);j.normal.copy(G);j.vertexNormals.push(G.clone(),G.clone(),G.clone());this.faces.push(j);this.faceVertexUvs[0].push([u.clone(),s,r.clone()])}}this.computeCentroids()};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.RingGeometry=function(k,r,g,s,h,p){THREE.Geometry.call(this);k=k||0;r=r||50;h=h!==undefined?h:0;p=p!==undefined?p:Math.PI*2;g=g!==undefined?Math.max(3,g):8;s=s!==undefined?Math.max(3,s):8;var t,m,l=[],f=k,j=((r-k)/s);for(t=0;t<=s;t++){for(m=0;m<=g;m++){var u=new THREE.Vector3();var c=h+m/g*p;u.x=f*Math.cos(c);u.y=f*Math.sin(c);this.vertices.push(u);l.push(new THREE.Vector2((u.x/r+1)/2,(u.y/r+1)/2))}f+=j}var q=new THREE.Vector3(0,0,1);for(t=0;t<s;t++){var a=t*g;for(m=0;m<=g;m++){var c=m+a;var e=c+t;var d=c+g+t;var b=c+g+1+t;this.faces.push(new THREE.Face3(e,d,b,[q.clone(),q.clone(),q.clone()]));this.faceVertexUvs[0].push([l[e].clone(),l[d].clone(),l[b].clone()]);e=c+t;d=c+g+1+t;b=c+1+t;this.faces.push(new THREE.Face3(e,d,b,[q.clone(),q.clone(),q.clone()]));this.faceVertexUvs[0].push([l[e].clone(),l[d].clone(),l[b].clone()])}}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3(),f)};THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.SphereGeometry=function(f,e,r,t,B,g,A){THREE.Geometry.call(this);this.radius=f=f||50;this.widthSegments=e=Math.max(3,Math.floor(e)||8);this.heightSegments=r=Math.max(2,Math.floor(r)||6);this.phiStart=t=t!==undefined?t:0;this.phiLength=B=B!==undefined?B:Math.PI*2;this.thetaStart=g=g!==undefined?g:0;this.thetaLength=A=A!==undefined?A:Math.PI;var n,m,h=[],o=[];for(m=0;m<=r;m++){var s=[];var H=[];for(n=0;n<=e;n++){var q=n/e;var p=m/r;var E=new THREE.Vector3();E.x=-f*Math.cos(t+q*B)*Math.sin(g+p*A);E.y=f*Math.cos(g+p*A);E.z=f*Math.sin(t+q*B)*Math.sin(g+p*A);this.vertices.push(E);s.push(this.vertices.length-1);H.push(new THREE.Vector2(q,1-p))}h.push(s);o.push(H)}for(m=0;m<this.heightSegments;m++){for(n=0;n<this.widthSegments;n++){var d=h[m][n+1];var c=h[m][n];var b=h[m+1][n];var a=h[m+1][n+1];var l=this.vertices[d].clone().normalize();var k=this.vertices[c].clone().normalize();var j=this.vertices[b].clone().normalize();var i=this.vertices[a].clone().normalize();var G=o[m][n+1].clone();var F=o[m][n].clone();var D=o[m+1][n].clone();var C=o[m+1][n+1].clone();if(Math.abs(this.vertices[d].y)===this.radius){G.x=(G.x+F.x)/2;this.faces.push(new THREE.Face3(d,b,a,[l,j,i]));this.faceVertexUvs[0].push([G,D,C])}else{if(Math.abs(this.vertices[b].y)===this.radius){D.x=(D.x+C.x)/2;this.faces.push(new THREE.Face3(d,c,b,[l,k,j]));this.faceVertexUvs[0].push([G,F,D])}else{this.faces.push(new THREE.Face3(d,c,a,[l,k,i]));this.faceVertexUvs[0].push([G,F,C]);this.faces.push(new THREE.Face3(c,b,a,[k.clone(),j,i.clone()]));this.faceVertexUvs[0].push([F.clone(),D,C.clone()])}}}}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3(),f)};THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TextGeometry=function(b,a){a=a||{};var c=THREE.FontUtils.generateShapes(b,a);a.amount=a.height!==undefined?a.height:50;if(a.bevelThickness===undefined){a.bevelThickness=10}if(a.bevelSize===undefined){a.bevelSize=8}if(a.bevelEnabled===undefined){a.bevelEnabled=false}THREE.ExtrudeGeometry.call(this,c,a)};THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype);THREE.TorusGeometry=function(h,g,f,m,k){THREE.Geometry.call(this);var e=this;this.radius=h||100;this.tube=g||40;this.radialSegments=f||8;this.tubularSegments=m||6;this.arc=k||Math.PI*2;var D=new THREE.Vector3(),n=[],q=[];for(var r=0;r<=this.radialSegments;r++){for(var s=0;s<=this.tubularSegments;s++){var p=s/this.tubularSegments*this.arc;var o=r/this.radialSegments*Math.PI*2;D.x=this.radius*Math.cos(p);D.y=this.radius*Math.sin(p);var t=new THREE.Vector3();t.x=(this.radius+this.tube*Math.cos(o))*Math.cos(p);t.y=(this.radius+this.tube*Math.cos(o))*Math.sin(p);t.z=this.tube*Math.sin(o);this.vertices.push(t);n.push(new THREE.Vector2(s/this.tubularSegments,r/this.radialSegments));q.push(t.clone().sub(D).normalize())}}for(var r=1;r<=this.radialSegments;r++){for(var s=1;s<=this.tubularSegments;s++){var E=(this.tubularSegments+1)*r+s-1;var C=(this.tubularSegments+1)*(r-1)+s-1;var B=(this.tubularSegments+1)*(r-1)+s;var A=(this.tubularSegments+1)*r+s;var l=new THREE.Face3(E,C,A,[q[E],q[C],q[A]]);l.normal.add(q[E]);l.normal.add(q[C]);l.normal.add(q[A]);l.normal.normalize();this.faces.push(l);this.faceVertexUvs[0].push([n[E].clone(),n[C].clone(),n[A].clone()]);l=new THREE.Face3(C,B,A,[q[C],q[B],q[A]]);l.normal.add(q[C]);l.normal.add(q[B]);l.normal.add(q[A]);l.normal.normalize();this.faces.push(l);this.faceVertexUvs[0].push([n[C].clone(),n[B].clone(),n[A].clone()])}}this.computeCentroids()};THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TorusKnotGeometry=function(s,r,m,B,F,E,e){THREE.Geometry.call(this);var g=this;this.radius=s||100;this.tube=r||40;this.radialSegments=m||64;this.tubularSegments=B||8;this.p=F||2;this.q=E||3;this.heightScale=e||1;this.grid=new Array(this.radialSegments);var o=new THREE.Vector3();var G=new THREE.Vector3();var T=new THREE.Vector3();for(var K=0;K<this.radialSegments;++K){this.grid[K]=new Array(this.tubularSegments);var D=K/this.radialSegments*2*this.p*Math.PI;var h=L(D,this.q,this.p,this.radius,this.heightScale);var f=L(D+0.01,this.q,this.p,this.radius,this.heightScale);o.subVectors(f,h);G.addVectors(f,h);T.crossVectors(o,G);G.crossVectors(T,o);T.normalize();G.normalize();for(var I=0;I<this.tubularSegments;++I){var C=I/this.tubularSegments*2*Math.PI;var l=-this.tube*Math.cos(C);var k=this.tube*Math.sin(C);var t=new THREE.Vector3();t.x=h.x+l*G.x+k*T.x;t.y=h.y+l*G.y+k*T.y;t.z=h.z+l*G.z+k*T.z;this.grid[K][I]=g.vertices.push(t)-1}}for(var K=0;K<this.radialSegments;++K){for(var I=0;I<this.tubularSegments;++I){var A=(K+1)%this.radialSegments;var H=(I+1)%this.tubularSegments;var S=this.grid[K][I];var R=this.grid[A][I];var Q=this.grid[A][H];var P=this.grid[K][H];var O=new THREE.Vector2(K/this.radialSegments,I/this.tubularSegments);var N=new THREE.Vector2((K+1)/this.radialSegments,I/this.tubularSegments);var M=new THREE.Vector2((K+1)/this.radialSegments,(I+1)/this.tubularSegments);var J=new THREE.Vector2(K/this.radialSegments,(I+1)/this.tubularSegments);this.faces.push(new THREE.Face3(S,R,P));this.faceVertexUvs[0].push([O,N,J]);this.faces.push(new THREE.Face3(R,Q,P));this.faceVertexUvs[0].push([N.clone(),M,J.clone()])}}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals();function L(U,p,v,q,a){var j=Math.cos(U);var V=Math.sin(U);var i=p/v*U;var n=Math.cos(i);var d=q*(2+n)*0.5*j;var c=q*(2+n)*V*0.5;var b=a*q*Math.sin(i)*0.5;return new THREE.Vector3(d,c,b)}};THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TubeGeometry=function(L,h,K,G,J){THREE.Geometry.call(this);this.path=L;this.segments=h||64;this.radius=K||1;this.radialSegments=G||8;this.closed=J||false;this.grid=[];var t=this,D,I,A,e=this.segments+1,E,C,B,O,N,M,H,F,o,n,s,f=new THREE.Vector3(),Q,P,r,g,Y,X,W,V,U,T,S,R;var p=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed),q=p.tangents,m=p.normals,l=p.binormals;this.tangents=q;this.normals=m;this.binormals=l;function k(a,c,b){return t.vertices.push(new THREE.Vector3(a,c,b))-1}for(Q=0;Q<e;Q++){this.grid[Q]=[];H=Q/(e-1);s=L.getPointAt(H);D=q[Q];I=m[Q];A=l[Q];for(P=0;P<this.radialSegments;P++){F=P/this.radialSegments*2*Math.PI;o=-this.radius*Math.cos(F);n=this.radius*Math.sin(F);f.copy(s);f.x+=o*I.x+n*A.x;f.y+=o*I.y+n*A.y;f.z+=o*I.z+n*A.z;this.grid[Q][P]=k(f.x,f.y,f.z)}}for(Q=0;Q<this.segments;Q++){for(P=0;P<this.radialSegments;P++){r=(this.closed)?(Q+1)%this.segments:Q+1;g=(P+1)%this.radialSegments;Y=this.grid[Q][P];X=this.grid[r][P];W=this.grid[r][g];V=this.grid[Q][g];U=new THREE.Vector2(Q/this.segments,P/this.radialSegments);T=new THREE.Vector2((Q+1)/this.segments,P/this.radialSegments);S=new THREE.Vector2((Q+1)/this.segments,(P+1)/this.radialSegments);R=new THREE.Vector2(Q/this.segments,(P+1)/this.radialSegments);this.faces.push(new THREE.Face3(Y,X,V));this.faceVertexUvs[0].push([U,T,R]);this.faces.push(new THREE.Face3(X,W,V));this.faceVertexUvs[0].push([T.clone(),S,R.clone()])}}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TubeGeometry.FrenetFrames=function(o,r,c){var f=new THREE.Vector3(),D=new THREE.Vector3(),p=new THREE.Vector3(),q=[],n=[],d=[],m=new THREE.Vector3(),t=new THREE.Matrix4(),b=r+1,e,E=0.0001,a,C,B,A,s,j,g;this.tangents=q;this.normals=n;this.binormals=d;for(s=0;s<b;s++){j=s/(b-1);q[s]=o.getTangentAt(j);q[s].normalize()}h();function l(i){n[0]=new THREE.Vector3();d[0]=new THREE.Vector3();if(i===undefined){i=new THREE.Vector3(0,0,1)}n[0].crossVectors(i,q[0]).normalize();d[0].crossVectors(q[0],n[0]).normalize()}function k(){var i=o.getTangentAt(E);n[0]=new THREE.Vector3().subVectors(i,q[0]).normalize();d[0]=new THREE.Vector3().crossVectors(q[0],n[0]);n[0].crossVectors(d[0],q[0]).normalize();d[0].crossVectors(q[0],n[0]).normalize()}function h(){n[0]=new THREE.Vector3();d[0]=new THREE.Vector3();a=Number.MAX_VALUE;C=Math.abs(q[0].x);B=Math.abs(q[0].y);A=Math.abs(q[0].z);if(C<=a){a=C;D.set(1,0,0)}if(B<=a){a=B;D.set(0,1,0)}if(A<=a){D.set(0,0,1)}m.crossVectors(q[0],D).normalize();n[0].crossVectors(q[0],m);d[0].crossVectors(q[0],n[0])}for(s=1;s<b;s++){n[s]=n[s-1].clone();d[s]=d[s-1].clone();m.crossVectors(q[s-1],q[s]);if(m.length()>E){m.normalize();e=Math.acos(THREE.Math.clamp(q[s-1].dot(q[s]),-1,1));n[s].applyMatrix4(t.makeRotationAxis(m,e))}d[s].crossVectors(q[s],n[s])}if(c){e=Math.acos(THREE.Math.clamp(n[0].dot(n[b-1]),-1,1));e/=(b-1);if(q[0].dot(m.crossVectors(n[0],n[b-1]))>0){e=-e}for(s=1;s<b;s++){n[s].applyMatrix4(t.makeRotationAxis(q[s],e*s));d[s].crossVectors(q[s],n[s])}}};THREE.PolyhedronGeometry=function(m,c,k,G){THREE.Geometry.call(this);k=k||1;G=G||0;var n=this;for(var A=0,u=m.length;A<u;A++){e(new THREE.Vector3(m[A][0],m[A][1],m[A][2]))}var s=[],r=this.vertices;var E=[];for(var A=0,u=c.length;A<u;A++){var h=r[c[A][0]];var g=r[c[A][1]];var b=r[c[A][2]];E[A]=new THREE.Face3(h.index,g.index,b.index,[h.clone(),g.clone(),b.clone()])}for(var A=0,u=E.length;A<u;A++){o(E[A],G)}for(var A=0,u=this.faceVertexUvs[0].length;A<u;A++){var q=this.faceVertexUvs[0][A];var F=q[0].x;var D=q[1].x;var C=q[2].x;var v=Math.max(F,Math.max(D,C));var t=Math.min(F,Math.min(D,C));if(v>0.9&&t<0.1){if(F<0.2){q[0].x+=1}if(D<0.2){q[1].x+=1}if(C<0.2){q[2].x+=1}}}for(var A=0,u=this.vertices.length;A<u;A++){this.vertices[A].multiplyScalar(k)}this.mergeVertices();this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3(),k);function e(f){var p=f.normalize().clone();p.index=n.vertices.push(p)-1;var l=B(f)/2/Math.PI+0.5;var i=d(f)/Math.PI+0.5;p.uv=new THREE.Vector2(l,1-i);return p}function j(H,p,l){var i=new THREE.Face3(H.index,p.index,l.index,[H.clone(),p.clone(),l.clone()]);i.centroid.add(H).add(p).add(l).divideScalar(3);n.faces.push(i);var f=B(i.centroid);n.faceVertexUvs[0].push([a(H.uv,H,f),a(p.uv,p,f),a(l.uv,l,f)])}function o(K,I){var M=Math.pow(2,I);var Q=Math.pow(4,I);var O=e(n.vertices[K.a]);var N=e(n.vertices[K.b]);var L=e(n.vertices[K.c]);var P=[];for(var H=0;H<=M;H++){P[H]=[];var J=e(O.clone().lerp(L,H/M));var f=e(N.clone().lerp(L,H/M));var R=M-H;for(var p=0;p<=R;p++){if(p==0&&H==M){P[H][p]=J}else{P[H][p]=e(J.clone().lerp(f,p/R))}}}for(var H=0;H<M;H++){for(var p=0;p<2*(M-H)-1;p++){var l=Math.floor(p/2);if(p%2==0){j(P[H][l+1],P[H+1][l],P[H][l])}else{j(P[H][l+1],P[H+1][l+1],P[H+1][l])}}}}function B(f){return Math.atan2(f.z,-f.x)}function d(f){return Math.atan2(-f.y,Math.sqrt((f.x*f.x)+(f.z*f.z)))}function a(i,f,l){if((l<0)&&(i.x===1)){i=new THREE.Vector2(i.x-1,i.y)}if((f.x===0)&&(f.z===0)){i=new THREE.Vector2(l/2/Math.PI+0.5,i.y)}return i.clone()}};THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.IcosahedronGeometry=function(b,e){this.radius=b;this.detail=e;var d=(1+Math.sqrt(5))/2;var c=[[-1,d,0],[1,d,0],[-1,-d,0],[1,-d,0],[0,-1,d],[0,1,d],[0,-1,-d],[0,1,-d],[d,0,-1],[d,0,1],[-d,0,-1],[-d,0,1]];var a=[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]];THREE.PolyhedronGeometry.call(this,c,a,b,e)};THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.OctahedronGeometry=function(b,d){var c=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]];var a=[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]];THREE.PolyhedronGeometry.call(this,c,a,b,d)};THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TetrahedronGeometry=function(b,d){var c=[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]];var a=[[2,1,0],[0,3,2],[1,3,0],[2,3,1]];THREE.PolyhedronGeometry.call(this,c,a,b,d)};THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ParametricGeometry=function(g,f,E){THREE.Geometry.call(this);var I=this.vertices;var e=this.faces;var k=this.faceVertexUvs[0];var s,h,q,o;var m,l;var n=E+1;var H=f+1;for(s=0;s<=E;s++){l=s/E;for(q=0;q<=f;q++){m=q/f;o=g(m,l);I.push(o)}}var G,F,D,C;var B,A,t,r;for(s=0;s<E;s++){for(q=0;q<f;q++){G=s*H+q;F=s*H+q+1;D=(s+1)*H+q+1;C=(s+1)*H+q;B=new THREE.Vector2(q/f,s/E);A=new THREE.Vector2((q+1)/f,s/E);t=new THREE.Vector2((q+1)/f,(s+1)/E);r=new THREE.Vector2(q/f,(s+1)/E);e.push(new THREE.Face3(G,F,C));k.push([B,A,r]);e.push(new THREE.Face3(F,D,C));k.push([A.clone(),t,r.clone()])}}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.AxisHelper=function(a){a=a||1;var c=new THREE.Geometry();c.vertices.push(new THREE.Vector3(),new THREE.Vector3(a,0,0),new THREE.Vector3(),new THREE.Vector3(0,a,0),new THREE.Vector3(),new THREE.Vector3(0,0,a));c.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775));var b=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,c,b,THREE.LinePieces)};THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype);THREE.ArrowHelper=function(e,d,h,g,c,a){THREE.Object3D.call(this);if(g===undefined){g=16776960}if(h===undefined){h=1}if(c===undefined){c=0.2*h}if(a===undefined){a=0.2*c}this.position=d;var b=new THREE.Geometry();b.vertices.push(new THREE.Vector3(0,0,0));b.vertices.push(new THREE.Vector3(0,1,0));this.line=new THREE.Line(b,new THREE.LineBasicMaterial({color:g}));this.line.matrixAutoUpdate=false;this.add(this.line);var f=new THREE.CylinderGeometry(0,0.5,1,5,1);f.applyMatrix(new THREE.Matrix4().makeTranslation(0,-0.5,0));this.cone=new THREE.Mesh(f,new THREE.MeshBasicMaterial({color:g}));this.cone.matrixAutoUpdate=false;this.add(this.cone);this.setDirection(e);this.setLength(h,c,a)};THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.setDirection=function(){var a=new THREE.Vector3();var b;return function(c){if(c.y>0.99999){this.quaternion.set(0,0,0,1)}else{if(c.y<-0.99999){this.quaternion.set(1,0,0,0)}else{a.set(c.z,0,-c.x).normalize();b=Math.acos(c.y);this.quaternion.setFromAxisAngle(a,b)}}}}();THREE.ArrowHelper.prototype.setLength=function(c,b,a){if(b===undefined){b=0.2*c}if(a===undefined){a=0.2*b}this.line.scale.set(1,c,1);this.line.updateMatrix();this.cone.scale.set(a,b,a);this.cone.position.y=c;this.cone.updateMatrix()};THREE.ArrowHelper.prototype.setColor=function(a){this.line.material.color.setHex(a);this.cone.material.color.setHex(a)};THREE.BoxHelper=function(b){var a=[new THREE.Vector3(1,1,1),new THREE.Vector3(-1,1,1),new THREE.Vector3(-1,-1,1),new THREE.Vector3(1,-1,1),new THREE.Vector3(1,1,-1),new THREE.Vector3(-1,1,-1),new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,-1,-1)];this.vertices=a;var c=new THREE.Geometry();c.vertices.push(a[0],a[1],a[1],a[2],a[2],a[3],a[3],a[0],a[4],a[5],a[5],a[6],a[6],a[7],a[7],a[4],a[0],a[4],a[1],a[5],a[2],a[6],a[3],a[7]);THREE.Line.call(this,c,new THREE.LineBasicMaterial({color:16776960}),THREE.LinePieces);if(b!==undefined){this.update(b)}};THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype);THREE.BoxHelper.prototype.update=function(c){var e=c.geometry;if(e.boundingBox===null){e.computeBoundingBox()}var d=e.boundingBox.min;var a=e.boundingBox.max;var b=this.vertices;b[0].set(a.x,a.y,a.z);b[1].set(d.x,a.y,a.z);b[2].set(d.x,d.y,a.z);b[3].set(a.x,d.y,a.z);b[4].set(a.x,a.y,d.z);b[5].set(d.x,a.y,d.z);b[6].set(d.x,d.y,d.z);b[7].set(a.x,d.y,d.z);this.geometry.computeBoundingSphere();this.geometry.verticesNeedUpdate=true;this.matrixAutoUpdate=false;this.matrixWorld=c.matrixWorld};THREE.BoundingBoxHelper=function(b,c){var a=c||8947848;this.object=b;this.box=new THREE.Box3();THREE.Mesh.call(this,new THREE.CubeGeometry(1,1,1),new THREE.MeshBasicMaterial({color:a,wireframe:true}))};THREE.BoundingBoxHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.BoundingBoxHelper.prototype.update=function(){this.box.setFromObject(this.object);this.box.size(this.scale);this.box.center(this.position)};THREE.CameraHelper=function(e){var h=new THREE.Geometry();var f=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors});var g={};var d=16755200;var k=16711680;var b=43775;var i=16777215;var c=3355443;j("n1","n2",d);j("n2","n4",d);j("n4","n3",d);j("n3","n1",d);j("f1","f2",d);j("f2","f4",d);j("f4","f3",d);j("f3","f1",d);j("n1","f1",d);j("n2","f2",d);j("n3","f3",d);j("n4","f4",d);j("p","n1",k);j("p","n2",k);j("p","n3",k);j("p","n4",k);j("u1","u2",b);j("u2","u3",b);j("u3","u1",b);j("c","t",i);j("p","c",c);j("cn1","cn2",c);j("cn3","cn4",c);j("cf1","cf2",c);j("cf3","cf4",c);function j(m,l,n){a(m,n);a(l,n)}function a(m,l){h.vertices.push(new THREE.Vector3());h.colors.push(new THREE.Color(l));if(g[m]===undefined){g[m]=[]}g[m].push(h.vertices.length-1)}THREE.Line.call(this,h,f,THREE.LinePieces);this.camera=e;this.matrixWorld=e.matrixWorld;this.matrixAutoUpdate=false;this.pointMap=g;this.update()};THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype);THREE.CameraHelper.prototype.update=function(){var a=new THREE.Vector3();var b=new THREE.Camera();var c=new THREE.Projector();return function(){var g=this;var d=1,f=1;b.projectionMatrix.copy(this.camera.projectionMatrix);e("c",0,0,-1);e("t",0,0,1);e("n1",-d,-f,-1);e("n2",d,-f,-1);e("n3",-d,f,-1);e("n4",d,f,-1);e("f1",-d,-f,1);e("f2",d,-f,1);e("f3",-d,f,1);e("f4",d,f,1);e("u1",d*0.7,f*1.1,-1);e("u2",-d*0.7,f*1.1,-1);e("u3",0,f*2,-1);e("cf1",-d,0,1);e("cf2",d,0,1);e("cf3",0,-f,1);e("cf4",0,f,1);e("cn1",-d,0,-1);e("cn2",d,0,-1);e("cn3",0,-f,-1);e("cn4",0,f,-1);function e(j,h,o,n){a.set(h,o,n);c.unprojectVector(a,b);var m=g.pointMap[j];if(m!==undefined){for(var l=0,k=m.length;l<k;l++){g.geometry.vertices[m[l]].copy(a)}}}this.geometry.verticesNeedUpdate=true}}();THREE.DirectionalLightHelper=function(a,b){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=false;b=b||1;var d=new THREE.PlaneGeometry(b,b);var c=new THREE.MeshBasicMaterial({wireframe:true,fog:false});c.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightPlane=new THREE.Mesh(d,c);this.add(this.lightPlane);d=new THREE.Geometry();d.vertices.push(new THREE.Vector3());d.vertices.push(new THREE.Vector3());c=new THREE.LineBasicMaterial({fog:false});c.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine=new THREE.Line(d,c);this.add(this.targetLine);this.update()};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose();this.lightPlane.material.dispose();this.targetLine.geometry.dispose();this.targetLine.material.dispose()};THREE.DirectionalLightHelper.prototype.update=function(){var c=new THREE.Vector3();var b=new THREE.Vector3();var a=new THREE.Vector3();return function(){c.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);a.subVectors(b,c);this.lightPlane.lookAt(a);this.lightPlane.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.vertices[1].copy(a);this.targetLine.geometry.verticesNeedUpdate=true;this.targetLine.material.color.copy(this.lightPlane.material.color)}}();THREE.FaceNormalsHelper=function(e,k,c,j){this.object=e;this.size=k||1;var f=c||16776960;var a=j||1;var h=new THREE.Geometry();var b=this.object.geometry.faces;for(var g=0,d=b.length;g<d;g++){h.vertices.push(new THREE.Vector3());h.vertices.push(new THREE.Vector3())}THREE.Line.call(this,h,new THREE.LineBasicMaterial({color:f,linewidth:a}),THREE.LinePieces);this.matrixAutoUpdate=false;this.normalMatrix=new THREE.Matrix3();this.update()};THREE.FaceNormalsHelper.prototype=Object.create(THREE.Line.prototype);THREE.FaceNormalsHelper.prototype.update=(function(a){var b=new THREE.Vector3();return function(h){this.object.updateMatrixWorld(true);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);var g=this.geometry.vertices;var d=this.object.geometry.faces;var f=this.object.matrixWorld;for(var j=0,e=d.length;j<e;j++){var k=d[j];b.copy(k.normal).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);var c=2*j;g[c].copy(k.centroid).applyMatrix4(f);g[c+1].addVectors(g[c],b)}this.geometry.verticesNeedUpdate=true;return this}}());THREE.GridHelper=function(c,e){var f=new THREE.Geometry();var d=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});this.color1=new THREE.Color(4473924);this.color2=new THREE.Color(8947848);for(var b=-c;b<=c;b+=e){f.vertices.push(new THREE.Vector3(-c,0,b),new THREE.Vector3(c,0,b),new THREE.Vector3(b,0,-c),new THREE.Vector3(b,0,c));var a=b===0?this.color1:this.color2;f.colors.push(a,a,a,a)}THREE.Line.call(this,f,d,THREE.LinePieces)};THREE.GridHelper.prototype=Object.create(THREE.Line.prototype);THREE.GridHelper.prototype.setColors=function(b,a){this.color1.set(b);this.color2.set(a);this.geometry.colorsNeedUpdate=true};THREE.HemisphereLightHelper=function(a,h,g,e){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=false;this.colors=[new THREE.Color(),new THREE.Color()];var f=new THREE.SphereGeometry(h,4,2);f.applyMatrix(new THREE.Matrix4().makeRotationX(-Math.PI/2));for(var c=0,b=8;c<b;c++){f.faces[c].color=this.colors[c<4?0:1]}var d=new THREE.MeshBasicMaterial({vertexColors:THREE.FaceColors,wireframe:true});this.lightSphere=new THREE.Mesh(f,d);this.add(this.lightSphere);this.update()};THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.dispose=function(){this.lightSphere.geometry.dispose();this.lightSphere.material.dispose()};THREE.HemisphereLightHelper.prototype.update=function(){var a=new THREE.Vector3();return function(){this.colors[0].copy(this.light.color).multiplyScalar(this.light.intensity);this.colors[1].copy(this.light.groundColor).multiplyScalar(this.light.intensity);this.lightSphere.lookAt(a.setFromMatrixPosition(this.light.matrixWorld).negate());this.lightSphere.geometry.colorsNeedUpdate=true}}();THREE.PointLightHelper=function(a,d){this.light=a;this.light.updateMatrixWorld();var c=new THREE.SphereGeometry(d,4,2);var b=new THREE.MeshBasicMaterial({wireframe:true,fog:false});b.color.copy(this.light.color).multiplyScalar(this.light.intensity);THREE.Mesh.call(this,c,b);this.matrixWorld=this.light.matrixWorld;this.matrixAutoUpdate=false};THREE.PointLightHelper.prototype=Object.create(THREE.Mesh.prototype);THREE.PointLightHelper.prototype.dispose=function(){this.geometry.dispose();this.material.dispose()};THREE.PointLightHelper.prototype.update=function(){this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};THREE.SpotLightHelper=function(a){THREE.Object3D.call(this);this.light=a;this.light.updateMatrixWorld();this.matrixWorld=a.matrixWorld;this.matrixAutoUpdate=false;var c=new THREE.CylinderGeometry(0,1,1,8,1,true);c.applyMatrix(new THREE.Matrix4().makeTranslation(0,-0.5,0));c.applyMatrix(new THREE.Matrix4().makeRotationX(-Math.PI/2));var b=new THREE.MeshBasicMaterial({wireframe:true,fog:false});this.cone=new THREE.Mesh(c,b);this.add(this.cone);this.update()};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose();this.cone.material.dispose()};THREE.SpotLightHelper.prototype.update=function(){var a=new THREE.Vector3();var b=new THREE.Vector3();return function(){var c=this.light.distance?this.light.distance:10000;var d=c*Math.tan(this.light.angle);this.cone.scale.set(d,d,c);a.setFromMatrixPosition(this.light.matrixWorld);b.setFromMatrixPosition(this.light.target.matrixWorld);this.cone.lookAt(b.sub(a));this.cone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)}}();THREE.VertexNormalsHelper=function(e,q,c,p){this.object=e;this.size=q||1;var f=c||16711680;var a=p||1;var o=new THREE.Geometry();var m=e.geometry.vertices;var b=e.geometry.faces;for(var k=0,d=b.length;k<d;k++){var n=b[k];for(var g=0,h=n.vertexNormals.length;g<h;g++){o.vertices.push(new THREE.Vector3());o.vertices.push(new THREE.Vector3())}}THREE.Line.call(this,o,new THREE.LineBasicMaterial({color:f,linewidth:a}),THREE.LinePieces);this.matrixAutoUpdate=false;this.normalMatrix=new THREE.Matrix3();this.update()};THREE.VertexNormalsHelper.prototype=Object.create(THREE.Line.prototype);THREE.VertexNormalsHelper.prototype.update=(function(a){var b=new THREE.Vector3();return function(e){var t=["a","b","c","d"];this.object.updateMatrixWorld(true);this.normalMatrix.getNormalMatrix(this.object.matrixWorld);var o=this.geometry.vertices;var r=this.object.geometry.vertices;var c=this.object.geometry.faces;var p=this.object.matrixWorld;var s=0;for(var h=0,d=c.length;h<d;h++){var q=c[h];for(var f=0,g=q.vertexNormals.length;f<g;f++){var n=q[t[f]];var k=r[n];var m=q.vertexNormals[f];o[s].copy(k).applyMatrix4(p);b.copy(m).applyMatrix3(this.normalMatrix).normalize().multiplyScalar(this.size);b.add(o[s]);s=s+1;o[s].copy(b);s=s+1}}this.geometry.verticesNeedUpdate=true;return this}}());THREE.VertexTangentsHelper=function(e,q,c,p){this.object=e;this.size=q||1;var f=c||255;var a=p||1;var o=new THREE.Geometry();var m=e.geometry.vertices;var b=e.geometry.faces;for(var k=0,d=b.length;k<d;k++){var n=b[k];for(var g=0,h=n.vertexTangents.length;g<h;g++){o.vertices.push(new THREE.Vector3());o.vertices.push(new THREE.Vector3())}}THREE.Line.call(this,o,new THREE.LineBasicMaterial({color:f,linewidth:a}),THREE.LinePieces);this.matrixAutoUpdate=false;this.update()};THREE.VertexTangentsHelper.prototype=Object.create(THREE.Line.prototype);THREE.VertexTangentsHelper.prototype.update=(function(a){var b=new THREE.Vector3();return function(e){var t=["a","b","c","d"];this.object.updateMatrixWorld(true);var n=this.geometry.vertices;var q=this.object.geometry.vertices;var c=this.object.geometry.faces;var o=this.object.matrixWorld;var r=0;for(var h=0,d=c.length;h<d;h++){var p=c[h];for(var f=0,g=p.vertexTangents.length;f<g;f++){var m=p[t[f]];var k=q[m];var s=p.vertexTangents[f];n[r].copy(k).applyMatrix4(o);b.copy(s).transformDirection(o).multiplyScalar(this.size);b.add(n[r]);r=r+1;n[r].copy(b);r=r+1}}this.geometry.verticesNeedUpdate=true;return this}}());THREE.WireframeHelper=function(u){var g=[0,0],a={};var p=function(j,i){return j-i};var n=["a","b","c","d"];var e=new THREE.BufferGeometry();var c=0;if(u.geometry instanceof THREE.Geometry){var h=u.geometry.vertices;var b=u.geometry.faces;var d=new Uint32Array(6*b.length);for(var s=0,o=b.length;s<o;s++){var m=b[s];for(var q=0;q<3;q++){g[0]=m[n[q]];g[1]=m[n[(q+1)%3]];g.sort(p);var v=g.toString();if(a[v]===undefined){d[2*c]=g[0];d[2*c+1]=g[1];a[v]=true;c++}}}e.addAttribute("position",Float32Array,2*c,3);var r=e.attributes.position.array;for(var s=0,o=c;s<o;s++){for(var q=0;q<2;q++){var t=h[d[2*s+q]];var k=6*s+3*q;r[k+0]=t.x;r[k+1]=t.y;r[k+2]=t.z}}}else{var h=u.geometry.attributes.position.array;var b=u.geometry.attributes.index.array;var d=new Uint32Array(2*b.length);for(var s=0,o=b.length/3;s<o;s++){for(var q=0;q<3;q++){var k=s*3;g[0]=b[k+q];g[1]=b[k+(q+1)%3];g.sort(p);var v=g.toString();if(a[v]===undefined){d[2*c]=g[0];d[2*c+1]=g[1];a[v]=true;c++}}}e.addAttribute("position",Float32Array,2*c,3);var r=e.attributes.position.array;for(var s=0,o=c;s<o;s++){for(var q=0;q<2;q++){var k=6*s+3*q;var f=3*d[2*s+q];r[k+0]=h[f];r[k+1]=h[f+1];r[k+2]=h[f+2]}}}THREE.Line.call(this,e,new THREE.LineBasicMaterial({color:16777215}),THREE.LinePieces);this.matrixAutoUpdate=false;this.matrixWorld=u.matrixWorld};THREE.WireframeHelper.prototype=Object.create(THREE.Line.prototype);THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this);this.render=function(a){}};THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare=function(d,b,e,c,a){THREE.Object3D.call(this);this.lensFlares=[];this.positionScreen=new THREE.Vector3();this.customUpdateCallback=undefined;if(d!==undefined){this.add(d,b,e,c,a)}};THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare.prototype.add=function(e,c,f,d,a,b){if(c===undefined){c=-1}if(f===undefined){f=0}if(b===undefined){b=1}if(a===undefined){a=new THREE.Color(16777215)}if(d===undefined){d=THREE.NormalBlending}f=Math.min(f,Math.max(0,f));this.lensFlares.push({texture:e,size:c,distance:f,x:0,y:0,z:0,scale:1,rotation:1,opacity:b,color:a,blending:d})};THREE.LensFlare.prototype.updateLensFlares=function(){var d,c=this.lensFlares.length;var b;var a=-this.positionScreen.x*2;var e=-this.positionScreen.y*2;for(d=0;d<c;d++){b=this.lensFlares[d];b.x=this.positionScreen.x+a*b.distance;b.y=this.positionScreen.y+e*b.distance;b.wantedRotation=b.x*Math.PI*0.25;b.rotation+=(b.wantedRotation-b.rotation)*0.25}};THREE.MorphBlendMesh=function(g,d){THREE.Mesh.call(this,g,d);this.animationsMap={};this.animationsList=[];var f=this.geometry.morphTargets.length;var b="__default";var c=0;var a=f-1;var e=f/1;this.createAnimation(b,c,a,e);this.setAnimationWeight(b,1)};THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.MorphBlendMesh.prototype.createAnimation=function(b,e,a,d){var c={startFrame:e,endFrame:a,length:a-e+1,fps:d,duration:(a-e)/d,lastFrame:0,currentFrame:0,active:false,time:0,direction:1,weight:1,directionBackwards:false,mirroredLoop:false};this.animationsMap[b]=c;this.animationsList.push(c)};THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(c){var j=/([a-z]+)(\d+)/;var b,g={};var k=this.geometry;for(var d=0,l=k.morphTargets.length;d<l;d++){var m=k.morphTargets[d];var h=m.name.match(j);if(h&&h.length>1){var a=h[1];var f=h[2];if(!g[a]){g[a]={start:Infinity,end:-Infinity}}var e=g[a];if(d<e.start){e.start=d}if(d>e.end){e.end=d}if(!b){b=a}}}for(var a in g){var e=g[a];this.createAnimation(a,e.start,e.end,c)}this.firstAnimation=b};THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(a){var b=this.animationsMap[a];if(b){b.direction=1;b.directionBackwards=false}};THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(a){var b=this.animationsMap[a];if(b){b.direction=-1;b.directionBackwards=true}};THREE.MorphBlendMesh.prototype.setAnimationFPS=function(a,c){var b=this.animationsMap[a];if(b){b.fps=c;b.duration=(b.end-b.start)/b.fps}};THREE.MorphBlendMesh.prototype.setAnimationDuration=function(a,c){var b=this.animationsMap[a];if(b){b.duration=c;b.fps=(b.end-b.start)/b.duration}};THREE.MorphBlendMesh.prototype.setAnimationWeight=function(a,c){var b=this.animationsMap[a];if(b){b.weight=c}};THREE.MorphBlendMesh.prototype.setAnimationTime=function(a,c){var b=this.animationsMap[a];if(b){b.time=c}};THREE.MorphBlendMesh.prototype.getAnimationTime=function(a){var c=0;var b=this.animationsMap[a];if(b){c=b.time}return c};THREE.MorphBlendMesh.prototype.getAnimationDuration=function(a){var c=-1;var b=this.animationsMap[a];if(b){c=b.duration}return c};THREE.MorphBlendMesh.prototype.playAnimation=function(a){var b=this.animationsMap[a];if(b){b.time=0;b.active=true}else{console.warn("animation["+a+"] undefined")}};THREE.MorphBlendMesh.prototype.stopAnimation=function(a){var b=this.animationsMap[a];if(b){b.active=false}};THREE.MorphBlendMesh.prototype.update=function(h){for(var c=0,a=this.animationsList.length;c<a;c++){var g=this.animationsList[c];if(!g.active){continue}var e=g.duration/g.length;g.time+=g.direction*h;if(g.mirroredLoop){if(g.time>g.duration||g.time<0){g.direction*=-1;if(g.time>g.duration){g.time=g.duration;g.directionBackwards=true}if(g.time<0){g.time=0;g.directionBackwards=false}}}else{g.time=g.time%g.duration;if(g.time<0){g.time+=g.duration}}var b=g.startFrame+THREE.Math.clamp(Math.floor(g.time/e),0,g.length-1);var f=g.weight;if(b!==g.currentFrame){this.morphTargetInfluences[g.lastFrame]=0;this.morphTargetInfluences[g.currentFrame]=1*f;this.morphTargetInfluences[b]=0;g.lastFrame=g.currentFrame;g.currentFrame=b}var d=(g.time%e)/e;if(g.directionBackwards){d=1-d}this.morphTargetInfluences[g.currentFrame]=d*f;this.morphTargetInfluences[g.lastFrame]=(1-d)*f}};THREE.LensFlarePlugin=function(){var c,d,a,e={};this.init=function(g){c=g.context;d=g;a=g.getPrecision();e.vertices=new Float32Array(8+8);e.faces=new Uint16Array(6);var f=0;e.vertices[f++]=-1;e.vertices[f++]=-1;e.vertices[f++]=0;e.vertices[f++]=0;e.vertices[f++]=1;e.vertices[f++]=-1;e.vertices[f++]=1;e.vertices[f++]=0;e.vertices[f++]=1;e.vertices[f++]=1;e.vertices[f++]=1;e.vertices[f++]=1;e.vertices[f++]=-1;e.vertices[f++]=1;e.vertices[f++]=0;e.vertices[f++]=1;f=0;e.faces[f++]=0;e.faces[f++]=1;e.faces[f++]=2;e.faces[f++]=0;e.faces[f++]=2;e.faces[f++]=3;e.vertexBuffer=c.createBuffer();e.elementBuffer=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,e.vertexBuffer);c.bufferData(c.ARRAY_BUFFER,e.vertices,c.STATIC_DRAW);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,e.elementBuffer);c.bufferData(c.ELEMENT_ARRAY_BUFFER,e.faces,c.STATIC_DRAW);e.tempTexture=c.createTexture();e.occlusionTexture=c.createTexture();c.bindTexture(c.TEXTURE_2D,e.tempTexture);c.texImage2D(c.TEXTURE_2D,0,c.RGB,16,16,0,c.RGB,c.UNSIGNED_BYTE,null);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.bindTexture(c.TEXTURE_2D,e.occlusionTexture);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,16,16,0,c.RGBA,c.UNSIGNED_BYTE,null);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);if(c.getParameter(c.MAX_VERTEX_TEXTURE_IMAGE_UNITS)<=0){e.hasVertexTexture=false;e.program=b(THREE.ShaderFlares.lensFlare,a)}else{e.hasVertexTexture=true;e.program=b(THREE.ShaderFlares.lensFlareVertexTexture,a)}e.attributes={};e.uniforms={};e.attributes.vertex=c.getAttribLocation(e.program,"position");e.attributes.uv=c.getAttribLocation(e.program,"uv");e.uniforms.renderType=c.getUniformLocation(e.program,"renderType");e.uniforms.map=c.getUniformLocation(e.program,"map");e.uniforms.occlusionMap=c.getUniformLocation(e.program,"occlusionMap");e.uniforms.opacity=c.getUniformLocation(e.program,"opacity");e.uniforms.color=c.getUniformLocation(e.program,"color");e.uniforms.scale=c.getUniformLocation(e.program,"scale");e.uniforms.rotation=c.getUniformLocation(e.program,"rotation");e.uniforms.screenPosition=c.getUniformLocation(e.program,"screenPosition")};this.render=function(C,v,r,f){var n=C.__webglFlares,E=n.length;if(!E){return}var A=new THREE.Vector3();var h=f/r,B=r*0.5,q=f*0.5;var o=16/f,F=new THREE.Vector2(o*h,o);var m=new THREE.Vector3(1,1,0),l=new THREE.Vector2(1,1);var D=e.uniforms,k=e.attributes;c.useProgram(e.program);c.enableVertexAttribArray(e.attributes.vertex);c.enableVertexAttribArray(e.attributes.uv);c.uniform1i(D.occlusionMap,0);c.uniform1i(D.map,1);c.bindBuffer(c.ARRAY_BUFFER,e.vertexBuffer);c.vertexAttribPointer(k.vertex,2,c.FLOAT,false,2*8,0);c.vertexAttribPointer(k.uv,2,c.FLOAT,false,2*8,8);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,e.elementBuffer);c.disable(c.CULL_FACE);c.depthMask(false);var t,s,u,g,p;for(t=0;t<E;t++){o=16/f;F.set(o*h,o);g=n[t];A.set(g.matrixWorld.elements[12],g.matrixWorld.elements[13],g.matrixWorld.elements[14]);A.applyMatrix4(v.matrixWorldInverse);A.applyProjection(v.projectionMatrix);m.copy(A);l.x=m.x*B+B;l.y=m.y*q+q;if(e.hasVertexTexture||(l.x>0&&l.x<r&&l.y>0&&l.y<f)){c.activeTexture(c.TEXTURE1);c.bindTexture(c.TEXTURE_2D,e.tempTexture);c.copyTexImage2D(c.TEXTURE_2D,0,c.RGB,l.x-8,l.y-8,16,16,0);c.uniform1i(D.renderType,0);c.uniform2f(D.scale,F.x,F.y);c.uniform3f(D.screenPosition,m.x,m.y,m.z);c.disable(c.BLEND);c.enable(c.DEPTH_TEST);c.drawElements(c.TRIANGLES,6,c.UNSIGNED_SHORT,0);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,e.occlusionTexture);c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,l.x-8,l.y-8,16,16,0);c.uniform1i(D.renderType,1);c.disable(c.DEPTH_TEST);c.activeTexture(c.TEXTURE1);c.bindTexture(c.TEXTURE_2D,e.tempTexture);c.drawElements(c.TRIANGLES,6,c.UNSIGNED_SHORT,0);g.positionScreen.copy(m);if(g.customUpdateCallback){g.customUpdateCallback(g)}else{g.updateLensFlares()}c.uniform1i(D.renderType,2);c.enable(c.BLEND);for(s=0,u=g.lensFlares.length;s<u;s++){p=g.lensFlares[s];if(p.opacity>0.001&&p.scale>0.001){m.x=p.x;m.y=p.y;m.z=p.z;o=p.size*p.scale/f;F.x=o*h;F.y=o;c.uniform3f(D.screenPosition,m.x,m.y,m.z);c.uniform2f(D.scale,F.x,F.y);c.uniform1f(D.rotation,p.rotation);c.uniform1f(D.opacity,p.opacity);c.uniform3f(D.color,p.color.r,p.color.g,p.color.b);d.setBlending(p.blending,p.blendEquation,p.blendSrc,p.blendDst);d.setTexture(p.texture,1);c.drawElements(c.TRIANGLES,6,c.UNSIGNED_SHORT,0)}}}}c.enable(c.CULL_FACE);c.enable(c.DEPTH_TEST);c.depthMask(true)};function b(i,g){var h=c.createProgram();var f=c.createShader(c.FRAGMENT_SHADER);var k=c.createShader(c.VERTEX_SHADER);var j="precision "+g+" float;\n";c.shaderSource(f,j+i.fragmentShader);c.shaderSource(k,j+i.vertexShader);c.compileShader(f);c.compileShader(k);c.attachShader(h,f);c.attachShader(h,k);c.linkProgram(h);return h}};THREE.ShadowMapPlugin=function(){var a,k,n,e,b,l,m=new THREE.Frustum(),c=new THREE.Matrix4(),h=new THREE.Vector3(),o=new THREE.Vector3(),j=new THREE.Vector3();this.init=function(r){a=r.context;k=r;var p=THREE.ShaderLib.depthRGBA;var q=THREE.UniformsUtils.clone(p.uniforms);n=new THREE.ShaderMaterial({fragmentShader:p.fragmentShader,vertexShader:p.vertexShader,uniforms:q});e=new THREE.ShaderMaterial({fragmentShader:p.fragmentShader,vertexShader:p.vertexShader,uniforms:q,morphTargets:true});b=new THREE.ShaderMaterial({fragmentShader:p.fragmentShader,vertexShader:p.vertexShader,uniforms:q,skinning:true});l=new THREE.ShaderMaterial({fragmentShader:p.fragmentShader,vertexShader:p.vertexShader,uniforms:q,morphTargets:true,skinning:true});n._shadowPass=true;e._shadowPass=true;b._shadowPass=true;l._shadowPass=true};this.render=function(q,p){if(!(k.shadowMapEnabled&&k.shadowMapAutoUpdate)){return}this.update(q,p)};this.update=function(R,P){var O,C,N,Q,I,t,S,U,B,M,F,q,V,v,D,T=[],L=0,p=null;a.clearColor(1,1,1,1);a.disable(a.BLEND);a.enable(a.CULL_FACE);a.frontFace(a.CCW);if(k.shadowMapCullFace===THREE.CullFaceFront){a.cullFace(a.FRONT)}else{a.cullFace(a.BACK)}k.setDepthTest(true);for(O=0,C=R.__lights.length;O<C;O++){v=R.__lights[O];if(!v.castShadow){continue}if((v instanceof THREE.DirectionalLight)&&v.shadowCascade){for(I=0;I<v.shadowCascadeCount;I++){var u;if(!v.shadowCascadeArray[I]){u=d(v,I);u.originalCamera=P;var K=new THREE.Gyroscope();K.position=v.shadowCascadeOffset;K.add(u);K.add(u.target);P.add(K);v.shadowCascadeArray[I]=u;console.log("Created virtualLight",u)}else{u=v.shadowCascadeArray[I]}g(v,I);T[L]=u;L++}}else{T[L]=v;L++}}for(O=0,C=T.length;O<C;O++){v=T[O];if(!v.shadowMap){var H=THREE.LinearFilter;if(k.shadowMapType===THREE.PCFSoftShadowMap){H=THREE.NearestFilter}var J={minFilter:H,magFilter:H,format:THREE.RGBAFormat};v.shadowMap=new THREE.WebGLRenderTarget(v.shadowMapWidth,v.shadowMapHeight,J);v.shadowMapSize=new THREE.Vector2(v.shadowMapWidth,v.shadowMapHeight);v.shadowMatrix=new THREE.Matrix4()}if(!v.shadowCamera){if(v instanceof THREE.SpotLight){v.shadowCamera=new THREE.PerspectiveCamera(v.shadowCameraFov,v.shadowMapWidth/v.shadowMapHeight,v.shadowCameraNear,v.shadowCameraFar)}else{if(v instanceof THREE.DirectionalLight){v.shadowCamera=new THREE.OrthographicCamera(v.shadowCameraLeft,v.shadowCameraRight,v.shadowCameraTop,v.shadowCameraBottom,v.shadowCameraNear,v.shadowCameraFar)}else{console.error("Unsupported light type for shadow");continue}}R.add(v.shadowCamera);if(R.autoUpdate===true){R.updateMatrixWorld()}}if(v.shadowCameraVisible&&!v.cameraHelper){v.cameraHelper=new THREE.CameraHelper(v.shadowCamera);v.shadowCamera.add(v.cameraHelper)}if(v.isVirtual&&u.originalCamera==P){i(P,v)}t=v.shadowMap;S=v.shadowMatrix;U=v.shadowCamera;U.position.setFromMatrixPosition(v.matrixWorld);j.setFromMatrixPosition(v.target.matrixWorld);U.lookAt(j);U.updateMatrixWorld();U.matrixWorldInverse.getInverse(U.matrixWorld);if(v.cameraHelper){v.cameraHelper.visible=v.shadowCameraVisible}if(v.shadowCameraVisible){v.cameraHelper.update()}S.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1);S.multiply(U.projectionMatrix);S.multiply(U.matrixWorldInverse);c.multiplyMatrices(U.projectionMatrix,U.matrixWorldInverse);m.setFromMatrix(c);k.setRenderTarget(t);k.clear();D=R.__webglObjects;for(N=0,Q=D.length;N<Q;N++){q=D[N];V=q.object;q.render=false;if(V.visible&&V.castShadow){if(!(V instanceof THREE.Mesh||V instanceof THREE.ParticleSystem)||!(V.frustumCulled)||m.intersectsObject(V)){V._modelViewMatrix.multiplyMatrices(U.matrixWorldInverse,V.matrixWorld);q.render=true}}}var s,A,E;for(N=0,Q=D.length;N<Q;N++){q=D[N];if(q.render){V=q.object;M=q.buffer;s=f(V);A=V.geometry.morphTargets.length>0&&s.morphTargets;E=V instanceof THREE.SkinnedMesh&&s.skinning;if(V.customDepthMaterial){F=V.customDepthMaterial}else{if(E){F=A?l:b}else{if(A){F=e}else{F=n}}}if(M instanceof THREE.BufferGeometry){k.renderBufferDirect(U,R.__lights,p,F,M,V)}else{k.renderBuffer(U,R.__lights,p,F,M,V)}}}D=R.__webglObjectsImmediate;for(N=0,Q=D.length;N<Q;N++){q=D[N];V=q.object;if(V.visible&&V.castShadow){V._modelViewMatrix.multiplyMatrices(U.matrixWorldInverse,V.matrixWorld);k.renderImmediateObject(U,R.__lights,p,n,V)}}}var r=k.getClearColor(),G=k.getClearAlpha();a.clearColor(r.r,r.g,r.b,G);a.enable(a.BLEND);if(k.shadowMapCullFace===THREE.CullFaceFront){a.cullFace(a.BACK)}};function d(q,s){var p=new THREE.DirectionalLight();p.isVirtual=true;p.onlyShadow=true;p.castShadow=true;p.shadowCameraNear=q.shadowCameraNear;p.shadowCameraFar=q.shadowCameraFar;p.shadowCameraLeft=q.shadowCameraLeft;p.shadowCameraRight=q.shadowCameraRight;p.shadowCameraBottom=q.shadowCameraBottom;p.shadowCameraTop=q.shadowCameraTop;p.shadowCameraVisible=q.shadowCameraVisible;p.shadowDarkness=q.shadowDarkness;p.shadowBias=q.shadowCascadeBias[s];p.shadowMapWidth=q.shadowCascadeWidth[s];p.shadowMapHeight=q.shadowCascadeHeight[s];p.pointsWorld=[];p.pointsFrustum=[];var v=p.pointsWorld,r=p.pointsFrustum;for(var u=0;u<8;u++){v[u]=new THREE.Vector3();r[u]=new THREE.Vector3()}var A=q.shadowCascadeNearZ[s];var t=q.shadowCascadeFarZ[s];r[0].set(-1,-1,A);r[1].set(1,-1,A);r[2].set(-1,1,A);r[3].set(1,1,A);r[4].set(-1,-1,t);r[5].set(1,-1,t);r[6].set(-1,1,t);r[7].set(1,1,t);return p}function g(q,s){var p=q.shadowCascadeArray[s];p.position.copy(q.position);p.target.position.copy(q.target.position);p.lookAt(p.target);p.shadowCameraVisible=q.shadowCameraVisible;p.shadowDarkness=q.shadowDarkness;p.shadowBias=q.shadowCascadeBias[s];var u=q.shadowCascadeNearZ[s];var t=q.shadowCascadeFarZ[s];var r=p.pointsFrustum;r[0].z=u;r[1].z=u;r[2].z=u;r[3].z=u;r[4].z=t;r[5].z=t;r[6].z=t;r[7].z=t}function i(t,q){var v=q.shadowCamera,r=q.pointsFrustum,u=q.pointsWorld;h.set(Infinity,Infinity,Infinity);o.set(-Infinity,-Infinity,-Infinity);for(var s=0;s<8;s++){var A=u[s];A.copy(r[s]);THREE.ShadowMapPlugin.__projector.unprojectVector(A,t);A.applyMatrix4(v.matrixWorldInverse);if(A.x<h.x){h.x=A.x}if(A.x>o.x){o.x=A.x}if(A.y<h.y){h.y=A.y}if(A.y>o.y){o.y=A.y}if(A.z<h.z){h.z=A.z}if(A.z>o.z){o.z=A.z}}v.left=h.x;v.right=o.x;v.top=o.y;v.bottom=h.y;v.updateProjectionMatrix()}function f(p){return p.material instanceof THREE.MeshFaceMaterial?p.material.materials[0]:p.material}};THREE.ShadowMapPlugin.__projector=new THREE.Projector();THREE.SpritePlugin=function(){var b,j,g;var h,c,i,a;var f,e,l;this.init=function(o){b=o.context;j=o;h=new Float32Array([-0.5,-0.5,0,0,0.5,-0.5,1,0,0.5,0.5,1,1,-0.5,0.5,0,1]);c=new Uint16Array([0,1,2,0,2,3]);i=b.createBuffer();a=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,i);b.bufferData(b.ARRAY_BUFFER,h,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a);b.bufferData(b.ELEMENT_ARRAY_BUFFER,c,b.STATIC_DRAW);f=d();e={position:b.getAttribLocation(f,"position"),uv:b.getAttribLocation(f,"uv")};l={uvOffset:b.getUniformLocation(f,"uvOffset"),uvScale:b.getUniformLocation(f,"uvScale"),rotation:b.getUniformLocation(f,"rotation"),scale:b.getUniformLocation(f,"scale"),color:b.getUniformLocation(f,"color"),map:b.getUniformLocation(f,"map"),opacity:b.getUniformLocation(f,"opacity"),modelViewMatrix:b.getUniformLocation(f,"modelViewMatrix"),projectionMatrix:b.getUniformLocation(f,"projectionMatrix"),fogType:b.getUniformLocation(f,"fogType"),fogDensity:b.getUniformLocation(f,"fogDensity"),fogNear:b.getUniformLocation(f,"fogNear"),fogFar:b.getUniformLocation(f,"fogFar"),fogColor:b.getUniformLocation(f,"fogColor"),alphaTest:b.getUniformLocation(f,"alphaTest")};var m=document.createElement("canvas");m.width=8;m.height=8;var n=m.getContext("2d");n.fillStyle="#ffffff";n.fillRect(0,0,m.width,m.height);g=new THREE.Texture(m);g.needsUpdate=true};this.render=function(q,A,u,s){var B=q.__webglSprites,t=B.length;if(!t){return}b.useProgram(f);b.enableVertexAttribArray(e.position);b.enableVertexAttribArray(e.uv);b.disable(b.CULL_FACE);b.enable(b.BLEND);b.bindBuffer(b.ARRAY_BUFFER,i);b.vertexAttribPointer(e.position,2,b.FLOAT,false,2*8,0);b.vertexAttribPointer(e.uv,2,b.FLOAT,false,2*8,8);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,a);b.uniformMatrix4fv(l.projectionMatrix,false,A.projectionMatrix.elements);b.activeTexture(b.TEXTURE0);b.uniform1i(l.map,0);var r=0;var D=0;var m=q.fog;if(m){b.uniform3f(l.fogColor,m.color.r,m.color.g,m.color.b);if(m instanceof THREE.Fog){b.uniform1f(l.fogNear,m.near);b.uniform1f(l.fogFar,m.far);b.uniform1i(l.fogType,1);r=1;D=1}else{if(m instanceof THREE.FogExp2){b.uniform1f(l.fogDensity,m.density);b.uniform1i(l.fogType,2);r=2;D=2}}}else{b.uniform1i(l.fogType,0);r=0;D=0}var p,C,v,o,n=[];for(p=0;p<t;p++){C=B[p];v=C.material;if(C.visible===false){continue}C._modelViewMatrix.multiplyMatrices(A.matrixWorldInverse,C.matrixWorld);C.z=-C._modelViewMatrix.elements[14]}B.sort(k);for(p=0;p<t;p++){C=B[p];if(C.visible===false){continue}v=C.material;b.uniform1f(l.alphaTest,v.alphaTest);b.uniformMatrix4fv(l.modelViewMatrix,false,C._modelViewMatrix.elements);n[0]=C.scale.x;n[1]=C.scale.y;if(q.fog&&v.fog){o=D}else{o=0}if(r!==o){b.uniform1i(l.fogType,o);r=o}b.uniform2f(l.uvScale,v.uvScale.x,v.uvScale.y);b.uniform2f(l.uvOffset,v.uvOffset.x,v.uvOffset.y);b.uniform1f(l.opacity,v.opacity);b.uniform3f(l.color,v.color.r,v.color.g,v.color.b);b.uniform1f(l.rotation,v.rotation);b.uniform2fv(l.scale,n);j.setBlending(v.blending,v.blendEquation,v.blendSrc,v.blendDst);j.setDepthTest(v.depthTest);j.setDepthWrite(v.depthWrite);if(v.map&&v.map.image&&v.map.image.width){j.setTexture(v.map,0)}else{j.setTexture(g,0)}b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0)}b.enable(b.CULL_FACE)};function d(){var n=b.createProgram();var o=b.createShader(b.VERTEX_SHADER);var m=b.createShader(b.FRAGMENT_SHADER);b.shaderSource(o,["precision "+j.getPrecision()+" float;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uvOffset + uv * uvScale;","vec2 alignedPosition = position * scale;","vec2 rotatedPosition;","rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","vec4 finalPosition;","finalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","finalPosition.xy += rotatedPosition;","finalPosition = projectionMatrix * finalPosition;","gl_Position = finalPosition;","}"].join("\n"));b.shaderSource(m,["precision "+j.getPrecision()+" float;","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","void main() {","vec4 texture = texture2D( map, vUV );","if ( texture.a < alphaTest ) discard;","gl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","if ( fogType > 0 ) {","float depth = gl_FragCoord.z / gl_FragCoord.w;","float fogFactor = 0.0;","if ( fogType == 1 ) {","fogFactor = smoothstep( fogNear, fogFar, depth );","} else {","const float LOG2 = 1.442695;","float fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );","fogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","}","gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );","}","}"].join("\n"));b.compileShader(o);b.compileShader(m);b.attachShader(n,o);b.attachShader(n,m);b.linkProgram(n);return n}function k(n,m){if(n.z!==m.z){return m.z-n.z}else{return m.id-n.id}}};THREE.DepthPassPlugin=function(){this.enabled=false;this.renderTarget=null;var a,f,i,d,b,g,h=new THREE.Frustum(),c=new THREE.Matrix4();this.init=function(l){a=l.context;f=l;var j=THREE.ShaderLib.depthRGBA;var k=THREE.UniformsUtils.clone(j.uniforms);i=new THREE.ShaderMaterial({fragmentShader:j.fragmentShader,vertexShader:j.vertexShader,uniforms:k});d=new THREE.ShaderMaterial({fragmentShader:j.fragmentShader,vertexShader:j.vertexShader,uniforms:k,morphTargets:true});b=new THREE.ShaderMaterial({fragmentShader:j.fragmentShader,vertexShader:j.vertexShader,uniforms:k,skinning:true});g=new THREE.ShaderMaterial({fragmentShader:j.fragmentShader,vertexShader:j.vertexShader,uniforms:k,morphTargets:true,skinning:true});i._shadowPass=true;d._shadowPass=true;b._shadowPass=true;g._shadowPass=true};this.render=function(k,j){if(!this.enabled){return}this.update(k,j)};this.update=function(H,F){var E,s,D,G,B,r,C,v,l,I,p,t,k=null;a.clearColor(1,1,1,1);a.disable(a.BLEND);f.setDepthTest(true);if(H.autoUpdate===true){H.updateMatrixWorld()}F.matrixWorldInverse.getInverse(F.matrixWorld);c.multiplyMatrices(F.projectionMatrix,F.matrixWorldInverse);h.setFromMatrix(c);f.setRenderTarget(this.renderTarget);f.clear();t=H.__webglObjects;for(D=0,G=t.length;D<G;D++){l=t[D];I=l.object;l.render=false;if(I.visible){if(!(I instanceof THREE.Mesh||I instanceof THREE.ParticleSystem)||!(I.frustumCulled)||h.intersectsObject(I)){I._modelViewMatrix.multiplyMatrices(F.matrixWorldInverse,I.matrixWorld);l.render=true}}}var o,q,u;for(D=0,G=t.length;D<G;D++){l=t[D];if(l.render){I=l.object;C=l.buffer;if(I instanceof THREE.ParticleSystem&&!I.customDepthMaterial){continue}o=e(I);if(o){f.setMaterialFaces(I.material)}q=I.geometry.morphTargets.length>0&&o.morphTargets;u=I instanceof THREE.SkinnedMesh&&o.skinning;if(I.customDepthMaterial){v=I.customDepthMaterial}else{if(u){v=q?g:b}else{if(q){v=d}else{v=i}}}if(C instanceof THREE.BufferGeometry){f.renderBufferDirect(F,H.__lights,k,v,C,I)}else{f.renderBuffer(F,H.__lights,k,v,C,I)}}}t=H.__webglObjectsImmediate;for(D=0,G=t.length;D<G;D++){l=t[D];I=l.object;if(I.visible){I._modelViewMatrix.multiplyMatrices(F.matrixWorldInverse,I.matrixWorld);f.renderImmediateObject(F,H.__lights,k,i,I)}}var m=f.getClearColor(),A=f.getClearAlpha();a.clearColor(m.r,m.g,m.b,A);a.enable(a.BLEND)};function e(j){return j.material instanceof THREE.MeshFaceMaterial?j.material.materials[0]:j.material}};THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","uniform sampler2D occlusionMap;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","vec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","visibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","vVisibility =        visibility.r / 9.0;","vVisibility *= 1.0 - visibility.g / 9.0;","vVisibility *=       visibility.b / 9.0;","vVisibility *= 1.0 - visibility.a / 9.0;","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["uniform lowp int renderType;","uniform sampler2D map;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * vVisibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")},lensFlare:{vertexShader:["uniform lowp int renderType;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform float rotation;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","vUV = uv;","vec2 pos = position;","if( renderType == 2 ) {","pos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;","pos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;","}","gl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision mediump float;","uniform lowp int renderType;","uniform sampler2D map;","uniform sampler2D occlusionMap;","uniform float opacity;","uniform vec3 color;","varying vec2 vUV;","void main() {","if( renderType == 0 ) {","gl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );","} else if( renderType == 1 ) {","gl_FragColor = texture2D( map, vUV );","} else {","float visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;","visibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;","visibility = ( 1.0 - visibility / 4.0 );","vec4 texture = texture2D( map, vUV );","texture.a *= opacity * visibility;","gl_FragColor = texture;","gl_FragColor.rgb *= color;","}","}"].join("\n")}};
</script>
<script type="text/javascript">
THREE.ColladaLoader=function(){var au=null;var N=null;var ad;var aR=null;var ah={};var n={};var V={};var am={};var ay={};var X={};var aB={};var al={};var f={};var a1={};var I={};var aW;var aP;var aZ;var g;var Q;var z=true;var W=THREE.SmoothShading;var aj={centerGeometry:false,convertUpAxis:false,subdivideFaces:true,upAxis:"Y",defaultEnvMap:null};var aY=1;var aC="Y";var F=null;function h(a9,bd,bc){var bb=0;if(document.implementation&&document.implementation.createDocument){var ba=new XMLHttpRequest();ba.onreadystatechange=function(){if(ba.readyState==4){if(ba.status==0||ba.status==200){if(ba.responseXML){aR=bd;at(ba.responseXML,undefined,a9)}else{if(ba.responseText){aR=bd;var be=new DOMParser();var bf=be.parseFromString(ba.responseText,"application/xml");at(bf,undefined,a9)}else{console.error("ColladaLoader: Empty or non-existing file ("+a9+")")}}}}else{if(ba.readyState==3){if(bc){if(bb==0){bb=ba.getResponseHeader("Content-Length")}bc({total:bb,loaded:ba.responseText.length})}}}};ba.open("GET",a9,true);ba.send(null)}else{alert("Don't know how to parse XML!")}}function at(be,bc,ba){au=be;bc=bc||aR;if(ba!==undefined){var bd=ba.split("/");bd.pop();aZ=(bd.length<1?".":bd.join("/"))+"/"}E();ab();n=aG("library_images image",ak,"image");X=aG("library_materials material",c,"material");aB=aG("library_effects effect",U,"effect");ay=aG("library_geometries geometry",aI,"geometry");al=aG("library_cameras camera",aX,"camera");f=aG("library_lights light",ax,"light");am=aG("library_controllers controller",P,"controller");V=aG("library_animations animation",a0,"animation");aP=aG("library_visual_scenes visual_scene",aT,"visual_scene");g=[];Q=[];ad=ae();N=new THREE.Object3D();for(var bb=0;bb<ad.nodes.length;bb++){N.add(d(ad.nodes[bb]))}N.scale.multiplyScalar(aY);B();var a9={scene:N,morphs:g,skins:Q,animations:aW,dae:{images:n,materials:X,cameras:al,lights:f,effects:aB,geometries:ay,controllers:am,animations:V,visualScenes:aP,scene:ad,reflectionTextures:a1,reflectionRenderTargets:I}};if(bc){bc(a9)}return a9}function J(a9){W=a9}function E(){var bc=au.querySelectorAll("asset");var ba=bc[0];if(ba&&ba.childNodes){for(var a9=0;a9<ba.childNodes.length;a9++){var bd=ba.childNodes[a9];switch(bd.nodeName){case"unit":var bb=bd.getAttribute("meter");if(bb){aY=parseFloat(bb)}break;case"up_axis":aC=bd.textContent.charAt(0);break}}}}function aG(ba,be,bf){var a9=au.querySelectorAll(ba);var bh={};var bd=0;var bg=a9.length;for(var bb=0;bb<bg;bb++){var bc=a9[bb];var bi=(new be()).parse(bc);if(!bi.id||bi.id.length==0){bi.id=bf+(bd++)}bh[bi.id]=bi}return bh}function ae(){var ba=au.querySelectorAll("scene instance_visual_scene")[0];if(ba){var a9=ba.getAttribute("url").replace(/^#/,"");return aP[a9.length>0?a9:"visual_scene0"]}else{return null}}function B(){aW=[];t(N)}function t(be){var bg=ad.getChildById(be.name,true),bd=null;if(bg&&bg.keys){bd={fps:60,hierarchy:[{node:bg,keys:bg.keys,sids:bg.sids}],node:be,name:"animation_"+be.name,length:0};aW.push(bd);for(var bc=0,a9=bg.keys.length;bc<a9;bc++){bd.length=Math.max(bd.length,bg.keys[bc].time)}}else{bd={hierarchy:[{keys:[],sids:[]}]}}for(var bc=0,a9=be.children.length;bc<a9;bc++){var bf=t(be.children[bc]);for(var ba=0,bb=bf.hierarchy.length;ba<bb;ba++){bd.hierarchy.push({keys:[],sids:[]})}}return bd}function O(){var bg=1000000;var ba=-bg;var be=0;var a9;for(var bf in V){var bd=V[bf];a9=a9||bd.id;for(var bc=0;bc<bd.sampler.length;bc++){var bb=bd.sampler[bc];bb.create();bg=Math.min(bg,bb.startTime);ba=Math.max(ba,bb.endTime);be=Math.max(be,bb.input.length)}}return{start:bg,end:ba,frames:be,ID:a9}}function q(bg,bd){var bf=bd instanceof K?am[bd.url]:bd;if(!bf||!bf.morph){console.log("could not find morph controller!");return}var bc=bf.morph;for(var bb=0;bb<bc.targets.length;bb++){var ba=bc.targets[bb];var a9=ay[ba];if(!a9.mesh||!a9.mesh.primitives||!a9.mesh.primitives.length){continue}var be=a9.mesh.primitives[0].geometry;if(be.vertices.length===bg.vertices.length){bg.morphTargets.push({name:"target_1",vertices:be.vertices})}}bg.morphTargets.push({name:"target_Z",vertices:bg.vertices})}function aU(bg,a9,be){var ba=am[a9.url];if(!ba||!ba.skin){console.log("could not find skin controller!");return}if(!a9.skeleton||!a9.skeleton.length){console.log("could not find the skeleton for the skin!");return}var bh=ba.skin;var bc=ad.getChildById(a9.skeleton[0]);var bf=[];be=be!==undefined?be:true;var bb=[];bg.skinWeights=[];bg.skinIndices=[];if(be){for(var bd=0;bd<bg.vertices.length;bd++){bg.vertices[bd].applyMatrix4(bh.bindShapeMatrix)}}}function H(be,ba,bf,bc){be.world=be.world||new THREE.Matrix4();be.localworld=be.localworld||new THREE.Matrix4();be.world.copy(be.matrix);be.localworld.copy(be.matrix);if(be.channels&&be.channels.length){var bd=be.channels[0];var a9=bd.sampler.output[bf];if(a9 instanceof THREE.Matrix4){be.world.copy(a9);be.localworld.copy(a9);if(bf==0){be.matrix.copy(a9)}}}if(bc){be.world.multiplyMatrices(bc,be.world)}ba.push(be);for(var bb=0;bb<be.nodes.length;bb++){H(be.nodes[bb],ba,bf,be.world)}}function Z(a9,bg){for(var bc=0;bc<a9.length;bc++){var bf=a9[bc];var bh=-1;if(bf.type!="JOINT"){continue}for(var bb=0;bb<bg.joints.length;bb++){if(bf.sid==bg.joints[bb]){bh=bb;break}}if(bh>=0){var bd=bg.invBindMatrices[bh];bf.invBindMatrix=bd;bf.skinningMatrix=new THREE.Matrix4();bf.skinningMatrix.multiplyMatrices(bf.world,bd);bf.animatrix=new THREE.Matrix4();bf.animatrix.copy(bf.localworld);bf.weights=[];for(var bb=0;bb<bg.weights.length;bb++){for(var ba=0;ba<bg.weights[bb].length;ba++){var be=bg.weights[bb][ba];if(be.joint==bh){bf.weights.push(be)}}}}else{console.warn("ColladaLoader: Could not find joint '"+bf.sid+"'.");bf.skinningMatrix=new THREE.Matrix4();bf.weights=[]}}}function m(bb){var ba=[];var a9=function(bh,bd,bg){var bf={};bf.name=bd.sid;bf.parent=bh;bf.matrix=bd.matrix;var be=[new THREE.Vector3(),new THREE.Quaternion(),new THREE.Vector3()];bf.matrix.decompose(be[0],be[1],be[2]);bf.pos=[be[0].x,be[0].y,be[0].z];bf.scl=[be[2].x,be[2].y,be[2].z];bf.rotq=[be[1].x,be[1].y,be[1].z,be[1].w];bg.push(bf);for(var bc in bd.nodes){a9(bd.sid,bd.nodes[bc],bg)}};a9(-1,bb,ba);return ba}function az(be,bd,bc){var a9=[];H(bd,a9,-1);Z(a9,bc.skin);v=new THREE.Vector3();var bb=[];for(var ba=0;ba<be.vertices.length;ba++){bb.push(new THREE.Vector3())}for(ba=0;ba<a9.length;ba++){if(a9[ba].type!="JOINT"){continue}for(j=0;j<a9[ba].weights.length;j++){w=a9[ba].weights[j];vidx=w.index;weight=w.weight;o=be.vertices[vidx];s=bb[vidx];v.x=o.x;v.y=o.y;v.z=o.z;v.applyMatrix4(a9[ba].skinningMatrix);s.x+=(v.x*weight);s.y+=(v.y*weight);s.z+=(v.z*weight)}}for(var ba=0;ba<be.vertices.length;ba++){be.vertices[ba]=bb[ba]}}function a2(be,bg,bm){var br=30;var bf=am[bg.url];bm=bm!==undefined?bm:40;if(!bf||!bf.skin){console.log("ColladaLoader: Could not find skin controller.");return}if(!bg.skeleton||!bg.skeleton.length){console.log("ColladaLoader: Could not find the skeleton for the skin. ");return}var bk=O();var bd=ad.getChildById(bg.skeleton[0],true)||ad.getChildBySid(bg.skeleton[0],true);var bw=m(bd);var bz=bf.skin.joints;var bq=[];for(var bt=0;bt<bz.length;bt++){for(var bs=0;bs<bw.length;bs++){if(bw[bs].name==bz[bt]){bq[bt]=bw[bs]}}}for(var bt=0;bt<bq.length;bt++){for(var bs=0;bs<bq.length;bs++){if(bq[bt].parent==bq[bs].name){bq[bt].parent=bs}}}var bt,bs,bh,bb,bl;var bj=new THREE.Vector3(),bp,bo;for(bt=0;bt<be.vertices.length;bt++){be.vertices[bt].applyMatrix4(bf.skin.bindShapeMatrix)}var bn=[];var ba=[];var bv=bf.skin.weights;for(var bt=0;bt<bv.length;bt++){var a9=new THREE.Vector4(bv[bt][0]?bv[bt][0].joint:0,bv[bt][1]?bv[bt][1].joint:0,bv[bt][2]?bv[bt][2].joint:0,bv[bt][3]?bv[bt][3].joint:0);var bl=new THREE.Vector4(bv[bt][0]?bv[bt][0].weight:0,bv[bt][1]?bv[bt][1].weight:0,bv[bt][2]?bv[bt][2].weight:0,bv[bt][3]?bv[bt][3].weight:0);bn.push(a9);ba.push(bl)}be.skinIndices=bn;be.skinWeights=ba;be.bones=bq;var bc={name:bk.ID,fps:30,length:bk.frames/30,hierarchy:[]};for(var bs=0;bs<bq.length;bs++){bc.hierarchy.push({parent:bq[bs].parent,name:bq[bs].name,keys:[]})}if(bq.length<br){az(be,bd,bf)}for(bm=0;bm<bk.frames;bm++){var bu=[];var bi=[];H(bd,bu,bm);Z(bu,bf.skin);if(bq.length<br){for(var bt=0;bt<bu.length;bt++){for(var bs=0;bs<bc.hierarchy.length;bs++){if(bc.hierarchy[bs].name==bu[bt].sid){var by={};by.time=(bm/30);by.matrix=bu[bt].animatrix;if(bm==0){bu[bt].matrix=by.matrix}var bx=[new THREE.Vector3(),new THREE.Quaternion(),new THREE.Vector3()];by.matrix.decompose(bx[0],bx[1],bx[2]);by.pos=[bx[0].x,bx[0].y,bx[0].z];by.scl=[bx[2].x,bx[2].y,bx[2].z];by.rot=bx[1];bc.hierarchy[bs].keys.push(by)}}}be.animation=bc}else{for(bt=0;bt<be.vertices.length;bt++){bi.push(new THREE.Vector3())}for(bt=0;bt<bu.length;bt++){if(bu[bt].type!="JOINT"){continue}for(bs=0;bs<bu[bt].weights.length;bs++){bh=bu[bt].weights[bs];bb=bh.index;bl=bh.weight;bp=be.vertices[bb];bo=bi[bb];bj.x=bp.x;bj.y=bp.y;bj.z=bp.z;bj.applyMatrix4(bu[bt].skinningMatrix);bo.x+=(bj.x*bl);bo.y+=(bj.y*bl);bo.z+=(bj.z*bl)}}be.morphTargets.push({name:"target_"+bm,vertices:bi})}}}function af(a9){if(a9.determinant()<0){return true}return false}function d(bw,bf){var ba=new THREE.Object3D();var bc=false;var bD;var bs;var bN,bL;for(bN=0;bN<bw.controllers.length;bN++){var bM=am[bw.controllers[bN].url];switch(bM.type){case"skin":if(ay[bM.skin.source]){var bE=new aE();bE.url=bM.skin.source;bE.instance_material=bw.controllers[bN].instance_material;bw.geometries.push(bE);bc=true;bD=bw.controllers[bN]}else{if(am[bM.skin.source]){var bu=am[bM.skin.source];bs=bu;if(bu.morph&&ay[bu.morph.source]){var bE=new aE();bE.url=bu.morph.source;bE.instance_material=bw.controllers[bN].instance_material;bw.geometries.push(bE)}}}break;case"morph":if(ay[bM.morph.source]){var bE=new aE();bE.url=bM.morph.source;bE.instance_material=bw.controllers[bN].instance_material;bw.geometries.push(bE);bs=bw.controllers[bN]}console.log("ColladaLoader: Morph-controller partially supported.");default:break}}var bI={};for(bN=0;bN<bw.geometries.length;bN++){var bB=bw.geometries[bN];var bJ=bB.instance_material;var bi=ay[bB.url];var bo={};var bA=[];var bb=0;var a9;if(bi){if(!bi.mesh||!bi.mesh.primitives){continue}if(ba.name.length==0){ba.name=bi.id}if(bJ){for(bL=0;bL<bJ.length;bL++){var bd=bJ[bL];var br=X[bd.target];var bx=br.instance_effect.url;var bO=aB[bx].shader;var by=bO.material;by.opacity=!by.opacity?1:by.opacity;bo[bd.symbol]=bb;bA.push(by);a9=by;a9.name=br.name==null||br.name===""?br.id:br.name;bb++}}var bp;var bK=a9||new THREE.MeshLambertMaterial({color:14540253,shading:THREE.FlatShading,side:bi.doubleSided?THREE.DoubleSide:THREE.FrontSide});var be=bi.mesh.geometry3js;if(bb>1){bK=new THREE.MeshFaceMaterial(bA);for(bL=0;bL<be.faces.length;bL++){var bg=be.faces[bL];bg.materialIndex=bo[bg.daeMaterial]}}if(bD!==undefined){a2(be,bD);if(be.morphTargets.length>0){bK.morphTargets=true;bK.skinning=false}else{bK.morphTargets=false;bK.skinning=true}bp=new THREE.SkinnedMesh(be,bK,false);bp.name="skin_"+Q.length;Q.push(bp)}else{if(bs!==undefined){q(be,bs);bK.morphTargets=true;bp=new THREE.Mesh(be,bK);bp.name="morph_"+g.length;g.push(bp)}else{bp=new THREE.Mesh(be,bK)}}bw.geometries.length>1?ba.add(bp):ba=bp}}objectMirrored=false;nodeMatrix=bw.matrix;if(af(bw.matrix)){objectMirrored=true;nodeMatrix=bw.matrix.clone();mirrorInverse=new THREE.Matrix4;mirrorInverse.makeScale(-1,-1,-1);nodeMatrix.multiply(mirrorInverse)}var bG=new THREE.Quaternion();var bF=new THREE.Vector3();var bz=new THREE.Vector3();nodeMatrix.decompose(bF,bG,bz);for(bN=0;bN<bw.cameras.length;bN++){var bq=bw.cameras[bN];var bh=al[bq.url];ba=new THREE.PerspectiveCamera(bh.yfov,bh.aspect_ratio,bh.znear,bh.zfar);ba.cameraTarget=bh.camera_target;var bm=ba.up;var bk=[bm.x,bm.y,bm.z];bm=ac(bk,0);bG.multiplyVector3(bm);ba.up=bm}for(bN=0;bN<bw.lights.length;bN++){var bH=bw.lights[bN];var bj=f[bH.url];if(bj&&bj.technique){var bt=bj.color.getHex();var bv=bj.intensity;var bn=0;var bl=bj.falloff_angle;var bP;switch(bj.technique){case"directional":ba=new THREE.DirectionalLight(bt,bv,bn);break;case"point":ba=new THREE.PointLight(bt,bv,bn);break;case"spot":ba=new THREE.SpotLight(bt,bv,bn,bl,bP);break;case"ambient":ba=new THREE.AmbientLight(bt);break}}}ba.name=bw.name||bw.id||"";ba.layer=bw.layer||"";ba.visible=bw.visible;ba.matrix=bw.matrix;ba.matrix.decompose(ba.position,ba.quaternion,ba.scale);ba.position=bF;ba.quaternion=bG;ba.useQuaternion=true;ba.scale=bz;if(objectMirrored){ba.scale.multiplyScalar(-1)}ba.position.multiplyScalar(aY);ba.scale.multiplyScalar(aY);if(aj.centerGeometry&&ba.geometry){var bC=THREE.GeometryUtils.center(ba.geometry);bC.multiply(ba.scale);bC.applyQuaternion(ba.quaternion);ba.position.sub(bC)}for(bN=0;bN<bw.nodes.length;bN++){ba.add(d(bw.nodes[bN],bw))}return ba}function r(ba,bb){for(var a9=0;a9<ba.joints.length;a9++){if(ba.joints[a9]==bb){return a9}}}function R(bc){var a9=au.querySelectorAll("library_nodes node");for(var bb=0;bb<a9.length;bb++){var ba=a9[bb].attributes.getNamedItem("id");if(ba&&ba.value===bc){return a9[bb]}}return undefined}function x(bb){var be=[];var ba=1000000;var bf=-1000000;for(var a9 in V){var bc=V[a9];for(var bd=0;bd<bc.channel.length;bd++){var bg=bc.channel[bd];var bh=bc.sampler[bd];var a9=bg.target.split("/")[0];if(a9==bb.id){bh.create();bg.sampler=bh;ba=Math.min(ba,bh.startTime);bf=Math.max(bf,bh.endTime);be.push(bg)}}}if(be.length){bb.startTime=ba;bb.endTime=bf}return be}function a4(be){var bc=10000000;for(var bb=0;bb<be.channels.length;bb++){var ba=be.channels[bb].sampler;for(var a9=0;a9<ba.input.length-1;a9++){var bf=ba.input[a9];var bd=ba.input[a9+1];bc=Math.min(bc,bd-bf)}}return bc}function ai(ba,bi){var bb={};var bd,bc;for(bd=0;bd<ba.channels.length;bd++){var be=ba.channels[bd];bb[be.sid]=be}var bg=new THREE.Matrix4();for(bd=0;bd<ba.transforms.length;bd++){var a9=ba.transforms[bd];var be=bb[a9.sid];if(be!==undefined){var bf=be.sampler;var bh;for(bc=0;bc<bf.input.length-1;bc++){if(bf.input[bc+1]>bi){bh=bf.output[bc];break}}if(bh!==undefined){if(bh instanceof THREE.Matrix4){bg.multiplyMatrices(bg,bh)}else{bg.multiplyMatrices(bg,a9.matrix)}}else{bg.multiplyMatrices(bg,a9.matrix)}}else{bg.multiplyMatrices(bg,a9.matrix)}}return bg}function aM(bj){if(bj.channels&&bj.channels.length){var bh=[],bn=[];for(var bl=0,be=bj.channels.length;bl<be;bl++){var bq=bj.channels[bl],a9=bq.fullSid,bi=bq.sampler,bf=bi.input,bg=bj.getTransformBySid(bq.sid),ba;if(bq.arrIndices){ba=[];for(var bk=0,bm=bq.arrIndices.length;bk<bm;bk++){ba[bk]=aH(bq.arrIndices[bk])}}else{ba=aa(bq.member)}if(bg){if(bn.indexOf(a9)===-1){bn.push(a9)}for(var bk=0,bm=bf.length;bk<bm;bk++){var bd=bf[bk],bo=bi.getData(bg.type,bk),bp=aw(bh,bd);if(!bp){bp=new an(bd);var bc=C(bh,bd);bh.splice(bc==-1?bh.length:bc,0,bp)}bp.addTarget(a9,bg,ba,bo)}}else{console.log('Could not find transform "'+bq.sid+'" in node '+bj.id)}}for(var bl=0;bl<bn.length;bl++){var bb=bn[bl];for(var bk=0;bk<bh.length;bk++){var bp=bh[bk];if(!bp.hasTarget(bb)){A(bh,bp,bk,bb)}}}bj.keys=bh;bj.sids=bn}}function aw(bc,be){var bd=null;for(var bb=0,a9=bc.length;bb<a9&&bd==null;bb++){var ba=bc[bb];if(ba.time===be){bd=ba}else{if(ba.time>be){break}}}return bd}function C(bd,be){var ba=-1;for(var bc=0,a9=bd.length;bc<a9&&ba==-1;bc++){var bb=bd[bc];if(bb.time>=be){ba=bc}}return ba}function A(bj,bg,bh,be){var bk=aF(bj,be,bh?bh-1:0),bf=l(bj,be,bh+1);if(bk&&bf){var ba=(bg.time-bk.time)/(bf.time-bk.time),bi=bk.getTarget(be),bd=bf.getTarget(be).data,a9=bi.data,bc;if(bi.type==="matrix"){bc=a9}else{if(a9.length){bc=[];for(var bb=0;bb<a9.length;++bb){bc[bb]=a9[bb]+(bd[bb]-a9[bb])*ba}}else{bc=a9+(bd-a9)*ba}}bg.addTarget(be,bi.transform,bi.member,bc)}}function l(bb,bc,a9){for(;a9<bb.length;a9++){var ba=bb[a9];if(ba.hasTarget(bc)){return ba}}return null}function aF(bb,bc,a9){a9=a9>=0?a9:a9+bb.length;for(;a9>=0;a9--){var ba=bb[a9];if(ba.hasTarget(bc)){return ba}}return null}function ak(){this.id="";this.init_from=""}ak.prototype.parse=function(ba){this.id=ba.getAttribute("id");for(var a9=0;a9<ba.childNodes.length;a9++){var bb=ba.childNodes[a9];if(bb.nodeName=="init_from"){this.init_from=bb.textContent}}return this};function P(){this.id="";this.name="";this.type="";this.skin=null;this.morph=null}P.prototype.parse=function(ba){this.id=ba.getAttribute("id");this.name=ba.getAttribute("name");this.type="none";for(var a9=0;a9<ba.childNodes.length;a9++){var bb=ba.childNodes[a9];switch(bb.nodeName){case"skin":this.skin=(new u()).parse(bb);this.type=bb.nodeName;break;case"morph":this.morph=(new k()).parse(bb);this.type=bb.nodeName;break;default:break}}return this};function k(){this.method=null;this.source=null;this.targets=null;this.weights=null}k.prototype.parse=function(bd){var bb={};var a9=[];var bc;this.method=bd.getAttribute("method");this.source=bd.getAttribute("source").replace(/^#/,"");for(bc=0;bc<bd.childNodes.length;bc++){var bf=bd.childNodes[bc];if(bf.nodeType!=1){continue}switch(bf.nodeName){case"source":var be=(new aV()).parse(bf);bb[be.id]=be;break;case"targets":a9=this.parseInputs(bf);break;default:console.log(bf.nodeName);break}}for(bc=0;bc<a9.length;bc++){var ba=a9[bc];var be=bb[ba.source];switch(ba.semantic){case"MORPH_TARGET":this.targets=be.read();break;case"MORPH_WEIGHT":this.weights=be.read();break;default:break}}return this};k.prototype.parseInputs=function(bb){var a9=[];for(var ba=0;ba<bb.childNodes.length;ba++){var bc=bb.childNodes[ba];if(bc.nodeType!=1){continue}switch(bc.nodeName){case"input":a9.push((new a()).parse(bc));break;default:break}}return a9};function u(){this.source="";this.bindShapeMatrix=null;this.invBindMatrices=[];this.joints=[];this.weights=[]}u.prototype.parse=function(bc){var ba={};var a9,bd;this.source=bc.getAttribute("source").replace(/^#/,"");this.invBindMatrices=[];this.joints=[];this.weights=[];for(var bb=0;bb<bc.childNodes.length;bb++){var bg=bc.childNodes[bb];if(bg.nodeType!=1){continue}switch(bg.nodeName){case"bind_shape_matrix":var be=e(bg.textContent);this.bindShapeMatrix=ar(be);break;case"source":var bf=new aV().parse(bg);ba[bf.id]=bf;break;case"joints":a9=bg;break;case"vertex_weights":bd=bg;break;default:console.log(bg.nodeName);break}}this.parseJoints(a9,ba);this.parseWeights(bd,ba);return this};u.prototype.parseJoints=function(bc,ba){for(var bb=0;bb<bc.childNodes.length;bb++){var be=bc.childNodes[bb];if(be.nodeType!=1){continue}switch(be.nodeName){case"input":var a9=(new a()).parse(be);var bd=ba[a9.source];if(a9.semantic=="JOINT"){this.joints=bd.read()}else{if(a9.semantic=="INV_BIND_MATRIX"){this.invBindMatrices=bd.read()}}break;default:break}}};u.prototype.parseWeights=function(be,a9){var bn,bk,bh=[];for(var bf=0;bf<be.childNodes.length;bf++){var ba=be.childNodes[bf];if(ba.nodeType!=1){continue}switch(ba.nodeName){case"input":bh.push((new a()).parse(ba));break;case"v":bn=a3(ba.textContent);break;case"vcount":bk=a3(ba.textContent);break;default:break}}var bi=0;for(var bf=0;bf<bk.length;bf++){var bc=bk[bf];var bg=[];for(var bd=0;bd<bc;bd++){var bj={};for(var bb=0;bb<bh.length;bb++){var bl=bh[bb];var bm=bn[bi+bl.offset];switch(bl.semantic){case"JOINT":bj.joint=bm;break;case"WEIGHT":bj.weight=a9[bl.source].data[bm];break;default:break}}bg.push(bj);bi+=bh.length}for(var bd=0;bd<bg.length;bd++){bg[bd].index=bf}this.weights.push(bg)}};function aT(){this.id="";this.name="";this.nodes=[];this.scene=new THREE.Object3D()}aT.prototype.getChildById=function(bc,a9){for(var ba=0;ba<this.nodes.length;ba++){var bb=this.nodes[ba].getChildById(bc,a9);if(bb){return bb}}return null};aT.prototype.getChildBySid=function(a9,ba){for(var bb=0;bb<this.nodes.length;bb++){var bc=this.nodes[bb].getChildBySid(a9,ba);if(bc){return bc}}return null};aT.prototype.parse=function(ba){this.id=ba.getAttribute("id");this.name=ba.getAttribute("name");this.nodes=[];for(var a9=0;a9<ba.childNodes.length;a9++){var bb=ba.childNodes[a9];if(bb.nodeType!=1){continue}switch(bb.nodeName){case"node":this.nodes.push((new aJ()).parse(bb));break;default:break}}return this};function aJ(){this.id="";this.name="";this.sid="";this.nodes=[];this.controllers=[];this.transforms=[];this.geometries=[];this.channels=[];this.matrix=new THREE.Matrix4()}aJ.prototype.getChannelForTransform=function(bj){for(var bf=0;bf<this.channels.length;bf++){var bg=this.channels[bf];var bd=bg.target.split("/");var a9=bd.shift();var ba=bd.shift();var bh=(ba.indexOf(".")>=0);var bi=(ba.indexOf("(")>=0);var bc;var be;if(bh){bd=ba.split(".");ba=bd.shift();be=bd.shift()}else{if(bi){bc=ba.split("(");ba=bc.shift();for(var bb=0;bb<bc.length;bb++){bc[bb]=parseInt(bc[bb].replace(/\)/,""))}}}if(ba==bj){bg.info={sid:ba,dotSyntax:bh,arrSyntax:bi,arrIndices:bc};return bg}}return null};aJ.prototype.getChildById=function(bc,a9){if(this.id==bc){return this}if(a9){for(var ba=0;ba<this.nodes.length;ba++){var bb=this.nodes[ba].getChildById(bc,a9);if(bb){return bb}}}return null};aJ.prototype.getChildBySid=function(a9,ba){if(this.sid==a9){return this}if(ba){for(var bb=0;bb<this.nodes.length;bb++){var bc=this.nodes[bb].getChildBySid(a9,ba);if(bc){return bc}}}return null};aJ.prototype.getTransformBySid=function(a9){for(var ba=0;ba<this.transforms.length;ba++){if(this.transforms[ba].sid==a9){return this.transforms[ba]}}return null};aJ.prototype.parse=function(bg){var a9;this.id=bg.getAttribute("id");this.sid=bg.getAttribute("sid");this.name=bg.getAttribute("name");this.type=bg.getAttribute("type");this.layer=bg.getAttribute("layer");this.type=this.type=="JOINT"?this.type:"NODE";this.nodes=[];this.transforms=[];this.geometries=[];this.cameras=[];this.lights=[];this.controllers=[];this.matrix=new THREE.Matrix4();this.visible=true;for(var bh=0;bh<bg.childNodes.length;bh++){var bb=bg.childNodes[bh];if(bb.nodeType!=1){continue}switch(bb.nodeName){case"node":this.nodes.push((new aJ()).parse(bb));break;case"instance_camera":this.cameras.push((new aD()).parse(bb));break;case"instance_controller":this.controllers.push((new K()).parse(bb));break;case"instance_geometry":this.geometries.push((new aE()).parse(bb));break;case"instance_light":this.lights.push((new aS()).parse(bb));break;case"instance_node":a9=bb.getAttribute("url").replace(/^#/,"");var bi=R(a9);if(bi){this.nodes.push((new aJ()).parse(bi))}break;case"rotate":case"translate":case"scale":case"matrix":case"lookat":case"skew":this.transforms.push((new aO()).parse(bb));break;case"extra":var bd=bg.childNodes[bh];for(var bf=0;bf<bd.childNodes.length;bf++){if(bd.childNodes[bf].nodeName=="technique"){var ba=bd.childNodes[bf];for(var be=0;be<ba.childNodes.length;be++){var bc=ba.childNodes[be];switch(bc.nodeName){case"visibility":if(bc.textContent==0){this.visible=false}}}}}break;default:console.log(bb.nodeName);break}}this.channels=x(this);aM(this);this.updateMatrix();return this};aJ.prototype.updateMatrix=function(){this.matrix.identity();for(var a9=0;a9<this.transforms.length;a9++){this.transforms[a9].apply(this.matrix)}};function aO(){this.sid="";this.type="";this.data=[];this.obj=null}aO.prototype.parse=function(a9){this.sid=a9.getAttribute("sid");this.type=a9.nodeName;this.data=e(a9.textContent);this.convert();return this};aO.prototype.convert=function(){switch(this.type){case"matrix":this.obj=ar(this.data);break;case"rotate":this.angle=THREE.Math.degToRad(this.data[3]);case"translate":Y(this.data,-1);this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;case"scale":Y(this.data,1);this.obj=new THREE.Vector3(this.data[0],this.data[1],this.data[2]);break;default:console.log("Can not convert Transform of type "+this.type);break}};aO.prototype.apply=function(){var a9=new THREE.Matrix4();return function(ba){switch(this.type){case"matrix":ba.multiply(this.obj);break;case"translate":ba.multiply(a9.makeTranslation(this.obj.x,this.obj.y,this.obj.z));break;case"rotate":ba.multiply(a9.makeRotationAxis(this.obj,this.angle));break;case"scale":ba.scale(this.obj);break}}}();aO.prototype.update=function(bb,bc){var a9=["X","Y","Z","ANGLE"];switch(this.type){case"matrix":if(!bc){this.obj.copy(bb)}else{if(bc.length===1){switch(bc[0]){case 0:this.obj.n11=bb[0];this.obj.n21=bb[1];this.obj.n31=bb[2];this.obj.n41=bb[3];break;case 1:this.obj.n12=bb[0];this.obj.n22=bb[1];this.obj.n32=bb[2];this.obj.n42=bb[3];break;case 2:this.obj.n13=bb[0];this.obj.n23=bb[1];this.obj.n33=bb[2];this.obj.n43=bb[3];break;case 3:this.obj.n14=bb[0];this.obj.n24=bb[1];this.obj.n34=bb[2];this.obj.n44=bb[3];break}}else{if(bc.length===2){var ba="n"+(bc[0]+1)+(bc[1]+1);this.obj[ba]=bb}else{console.log("Incorrect addressing of matrix in transform.")}}}break;case"translate":case"scale":if(Object.prototype.toString.call(bc)==="[object Array]"){bc=a9[bc[0]]}switch(bc){case"X":this.obj.x=bb;break;case"Y":this.obj.y=bb;break;case"Z":this.obj.z=bb;break;default:this.obj.x=bb[0];this.obj.y=bb[1];this.obj.z=bb[2];break}break;case"rotate":if(Object.prototype.toString.call(bc)==="[object Array]"){bc=a9[bc[0]]}switch(bc){case"X":this.obj.x=bb;break;case"Y":this.obj.y=bb;break;case"Z":this.obj.z=bb;break;case"ANGLE":this.angle=THREE.Math.degToRad(bb);break;default:this.obj.x=bb[0];this.obj.y=bb[1];this.obj.z=bb[2];this.angle=THREE.Math.degToRad(bb[3]);break}break}};function K(){this.url="";this.skeleton=[];this.instance_material=[]}K.prototype.parse=function(bc){this.url=bc.getAttribute("url").replace(/^#/,"");this.skeleton=[];this.instance_material=[];for(var bb=0;bb<bc.childNodes.length;bb++){var be=bc.childNodes[bb];if(be.nodeType!==1){continue}switch(be.nodeName){case"skeleton":this.skeleton.push(be.textContent.replace(/^#/,""));break;case"bind_material":var bd=be.querySelectorAll("instance_material");for(var ba=0;ba<bd.length;ba++){var a9=bd[ba];this.instance_material.push((new i()).parse(a9))}break;case"extra":break;default:break}}return this};function i(){this.symbol="";this.target=""}i.prototype.parse=function(a9){this.symbol=a9.getAttribute("symbol");this.target=a9.getAttribute("target").replace(/^#/,"");return this};function aE(){this.url="";this.instance_material=[]}aE.prototype.parse=function(bc){this.url=bc.getAttribute("url").replace(/^#/,"");this.instance_material=[];for(var bb=0;bb<bc.childNodes.length;bb++){var be=bc.childNodes[bb];if(be.nodeType!=1){continue}if(be.nodeName=="bind_material"){var bd=be.querySelectorAll("instance_material");for(var ba=0;ba<bd.length;ba++){var a9=bd[ba];this.instance_material.push((new i()).parse(a9))}break}}return this};function aI(){this.id="";this.mesh=null}aI.prototype.parse=function(ba){this.id=ba.getAttribute("id");aN(this,ba);for(var a9=0;a9<ba.childNodes.length;a9++){var bb=ba.childNodes[a9];switch(bb.nodeName){case"mesh":this.mesh=(new aq(this)).parse(bb);break;case"extra":break;default:break}}return this};function aq(a9){this.geometry=a9.id;this.primitives=[];this.vertices=null;this.geometry3js=null}aq.prototype.parse=function(bd){this.primitives=[];var bc,bb;for(bc=0;bc<bd.childNodes.length;bc++){var be=bd.childNodes[bc];switch(be.nodeName){case"source":a6(be);break;case"vertices":this.vertices=(new ap()).parse(be);break;case"triangles":this.primitives.push((new ag().parse(be)));break;case"polygons":this.primitives.push((new G().parse(be)));break;case"polylist":this.primitives.push((new aK().parse(be)));break;default:break}}this.geometry3js=new THREE.Geometry();var ba=ah[this.vertices.input.POSITION.source].data;for(bc=0;bc<ba.length;bc+=3){this.geometry3js.vertices.push(ac(ba,bc).clone())}for(bc=0;bc<this.primitives.length;bc++){var a9=this.primitives[bc];a9.setVertices(this.vertices);this.handlePrimitive(a9,this.geometry3js)}this.geometry3js.computeCentroids();this.geometry3js.computeFaceNormals();if(this.geometry3js.calcNormals){this.geometry3js.computeVertexNormals();delete this.geometry3js.calcNormals}return this};aq.prototype.handlePrimitive=function(bg,bb){var by,bx,br=bg.p,bl=bg.inputs;var a9,bq,bc;var bk,bw;var bu=0,bs=3,bo=0;var bG=[];for(by=0;by<bl.length;by++){a9=bl[by];var bt=a9.offset+1;bo=(bo<bt)?bt:bo;switch(a9.semantic){case"TEXCOORD":bG.push(a9.set);break}}for(var bi=0;bi<br.length;++bi){var bv=br[bi],bA=0;while(bA<bv.length){var bf=[];var bz=[];var bE=null;var bm=[];if(bg.vcount){bs=bg.vcount.length?bg.vcount[bu++]:bg.vcount}else{bs=bv.length/bo}for(by=0;by<bs;by++){for(bx=0;bx<bl.length;bx++){a9=bl[bx];bk=ah[a9.source];bq=bv[bA+(by*bo)+a9.offset];bw=bk.accessor.params.length;bc=bq*bw;switch(a9.semantic){case"VERTEX":bf.push(bq);break;case"NORMAL":bz.push(ac(bk.data,bc));break;case"TEXCOORD":bE=bE||{};if(bE[a9.set]===undefined){bE[a9.set]=[]}bE[a9.set].push(new THREE.Vector2(bk.data[bc],bk.data[bc+1]));break;case"COLOR":bm.push(new THREE.Color().setRGB(bk.data[bc],bk.data[bc+1],bk.data[bc+2]));break;default:break}}}if(bz.length==0){a9=this.vertices.input.NORMAL;if(a9){bk=ah[a9.source];bw=bk.accessor.params.length;for(var bh=0,bj=bf.length;bh<bj;bh++){bz.push(ac(bk.data,bf[bh]*bw))}}else{bb.calcNormals=true}}if(!bE){bE={};a9=this.vertices.input.TEXCOORD;if(a9){bG.push(a9.set);bk=ah[a9.source];bw=bk.accessor.params.length;for(var bh=0,bj=bf.length;bh<bj;bh++){bc=bf[bh]*bw;if(bE[a9.set]===undefined){bE[a9.set]=[]}bE[a9.set].push(new THREE.Vector2(bk.data[bc],1-bk.data[bc+1]))}}}if(bm.length==0){a9=this.vertices.input.COLOR;if(a9){bk=ah[a9.source];bw=bk.accessor.params.length;for(var bh=0,bj=bf.length;bh<bj;bh++){bc=bf[bh]*bw;bm.push(new THREE.Color().setRGB(bk.data[bc],bk.data[bc+1],bk.data[bc+2]))}}}var bd=null,be=[],bp,bn;if(bs===3){be.push(new THREE.Face3(bf[0],bf[1],bf[2],bz,bm.length?bm:new THREE.Color()))}else{if(bs===4){be.push(new THREE.Face3(bf[0],bf[1],bf[3],[bz[0],bz[1],bz[3]],bm.length?[bm[0],bm[1],bm[3]]:new THREE.Color()));be.push(new THREE.Face3(bf[1],bf[2],bf[3],[bz[1],bz[2],bz[3]],bm.length?[bm[1],bm[2],bm[3]]:new THREE.Color()))}else{if(bs>4&&aj.subdivideFaces){var ba=bm.length?bm:new THREE.Color(),bD,bC,bB,bI,bH,bF;for(bx=1;bx<bs-1;){be.push(new THREE.Face3(bf[0],bf[bx],bf[bx+1],[bz[0],bz[bx++],bz[bx]],ba))}}}}if(be.length){for(var bh=0,bj=be.length;bh<bj;bh++){bd=be[bh];bd.daeMaterial=bg.material;bb.faces.push(bd);for(bx=0;bx<bG.length;bx++){bp=bE[bG[bx]];if(bs>4){bn=[bp[0],bp[bh+1],bp[bh+2]]}else{if(bs===4){if(bh===0){bn=[bp[0],bp[1],bp[3]]}else{bn=[bp[1].clone(),bp[2],bp[3].clone()]}}else{bn=[bp[0],bp[1],bp[2]]}}if(bb.faceVertexUvs[bx]===undefined){bb.faceVertexUvs[bx]=[]}bb.faceVertexUvs[bx].push(bn)}}}else{console.log("dropped face with vcount "+bs+" for geometry with id: "+bb.id)}bA+=bo*bs}}};function G(){this.material="";this.count=0;this.inputs=[];this.vcount=null;this.p=[];this.geometry=new THREE.Geometry()}G.prototype.setVertices=function(a9){for(var ba=0;ba<this.inputs.length;ba++){if(this.inputs[ba].source==a9.id){this.inputs[ba].source=a9.input.POSITION.source}}};G.prototype.parse=function(ba){this.material=ba.getAttribute("material");this.count=p(ba,"count",0);for(var a9=0;a9<ba.childNodes.length;a9++){var bb=ba.childNodes[a9];switch(bb.nodeName){case"input":this.inputs.push((new a()).parse(ba.childNodes[a9]));break;case"vcount":this.vcount=a3(bb.textContent);break;case"p":this.p.push(a3(bb.textContent));break;case"ph":console.warn("polygon holes not yet supported!");break;default:break}}return this};function aK(){G.call(this);this.vcount=[]}aK.prototype=Object.create(G.prototype);function ag(){G.call(this);this.vcount=3}ag.prototype=Object.create(G.prototype);function aL(){this.source="";this.count=0;this.stride=0;this.params=[]}aL.prototype.parse=function(ba){this.params=[];this.source=ba.getAttribute("source");this.count=p(ba,"count",0);this.stride=p(ba,"stride",0);for(var a9=0;a9<ba.childNodes.length;a9++){var bc=ba.childNodes[a9];if(bc.nodeName=="param"){var bb={};bb.name=bc.getAttribute("name");bb.type=bc.getAttribute("type");this.params.push(bb)}}return this};function ap(){this.input={}}ap.prototype.parse=function(bb){this.id=bb.getAttribute("id");for(var ba=0;ba<bb.childNodes.length;ba++){if(bb.childNodes[ba].nodeName=="input"){var a9=(new a()).parse(bb.childNodes[ba]);this.input[a9.semantic]=a9}}return this};function a(){this.semantic="";this.offset=0;this.source="";this.set=0}a.prototype.parse=function(a9){this.semantic=a9.getAttribute("semantic");this.source=a9.getAttribute("source").replace(/^#/,"");this.set=p(a9,"set",-1);this.offset=p(a9,"offset",0);if(this.semantic=="TEXCOORD"&&this.set<0){this.set=0}return this};function aV(a9){this.id=a9;this.type=null}aV.prototype.parse=function(bb){this.id=bb.getAttribute("id");for(var ba=0;ba<bb.childNodes.length;ba++){var bc=bb.childNodes[ba];switch(bc.nodeName){case"bool_array":this.data=ao(bc.textContent);this.type=bc.nodeName;break;case"float_array":this.data=e(bc.textContent);this.type=bc.nodeName;break;case"int_array":this.data=a3(bc.textContent);this.type=bc.nodeName;break;case"IDREF_array":case"Name_array":this.data=M(bc.textContent);this.type=bc.nodeName;break;case"technique_common":for(var a9=0;a9<bc.childNodes.length;a9++){if(bc.childNodes[a9].nodeName=="accessor"){this.accessor=(new aL()).parse(bc.childNodes[a9]);break}}break;default:break}}return this};aV.prototype.read=function(){var ba=[];var bd=this.accessor.params[0];switch(bd.type){case"IDREF":case"Name":case"name":case"float":return this.data;case"float4x4":for(var bb=0;bb<this.data.length;bb+=16){var bc=this.data.slice(bb,bb+16);var a9=ar(bc);ba.push(a9)}break;default:console.log("ColladaLoader: Source: Read dont know how to read "+bd.type+".");break}return ba};function c(){this.id="";this.name="";this.instance_effect=null}c.prototype.parse=function(ba){this.id=ba.getAttribute("id");this.name=ba.getAttribute("name");for(var a9=0;a9<ba.childNodes.length;a9++){if(ba.childNodes[a9].nodeName=="instance_effect"){this.instance_effect=(new D()).parse(ba.childNodes[a9]);break}}return this};function av(){this.color=new THREE.Color();this.color.setRGB(Math.random(),Math.random(),Math.random());this.color.a=1;this.texture=null;this.texcoord=null;this.texOpts=null}av.prototype.isColor=function(){return(this.texture==null)};av.prototype.isTexture=function(){return(this.texture!=null)};av.prototype.parse=function(bb){if(bb.nodeName=="transparent"){this.opaque=bb.getAttribute("opaque")}for(var ba=0;ba<bb.childNodes.length;ba++){var bc=bb.childNodes[ba];if(bc.nodeType!=1){continue}switch(bc.nodeName){case"color":var a9=e(bc.textContent);this.color=new THREE.Color();this.color.setRGB(a9[0],a9[1],a9[2]);this.color.a=a9[3];break;case"texture":this.texture=bc.getAttribute("texture");this.texcoord=bc.getAttribute("texcoord");this.texOpts={offsetU:0,offsetV:0,repeatU:1,repeatV:1,wrapU:1,wrapV:1};this.parseTexture(bc);break;default:break}}return this};av.prototype.parseTexture=function(bb){if(!bb.childNodes){return this}if(bb.childNodes[1]&&bb.childNodes[1].nodeName==="extra"){bb=bb.childNodes[1];if(bb.childNodes[1]&&bb.childNodes[1].nodeName==="technique"){bb=bb.childNodes[1]}}for(var ba=0;ba<bb.childNodes.length;ba++){var bc=bb.childNodes[ba];switch(bc.nodeName){case"offsetU":case"offsetV":case"repeatU":case"repeatV":this.texOpts[bc.nodeName]=parseFloat(bc.textContent);break;case"wrapU":case"wrapV":if(bc.textContent.toUpperCase()==="TRUE"){this.texOpts[bc.nodeName]=1}else{this.texOpts[bc.nodeName]=parseInt(bc.textContent)}break;case"blend_color":var a9=e(bc.textContent);this.texOpts[bc.nodeName]=new THREE.Color(0);this.texOpts[bc.nodeName].setRGB(a9[0],a9[1],a9[2]);this.texOpts[bc.nodeName].a=a9[3];break;break;default:this.texOpts[bc.nodeName]=bc.textContent;break}}return this};function aA(ba,a9){this.type=ba;this.effect=a9;this.material=null}aA.prototype.parse=function(ba){for(var a9=0;a9<ba.childNodes.length;a9++){var bc=ba.childNodes[a9];if(bc.nodeType!=1){continue}switch(bc.nodeName){case"ambient":case"emission":case"diffuse":case"specular":case"reflective":case"transparent":this[bc.nodeName]=(new av()).parse(bc);break;case"shininess":case"reflectivity":case"index_of_refraction":case"transparency":var bb=bc.querySelectorAll("float");if(bb.length>0){this[bc.nodeName]=parseFloat(bb[0].textContent)}break;default:break}}return this};aA.prototype.create=function(){var bi={};var bm=false;if(this["transparency"]!==undefined&&this["transparent"]!==undefined){var ba=this["transparent"];var bl=(this.transparent.color.r+this.transparent.color.g+this.transparent.color.b)/3*this.transparency;if(bl<1){bm=true;bi.transparent=true;bi.opacity=bl}}for(var a9 in this){switch(a9){case"ambient":case"emission":case"diffuse":case"specular":var bk=this[a9];if(bk instanceof av){if(bk.isTexture()){var bc=bk.texture;var bj=this.effect.sampler[bc];if(bj!==undefined&&bj.source!==undefined){var bb=this.effect.surface[bj.source];var bd=n[bb.init_from];if(bd){var bh=THREE.ImageUtils.loadTexture(bd.init_from);bh.wrapS=bk.texOpts.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping;bh.wrapT=bk.texOpts.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping;bh.offset.x=bk.texOpts.offsetU;bh.offset.y=bk.texOpts.offsetV;bh.repeat.x=bk.texOpts.repeatU;bh.repeat.y=bk.texOpts.repeatV;bi.map=bh;if(bk.texOpts.blend_color!=undefined){bi.diffuse=bk.texOpts.blend_color.getHex()}if(a9==="emission"){bi.emissive=16777215}}}}else{if(a9==="diffuse"||!bm){if(a9==="emission"){bi.emissive=bk.color.getHex()}else{bi[a9]=bk.color.getHex()}}}}break;case"shininess":bi[a9]=this[a9];break;case"reflectivity":bi[a9]=this[a9];if(navigator.appName=="Microsoft Internet Explorer"||navigator.appName=="Netscape"&&(new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)!=null)){if(bi[a9]>0){bi.envMap=aj.defaultEnvMap}}bi.combine=THREE.MixOperation;break;case"index_of_refraction":bi.refractionRatio=this[a9];if(this[a9]!==1){bi.envMap=aj.defaultEnvMap}break;case"transparency":break;case"bump":var bk=this[a9];if(bk instanceof av){if(bk.isTexture()){var bc=bk.texture;var bj=this.effect.sampler[bc].source;if(bj){var bb=this.effect.surface[bj];var bd=n[bb.init_from];if(bd){var bh=THREE.ImageUtils.loadTexture(bd.init_from);bh.wrapS=bk.texOpts.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping;bh.wrapT=bk.texOpts.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping;bh.offset.x=bk.texOpts.offsetU;bh.offset.y=bk.texOpts.offsetV;bh.repeat.x=bk.texOpts.repeatU;bh.repeat.y=bk.texOpts.repeatV;if(navigator.appName=="Microsoft Internet Explorer"||navigator.appName=="Netscape"&&(new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent)!=null)){}else{bi.bumpMap=bh}}}}}break;case"bump_scale":bi.bumpScale=this[a9]/20;break;case"reflective":var bk=this[a9];if(bk instanceof av){if(bk.isTexture()){var bc=bk.texture;var bj=this.effect.sampler[bc].source;if(bj){var bb=this.effect.surface[bj];var bd=n[bb.init_from];var be=bb.init_from;if(bd){if(!(be in a1)){var bg=THREE.ImageUtils.loadTexture(bd.init_from);var bf=new THREE.WebGLRenderTargetCube(256,256,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});bi.envMap=bf;a1[be]=bg;I[be]=bf}else{bi.envMap=I[be]}}}}}break;default:break}}bi.shading=W;bi.side=this.effect.doubleSided?THREE.DoubleSide:THREE.FrontSide;switch(this.type){case"constant":if(bi.emissive!=undefined){bi.color=bi.emissive}this.material=new THREE.MeshBasicMaterial(bi);break;case"phong":case"blinn":if(bi.diffuse!=undefined){bi.color=bi.diffuse}this.material=new THREE.MeshPhongMaterial(bi);break;case"lambert":default:if(bi.diffuse!=undefined){bi.color=bi.diffuse}this.material=new THREE.MeshLambertMaterial(bi);break}return this.material};function b(a9){this.effect=a9;this.init_from=null;this.format=null}b.prototype.parse=function(ba){for(var a9=0;a9<ba.childNodes.length;a9++){var bb=ba.childNodes[a9];if(bb.nodeType!=1){continue}switch(bb.nodeName){case"init_from":this.init_from=bb.textContent;break;case"format":this.format=bb.textContent;break;default:console.log("unhandled Surface prop: "+bb.nodeName);break}}return this};function T(a9){this.effect=a9;this.source=null;this.wrap_s=null;this.wrap_t=null;this.minfilter=null;this.magfilter=null;this.mipfilter=null}T.prototype.parse=function(ba){for(var a9=0;a9<ba.childNodes.length;a9++){var bb=ba.childNodes[a9];if(bb.nodeType!=1){continue}switch(bb.nodeName){case"source":this.source=bb.textContent;break;case"minfilter":this.minfilter=bb.textContent;break;case"magfilter":this.magfilter=bb.textContent;break;case"mipfilter":this.mipfilter=bb.textContent;break;case"wrap_s":this.wrap_s=bb.textContent;break;case"wrap_t":this.wrap_t=bb.textContent;break;default:console.log("unhandled Sampler2D prop: "+bb.nodeName);break}}return this};function U(){this.id="";this.name="";this.shader=null;this.surface={};this.sampler={}}U.prototype.create=function(){if(this.shader==null){return null}this.shader.create()};U.prototype.parse=function(ba){this.id=ba.getAttribute("id");this.name=ba.getAttribute("name");aN(this,ba);this.shader=null;for(var a9=0;a9<ba.childNodes.length;a9++){var bb=ba.childNodes[a9];if(bb.nodeType!=1){continue}switch(bb.nodeName){case"profile_COMMON":this.parseProfileCOMMON(bb);break;default:break}}this.create();return this};U.prototype.parseNewparam=function(bb){var a9=bb.getAttribute("sid");for(var ba=0;ba<bb.childNodes.length;ba++){var bc=bb.childNodes[ba];if(bc.nodeType!=1){continue}switch(bc.nodeName){case"surface":this.surface[a9]=(new b(this)).parse(bc);break;case"sampler2D":this.sampler[a9]=(new T(this)).parse(bc);break;case"extra":break;default:console.log(bc.nodeName);break}}};U.prototype.parseProfileCOMMON=function(bb){var bc;for(var ba=0;ba<bb.childNodes.length;ba++){var bd=bb.childNodes[ba];if(bd.nodeType!=1){continue}switch(bd.nodeName){case"profile_COMMON":this.parseProfileCOMMON(bd);break;case"technique":this.parseTechnique(bd);break;case"newparam":this.parseNewparam(bd);break;case"image":var a9=(new ak()).parse(bd);n[a9.id]=a9;break;case"extra":this.parseExtra(bd);break;default:console.log(bd.nodeName);break}}return bc};U.prototype.parseTechnique=function(ba){for(var a9=0;a9<ba.childNodes.length;a9++){var bb=ba.childNodes[a9];if(bb.nodeType!=1){continue}switch(bb.nodeName){case"constant":case"lambert":case"blinn":case"phong":this.shader=(new aA(bb.nodeName,this)).parse(bb);break;default:break}}};U.prototype.parseExtra=function(bb){for(var ba=0;ba<bb.childNodes.length;ba++){var bd=bb.childNodes[ba];if(bd.nodeType!=1){continue}for(var a9=0;a9<bd.childNodes.length;a9++){var bc=bd.childNodes[a9];switch(bc.nodeName){case"bump":this.shader[bc.nodeName]=(new av()).parse(bc);break;case"bump_scale":this.shader[bc.nodeName]=parseFloat(bc.textContent);break;default:break}}}};function D(){this.url=""}D.prototype.parse=function(a9){this.url=a9.getAttribute("url").replace(/^#/,"");return this};function a0(){this.id="";this.name="";this.source={};this.sampler=[];this.channel=[]}a0.prototype.parse=function(bb){this.id=bb.getAttribute("id");this.name=bb.getAttribute("name");this.source={};for(var ba=0;ba<bb.childNodes.length;ba++){var be=bb.childNodes[ba];if(be.nodeType!=1){continue}switch(be.nodeName){case"animation":var bc=(new a0()).parse(be);for(var bd in bc.source){this.source[bd]=bc.source[bd]}for(var a9=0;a9<bc.channel.length;a9++){this.channel.push(bc.channel[a9]);this.sampler.push(bc.sampler[a9])}break;case"source":var bd=(new aV()).parse(be);this.source[bd.id]=bd;break;case"sampler":this.sampler.push((new L(this)).parse(be));break;case"channel":this.channel.push((new S(this)).parse(be));break;default:break}}return this};function S(a9){this.animation=a9;this.source="";this.target="";this.fullSid=null;this.sid=null;this.dotSyntax=null;this.arrSyntax=null;this.arrIndices=null;this.member=null}S.prototype.parse=function(bb){this.source=bb.getAttribute("source").replace(/^#/,"");this.target=bb.getAttribute("target");var bd=this.target.split("/");var bg=bd.shift();var a9=bd.shift();var bf=(a9.indexOf(".")>=0);var bc=(a9.indexOf("(")>=0);if(bf){bd=a9.split(".");this.sid=bd.shift();this.member=bd.shift()}else{if(bc){var be=a9.split("(");this.sid=be.shift();for(var ba=0;ba<be.length;ba++){be[ba]=parseInt(be[ba].replace(/\)/,""))}this.arrIndices=be}else{this.sid=a9}}this.fullSid=a9;this.dotSyntax=bf;this.arrSyntax=bc;return this};function L(a9){this.id="";this.animation=a9;this.inputs=[];this.input=null;this.output=null;this.strideOut=null;this.interpolation=null;this.startTime=null;this.endTime=null;this.duration=0}L.prototype.parse=function(ba){this.id=ba.getAttribute("id");this.inputs=[];for(var a9=0;a9<ba.childNodes.length;a9++){var bb=ba.childNodes[a9];if(bb.nodeType!=1){continue}switch(bb.nodeName){case"input":this.inputs.push((new a()).parse(bb));break;default:break}}return this};L.prototype.create=function(){for(var ba=0;ba<this.inputs.length;ba++){var a9=this.inputs[ba];var bb=this.animation.source[a9.source];switch(a9.semantic){case"INPUT":this.input=bb.read();break;case"OUTPUT":this.output=bb.read();this.strideOut=bb.accessor.stride;break;case"INTERPOLATION":this.interpolation=bb.read();break;case"IN_TANGENT":break;case"OUT_TANGENT":break;default:console.log(a9.semantic);break}}this.startTime=0;this.endTime=0;this.duration=0;if(this.input.length){this.startTime=100000000;this.endTime=-100000000;for(var ba=0;ba<this.input.length;ba++){this.startTime=Math.min(this.startTime,this.input[ba]);this.endTime=Math.max(this.endTime,this.input[ba])}this.duration=this.endTime-this.startTime}};L.prototype.getData=function(bb,a9){var bc;if(bb==="matrix"&&this.strideOut===16){bc=this.output[a9]}else{if(this.strideOut>1){bc=[];a9*=this.strideOut;for(var ba=0;ba<this.strideOut;++ba){bc[ba]=this.output[a9+ba]}if(this.strideOut===3){switch(bb){case"rotate":case"translate":Y(bc,-1);break;case"scale":Y(bc,1);break}}else{if(this.strideOut===4&&bb==="matrix"){Y(bc,-1)}}}else{bc=this.output[a9]}}return bc};function an(a9){this.targets=[];this.time=a9}an.prototype.addTarget=function(bc,a9,bb,ba){this.targets.push({sid:bc,member:bb,transform:a9,data:ba})};an.prototype.apply=function(a9){for(var ba=0;ba<this.targets.length;++ba){var bb=this.targets[ba];if(!a9||bb.sid===a9){bb.transform.update(bb.data,bb.member)}}};an.prototype.getTarget=function(ba){for(var a9=0;a9<this.targets.length;++a9){if(this.targets[a9].sid===ba){return this.targets[a9]}}return null};an.prototype.hasTarget=function(ba){for(var a9=0;a9<this.targets.length;++a9){if(this.targets[a9].sid===ba){return true}}return false};an.prototype.interpolate=function(bi,bb){for(var bf=0;bf<this.targets.length;++bf){var bh=this.targets[bf],a9=bi.getTarget(bh.sid),be;if(bh.transform.type!=="matrix"&&a9){var bc=(bb-this.time)/(bi.time-this.time),bg=a9.data,ba=bh.data;if(bc<0||bc>1){console.log("Key.interpolate: Warning! Scale out of bounds:"+bc);bc=bc<0?0:1}if(ba.length){be=[];for(var bd=0;bd<ba.length;++bd){be[bd]=ba[bd]+(bg[bd]-ba[bd])*bc}}else{be=ba+(bg-ba)*bc}}else{be=bh.data}bh.transform.update(be,bh.member)}};function aX(){this.id="";this.name="";this.technique=""}aX.prototype.parse=function(bc){this.id=bc.getAttribute("id");this.name=bc.getAttribute("name");for(var bb=0;bb<bc.childNodes.length;bb++){var bf=bc.childNodes[bb];if(bf.nodeType!=1){continue}switch(bf.nodeName){case"optics":this.parseOptics(bf);break;case"extra":for(var bb=0;bb<bf.childNodes.length;bb++){if(bf.childNodes[bb].nodeName=="technique"){var bd=bf.childNodes[bb];for(var ba=0;ba<bd.childNodes.length;ba++){var be=bd.childNodes[ba];switch(be.nodeName){case"camera_target":var a9=e(be.textContent);this.camera_target=ac(a9,0);break;case"camera_position":var a9=e(be.textContent);this.camera_position=ac(a9,0);break;case"camera_up":var a9=e(be.textContent);this.camera_up=ac(a9,0);break}}}}break;default:break}}return this};aX.prototype.parseOptics=function(bd){for(var bc=0;bc<bd.childNodes.length;bc++){if(bd.childNodes[bc].nodeName=="technique_common"){var bf=bd.childNodes[bc];for(var bb=0;bb<bf.childNodes.length;bb++){this.technique=bf.childNodes[bb].nodeName;if(this.technique=="perspective"){var be=bf.childNodes[bb];for(var a9=0;a9<be.childNodes.length;a9++){var bg=be.childNodes[a9];switch(bg.nodeName){case"yfov":this.yfov=bg.textContent;break;case"xfov":this.xfov=bg.textContent;break;case"znear":this.znear=bg.textContent;break;case"zfar":this.zfar=bg.textContent;break;case"aspect_ratio":this.aspect_ratio=bg.textContent;break}}}else{if(this.technique=="orthographic"){var ba=bf.childNodes[bb];for(var a9=0;a9<ba.childNodes.length;a9++){var bg=ba.childNodes[a9];switch(bg.nodeName){case"xmag":this.xmag=bg.textContent;break;case"ymag":this.ymag=bg.textContent;break;case"znear":this.znear=bg.textContent;break;case"zfar":this.zfar=bg.textContent;break;case"aspect_ratio":this.aspect_ratio=bg.textContent;break}}}}}}}return this};function aD(){this.url=""}aD.prototype.parse=function(a9){this.url=a9.getAttribute("url").replace(/^#/,"");return this};function ax(){this.id="";this.name="";this.technique=""}ax.prototype.parse=function(ba){this.id=ba.getAttribute("id");this.name=ba.getAttribute("name");for(var a9=0;a9<ba.childNodes.length;a9++){var bb=ba.childNodes[a9];if(bb.nodeType!=1){continue}switch(bb.nodeName){case"technique_common":this.parseCommon(bb);break;case"extra":this.parseTechnique(bb);break;default:break}}return this};ax.prototype.parseCommon=function(bd){for(var bc=0;bc<bd.childNodes.length;bc++){switch(bd.childNodes[bc].nodeName){case"directional":case"point":case"spot":case"ambient":this.technique=bd.childNodes[bc].nodeName;var a9=bd.childNodes[bc];for(var ba=0;ba<a9.childNodes.length;ba++){var be=a9.childNodes[ba];switch(be.nodeName){case"color":var bb=e(be.textContent);this.color=new THREE.Color(0);this.color.setRGB(bb[0],bb[1],bb[2]);this.color.a=bb[3];break;case"falloff_angle":this.falloff_angle=parseFloat(be.textContent);break}}}}return this};ax.prototype.parseTechnique=function(ba){this.profile=ba.getAttribute("profile");for(var a9=0;a9<ba.childNodes.length;a9++){var bb=ba.childNodes[a9];switch(bb.nodeName){case"technique":this.intensity=parseFloat(bb.textContent);break}}return this};function aS(){this.url=""}aS.prototype.parse=function(a9){this.url=a9.getAttribute("url").replace(/^#/,"");return this};function a6(a9){var ba=a9.getAttribute("id");if(ah[ba]!=undefined){return ah[ba]}ah[ba]=(new aV(ba)).parse(a9);return ah[ba]}function a5(a9){if(a9=="dae"){return"http://www.collada.org/2005/11/COLLADASchema"}return null}function ao(bd){var ba=M(bd);var bc=[];for(var bb=0,a9=ba.length;bb<a9;bb++){bc.push((ba[bb]=="true"||ba[bb]=="1")?true:false)}return bc}function e(bd){var ba=M(bd);var bc=[];for(var bb=0,a9=ba.length;bb<a9;bb++){bc.push(parseFloat(ba[bb]))}return bc}function a3(bd){var ba=M(bd);var bc=[];for(var bb=0,a9=ba.length;bb<a9;bb++){bc.push(parseInt(ba[bb],10))}return bc}function M(a9){return(a9.length>0)?y(a9).split(/\s+/):[]}function y(a9){return a9.replace(/^\s+/,"").replace(/\s+$/,"")}function a7(bb,ba,a9){if(bb.hasAttribute(ba)){return parseFloat(bb.getAttribute(ba))}else{return a9}}function p(bb,ba,a9){if(bb.hasAttribute(ba)){return parseInt(bb.getAttribute(ba),10)}else{return a9}}function aQ(bb,ba,a9){if(bb.hasAttribute(ba)){return bb.getAttribute(ba)}else{return a9}}function a8(bb,a9){if(bb===undefined){var ba="0.";while(ba.length<a9+2){ba+="0"}return ba}a9=a9||2;var bc=bb.toString().split(".");bc[1]=bc.length>1?bc[1].substr(0,a9):"0";while(bc[1].length<a9){bc[1]+="0"}return bc.join(".")}function aN(bb,a9){bb.doubleSided=true;var ba=a9.querySelectorAll("extra double_sided")[0];if(ba){if(ba&&parseInt(ba.textContent,10)===1){bb.doubleSided=true}}}function ab(){if(!aj.convertUpAxis||aC===aj.upAxis){F=null}else{switch(aC){case"X":F=aj.upAxis==="Y"?"XtoY":"XtoZ";break;case"Y":F=aj.upAxis==="X"?"YtoX":"YtoZ";break;case"Z":F=aj.upAxis==="X"?"ZtoX":"ZtoY";break}}}function Y(bb,a9){if(!aj.convertUpAxis||aC===aj.upAxis){return}switch(F){case"XtoY":var ba=bb[0];bb[0]=a9*bb[1];bb[1]=ba;break;case"XtoZ":var ba=bb[2];bb[2]=bb[1];bb[1]=bb[0];bb[0]=ba;break;case"YtoX":var ba=bb[0];bb[0]=bb[1];bb[1]=a9*ba;break;case"YtoZ":var ba=bb[1];bb[1]=a9*bb[2];bb[2]=ba;break;case"ZtoX":var ba=bb[0];bb[0]=bb[1];bb[1]=bb[2];bb[2]=ba;break;case"ZtoY":var ba=bb[1];bb[1]=bb[2];bb[2]=a9*ba;break}}function ac(ba,bb){var a9=[ba[bb],ba[bb+1],ba[bb+2]];Y(a9,-1);return new THREE.Vector3(a9[0],a9[1],a9[2])}function ar(ba){if(aj.convertUpAxis){var a9=[ba[0],ba[4],ba[8]];Y(a9,-1);ba[0]=a9[0];ba[4]=a9[1];ba[8]=a9[2];a9=[ba[1],ba[5],ba[9]];Y(a9,-1);ba[1]=a9[0];ba[5]=a9[1];ba[9]=a9[2];a9=[ba[2],ba[6],ba[10]];Y(a9,-1);ba[2]=a9[0];ba[6]=a9[1];ba[10]=a9[2];a9=[ba[0],ba[1],ba[2]];Y(a9,-1);ba[0]=a9[0];ba[1]=a9[1];ba[2]=a9[2];a9=[ba[4],ba[5],ba[6]];Y(a9,-1);ba[4]=a9[0];ba[5]=a9[1];ba[6]=a9[2];a9=[ba[8],ba[9],ba[10]];Y(a9,-1);ba[8]=a9[0];ba[9]=a9[1];ba[10]=a9[2];a9=[ba[3],ba[7],ba[11]];Y(a9,-1);ba[3]=a9[0];ba[7]=a9[1];ba[11]=a9[2]}return new THREE.Matrix4(ba[0],ba[1],ba[2],ba[3],ba[4],ba[5],ba[6],ba[7],ba[8],ba[9],ba[10],ba[11],ba[12],ba[13],ba[14],ba[15])}function aH(ba){if(ba>-1&&ba<3){var a9=["X","Y","Z"],bb={X:0,Y:1,Z:2};ba=aa(a9[ba]);ba=bb[ba]}return ba}function aa(a9){if(aj.convertUpAxis){switch(a9){case"X":switch(F){case"XtoY":case"XtoZ":case"YtoX":a9="Y";break;case"ZtoX":a9="Z";break}break;case"Y":switch(F){case"XtoY":case"YtoX":case"ZtoX":a9="X";break;case"XtoZ":case"YtoZ":case"ZtoY":a9="Z";break}break;case"Z":switch(F){case"XtoZ":a9="X";break;case"YtoZ":case"ZtoX":case"ZtoY":a9="Y";break}break}}return a9}return{load:h,parse:at,setPreferredShading:J,applySkin:a2,geometries:ay,options:aj}};
</script>
<script type="text/javascript">
THREE.TrackballControls=function(C,B){THREE.EventDispatcher.call(this);var s=this;var t={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM:4,TOUCH_PAN:5};var a={ScreenLift:0,ScreenTop:0,ScreenWidth:0,ScreenHeight:0};this.object=C;this.domElement=(B!==undefined)?B:document;this.enabled=true;this.screen={left:0,top:0,width:0,height:0};this.radius=(this.screen.width+this.screen.height)/4;this.rotateSpeed=1;this.zoomSpeed=1.2;this.panSpeed=0.3;this.noRotate=false;this.noZoom=false;this.noPan=false;this.noRoll=false;this.staticMoving=false;this.dynamicDampingFactor=0.2;this.minDistance=0;this.maxDistance=Infinity;this.keys=[65,83,68];this.navMode="Rotate";this.keepCameraAboveGround=false;this.target=new THREE.Vector3();if(this.object.hasOwnProperty("cameraTarget")){this.target=this.object.cameraTarget.clone()}var k=new THREE.Vector3();var u=t.NONE,n=t.NONE,b=new THREE.Vector3(),q=new THREE.Vector3(),j=new THREE.Vector3(),l=new THREE.Vector2(),x=new THREE.Vector2(),i=0,c=0,d=new THREE.Vector2(),w=new THREE.Vector2();this.target0=this.target.clone();this.position0=this.object.position.clone();this.up0=this.object.up.clone();var A={type:"change"};var m={type:"start"};var h={type:"end"};this.SetScreenSize=function(E,F,D,G){a.ScreenLift=E;a.ScreenTop=F;a.ScreenWidth=D;a.creenHeight=G};this.checkOnScreen=function(D,E){if(D<a.ScreenLift||D>(a.ScreenLift+a.ScreenWidth)){return false}if(E<a.ScreenTop||E>(a.ScreenTop+a.creenHeight)){return false}return true};this.handleResize=function(){if(this.domElement===document){this.screen.left=0;this.screen.top=0;this.screen.width=window.innerWidth;this.screen.height=window.innerHeight}else{this.screen=this.domElement.getBoundingClientRect();var D=this.domElement.ownerDocument.documentElement;this.screen.left+=window.pageXOffset-D.clientLeft;this.screen.top+=window.pageYOffset-D.clientTop}};this.handleEvent=function(D){if(typeof this[D.type]=="function"){this[D.type](D)}};this.getMouseOnScreen=function(F,E,D){return(D||new THREE.Vector2()).set((F-s.screen.left)/s.screen.width,(E-s.screen.top)/s.screen.height)};this.getMouseProjectionOnBall=(function(){var D=new THREE.Vector3();return function(H,G,E){var F=new THREE.Vector3((H-s.screen.width*0.5-s.screen.left)/(s.screen.width*0.5),(s.screen.height*0.5+s.screen.top-G)/(s.screen.height*0.5),0);var I=F.length();if(s.noRoll){if(I<Math.SQRT1_2){F.z=Math.sqrt(1-I*I)}else{F.z=0.5/I}}else{if(I>1){F.normalize()}else{F.z=Math.sqrt(1-I*I)}}b.copy(s.object.position).sub(s.target);E.copy(s.object.up).setLength(F.y);E.add(D.copy(s.object.up).cross(b).setLength(F.x));E.add(b.setLength(F.z));return E}}());this.applyAngle=function(E,G,D,F){if(G){quaternion=new THREE.Quaternion();G*=D;quaternion.setFromAxisAngle(E,-G);if(s.keepCameraAboveGround){cameraPosition=b.clone();cameraPosition.applyQuaternion(quaternion);zAxis=new THREE.Vector3(0,0,1);if(cameraPosition.dot(zAxis)<=0){return}}b.applyQuaternion(quaternion);s.object.up.applyQuaternion(quaternion);j.applyQuaternion(quaternion);if(F){q.copy(j)}else{quaternion.setFromAxisAngle(E,G*(s.dynamicDampingFactor-1));q.applyQuaternion(quaternion)}}};this.forceFixedAxis=function(H,F){var I=s.object.up.clone();var N=b.clone();var E=(new THREE.Vector3()).crossVectors(N,I).normalize();var K=(new THREE.Vector3()).crossVectors(N,H);var J=(new THREE.Vector3()).crossVectors(I,H);var D=(K.lengthSq()>J.lengthSq())?K:J;if(D.dot(E)<0){D.multiplyScalar(-1)}var M=(new THREE.Vector3()).crossVectors(D,E).normalize();var G=E.angleTo(D);this.applyAngle(M,G,1,true);if(!F){var L=s.object.up.clone();if(L.dot(H)<0){this.applyAngle(D,Math.PI,1,true)}}};this.rotateCamera=function(){if(q.equals(j)){return}var J=Math.acos(q.dot(j)/q.length()/j.length());var I=(new THREE.Vector3()).crossVectors(q,j).normalize(),F=s.navMode==="Spin";trackballMode=s.navMode==="Rotate";if(trackballMode){s.applyAngle(I,J,s.rotateSpeed,s.staticMoving)}else{if(F){rotateSpeed=4;staticMoving=true;fixedAxis=new THREE.Vector3(0,0,1);var E=s.object.up.clone();var G=b.clone();var H=(new THREE.Vector3()).crossVectors(G,E).normalize();s.forceFixedAxis(fixedAxis,false);projectedStart=q.clone();projectedStart.projectOnPlane(E);projectedStart.normalize();projectedEnd=j.clone();projectedEnd.projectOnPlane(E);projectedEnd.normalize();angleYaw=Math.acos(projectedStart.dot(projectedEnd));if(I.dot(E)<0){angleYaw=-angleYaw}projectedStart=q.clone();projectedStart.projectOnPlane(H);projectedStart.normalize();projectedEnd=j.clone();projectedEnd.projectOnPlane(H);projectedEnd.normalize();anglePitch=Math.acos(projectedStart.dot(projectedEnd));if(I.dot(H)<0){anglePitch=-anglePitch}var D=E.clone();D.applyAxisAngle(H,-anglePitch*rotateSpeed);if(D.dot(fixedAxis)<0){anglePitch=0}s.applyAngle(H,anglePitch,rotateSpeed,staticMoving);s.applyAngle(fixedAxis,angleYaw,rotateSpeed,staticMoving)}}};this.zoomCamera=function(){if(u===t.TOUCH_ZOOM){var D=i/c;i=c;b.multiplyScalar(D)}else{var D=1+(x.y-l.y)*s.zoomSpeed;if(D!==1&&D>0){b.multiplyScalar(D);if(s.staticMoving){l.copy(x)}else{l.y+=(x.y-l.y)*this.dynamicDampingFactor}}}};this.panCamera=(function(){var E=new THREE.Vector2(),D=new THREE.Vector3(),F=new THREE.Vector3();return function(){E.copy(w).sub(d);if(E.lengthSq()){E.multiplyScalar(b.length()*s.panSpeed);F.copy(b).cross(s.object.up).setLength(E.x);F.add(D.copy(s.object.up).setLength(E.y));s.object.position.add(F);s.target.add(F);if(s.staticMoving){d.copy(w)}else{d.add(E.subVectors(w,d).multiplyScalar(s.dynamicDampingFactor))}}}}());this.checkDistances=function(){if(!s.noZoom||!s.noPan){if(b.lengthSq()>s.maxDistance*s.maxDistance){s.object.position.addVectors(s.target,b.setLength(s.maxDistance))}if(b.lengthSq()<s.minDistance*s.minDistance){s.object.position.addVectors(s.target,b.setLength(s.minDistance))}}};this.update=function(){b.subVectors(s.object.position,s.target);if(!s.noRotate){s.rotateCamera()}if(!s.noZoom){s.zoomCamera()}if(!s.noPan){s.panCamera()}s.object.position.addVectors(s.target,b);s.checkDistances();s.object.lookAt(s.target);if(k.distanceToSquared(s.object.position)>0){s.dispatchEvent(A);k.copy(s.object.position)}};this.reset=function(){u=t.NONE;n=t.NONE;s.target.copy(s.target0);s.object.position.copy(s.position0);s.object.up.copy(s.up0);b.subVectors(s.object.position,s.target);s.object.lookAt(s.target);s.dispatchEvent(A);k.copy(s.object.position)};function g(D){if(s.enabled===false){return}window.removeEventListener("keydown",g);n=u;if(u!==t.NONE){return}else{if(D.keyCode===s.keys[t.ROTATE]&&!s.noRotate){u=t.ROTATE}else{if(D.keyCode===s.keys[t.ZOOM]&&!s.noZoom){u=t.ZOOM}else{if(D.keyCode===s.keys[t.PAN]&&!s.noPan){u=t.PAN}}}}}function e(D){if(s.enabled===false){return}u=n;window.addEventListener("keydown",g,false)}function p(D){if(s.enabled===false){return}D.preventDefault();D.stopPropagation();if(u===t.NONE){u=D.button}if(u===t.ROTATE&&!s.noRotate){q=s.getMouseProjectionOnBall(D.pageX,D.pageY,q);j.copy(q)}else{if(u===t.ZOOM&&!s.noZoom){l=s.getMouseOnScreen(D.pageX,D.pageY,l);x.copy(l)}else{if(u===t.PAN&&!s.noPan){d=s.getMouseOnScreen(D.pageX,D.pageY,d);w.copy(d)}}}document.addEventListener("mousemove",y,false);document.addEventListener("mouseup",r,false);s.dispatchEvent(m)}function y(D){if(s.enabled===false){return}D.preventDefault();D.stopPropagation();if(u===t.ROTATE&&!s.noRotate){j=s.getMouseProjectionOnBall(D.pageX,D.pageY,j)}else{if(u===t.ZOOM&&!s.noZoom){x=s.getMouseOnScreen(D.pageX,D.pageY,x)}else{if(u===t.PAN&&!s.noPan){w=s.getMouseOnScreen(D.pageX,D.pageY,w)}}}}function r(D){if(s.enabled===false){return}D.preventDefault();D.stopPropagation();u=t.NONE;document.removeEventListener("mousemove",y);document.removeEventListener("mouseup",r);s.dispatchEvent(h)}function o(D){if(s.enabled===false){return}D.preventDefault();D.stopPropagation();var E=0;if(D.wheelDelta){E=D.wheelDelta/40}else{if(D.detail){E=-D.detail/3}}l.y+=E*0.01;s.dispatchEvent(m);s.dispatchEvent(h)}function v(F){if(s.enabled===false){return}switch(F.touches.length){case 1:u=t.TOUCH_ROTATE;j.copy(s.getMouseProjectionOnBall(F.touches[0].pageX,F.touches[0].pageY,q));break;case 2:u=t.TOUCH_ZOOM;var E=F.touches[0].pageX-F.touches[1].pageX;var D=F.touches[0].pageY-F.touches[1].pageY;c=i=Math.sqrt(E*E+D*D);break;case 3:u=t.TOUCH_PAN;w.copy(s.getMouseOnScreen(F.touches[0].pageX,F.touches[0].pageY,d));break;default:u=t.NONE}s.dispatchEvent(m)}function f(F){if(s.enabled===false){return}F.preventDefault();F.stopPropagation();switch(F.touches.length){case 1:j=s.getMouseProjectionOnBall(F.touches[0].pageX,F.touches[0].pageY,j);break;case 2:var E=F.touches[0].pageX-F.touches[1].pageX;var D=F.touches[0].pageY-F.touches[1].pageY;c=Math.sqrt(E*E+D*D);break;case 3:w=s.getMouseOnScreen(F.touches[0].pageX,F.touches[0].pageY,w);break;default:u=t.NONE}}function z(D){if(s.enabled===false){return}switch(D.touches.length){case 1:q.copy(s.getMouseProjectionOnBall(D.touches[0].pageX,D.touches[0].pageY,j));break;case 2:i=c=0;break;case 3:d.copy(s.getMouseOnScreen(D.touches[0].pageX,D.touches[0].pageY,w));break}u=t.NONE;s.dispatchEvent(h)}this.domElement.addEventListener("contextmenu",function(D){D.preventDefault()},false);this.domElement.addEventListener("mousedown",p,false);this.domElement.addEventListener("mousewheel",o,false);this.domElement.addEventListener("DOMMouseScroll",o,false);this.domElement.addEventListener("touchstart",v,false);this.domElement.addEventListener("touchend",z,false);this.domElement.addEventListener("touchmove",f,false);window.addEventListener("keydown",g,false);window.addEventListener("keyup",e,false);this.handleResize()};THREE.TrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype);
</script>

<script type="text/javascript">
o139 = THREE;o298= o139.ImageUtils;o299 = o139.Matrix4;o140 = o139.Vector3;o300 = o139.Color;o152 = o139.Scene;if (typeof Object.create == 'undefined'){Object.create = function ( o301 ){function o302() {}o302.prototype = o301;return new o302();};}function o303(){Object.defineProperty(this, "name",{get : function(){if(this.o304)return this.o304.name;if(this.o305)return this.o305.name;},set : function(o306){if(this.o304)this.o304.name = o306;if(this.o305)this.o305.name= o306;},enumerable : true,configurable : true});};function o29(o307){o303.call(this);this.o305;Object.defineProperty(this, "diffuseColor",{get : function(){return this.o305.color;},set : function(o306){},enumerable : true,configurable : true});Object.defineProperty(this, "ambientColor",{get : function(){return this.o305.ambient;},set : function(o306){},enumerable : true,configurable : true});Object.defineProperty(this, "emissiveColor",{get : function(){return this.o305.emissive;},set : function(o306){},enumerable : true,configurable : true});Object.defineProperty(this, "specularColor",{get : function(){return this.o305.specular;},set : function(o306){},enumerable : true,configurable : true});this.ambientTexture= new o308();this.opacityTexture = new o308();this.emissiveTexture = new o308();this.phongExponent= 0;this.diffuseTexture = new o308();this.diffuseTexture.o309=1;this.bumpTexture    = new o308();this.bumpTexture.o309=2;this.reflectionTexture= new o308();this.reflectionTexture.o309= 3;Object.defineProperty(this, "opacity",{get : function(){return this.o305.opacity;},set : function(o306){this.o305.opacity = o306;this.o305.needsUpdate=true;},enumerable : true,configurable : true});Object.defineProperty(this, "reflectionStrength",{get : function(){return this.o305.reflectivity;},set : function(o306){this.o305.reflectivity = o306;this.o305.needsUpdate=true;},enumerable : true,configurable : true});Object.defineProperty(this, "specularStrength",{get : function(){return this.o305.shininess;},set : function(o306){this.o305.shininess = o306;this.o305.needsUpdate=true;},enumerable : true,configurable : true});if(o307){this.o310(o307);}};o29.prototype = Object.create(o303.prototype);o29.prototype.o310 = function( o305 ){this.o305 = o305;this.diffuseTexture.o305 = o305;this.bumpTexture.o305 = o305;this.reflectionTexture.o305 = o305;};function Color(red, green, blue ){o300.call(this);if(red != undefined &&	green!= undefined  && blue!= undefined ){this.setRGB(red, green, blue);}else{this.setRGB(0,0,0);}};Color.prototype = Object.create(o300.prototype);function o308(){this.o305;this.o309= -1;this.angle;this.clampU;this.clampV;this.modulate;this.uOffset;this.uScale;this.use3DSStyleMapping;this.vOffset;this.vScale;Object.defineProperty(this, "amount",{get: function (){amount = 0;if (this.o309 == 1){if (this.o305.map == null)amount = 0;else{amount = 1; }}if (this.o309 == 2){if (this.o305.bumpMap == null)amount = 0;else{ amount = 1;}}if (this.o309 == 3){if (this.o305.envMap == null)amount = 0;else{ amount = 1;}}return amount;},set: function (o306) {amount = o306;if (amount == 0) {if (this.o309 == 1) {this.o305.map = null;}if (this.o309 == 2) {this.o305.bumpMap = null;}if (this.o309 == 3) {this.o305.envMap = null;}}},enumerable: true,configurable: true});Object.defineProperty(this, "image",{get: function () {if (this.o309 == -1){return null;}if (this.o309 == 1){image = null;if (this.o305.map != null)image = this.o305.map;}else if (this.o309 == 2){image = null;if (this.o305.bumpMap != null){image = this.o305.bumpMap;}}else if (this.o309 == 3){image = null;if (this.o305.envMap != null){image = this.o305.envMap;}}return image;},set: function (o306) {if (this.o309 == -1){image = o306;return;}if (this.o309 == 1){this.o305.map = o306;image = o306;}else if (this.o309 == 2){this.o305.bumpMap = o306;image = o306;}else if (this.o309 == 3){this.o305.envMap = o306;image = o306;}this.o305.needsUpdate = true;},enumerable: true,configurable: true});};o308.prototype.setPath = function(o311){if(this.o309==1){o312 = o298.loadTexture(o311 );this.o305.map = o312;}if(this.o309==2){o313 = o298.loadTexture(o311 );this.o305.bumpMap = o313;}if(this.o309==3){o314 = o298.loadTexture(o311 );this.o305.envMap = o314;}this.o305.needsUpdate=true;};function o316(o315){o303.call(this);this.o304;Object.defineProperty(this, "visible", {get : function(){ return this.o304.visible; },set : function(o306){this.o304.visible = o306;},enumerable : true,configurable : true});this.o317 = new Matrix4x4();Object.defineProperty(this, "transform",{get : function(){return this.o317;},set : function(o306){},enumerable : true,configurable : true});this.o319 = function(o318){this.o304 = o318;this.o317.o304 = o318;};if(o315){this.o319(o315);}};o316.prototype = Object.create(o303.prototype);function o321(o320){o316.call(this);Object.defineProperty(this, "brightness", {get : function(){return this.o304.intensity;},set : function(o306){this.o304.intensity = o306;},enumerable : true,configurable : true});Object.defineProperty(this, "color", {get : function(){return this.o304.color;},set : function(o306){},enumerable : true,configurable : true});if(o320){this.o319(o320);}};o321.prototype = Object.create(o316.prototype);function o323(o322){o316.call(this);this.up;this.position;this.targetPosition;Object.defineProperty(this, "fov", {get : function(){return this.o304.fov;},set : function(o306){this.o304.fov = o306;},enumerable : true,configurable : true});if(o322){this.o319(o322);this.up=o322.up;this.targetPosition =  o322.cameraTarget;this.position = o322.position;}};o323.prototype = Object.create(o316.prototype);function o325(o324){o316.call(this);this.material=new o29();if(o324){this.o319(o324);this.material.o310(o324.material);}};o325.prototype = Object.create(o316.prototype);function Matrix4x4(){this.o304;this.o326=new o299();this.scaleInPlace = function(o327,o328,o329){this.o304.scale.x = o327;this.o304.scale.y = o328;this.o304.scale.z = o329;this.o304.updateMatrix();};this.scale = function(o327,o328,o329){var o330=new Vector3(o327,o328,o329);var o331 = new o299();o331.copy(this.o304.matrix);o331.scale(o330);return o331;};this.set= function(o332, o333, o334, o335, o336, o337, o338, o339, o340, o341, o342, o343, o344, o345, o346, o347 ){if(typeof o333 === "undefined"){var o348 = o349(o332);}else{var o348 = o350(o332, o333, o334, o335, o336, o337, o338, o339, o340, o341, o342, o343, o344, o345, o346, o347);}if(this.o304==null){this.o326=o348;return this.o326;}else{o348.transpose();this.o304.matrixAutoUpdate  = false;this.o304.matrix=o348;this.o304.updateMatrixWorld(true);}};this.translateInPlace= function(o218){this.o304.translateX(o218.x);this.o304.translateY(o218.y);this.o304.translateZ(o218.z);};this.translate= function(o218){var o351 = new o299();o351.copy(this.o304.matrix);o351.translate(o218);return o351;};this.transformPosition= function(o218){var o351 = new o299();o351.copy(this.o304.matrix);var o352= new o140(o218.x,o218.y,o218.z);o352.getPositionFromMatrix(o351);return o352;};this.multiply= function(o353){var o354 = new o299();o354.copy(this.o304.matrix);o354.multiply(o353.o326);return o354;};function o350(o332, o333, o334, o335, o336, o337, o338, o339, o340, o341, o342, o343, o344, o345, o346, o347 ){var o355 = new o299(o332, o333, o334, o335, o336, o337, o338, o339, o340, o341, o342, o343, o344, o345, o346, o347 );return o355;};function o349(o356){var  o332 = o356[0];var  o333 = o356[1];var  o334 = o356[2];var  o335 = o356[3];var  o336 = o356[4];var  o337 = o356[5];var  o338 = o356[6];var  o339 = o356[7];var  o340 = o356[8];var  o341 = o356[9];var  o342 = o356[10];var  o343 = o356[11];var  o344 = o356[12];var  o345 = o356[13];var  o346 = o356[14];var  o347 = o356[15];var o357= new o299(o332, o333, o334, o335, o336, o337, o338, o339, o340, o341, o342, o343, o344, o345, o346, o347 );return o357;};};function Vector3(o327,o328,o329){this.o358 = new o140(o327,o328,o329);Object.defineProperty(this, "x", {   get : function(){ return this.o358.x; },set : function(o306){this.o358.x = o306;},enumerable : true,configurable : true});Object.defineProperty(this, "y", {get : function(){ return this.o358.y; },set : function(o306){this.o358.y = o306;},enumerable : true,configurable : true});Object.defineProperty(this, "z", {get : function(){ return this.o358.z; },set : function(o306){this.o358.z = o306;},enumerable : true,configurable : true});this.set = function(o327,o328,o329){this.o358.x=  o327;this.o358.y=  o328;this.o358.z=  o329;};this.clone= function(){return new Vector3( this.x, this.y, this.z );};};function o360 (o359){this.o361;this.o195;this.o27;this.o362= [];this.o364 = function (o363){if(o363.o239 == "materials"){o363.o365();}else if(o363.o239 == "lights"){o363.o366();}else if(o363.o239 == "cameras"){o363.o367();}else if(o363.o239 == "meshes"){o363.o368();}else if(o363.o239 == "nodes"){o363.o369();}};Object.defineProperty(this, "count",{get : function(){if(this.o362.length ==0){this.o364(this);}return this.o362.length;},set : function(o306){},enumerable : true,configurable : true});this.getByIndex = function(o370){if( this.o362.length == 0 ){this.o364(this);}if( o370 >= 0 && o370 < this.o362.length ){return this.o362[o370];}};if(o359 =="material"){this.getByName = function(o371){var o372 = 0;this.o361.traverse(  function ( o189 ){if ( o189.material && o189.material.name === o371 ){o372=new o29(o189.material);}});if(o372 == 0){for(var i=0;i<this.o195.length;i++){if(o371 === this.o195[i].name){o372=new o29(this.o195[i]);}}}return o372;};}if(o359 =="camera"){this.getByName = function(o373){var o374 ;var o322 = this.o361.getChildByName(o373, true);if (  o322.name==o373 ){var o374 = new o323(o322);}return o374;};}if(o359 =="mesh"){this.getByName = function(o375){var o376 ;var o324 = this.o361.getChildByName(o375, true);if (  o324.name==o375 ){var o376 = new o325(o324);}return o376;};}if(o359 =="node"){this.getByName = function(o377){var o315 = this.o361.getChildByName(o377, true);var o378 = this.o79(o315);var o379 ;if ( o315.name==o377 ){if (  o378=="Node" ){o379 = new o316(o315);}else if (o378 == "Light"){o379 = new o321(o315);}else if (o378 == "Camera"){o379 = new o323(o315);}else if (o378 == "Mesh"){o379 = new o325(o315);}if	(o379){return o379;}}};}if(o359 =="light"){this.getByName = function(o380){var o381 ;var o320 = this.o361.getChildByName(o380, true);if (  o320.name==o380 ){var o381 = new o321(o320);}return o381;};}this.o79 = function(o382){if(o382.hasOwnProperty("intensity")==true){return "Light";}else if(o382.hasOwnProperty("fov")==true){return "Camera";}else if(o382.hasOwnProperty("material")==true){return "Mesh";}else{return "Node";}};this.update = function(){this.o362=[];};this.o365 = function(){var o383={};var	o384=0;var o372;this.o361.traverse( function ( o189 ){o372 = 0;if ( o189.material){if(!o383.hasOwnProperty(o189.material.id)){o383[o189.material.id]= o384;o372=new o29(o189.material);this.scene.materials.o362.push( o372 );}}});};this.o367 = function(){this.o361.traverse( function ( o189 ){var o378 = this.scene.nodes.o79(o189);var o374 ;if(o378 == "Camera"){o374 = new o323(o189);this.scene.cameras.o362.push( o374 );}});};this.o366 = function(){this.o361.traverse( function ( o189 ){var o378 = this.scene.nodes.o79(o189);var o381 ;if(o378 == "Light"){o381 = new o321(o189);this.scene.lights.o362.push( o381 );}});};this.o368 = function(){this.o361.traverse( function ( o189 ){var o378 = this.scene.nodes.o79(o189);var o376 ;if(o378 == "Mesh"){o376 = new o325(o189);this.scene.meshes.o362.push( o376 );}});};this.o369 = function(){this.o361.traverse( function ( o189 ){var o378 = this.scene.nodes.o79(o189);var o379 ;if(o378 == "Node"){o379 = new o316(o189);}else if(o378 == "Light"){o379 = new o321(o189);}else if(o378 == "Camera"){o379 = new o323(o189);}else if(o378 == "Mesh"){o379 = new o325(o189);}if(o379){this.scene.nodes.o362.push( o379 );}});};};function o203(){this.o385 = new Array();this.setView = function(o386, o387){var o388 = o199( this.o385[o386] );o234(o388);};this.o204 = function( o389 ){this.o385 = o389;};this.o390 = 1.0;Object.defineProperty(this, "versionOfSimLab",{get : function(){return this.o390;},set : function(){},enumerable : true,configurable : true});};function o187 (){this.o77;this.o77 = new o152();this.o195 = new Array();this.o27 = new Array();this.materials       = new o360("material");this.materials.o239  = "materials";this.materials.o361 = this.o77;this.materials.o195 = this.o195;this.materials.o27 = this.o27;this.cameras		   = new o360("camera");this.cameras.o239	   = "cameras";this.cameras.o361   = this.o77;this.nodes		   = new o360("node");this.nodes.o239	   = "nodes";this.nodes.o361	   = this.o77;this.lights		   = new o360("light");this.lights.o239     = "lights";this.lights.o361    = this.o77;this.meshes		   = new o360("mesh");this.meshes.o239     = "meshes";this.meshes.o361    = this.o77;this.update = function(){this.materials.update();this.cameras.update();this.nodes.update();this.lights.update();this.meshes.update();};};
</script>

<script type="text/javascript">
o2={o3 : function( destColor, srcColor ){destColor.r= srcColor.r;destColor.g= srcColor.g;destColor.b= srcColor.b;},o4 : function( destTexture, srcTexture ){destTexture.amount= srcTexture.amount;try{if( srcTexture.amount != 0 ){destTexture.image= srcTexture.image;}var x = 0;if(x!=0){}}catch(err){destTexture.amount=0;srcTexture.amount=0;}if( srcTexture.amount == 0 ){destTexture.image=null;}destTexture.angle= srcTexture.angle;destTexture.clampU= srcTexture.clampU;destTexture.clampV= srcTexture.clampV;destTexture.modulate= srcTexture.modulate;destTexture.uOffset= srcTexture.uOffset;destTexture.uScale= srcTexture.uScale;destTexture.use3DSStyleMapping= srcTexture.use3DSStyleMapping;destTexture.vOffset= srcTexture.vOffset;destTexture.vScale= srcTexture.vScale;},o5 : function( destMtl, srcMtl ){this.o3(destMtl.ambientColor, srcMtl.ambientColor);this.o4(destMtl.ambientTexture, srcMtl.ambientTexture);this.o4(destMtl.bumpTexture, srcMtl.bumpTexture);this.o3(destMtl.diffuseColor, srcMtl.diffuseColor);this.o4(destMtl.diffuseTexture, srcMtl.diffuseTexture);this.o3(destMtl.emissiveColor, srcMtl.emissiveColor);this.o4(destMtl.emissiveTexture, srcMtl.emissiveTexture);destMtl.opacity= srcMtl.opacity;this.o4(destMtl.opacityTexture, srcMtl.opacityTexture);destMtl.phongExponent= srcMtl.phongExponent;destMtl.reflectionStrength= srcMtl.reflectionStrength;this.o4(destMtl.reflectionTexture, srcMtl.reflectionTexture);this.o3(destMtl.specularColor, srcMtl.specularColor);destMtl.specularStrength= srcMtl.specularStrength;}};function o6(){this.o7= [];this.o8= function(){for( i=0, count= this.o7.length; i<count; ++i ){this.o7[i].o8();}}};function o9(){this.o10= new Array( 0 );this.o11 = -1;this.o12 = false;this.o13 = 1;this.o14 = 1;for( var i=0, count= this.o10.length; i<count; ++i ){this.o10[i]= new o6();}this.o15= [];this.o16= [];this.o17= [];this.o18= [];this.o19= 0;this.o20 = false;this.o21= function(){for( var i=0, count= this.o15.length; i<count; i+=2 ){var o22= this.o15[i];var o23= this.o15[i+1];for( var k=0, kCount= o22.length; k<kCount; ++k ){var o24= o22[k];var o25= scene.nodes.getByIndex( o24 );var o26= o23[ this.o19 ];o25.transform.set( o26 );}}for( var i=0, count= this.o16.length; i<count; i+=2 ){var o24= this.o16[i];var o25= scene.materials.getByIndex( o24 );var o23= this.o16[i+1];var o26= scene.o27[o23[this.o19]];var o28 =new o29(o26);o2.o5( o25, o28 );}for( var i=0, count= this.o17.length; i<count; i+=2 ){var o22= this.o17[i];var o23= this.o17[i+1];for( var k=0, kCount= o22.length; k<kCount; ++k ){var o24= o22[k];var o25= scene.nodes.getByIndex( o24 );var o26= o23[ this.o19 ] != 0 ? true : false;if( o25.visible != o26 ){o25.visible= o26;}}}for( var i=0, count= this.o18.length; i<count; i+=2 ){var o22= this.o18[i];var o23= this.o18[i+1];for( var k=0, kCount= o22.length; k<kCount; ++k ){var o24= o22[k];var o25= scene.nodes.getByIndex( o24 );var o30= o23[ this.o19 ];o25.brightness= o30[3];o25.color.r= o30[0];o25.color.g= o30[1];o25.color.b= o30[2];}}if( 101 > 0 ){var o31= 0 + this.o19+ 0 ;runtime.setView( o31, false );}};o32=true;this.o35= function(/*o32,o33,o34*/){/*if (o34 != this.o36){switch (o32){case true :break;case false :this.o19= o33[0];break;}this.o36= o34;}*/if (o32){if( this.o19 >= this.o10.length-1 ){if ( this.o11 == -1 ){switch (this.o12){case true :this.o13= -1;break;case false :this.o19= 0;this.o13= 1;break;}}else if ( this.o11 != -1){this.o13= 0;this.o19 = 0;this.o20 = true;}}if( this.o19 == 0 && this.o11 != 1){this.o13= 1;}switch ( this.o13 ){case 1 :++this.o19;break;case -1 :--this.o19;break;}}else if (!o32){if( this.o19 >= o33[1] ){if ( this.o11 == -1 ){switch (this.o12){case true :this.o13= -1;break;case false :this.o19= o33[0];this.o13= 1;break;}}else if ( this.o11 != -1){this.o13= 0;this.o20 = true;}}if( this.o19 == o33[0] ){this.o13= 1;}switch ( this.o13 ){case 1 :++this.o19;break;case -1 :--this.o19;break;}}this.o21();this.o14 = o32;};this.o37= function(/*o32,o33,o34*/){this.o35(/*o32,o33,o34*/);};};function o38(){this.m_currentSequenceReference = "";this.m_numberOfSequenceAnimationFrames = 0;this.o39 = 1;var isSequenceAnimationSwingJSConst = false;this.o12 = isSequenceAnimationSwingJSConst;this.o13 = 1;this.o14 = 1;this.o40= [];this.o41= [];this.o42= [];this.o43= [];this.o44= 0;this.o20 = false;this.o46= function(o45){o47 = [];o48 = [];o49 = [];o50 = [];for( var i=0, count= this.o40.length; i<count; i+=2 ){if(this.o40[i] == o45){o47 = this.o40[i+1];}}for (var i = 0, count = this.o41.length; i < count; i += 2){if (this.o41[i] == o45){o48 = this.o41[i + 1];}}for (var i = 0, count = this.o42.length; i < count; i += 2){if (this.o42[i] == o45){o49 = this.o42[i + 1];}}for (var i = 0, count = this.o43.length; i < count; i += 2){if (this.o43[i] == o45){o50 = this.o43[i + 1];}}for( var i=0, count= o47.length; i<count; i+=2 ){var o22= o47[i];var o23= o47[i+1];for( var k=0, kCount= o22.length; k<kCount; ++k ){var o24= o22[k];var o25= scene.nodes.getByIndex( o24 );var o26= o23[ this.o44 ];o25.transform.set( o26 );}}for( var i=0, count= o48.length; i<count; i+=2 ){var o24= o48[i];var o25= scene.materials.getByIndex( o24 );var o23= o48[i+1];var o26= scene.o27[o23[this.o44]];var o28 =new o29(o26);o2.o5( o25, o28 );}for( var i=0, count= o49.length; i<count; i+=2 ){var o22= o49[i];var o23= o49[i+1];for( var k=0, kCount= o22.length; k<kCount; ++k ){var o24= o22[k];var o25= scene.nodes.getByIndex( o24 );var o26= o23[ this.o44 ] != 0 ? true : false;if( o25.visible != o26 ){o25.visible= o26;}}}for( var i=0, count= o50.length; i<count; i+=2 ){var o22= o50[i];var o23= o50[i+1];for( var k=0, kCount= o22.length; k<kCount; ++k ){var o24= o22[k];var o25= scene.nodes.getByIndex( o24 );var o30= o23[ this.o44 ];o25.brightness= o30[3];o25.color.r= o30[0];o25.color.g= o30[1];o25.color.b= o30[2];}}};o32=true;this.o51= function(o45/*o32,o33,o34*/){/*if (o34 != this.o36){switch (o32){case true :break;case false :this.o44= o33[0];break;}this.o36= o34;}*/if (o32){if( this.o44 >= this.m_numberOfSequenceAnimationFrames - 1 ){if ( this.o39 == -1 ){switch (this.o12){case true :this.o13= -1;break;case false :this.o44= 0;this.o13= 1;break;}}else if ( this.o39 != -1){this.o13= 0;this.o20 = true;}}if( this.o44 == 0 && this.o39 != 1){this.o13= 1;}switch ( this.o13 ){case 1 :++this.o44;break;case -1 :--this.o44;break;}}else if (!o32){if( this.o44 >= o33[1] ){if ( this.o39 == -1 ){switch (this.o12){case true :this.o13= -1;break;case false :this.o44= o33[0];this.o13= 1;break;}}else if ( this.o39 != -1){this.o13= 0;this.o20 = true;}}if( this.o44 == o33[0] ){this.o13= 1;}switch ( this.o13 ){case 1 :++this.o44;break;case -1 :--this.o44;break;}}this.o46(o45);this.o14 = o32;};this.o53= function(o45,o52/*,o32,o33,o34*/){this.m_currentSequenceReference = o45;var o54 = [];for( var i=0, count= o54.length; i<count; i+=1 ){var o55 = o54[i];if(o55[0] == o45){this.m_numberOfSequenceAnimationFrames  = o55[1];break;}}if(o52 == true){this.o39 = -1;}if(o52 == false){this.o39 = 1;}this.o51(o45/*,o32,o33,o34*/);};this.SeekSequenceToEnd= function(){numberOfSequenceAnimationFrames = this.m_numberOfSequenceAnimationFrames;this.o44 = numberOfSequenceAnimationFrames - 1;this.o46(this.m_currentSequenceReference);this.o20 = true;};};function o56(){this.o57 = {};this.o58 = {};this.o59 = {};this.o60 = null;this.o61 = null;this.o62 = false;this.o63 = {r:0.25, g:0.25, b:0.25};this.o65= function(o64){if ( o64.length > 0 ){for( var i = 0; i< o64.length; ++i ){if( o64[ i ].object.visible == true){var o24 = o64[ i ].object.index;break;}}this.o66(o24,o64);this.o67(o24,o64);}else{if ( this.o60 ){this.o60.material = this.o60.currentHex;}this.o60 = null;this.o68();this.o61 = null;}};this.o67= function(o24, o64){if(this.o57.hasOwnProperty(o24) ){if ( this.o60 != o64[ 0 ].object ){if ( this.o60 ){this.o60.material = this.o60.currentHex;}this.o60 = o64[ 0 ].object;this.o60.currentHex = this.o60.material;var o69 = this.o60.material.clone();o2.o3(o69.emissive,this.o63);this.o60.material = o69;}}else{if ( this.o60 ){this.o60.material = this.o60.currentHex;}this.o60 = null;}};this.o66= function(o24 , o64){if( this.o58.hasOwnProperty( o24 ) ){if(this.o61 != o64[ 0 ].object){if ( this.o61 ){this.o68();}this.o61 = o64[ 0 ].object;var o70 = this.o58[o24];for (var key in this.o58){if (this.o58.hasOwnProperty(key)){if(this.o58[key] == o70){var o71 = Number(key);this.o72(o71);}}}}}else{if ( this.o61 ){this.o68();}this.o61 = null;}};this.o73= function(){this.o62 = true;for (var key in this.o57){if (this.o57.hasOwnProperty(key)){var o71 = Number(key);this.o72(o71);}}for (var key in this.o58){if (this.o58.hasOwnProperty(key)){var o71 = Number(key);this.o72(o71);}}};this.o74= function(){if(this.o62 == true){this.o68();this.o62 = false;}};this.o68= function(){for (var key in this.o59){if (this.o59.hasOwnProperty(key)){var o75 = this.o59[key];var o76;scene.o77.traverse(  function ( o78 ){if(o78.index == key){if(scene.nodes.o79(o78) == "Mesh"){o76 = o78;}}});o76.material = o75;}}this.o59 = {};};this.o72= function(o71){var o80 = null;scene.o77.traverse(  function ( o78 ){if(o78.index == o71){if(scene.nodes.o79(o78) == "Mesh"){o80 = o78;}}});if(o80 != null){var o75 = o80.material;var o69 = o80.material.clone();o2.o3(o69.emissive,this.o63);o80.material = o69;this.o59[o80.index] = o75;}};};function o81(){this.o82 = false;this.o83= [];this.o84= [];this.o85= [];this.o86= [];this.o87= [];this.o88= [];this.o89= [];this.o90= [];this.o91= [];this.o92= [];this.o93= [];this.o94= [];this.o95= [];this.o96= [];this.o97= 0;this.o98= 0;this.o99= false;this.o100= false;};o81.prototype.o104 = function ( o101, o102, o103 ){if( ! this.o82 ){return;}o105= this.o83.length;if( o101 < 0  || o101 >= o105 ){return;}o106= this.o92[o101];if( o106 ){o107= this.o83[o101];o108= this.o84[o101];for( i=0, count= o107.length; i<count; ++i ){o109= o107[i];o110= o108[i];try{o111= scene.nodes.getByIndex( o109 );o111.transform.set( o110 );}catch(err){}}}o112= this.o93[o101];if( o112 ){o113= this.o87[o101];o114= this.o88[o101];for( i=0, count= o113.length; i<count; ++i ){o115= o113[i];o116= o114[i];try{o117= scene.materials.getByName( o115 );o118= scene.materials.getByName( o116 );o2.o5( o117, o118 );}catch(err){}}o119.o60.currentHex = o119.o60.material;}o120= this.o94[o101];if( o120 ){o121= this.o89[o101];o122= this.o90[o101];o123= this.o91[o101];for( i=0, count= o121.length; i<count; ++i ){o124= o121[i];try{o125= scene.nodes.getByIndex( o124 );o125.brightness= o122[i];o125.color.r= o123[i][0];o125.color.g= o123[i][1];o125.color.b= o123[i][2];}catch(err){}}}o126= this.o95[o101];if(o126){o127= this.o85[o101];o128= this.o86[o101];for( i=0, count= o127.length; i<count; ++i ){o129=o127[i];o130=o128[i];try{o131=scene.nodes.getByIndex(o129);o131.visible=o130;}catch(err){}}}o132= this.o96[o101];if( o132 && ! this.o98 ){if( o103 ){o133= o101 + this.o97;this.o100= true;runtime.setView( o133, o102 );}}};o81.prototype.o134 = function (){};o81.prototype.o136 = function ( o135 ){if( ! this.o82 ){return;}if( this.o100 ){this.o100= false;return;}if( o135 == -1 ){return;}if( o135 < this.o97 ){return;}o101= o135 - this.o97;this.o104( o101, false, false );};o81.prototype.o138 = function ( o137 ){if( ! this.o82 ){return;}this.o104( o137, this.o99, true );};
</script>
<script type="text/javascript">
o139 = THREE;o140 = o139.Vector3;o141 = o139.ColladaLoader;o142 = o139.TrackballControls;o143 = o139.DirectionalLight;o144 = o139.Projector;o145 = o139.WebGLRenderer;o146 = o139.Raycaster;o147 = o139.CubeCamera;o148 = o139.Mesh;o149 = o139.SphereGeometry;o150 = o139.MeshBasicMaterial;o151 = o139.PerspectiveCamera;o152 = o139.Scene;var o153 , o154, scene, o155 , o156 ,o157;var o158 = { o159: 0, o160: 0 }, o161;var o162 = [];var o163 = {};var o164 = {};var o165 = new o141();var o166;var o167= {};var o168 = {};var o169 = false ;var o170 = [];var o171 = [];var o172 = [];var o173 = [];var o174 = false;var globalCounter = 0 ;var playAnimationAtStart= 1.000000000000000;var billboards = [];var sceneCantainsBillboards;function unzipToBlobAndLoad(){var blob;var TEXT_CONTENT;var blobURL;var zipFs = new zip.fs.FS();zipFs.importHttpContent('./test-3d_files/test-3d.zip'/*"./x_files/x.zip"*/, false, function(){var firstEntry = zipFs.root.children[0];firstEntry.getText(function(data){blob = new Blob([data], { type: "text/xml"});TEXT_CONTENT = data;blobURL = URL.createObjectURL(blob);console.log(blobURL);document.getElementById("progressText").innerHTML = "Loading...";o165.load(blobURL/*'./test-3d_files/test-3d.zip'*/, function (o175) {o164 = o175;o156 = o175.scene;o156.scale.x = o156.scale.y = o156.scale.z = 1;o156.updateMatrix();o162 = o175.dae.materials;o163 = o175.dae.effects;init();setTimeout(function() { HideProgressBar();}, 500);o176();for (var i=0; i<o170.length; ++i ){var o177= o170[i];var o178 = scene.materials.getByName( o177 );o178.opacity = 1;}for (var i=0; i<o171.length; ++i ){var o177= o171[i];var o178 = scene.materials.getByName( o177 );o178.diffuseTexture.amount= 0;o178.diffuseTexture.image= null;}for (var i=0; i<o172.length; ++i ){var o177= o172[i];var o178 = scene.materials.getByName( o177 );o178.reflectionTexture.amount= 0;o178.reflectionTexture.image= null;}for (var i=0; i<o173.length; ++i ){var o177= o173[i];var o178 = scene.materials.getByName( o177 );o178.bumpTexture.amount= 0;o178.bumpTexture.image= null;}});});}, onerror);}function o179(){var o180 = document.getElementById("bdy");var o181 = document.getElementById( 'Object3D' );var o182 = parseInt(o181.style.left) + parseInt(o180.style.left) ;var o183 = o180.style.top;var o184 = parseInt(o180.style.top);if (o183.indexOf("%") >= 0){var o185 = o184 / 100;o184 = o185 * window.innerHeight;}var o186 = parseInt(o181.style.top) + o184;return { 'annotLeft': o182, 'annotTop': o186 };}function init() {o153 = document.getElementById( 'Object3D' );scene = new o187();scene.o77.add( o156 );var o188=0;scene.o77.traverse(  function ( o189 ){o189.index = o188;o188++;});scene.o77.traverse(  function ( o189 ) {if(o189.name.search('_SLCBB0x2340d0') > -1) {billboards.push(o189);}if(billboards.length == 0){sceneCantainsBillboards = false;}else{sceneCantainsBillboards = true;}});var o190=0;for (var o191 in o162){var o192 = o162[ o191 ];o193 = o194(o192,o163);scene.o195[o190] = o193;++o190;}var o196=0;for (var o191 in o162){var o192 = o162[ o191 ];o193 = o194(o192,o163);scene.o27[o196] = o193;++o196;}var o197 = 'Camera1';var o198 = o156.getChildByName(o197,true);var undefined;if (o198 === undefined){o166 = o199(o197);}else{o166 = new o151(o198.fov, o198.aspect, o198.near, o198.far);o166.cameraTarget = o198.cameraTarget.clone();o166.up = o198.up.clone();o166.position = o198.position.clone();}o166.aspect = 580 / 390;o166.updateProjectionMatrix();scene.o77.add( o166 );o200 = new o142(o166);o200.navMode= "Rotate";o200.keepCameraAboveGround= false;window.onresize();var o201 =  o179();o200.SetScreenSize(o201.annotLeft,o201.annotTop,580,390);if ( 1 ){var o202 = new o143(0xffffff);o166.add(o202);}o157 = new o144();o155 = new o145({ antialias: true, alpha:true });o155.setSize( 580, 390);o153.appendChild( o155.domElement );runtime = new o203();runtime.o204([]);document.addEventListener( 'mousedown', o205, false );document.addEventListener( 'mouseup', o206, false );document.addEventListener( 'mousemove', o207, false );if(false && playAnimationAtStart){o208.PlayAnimationAtStart();}};function o210(o209){if(o200.checkOnScreen(o209.clientX, o209.clientY)=== false) return;o209.preventDefault();var o180 = document.getElementById("bdy");var o181 = document.getElementById( 'Object3D' );var o182 = parseInt(o181.style.left) + parseInt(o180.style.left) ;var o183 = o180.style.top;var o184 = parseInt(o180.style.top);if (o183.indexOf("%") >= 0){var o185 = o184 / 100;o184 = o185 * window.innerHeight;}var o186 = parseInt(o181.style.top) + o184;var o211 = o209.clientX - o182 ;var o212 = o209.clientY - o186;o158.o159 = ( o211 /  580 ) * 2 - 1;o158.o160 = -( o212 / 390 ) * 2 + 1;o213(o158.o159 , o158.o160);};function updateBillboardsToFaceCam(){if( sceneCantainsBillboards ){var VecteurCameraXPositonCam = ( (o166.cameraTarget.x) - (o166.position.x) );var VecteurCameraYPositonCam = ( (o166.cameraTarget.y) - (o166.position.y) );var VecteurCameraZPositonCam = ( (o166.cameraTarget.z) - (o166.position.z) );if ((VecteurCameraYPositonCam > 0 & VecteurCameraXPositonCam > 0) | (VecteurCameraYPositonCam < 0 & VecteurCameraXPositonCam > 0)){AngleCamPositonCam = Math.atan( (VecteurCameraYPositonCam / VecteurCameraXPositonCam) );}else{AngleCamPositonCam = Math.atan( (VecteurCameraYPositonCam / VecteurCameraXPositonCam) ) + Math.PI;}for (var i=0; i < billboards.length ; i++){billboards[i].rotation.z = Math.abs(AngleCamPositonCam+Math.PI*2);}}}function o206( o209 ){o209.preventDefault();if(o209.which == 1 && o169 ){var o180 = document.getElementById("bdy");var o181 = document.getElementById( 'Object3D' );var o182 = parseInt(o181.style.left) + parseInt(o180.style.left) ;var o183 = o180.style.top;var o184 = parseInt(o180.style.top);if (o183.indexOf("%") >= 0){var o185 = o184 / 100;o184 = o185 * window.innerHeight;}var o186 = parseInt(o181.style.top) + o184;var o211 = o209.clientX - o182;var o212 = o209.clientY - o186;var o159 = ( o211 /  580 ) * 2 - 1;var o160 = -( o212 / 390 ) * 2 + 1;if( o158.o159 == o159 && o158.o160 == o160){o214(o159 , o160);}o169 = false ;if(o119){o119.o74();}}};function o207( o209 ){o210(o209);updateBillboardsToFaceCam();};function o205( o209 ){if(o200.checkOnScreen(o209.clientX, o209.clientY)=== false) return;o209.preventDefault();if(o209.which == 1){var o180 = document.getElementById("bdy");var o181 = document.getElementById( 'Object3D' );var o182 = parseInt(o181.style.left) + parseInt(o180.style.left) ;var o183 = o180.style.top;var o184 = parseInt(o180.style.top);if (o183.indexOf("%") >= 0) {var o185 = o184 / 100;o184 = o185 * window.innerHeight;}var o186 = parseInt(o181.style.top) + o184;var o211 = o209.clientX - o182 ;var o212 = o209.clientY - o186;o158.o159 = ( o211 /  580 ) * 2 - 1;o158.o160 = -( o212 / 390 ) * 2 + 1;o169 = true ;if(o209.shiftKey){if(o119){o119.o73();}}}};function o176(){requestAnimationFrame( o176 );updateBillboardsToFaceCam();o215();};function o213( o216 , o217){var o218 = new o140( o216, o217, 1 );o157.unprojectVector( o218, o166 );var o219 = new o146( o166.position, o218.sub( o166.position ).normalize() );var o64 = o219.intersectObjects( scene.o77.children  , true );if(o119){o119.o65(o64);}}function o214( o216 , o217){var o218 = new o140( o216, o217, 1 );o157.unprojectVector( o218, o166 );var o219 = new o146( o166.position, o218.sub( o166.position ).normalize() );var o64 = o219.intersectObjects( scene.o77.children  , true );if ( o64.length > 0 ){for( var i = 0; i< o64.length; ++i ){if( o64[ i ].object.visible == true){var o24 = o64[ i ].object.index;break;}}if( o168.hasOwnProperty( o24 ) ){o24 = o168[o24];}if(o167.hasOwnProperty(o24) ){var o220 = o167[o24];o208.o221(o220);}}};function o222(){var o223 = new o147( 1, 1000, 256 );var o224 = o164.dae.reflectionTextures;var o225 =  o164.dae.reflectionRenderTargets;for (var o226 in o224){var o227 = o224[ o226 ];o228 = new o152();var o229 = new o148( new o149( 500, 60, 40 ), new o150( { map: o227 } ) );o229.scale.x = -1;o228.add( o229 );o228.add( o223 );var o230 = o225[ o226 ];o223.renderTarget = o230;o223.updateCubeMap( o155, o228 );}};function o215() {o200.update();o222();o155.render( scene.o77, o200.object );};var o194 = function(o231,o163){var o232 = o231.instance_effect.url;var o233 = o163[ o232 ].shader;var o193 = o233.material;o193.name = o231.name == null || o231.name === '' ? o231.id : o231.name;o193.opacity = !o193.opacity ? 1 : o193.opacity;return o193;};function o234(o154) {if (!o154.hasOwnProperty('cameraTarget')) {o154.cameraTarget = new o140();}o200.target = o154.cameraTarget.clone();o200.object.position = o154.position.clone();o200.object.up = o154.up.clone();o200.object.fov = o154.fov;o200.object.near = o154.near;o200.object.far = o154.far;o200.object.updateProjectionMatrix();};function o235(o154) {var o236 = o155.domElement.width / o155.devicePixelRatio;var o237 = o155.domElement.height / o155.devicePixelRatio;var o238 = o236 / o237;o154.aspect = o238;o154.updateProjectionMatrix();o200.object = o154;if (!o154.hasOwnProperty('cameraTarget')) {o154.cameraTarget = new o140();}o200.target = o154.cameraTarget.clone();};var o199 = function (o239) {var o240;var o241 = o164.dae.cameras;for (var o242 in o241){var o243 = o241[o242];if (o243.name == o239){o240 = new o151(o243.yfov, o243.aspect_ratio, o243.znear, o243.zfar);var undefined;if (o243.camera_target != undefined){o240.cameraTarget = o243.camera_target;}if (o243.camera_up != undefined){o240.up = o243.camera_up;}if (o243.camera_position != undefined){o240.position = o243.camera_position;}return o240;}}};function o244() {var o245 = 0, o246 = 0;if( typeof( window.innerWidth ) == 'number' ) {o245 = window.innerWidth;o246 = window.innerHeight;} else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {o245 = document.documentElement.clientWidth;o246 = document.documentElement.clientHeight;} else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {o245 = document.body.clientWidth;o246 = document.body.clientHeight;}return { 'w': o245, 'h': o246 };};window.onresize=function(){var o247 = o244();var o180 = document.getElementById("bdy");if(600< o247.w)o180.style.left = parseInt((o247.w - 600)/2) + "px";else{o180.style.left = "0px";}var o201 =  o179();if(typeof(o200) != "undefined"){o200.SetScreenSize(o201.annotLeft,o201.annotTop,580,390);}};function o250(o248 , o249,messageID) {o251 = document;o174 = true;if(o251.getElementById(messageID)) return;o252 = o251.getElementsByTagName("body")[0].appendChild(o251.createElement("div"));o252.id = messageID;o252.className ="modalContainer";o252.style.left = "0px";o253 = o252.appendChild(o251.createElement("div"));o253.id = "alertBox";o254 = o253.appendChild(o251.createElement("h3"));o254.appendChild(o251.createTextNode(o248));o255 = o253.appendChild(o251.createElement("h5"));o255.innerHTML = o249;o256 = o253.appendChild(o251.createElement("a"));o256.id = "closeBtn";o256.appendChild(o251.createTextNode("Ok"));o256.href = "#";o256.onclick = function() { o257(messageID); o174 = false ; return false; };};function prepopulateFormTextBoxJSMethod(o258) {o251 = document;var o259 = [];var o260 = {};for( i=0, count= o259.length;i<count; ++i ){o251.getElementById(o259[i]).value = o260[o258][o259[i]];}};function o257(messageID) {document.getElementsByTagName("body")[0].removeChild(document.getElementById(messageID));};window.addEventListener("load",function() {var o247 = o244();var o180 = document.getElementById("bdy");if( 600 < o247.w){o180.style.left = parseInt((o247.w - 600)/2) + "px";}else{o180.style.left = "0px";}},true);o261= new o81();o262  = new o9();o263  = new o38();o119  = new o56();function o264(){this.o265= [];this.o268= function( o266, o267, o220 ){o269= o267;for( i=0; i< o220; ++i ){o270= o266[ 0 + o269 ];o269 += o270;}return o269;};this.o221= function( o220 ){if(o174){return;}o266= this.o265[ o220 ];o267= 0;this.o271( o266, o267 );};var currentSequenceReference = "";var soundAction = new Audio();this.o271= function( o266, o267 ){o272= o266[1+o267];switch( o272 ){case 0:{o273= o266[2+o267];isLocalHtml = o266[3+o267];if(isLocalHtml){OpenLocalHtmlFile(o273);}else{window.open(o273);}}break;case 1:{o248= o266[2+o267];o249= o266[3+o267];globalCounter++;var messageID = "modalContainer"+globalCounter;o250(o248 , o249,messageID);}break;case 2 :{o137 = o266[2+o267];o261.o104( o137 , true, true );}break;case 3 :{o274 = o266[2+o267];o275=o274;o275();}break;case 4 :{this.o276( o266, o267 );}break;case 5 :{var animationExist = false;var o277= 1000.0 / 15.000000000000000 ;if ( o262.o20 == true){o262.o13 =  1;}o32= o266[2+o267];o33=[0,0];o33[0]= o266[3+o267];o33[1]= o266[4+o267];this.o278( o277,false );this.o279( 0,0,o277,false );if(o32 ==false){o262.o19=  o33[0];}this.o278( o277,true );}break;case 6 :{this.o278( o277,false );}break;case 7 :{o258= o266[2+o267];prepopulateFormTextBoxJSMethod(o258);}break;case 8 :{o280  = o266[2+o267];o281 = o266[3+o267];soundAction.src = o280;soundAction.loop = o281;soundAction.play();}break;case 9 :{var o277= 1000.0 / 15.000000000000000 ;o32= true;o33=[0,0];o45  = o266[2+o267];o282 = o266[3+o267];this.o279(o45, o282, o277,false);this.o278( o277,false );if(o32 ==false){o263.o44=  o33[0];}if ( o263.o20 == true){o263.o44 = 0;o263.o13 =  1;}this.o279(o45, o282, o277,true);}}};this.PlayAnimationAtStart= function(){var animationExist = false;var o277= 1000.0 / 15.000000000000000 ;this.o278( o277,true );};this.m_isPlay= false;this.o278= function( o277 ,playAnimation){if(playAnimation && !this.m_isPlay){this.o283= setInterval(function(){myTimer()},o277);this.m_isPlay=true;}if(!playAnimation ){clearInterval( this.o283 );this.m_isPlay= false;}function myTimer(){o262.o37();}};this.m_isSequencePlay= false;this.o279= function(o45, o282,o277 ,playAnimation){if(playAnimation && !this.m_isSequencePlay){this.o284= setInterval(function(){mySequenceTimer(o45,o282)},o277);this.m_isSequencePlay=true;}if(!playAnimation ){if(currentSequenceReference != o45){o263.SeekSequenceToEnd();currentSequenceReference = o45;}clearInterval( this.o284 );this.m_isSequencePlay= false;}function mySequenceTimer(o45,o282){o263.o53(o45,o282);}};this.o276= function( o266, o267 ){var o285= o266[0+o267];var o286= o266[1+o267];var o287= o266[2+o267];var o288= o266[3+o267];var o289= o266[4+o267];var o290= o266[5+o267];var o291= o266[6+o267];var o292= 7+o267;if( o291 == 0 ){return;}if( o287 == 1 ){o293= o292;for( var i=0; i< o291; ++i ){this.o271( o266, o293 );o294= o266[ o293 ];o293 += o294;}}else if( o287 == 4 ){o295= Math.floor( Math.random()*o291 );if( o291 >= 2 ){while( o295 == o288 ){o295= Math.floor( Math.random()*o291 );}o266[3+o267]= o295;}o296= this.o268( o266, o292, o295 );this.o271( o266, o296 );}else{o296= this.o268( o266, o292, o289 );this.o271( o266, o296 );if( o291 < 2 ){return;}if( o287 == 2 ){o297= o289 + 1;if( o290 ){o297= o289 - 1;}if( o297 >= o291 ){o290= true;o297= o291 - 2;}else if( o297 < 0 ){o290= false;o297= 1;}o289= o297;}else if( o287 == 3 ){o297= o289 + 1;if( o297 >= o291 ){o297= 0;}o289= o297;}o266[4+o267]= o289;o266[5+o267]= o290;}};};o208= new o264;</script>
</head>
<body id="bdy" style="overflow:auto;top:0%;position:absolute;padding:0;margin:0;">
<div style="position:absolute; width:600; height:480;">
<div class='popup'>
<div class='content'>
<img src='test-3d_files/closeLocalFileIcon.png' alt='quit' class='x' id='x' />
<iframe  id="iframeId" border=0 width="100%" height ="95%" style="z-index:205" src=""></iframe>
</div>
</div> 
<label style="position:absolute;"><div style="z-index:5;position:relative; width:87px; top:430px; left:80px; background-color:rgba(255,255,255,0); font-family:'MS Shell Dlg 2'; font-size:8.25pt; font-weight:400; font-style:normal;">
<p style=" margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;"><span style=" font-family:'Verdana'; font-size:16pt; color:#5a2f13;">Test 3D</span></p></div></label>
<div id="Object3D" style="z-index:6;position:absolute;left:10px; top:7px; width:580px; height:390px;background-color:rgba(210,210,210,0);"></div>
<div style="z-index:99999; visibility:hidden; position:absolute; left:10px; top:7px; width:580px; height:390px; text-align: center;">
<div class="opacityEffect" id="progressText"></div>
</div>
<div style="z-index:99998; visibility:hidden; position:absolute; left:10px; top:7px; width:580px; height:390px; text-align: center;">
<div class="progress opacityEffect glowEffect" id="progress"></div>
</div>
<div style="z-index:99997; visibility:hidden; position:absolute; left:10px; top:7px; width:580px; height:390px; text-align: center;">
<div class="rotating progress opacityEffect glowEffect" id="progress2"></div>
</div>
</div>
<script type="text/javascript">
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.ProgressBar=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(b,c,d){(function(){var b=this,e=function(){"use strict";function e(){}function f(a,b){var c;for(c in a)Object.hasOwnProperty.call(a,c)&&b(c)}function g(a,b){return f(b,function(c){a[c]=b[c]}),a}function h(a,b){f(b,function(c){"undefined"==typeof a[c]&&(a[c]=b[c])})}function i(a,b,c,d,e,f,g){var h,i,k,l=f>a?0:(a-f)/e;for(h in b)b.hasOwnProperty(h)&&(i=g[h],k="function"==typeof i?i:o[i],b[h]=j(c[h],d[h],k,l));return b}function j(a,b,c,d){return a+(b-a)*c(d)}function k(a,b){var c=n.prototype.filter,d=a._filterArgs;f(c,function(e){"undefined"!=typeof c[e][b]&&c[e][b].apply(a,d)})}function l(a,b,c,d,e,f,g,h,j,l,m){v=b+c+d,w=Math.min(m||u(),v),x=w>=v,y=d-(v-w),a.isPlaying()&&!x?(a._scheduleId=l(a._timeoutHandler,s),k(a,"beforeTween"),b+c>w?i(1,e,f,g,1,1,h):i(w,e,f,g,d,b+c,h),k(a,"afterTween"),j(e,a._attachment,y)):a.isPlaying()&&x&&(j(g,a._attachment,y),a.stop(!0))}function m(a,b){var c={},d=typeof b;return"string"===d||"function"===d?f(a,function(a){c[a]=b}):f(a,function(a){c[a]||(c[a]=b[a]||q)}),c}function n(a,b){this._currentState=a||{},this._configured=!1,this._scheduleFunction=p,"undefined"!=typeof b&&this.setConfig(b)}var o,p,q="linear",r=500,s=1e3/60,t=Date.now?Date.now:function(){return+new Date},u="undefined"!=typeof SHIFTY_DEBUG_NOW?SHIFTY_DEBUG_NOW:t;p="undefined"!=typeof window?window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||window.mozCancelRequestAnimationFrame&&window.mozRequestAnimationFrame||setTimeout:setTimeout;var v,w,x,y;return n.prototype.tween=function(a){return this._isTweening?this:(void 0===a&&this._configured||this.setConfig(a),this._timestamp=u(),this._start(this.get(),this._attachment),this.resume())},n.prototype.setConfig=function(a){a=a||{},this._configured=!0,this._attachment=a.attachment,this._pausedAtTime=null,this._scheduleId=null,this._delay=a.delay||0,this._start=a.start||e,this._step=a.step||e,this._finish=a.finish||e,this._duration=a.duration||r,this._currentState=g({},a.from)||this.get(),this._originalState=this.get(),this._targetState=g({},a.to)||this.get();var b=this;this._timeoutHandler=function(){l(b,b._timestamp,b._delay,b._duration,b._currentState,b._originalState,b._targetState,b._easing,b._step,b._scheduleFunction)};var c=this._currentState,d=this._targetState;return h(d,c),this._easing=m(c,a.easing||q),this._filterArgs=[c,this._originalState,d,this._easing],k(this,"tweenCreated"),this},n.prototype.get=function(){return g({},this._currentState)},n.prototype.set=function(a){this._currentState=a},n.prototype.pause=function(){return this._pausedAtTime=u(),this._isPaused=!0,this},n.prototype.resume=function(){return this._isPaused&&(this._timestamp+=u()-this._pausedAtTime),this._isPaused=!1,this._isTweening=!0,this._timeoutHandler(),this},n.prototype.seek=function(a){a=Math.max(a,0);var b=u();return this._timestamp+a===0?this:(this._timestamp=b-a,this.isPlaying()||(this._isTweening=!0,this._isPaused=!1,l(this,this._timestamp,this._delay,this._duration,this._currentState,this._originalState,this._targetState,this._easing,this._step,this._scheduleFunction,b),this.pause()),this)},n.prototype.stop=function(a){return this._isTweening=!1,this._isPaused=!1,this._timeoutHandler=e,(b.cancelAnimationFrame||b.webkitCancelAnimationFrame||b.oCancelAnimationFrame||b.msCancelAnimationFrame||b.mozCancelRequestAnimationFrame||b.clearTimeout)(this._scheduleId),a&&(k(this,"beforeTween"),i(1,this._currentState,this._originalState,this._targetState,1,0,this._easing),k(this,"afterTween"),k(this,"afterTweenEnd"),this._finish.call(this,this._currentState,this._attachment)),this},n.prototype.isPlaying=function(){return this._isTweening&&!this._isPaused},n.prototype.setScheduleFunction=function(a){this._scheduleFunction=a},n.prototype.dispose=function(){var a;for(a in this)this.hasOwnProperty(a)&&delete this[a]},n.prototype.filter={},n.prototype.formula={linear:function(a){return a}},o=n.prototype.formula,g(n,{now:u,each:f,tweenProps:i,tweenProp:j,applyFilter:k,shallowCopy:g,defaults:h,composeEasingObject:m}),"function"==typeof SHIFTY_DEBUG_NOW&&(b.timeoutHandler=l),"object"==typeof d?c.exports=n:"function"==typeof a&&a.amd?a(function(){return n}):"undefined"==typeof b.Tweenable&&(b.Tweenable=n),n}();!function(){e.shallowCopy(e.prototype.formula,{easeInQuad:function(a){return Math.pow(a,2)},easeOutQuad:function(a){return-(Math.pow(a-1,2)-1)},easeInOutQuad:function(a){return(a/=.5)<1?.5*Math.pow(a,2):-.5*((a-=2)*a-2)},easeInCubic:function(a){return Math.pow(a,3)},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutCubic:function(a){return(a/=.5)<1?.5*Math.pow(a,3):.5*(Math.pow(a-2,3)+2)},easeInQuart:function(a){return Math.pow(a,4)},easeOutQuart:function(a){return-(Math.pow(a-1,4)-1)},easeInOutQuart:function(a){return(a/=.5)<1?.5*Math.pow(a,4):-.5*((a-=2)*Math.pow(a,3)-2)},easeInQuint:function(a){return Math.pow(a,5)},easeOutQuint:function(a){return Math.pow(a-1,5)+1},easeInOutQuint:function(a){return(a/=.5)<1?.5*Math.pow(a,5):.5*(Math.pow(a-2,5)+2)},easeInSine:function(a){return-Math.cos(a*(Math.PI/2))+1},easeOutSine:function(a){return Math.sin(a*(Math.PI/2))},easeInOutSine:function(a){return-.5*(Math.cos(Math.PI*a)-1)},easeInExpo:function(a){return 0===a?0:Math.pow(2,10*(a-1))},easeOutExpo:function(a){return 1===a?1:-Math.pow(2,-10*a)+1},easeInOutExpo:function(a){return 0===a?0:1===a?1:(a/=.5)<1?.5*Math.pow(2,10*(a-1)):.5*(-Math.pow(2,-10*--a)+2)},easeInCirc:function(a){return-(Math.sqrt(1-a*a)-1)},easeOutCirc:function(a){return Math.sqrt(1-Math.pow(a-1,2))},easeInOutCirc:function(a){return(a/=.5)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)},easeOutBounce:function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},easeInBack:function(a){var b=1.70158;return a*a*((b+1)*a-b)},easeOutBack:function(a){var b=1.70158;return(a-=1)*a*((b+1)*a+b)+1},easeInOutBack:function(a){var b=1.70158;return(a/=.5)<1?.5*(a*a*(((b*=1.525)+1)*a-b)):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},elastic:function(a){return-1*Math.pow(4,-8*a)*Math.sin((6*a-1)*(2*Math.PI)/2)+1},swingFromTo:function(a){var b=1.70158;return(a/=.5)<1?.5*(a*a*(((b*=1.525)+1)*a-b)):.5*((a-=2)*a*(((b*=1.525)+1)*a+b)+2)},swingFrom:function(a){var b=1.70158;return a*a*((b+1)*a-b)},swingTo:function(a){var b=1.70158;return(a-=1)*a*((b+1)*a+b)+1},bounce:function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},bouncePast:function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?2-(7.5625*(a-=1.5/2.75)*a+.75):2.5/2.75>a?2-(7.5625*(a-=2.25/2.75)*a+.9375):2-(7.5625*(a-=2.625/2.75)*a+.984375)},easeFromTo:function(a){return(a/=.5)<1?.5*Math.pow(a,4):-.5*((a-=2)*Math.pow(a,3)-2)},easeFrom:function(a){return Math.pow(a,4)},easeTo:function(a){return Math.pow(a,.25)}})}(),function(){function a(a,b,c,d,e,f){function g(a){return((n*a+o)*a+p)*a}function h(a){return((q*a+r)*a+s)*a}function i(a){return(3*n*a+2*o)*a+p}function j(a){return 1/(200*a)}function k(a,b){return h(m(a,b))}function l(a){return a>=0?a:0-a}function m(a,b){var c,d,e,f,h,j;for(e=a,j=0;8>j;j++){if(f=g(e)-a,l(f)<b)return e;if(h=i(e),l(h)<1e-6)break;e-=f/h}if(c=0,d=1,e=a,c>e)return c;if(e>d)return d;for(;d>c;){if(f=g(e),l(f-a)<b)return e;a>f?c=e:d=e,e=.5*(d-c)+c}return e}var n=0,o=0,p=0,q=0,r=0,s=0;return p=3*b,o=3*(d-b)-p,n=1-p-o,s=3*c,r=3*(e-c)-s,q=1-s-r,k(a,j(f))}function b(b,c,d,e){return function(f){return a(f,b,c,d,e,1)}}e.setBezierFunction=function(a,c,d,f,g){var h=b(c,d,f,g);return h.displayName=a,h.x1=c,h.y1=d,h.x2=f,h.y2=g,e.prototype.formula[a]=h},e.unsetBezierFunction=function(a){delete e.prototype.formula[a]}}(),function(){function a(a,b,c,d,f,g){return e.tweenProps(d,b,a,c,1,g,f)}var b=new e;b._filterArgs=[],e.interpolate=function(c,d,f,g,h){var i=e.shallowCopy({},c),j=h||0,k=e.composeEasingObject(c,g||"linear");b.set({});var l=b._filterArgs;l.length=0,l[0]=i,l[1]=c,l[2]=d,l[3]=k,e.applyFilter(b,"tweenCreated"),e.applyFilter(b,"beforeTween");var m=a(c,i,d,f,k,j);return e.applyFilter(b,"afterTween"),m}}(),function(a){function b(a,b){var c,d=[],e=a.length;for(c=0;e>c;c++)d.push("_"+b+"_"+c);return d}function c(a){var b=a.match(v);return b?(1===b.length||a[0].match(u))&&b.unshift(""):b=["",""],b.join(A)}function d(b){a.each(b,function(a){var c=b[a];"string"==typeof c&&c.match(z)&&(b[a]=e(c))})}function e(a){return i(z,a,f)}function f(a){var b=g(a);return"rgb("+b[0]+","+b[1]+","+b[2]+")"}function g(a){return a=a.replace(/#/,""),3===a.length&&(a=a.split(""),a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),B[0]=h(a.substr(0,2)),B[1]=h(a.substr(2,2)),B[2]=h(a.substr(4,2)),B}function h(a){return parseInt(a,16)}function i(a,b,c){var d=b.match(a),e=b.replace(a,A);if(d)for(var f,g=d.length,h=0;g>h;h++)f=d.shift(),e=e.replace(A,c(f));return e}function j(a){return i(x,a,k)}function k(a){for(var b=a.match(w),c=b.length,d=a.match(y)[0],e=0;c>e;e++)d+=parseInt(b[e],10)+",";return d=d.slice(0,-1)+")"}function l(d){var e={};return a.each(d,function(a){var f=d[a];if("string"==typeof f){var g=r(f);e[a]={formatString:c(f),chunkNames:b(g,a)}}}),e}function m(b,c){a.each(c,function(a){for(var d=b[a],e=r(d),f=e.length,g=0;f>g;g++)b[c[a].chunkNames[g]]=+e[g];delete b[a]})}function n(b,c){a.each(c,function(a){var d=b[a],e=o(b,c[a].chunkNames),f=p(e,c[a].chunkNames);d=q(c[a].formatString,f),b[a]=j(d)})}function o(a,b){for(var c,d={},e=b.length,f=0;e>f;f++)c=b[f],d[c]=a[c],delete a[c];return d}function p(a,b){C.length=0;for(var c=b.length,d=0;c>d;d++)C.push(a[b[d]]);return C}function q(a,b){for(var c=a,d=b.length,e=0;d>e;e++)c=c.replace(A,+b[e].toFixed(4));return c}function r(a){return a.match(w)}function s(b,c){a.each(c,function(a){var d,e=c[a],f=e.chunkNames,g=f.length,h=b[a];if("string"==typeof h){var i=h.split(" "),j=i[i.length-1];for(d=0;g>d;d++)b[f[d]]=i[d]||j}else for(d=0;g>d;d++)b[f[d]]=h;delete b[a]})}function t(b,c){a.each(c,function(a){var d=c[a],e=d.chunkNames,f=e.length,g=b[e[0]],h=typeof g;if("string"===h){for(var i="",j=0;f>j;j++)i+=" "+b[e[j]],delete b[e[j]];b[a]=i.substr(1)}else b[a]=g})}var u=/(\d|\-|\.)/,v=/([^\-0-9\.]+)/g,w=/[0-9.\-]+/g,x=new RegExp("rgb\\("+w.source+/,\s*/.source+w.source+/,\s*/.source+w.source+"\\)","g"),y=/^.*\(/,z=/#([0-9]|[a-f]){3,6}/gi,A="VAL",B=[],C=[];a.prototype.filter.token={tweenCreated:function(a,b,c,e){d(a),d(b),d(c),this._tokenData=l(a)},beforeTween:function(a,b,c,d){s(d,this._tokenData),m(a,this._tokenData),m(b,this._tokenData),m(c,this._tokenData)},afterTween:function(a,b,c,d){n(a,this._tokenData),n(b,this._tokenData),n(c,this._tokenData),t(d,this._tokenData)}}}(e)}).call(null)},{}],2:[function(a,b,c){var d=a("./shape"),e=a("./utils"),f=function(a,b){this._pathTemplate="M 50,50 m 0,-{radius} a {radius},{radius} 0 1 1 0,{2radius} a {radius},{radius} 0 1 1 0,-{2radius}",d.apply(this,arguments)};f.prototype=new d,f.prototype.constructor=f,f.prototype._pathString=function(a){var b=a.strokeWidth;a.trailWidth&&a.trailWidth>a.strokeWidth&&(b=a.trailWidth);var c=50-b/2;return e.render(this._pathTemplate,{radius:c,"2radius":2*c})},f.prototype._trailString=function(a){return this._pathString(a)},b.exports=f},{"./shape":7,"./utils":8}],3:[function(a,b,c){var d=a("./shape"),e=a("./utils"),f=function(a,b){this._pathTemplate="M 0,{center} L 100,{center}",d.apply(this,arguments)};f.prototype=new d,f.prototype.constructor=f,f.prototype._initializeSvg=function(a,b){a.setAttribute("viewBox","0 0 100 "+b.strokeWidth),a.setAttribute("preserveAspectRatio","none")},f.prototype._pathString=function(a){return e.render(this._pathTemplate,{center:a.strokeWidth/2})},f.prototype._trailString=function(a){return this._pathString(a)},b.exports=f},{"./shape":7,"./utils":8}],4:[function(a,b,c){b.exports={Line:a("./line"),Circle:a("./circle"),SemiCircle:a("./semicircle"),Path:a("./path"),Shape:a("./shape"),utils:a("./utils")}},{"./circle":2,"./line":3,"./path":5,"./semicircle":6,"./shape":7,"./utils":8}],5:[function(a,b,c){var d=a("shifty"),e=a("./utils"),f={easeIn:"easeInCubic",easeOut:"easeOutCubic",easeInOut:"easeInOutCubic"},g=function(a,b){b=e.extend({duration:800,easing:"linear",from:{},to:{},step:function(){}},b);var c;c=e.isString(a)?document.querySelector(a):a,this.path=c,this._opts=b,this._tweenable=null;var d=this.path.getTotalLength();this.path.style.strokeDasharray=d+" "+d,this.set(0)};g.prototype.value=function(){var a=this._getComputedDashOffset(),b=this.path.getTotalLength(),c=1-a/b;return parseFloat(c.toFixed(6),10)},g.prototype.set=function(a){this.stop(),this.path.style.strokeDashoffset=this._progressToOffset(a);var b=this._opts.step;if(e.isFunction(b)){var c=this._easing(this._opts.easing),d=this._calculateTo(a,c),f=this._opts.shape||this;b(d,f,this._opts.attachment)}},g.prototype.stop=function(){this._stopTween(),this.path.style.strokeDashoffset=this._getComputedDashOffset()},g.prototype.animate=function(a,b,c){b=b||{},e.isFunction(b)&&(c=b,b={});var f=e.extend({},b),g=e.extend({},this._opts);b=e.extend(g,b);var h=this._easing(b.easing),i=this._resolveFromAndTo(a,h,f);this.stop(),this.path.getBoundingClientRect();var j=this._getComputedDashOffset(),k=this._progressToOffset(a),l=this;this._tweenable=new d,this._tweenable.tween({from:e.extend({offset:j},i.from),to:e.extend({offset:k},i.to),duration:b.duration,easing:h,step:function(a){l.path.style.strokeDashoffset=a.offset;var c=b.shape||l;b.step(a,c,b.attachment)},finish:function(a){e.isFunction(c)&&c()}})},g.prototype._getComputedDashOffset=function(){var a=window.getComputedStyle(this.path,null);return parseFloat(a.getPropertyValue("stroke-dashoffset"),10)},g.prototype._progressToOffset=function(a){var b=this.path.getTotalLength();return b-a*b},g.prototype._resolveFromAndTo=function(a,b,c){return c.from&&c.to?{from:c.from,to:c.to}:{from:this._calculateFrom(b),to:this._calculateTo(a,b)}},g.prototype._calculateFrom=function(a){return d.interpolate(this._opts.from,this._opts.to,this.value(),a)},g.prototype._calculateTo=function(a,b){return d.interpolate(this._opts.from,this._opts.to,a,b)},g.prototype._stopTween=function(){null!==this._tweenable&&(this._tweenable.stop(),this._tweenable.dispose(),this._tweenable=null)},g.prototype._easing=function(a){return f.hasOwnProperty(a)?f[a]:a},b.exports=g},{"./utils":8,shifty:1}],6:[function(a,b,c){var d=a("./shape"),e=a("./circle"),f=a("./utils"),g=function(a,b){this._pathTemplate="M 50,50 m -{radius},0 a {radius},{radius} 0 1 1 {2radius},0",d.apply(this,arguments)};g.prototype=new d,g.prototype.constructor=g,g.prototype._initializeSvg=function(a,b){a.setAttribute("viewBox","0 0 100 50")},g.prototype._initializeTextElement=function(a,b,c){a.text.style&&(c.style.top="auto",c.style.bottom="0",a.text.alignToBottom?f.setStyle(c,"transform","translate(-50%, 0)"):f.setStyle(c,"transform","translate(-50%, 50%)"))},g.prototype._pathString=e.prototype._pathString,g.prototype._trailString=e.prototype._trailString,b.exports=g},{"./circle":2,"./shape":7,"./utils":8}],7:[function(a,b,c){var d=a("./path"),e=a("./utils"),f="Object is destroyed",g=function h(a,b){if(!(this instanceof h))throw new Error("Constructor was called without new keyword");if(0!==arguments.length){this._opts=e.extend({color:"#555",strokeWidth:1,trailColor:null,trailWidth:null,fill:null,text:{style:{color:null,position:"absolute",left:"50%",top:"50%",padding:0,margin:0,transform:{prefix:!0,value:"translate(-50%, -50%)"}},alignToBottom:!0,value:"",className:"progressbar-text"},svgStyle:{display:"block",width:"100%"}},b,!0);var c,f=this._createSvgView(this._opts);if(c=e.isString(a)?document.querySelector(a):a,!c)throw new Error("Container does not exist: "+a);this._container=c,this._container.appendChild(f.svg),this._opts.svgStyle&&e.setStyles(f.svg,this._opts.svgStyle),this.text=null,this._opts.text.value&&(this.text=this._createTextElement(this._opts,this._container),this._container.appendChild(this.text)),this.svg=f.svg,this.path=f.path,this.trail=f.trail;var g=e.extend({attachment:void 0,shape:this},this._opts);this._progressPath=new d(f.path,g)}};g.prototype.animate=function(a,b,c){if(null===this._progressPath)throw new Error(f);this._progressPath.animate(a,b,c)},g.prototype.stop=function(){if(null===this._progressPath)throw new Error(f);void 0!==this._progressPath&&this._progressPath.stop()},g.prototype.destroy=function(){if(null===this._progressPath)throw new Error(f);this.stop(),this.svg.parentNode.removeChild(this.svg),this.svg=null,this.path=null,this.trail=null,this._progressPath=null,null!==this.text&&(this.text.parentNode.removeChild(this.text),this.text=null)},g.prototype.set=function(a){if(null===this._progressPath)throw new Error(f);this._progressPath.set(a)},g.prototype.value=function(){if(null===this._progressPath)throw new Error(f);return void 0===this._progressPath?0:this._progressPath.value()},g.prototype.setText=function(a){if(null===this._progressPath)throw new Error(f);null===this.text&&(this.text=this._createTextElement(this._opts,this._container),this._container.appendChild(this.text)),this.text.removeChild(this.text.firstChild),this.text.appendChild(document.createTextNode(a))},g.prototype._createSvgView=function(a){var b=document.createElementNS("http://www.w3.org/2000/svg","svg");this._initializeSvg(b,a);var c=null;(a.trailColor||a.trailWidth)&&(c=this._createTrail(a),b.appendChild(c));var d=this._createPath(a);return b.appendChild(d),{svg:b,path:d,trail:c}},g.prototype._initializeSvg=function(a,b){a.setAttribute("viewBox","0 0 100 100")},g.prototype._createPath=function(a){var b=this._pathString(a);return this._createPathElement(b,a)},g.prototype._createTrail=function(a){var b=this._trailString(a),c=e.extend({},a);return c.trailColor||(c.trailColor="#eee"),c.trailWidth||(c.trailWidth=c.strokeWidth),c.color=c.trailColor,c.strokeWidth=c.trailWidth,c.fill=null,this._createPathElement(b,c)},g.prototype._createPathElement=function(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg","path");return c.setAttribute("d",a),c.setAttribute("stroke",b.color),c.setAttribute("stroke-width",b.strokeWidth),b.fill?c.setAttribute("fill",b.fill):c.setAttribute("fill-opacity","0"),c},g.prototype._createTextElement=function(a,b){var c=document.createElement("p");c.appendChild(document.createTextNode(a.text.value));var d=a.text.style;return d&&(b.style.position="relative",e.setStyles(c,d),d.color||(c.style.color=a.color)),c.className=a.text.className,this._initializeTextElement(a,b,c),c},g.prototype._initializeTextElement=function(a,b,c){},g.prototype._pathString=function(a){throw new Error("Override this function for each progress bar")},g.prototype._trailString=function(a){throw new Error("Override this function for each progress bar")},b.exports=g},{"./path":5,"./utils":8}],8:[function(a,b,c){function d(a,b,c){a=a||{},b=b||{},c=c||!1;for(var e in b)if(b.hasOwnProperty(e)){var f=a[e],g=b[e];c&&l(f)&&l(g)?a[e]=d(f,g,c):a[e]=g}return a}function e(a,b){var c=a;for(var d in b)if(b.hasOwnProperty(d)){var e=b[d],f="\\{"+d+"\\}",g=new RegExp(f,"g");c=c.replace(g,e)}return c}function f(a,b,c){for(var d=0;d<n.length;++d){var e=n[d];a.style[e+h(b)]=c}a.style[b]=c}function g(a,b){m(b,function(b,c){null!==b&&void 0!==b&&(l(b)&&b.prefix===!0?f(a,c,b.value):a.style[c]=b)})}function h(a){return a.charAt(0).toUpperCase()+a.slice(1)}function i(a){return"string"==typeof a||a instanceof String}function j(a){return"function"==typeof a}function k(a){return"[object Array]"===Object.prototype.toString.call(a)}function l(a){if(k(a))return!1;var b=typeof a;return"object"===b&&!!a}function m(a,b){for(var c in a)if(a.hasOwnProperty(c)){var d=a[c];b(d,c)}}var n="Webkit Moz O ms".split(" ");b.exports={extend:d,render:e,setStyle:f,setStyles:g,capitalize:h,isString:i,isFunction:j,isObject:l,forEachObject:m}},{}]},{},[4])(4)});
</script>
</body>
</html>
